import{b as fI,c as pI,f as sz,g as hI}from"./chunk-AQT7K737.js";import{a as B,b as ne,c as hy,d as Sl,f as ar,h as gy,i as oz,j as C}from"./chunk-TWZW5B45.js";var HC=ar(UC=>{"use strict";Object.defineProperty(UC,"__esModule",{value:!0});var BC=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};UC.default=BC});var $C=ar(Ku=>{"use strict";var vk=Ku&&Ku.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ku,"__esModule",{value:!0});var P6=vk((hI(),oz(sz))),A6=vk(HC()),WC=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=P6.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let i=this.fetch,r=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(o=>C(this,null,function*(){var s,l,c;let u=null,f=null,m=null,w=o.status,b=o.statusText;if(o.ok){if(this.method!=="HEAD"){let P=yield o.text();P===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?f=P:f=JSON.parse(P))}let T=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),M=(l=o.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");T&&M&&M.length>1&&(m=parseInt(M[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,m=null,w=406,b="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{let T=yield o.text();try{u=JSON.parse(T),Array.isArray(u)&&o.status===404&&(f=[],u=null,w=200,b="OK")}catch{o.status===404&&T===""?(w=204,b="No Content"):u={message:T}}if(u&&this.isMaybeSingle&&(!((c=u?.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,w=200,b="OK"),u&&this.shouldThrowOnError)throw new A6.default(u)}return{error:u,data:f,count:m,status:w,statusText:b}}));return this.shouldThrowOnError||(r=r.catch(o=>{var s,l,c;return{error:{message:`${(s=o?.name)!==null&&s!==void 0?s:"FetchError"}: ${o?.message}`,details:`${(l=o?.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=o?.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}};Ku.default=WC});var GC=ar(Ju=>{"use strict";var R6=Ju&&Ju.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ju,"__esModule",{value:!0});var k6=R6($C()),qC=class extends k6.default{select(e){let t=!1,i=(e??"*").split("").map(r=>/\s/.test(r)&&!t?"":(r==='"'&&(t=!t),r)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:i,foreignTable:r,referencedTable:o=r}={}){let s=o?`${o}.order`:"order",l=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:i=t}={}){let r=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:i,referencedTable:r=i}={}){let o=typeof r>"u"?"offset":`${r}.offset`,s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:i=!1,buffers:r=!1,wal:o=!1,format:s="text"}={}){var l;let c=[e?"analyze":null,t?"verbose":null,i?"settings":null,r?"buffers":null,o?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${u}"; options=${c};`,s==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ju.default=qC});var nv=ar(Xu=>{"use strict";var O6=Xu&&Xu.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Xu,"__esModule",{value:!0});var N6=O6(GC()),ZC=class extends N6.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let i=Array.from(new Set(t)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${i})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:i,type:r}={}){let o="";r==="plain"?o="pl":r==="phrase"?o="ph":r==="websearch"&&(o="w");let s=i===void 0?"":`(${i})`;return this.url.searchParams.append(e,`${o}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([t,i])=>{this.url.searchParams.append(t,`eq.${i}`)}),this}not(e,t,i){return this.url.searchParams.append(e,`not.${t}.${i}`),this}or(e,{foreignTable:t,referencedTable:i=t}={}){let r=i?`${i}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,i){return this.url.searchParams.append(e,`${t}.${i}`),this}};Xu.default=ZC});var QC=ar(tf=>{"use strict";var L6=tf&&tf.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(tf,"__esModule",{value:!0});var ef=L6(nv()),YC=class{constructor(e,{headers:t={},schema:i,fetch:r}){this.url=e,this.headers=t,this.schema=i,this.fetch=r}select(e,{head:t=!1,count:i}={}){let r=t?"HEAD":"GET",o=!1,s=(e??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",s),i&&(this.headers.Prefer=`count=${i}`),new ef.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:i=!0}={}){let r="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),t&&o.push(`count=${t}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){let s=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(s.length>0){let l=[...new Set(s)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ef.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:i=!1,count:r,defaultToNull:o=!0}={}){let s="POST",l=[`resolution=${i?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){let c=e.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(c.length>0){let u=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new ef.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let i="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new ef.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t="DELETE",i=[];return e&&i.push(`count=${e}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new ef.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};tf.default=YC});var _k=ar(iv=>{"use strict";Object.defineProperty(iv,"__esModule",{value:!0});iv.version=void 0;iv.version="0.0.0-automated"});var yk=ar(rv=>{"use strict";Object.defineProperty(rv,"__esModule",{value:!0});rv.DEFAULT_HEADERS=void 0;var F6=_k();rv.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${F6.version}`}});var wk=ar(nf=>{"use strict";var bk=nf&&nf.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(nf,"__esModule",{value:!0});var z6=bk(QC()),V6=bk(nv()),j6=yk(),KC=class n{constructor(e,{headers:t={},schema:i,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},j6.DEFAULT_HEADERS),t),this.schemaName=i,this.fetch=r}from(e){let t=new URL(`${this.url}/${e}`);return new z6.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new n(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:i=!1,get:r=!1,count:o}={}){let s,l=new URL(`${this.url}/rpc/${e}`),c;i||r?(s=i?"HEAD":"GET",Object.entries(t).filter(([f,m])=>m!==void 0).map(([f,m])=>[f,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([f,m])=>{l.searchParams.append(f,m)})):(s="POST",c=t);let u=Object.assign({},this.headers);return o&&(u.Prefer=`count=${o}`),new V6.default({method:s,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};nf.default=KC});var Mk=ar(On=>{"use strict";var Dc=On&&On.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(On,"__esModule",{value:!0});On.PostgrestError=On.PostgrestBuilder=On.PostgrestTransformBuilder=On.PostgrestFilterBuilder=On.PostgrestQueryBuilder=On.PostgrestClient=void 0;var Sk=Dc(wk());On.PostgrestClient=Sk.default;var Ck=Dc(QC());On.PostgrestQueryBuilder=Ck.default;var Ek=Dc(nv());On.PostgrestFilterBuilder=Ek.default;var xk=Dc(GC());On.PostgrestTransformBuilder=xk.default;var Dk=Dc($C());On.PostgrestBuilder=Dk.default;var Ik=Dc(HC());On.PostgrestError=Ik.default;On.default={PostgrestClient:Sk.default,PostgrestQueryBuilder:Ck.default,PostgrestFilterBuilder:Ek.default,PostgrestTransformBuilder:xk.default,PostgrestBuilder:Dk.default,PostgrestError:Ik.default}});var TF=ar((S0,MF)=>{"use strict";(function(n,e){typeof S0=="object"&&typeof MF<"u"?e(S0):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis<"u"?globalThis:n||self,e(n.leaflet={}))})(S0,function(n){"use strict";var e="1.9.4";function t(a){var d,h,y,S;for(h=1,y=arguments.length;h<y;h++){S=arguments[h];for(d in S)a[d]=S[d]}return a}var i=Object.create||function(){function a(){}return function(d){return a.prototype=d,new a}}();function r(a,d){var h=Array.prototype.slice;if(a.bind)return a.bind.apply(a,h.call(arguments,1));var y=h.call(arguments,2);return function(){return a.apply(d,y.length?y.concat(h.call(arguments)):arguments)}}var o=0;function s(a){return"_leaflet_id"in a||(a._leaflet_id=++o),a._leaflet_id}function l(a,d,h){var y,S,I,O;return O=function(){y=!1,S&&(I.apply(h,S),S=!1)},I=function(){y?S=arguments:(a.apply(h,arguments),setTimeout(O,d),y=!0)},I}function c(a,d,h){var y=d[1],S=d[0],I=y-S;return a===y&&h?a:((a-S)%I+I)%I+S}function u(){return!1}function f(a,d){if(d===!1)return a;var h=Math.pow(10,d===void 0?6:d);return Math.round(a*h)/h}function m(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function w(a){return m(a).split(/\s+/)}function b(a,d){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?i(a.options):{});for(var h in d)a.options[h]=d[h];return a.options}function D(a,d,h){var y=[];for(var S in a)y.push(encodeURIComponent(h?S.toUpperCase():S)+"="+encodeURIComponent(a[S]));return(!d||d.indexOf("?")===-1?"?":"&")+y.join("&")}var T=/\{ *([\w_ -]+) *\}/g;function M(a,d){return a.replace(T,function(h,y){var S=d[y];if(S===void 0)throw new Error("No value provided for variable "+h);return typeof S=="function"&&(S=S(d)),S})}var P=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function U(a,d){for(var h=0;h<a.length;h++)if(a[h]===d)return h;return-1}var K="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function W(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var re=0;function fe(a){var d=+new Date,h=Math.max(0,16-(d-re));return re=d+h,window.setTimeout(a,h)}var ce=window.requestAnimationFrame||W("RequestAnimationFrame")||fe,le=window.cancelAnimationFrame||W("CancelAnimationFrame")||W("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function ct(a,d,h){if(h&&ce===fe)a.call(d);else return ce.call(window,r(a,d))}function Wt(a){a&&le.call(window,a)}var Li={__proto__:null,extend:t,create:i,bind:r,get lastId(){return o},stamp:s,throttle:l,wrapNum:c,falseFn:u,formatNum:f,trim:m,splitWords:w,setOptions:b,getParamString:D,template:M,isArray:P,indexOf:U,emptyImageUrl:K,requestFn:ce,cancelFn:le,requestAnimFrame:ct,cancelAnimFrame:Wt};function xi(){}xi.extend=function(a){var d=function(){b(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=d.__super__=this.prototype,y=i(h);y.constructor=d,d.prototype=y;for(var S in this)Object.prototype.hasOwnProperty.call(this,S)&&S!=="prototype"&&S!=="__super__"&&(d[S]=this[S]);return a.statics&&t(d,a.statics),a.includes&&(k0(a.includes),t.apply(null,[y].concat(a.includes))),t(y,a),delete y.statics,delete y.includes,y.options&&(y.options=h.options?i(h.options):{},t(y.options,a.options)),y._initHooks=[],y.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var I=0,O=y._initHooks.length;I<O;I++)y._initHooks[I].call(this)}},d},xi.include=function(a){var d=this.prototype.options;return t(this.prototype,a),a.options&&(this.prototype.options=d,this.mergeOptions(a.options)),this},xi.mergeOptions=function(a){return t(this.prototype.options,a),this},xi.addInitHook=function(a){var d=Array.prototype.slice.call(arguments,1),h=typeof a=="function"?a:function(){this[a].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function k0(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=P(a)?a:[a];for(var d=0;d<a.length;d++)a[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Zn={on:function(a,d,h){if(typeof a=="object")for(var y in a)this._on(y,a[y],d);else{a=w(a);for(var S=0,I=a.length;S<I;S++)this._on(a[S],d,h)}return this},off:function(a,d,h){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var y in a)this._off(y,a[y],d);else{a=w(a);for(var S=arguments.length===1,I=0,O=a.length;I<O;I++)S?this._off(a[I]):this._off(a[I],d,h)}return this},_on:function(a,d,h,y){if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}if(this._listens(a,d,h)===!1){h===this&&(h=void 0);var S={fn:d,ctx:h};y&&(S.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(S)}},_off:function(a,d,h){var y,S,I;if(this._events&&(y=this._events[a],!!y)){if(arguments.length===1){if(this._firingCount)for(S=0,I=y.length;S<I;S++)y[S].fn=u;delete this._events[a];return}if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}var O=this._listens(a,d,h);if(O!==!1){var j=y[O];this._firingCount&&(j.fn=u,this._events[a]=y=y.slice()),y.splice(O,1)}}},fire:function(a,d,h){if(!this.listens(a,h))return this;var y=t({},d,{type:a,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var S=this._events[a];if(S){this._firingCount=this._firingCount+1||1;for(var I=0,O=S.length;I<O;I++){var j=S[I],$=j.fn;j.once&&this.off(a,$,j.ctx),$.call(j.ctx||this,y)}this._firingCount--}}return h&&this._propagateEvent(y),this},listens:function(a,d,h,y){typeof a!="string"&&console.warn('"string" type argument expected');var S=d;typeof d!="function"&&(y=!!d,S=void 0,h=void 0);var I=this._events&&this._events[a];if(I&&I.length&&this._listens(a,S,h)!==!1)return!0;if(y){for(var O in this._eventParents)if(this._eventParents[O].listens(a,d,h,y))return!0}return!1},_listens:function(a,d,h){if(!this._events)return!1;var y=this._events[a]||[];if(!d)return!!y.length;h===this&&(h=void 0);for(var S=0,I=y.length;S<I;S++)if(y[S].fn===d&&y[S].ctx===h)return S;return!1},once:function(a,d,h){if(typeof a=="object")for(var y in a)this._on(y,a[y],d,!0);else{a=w(a);for(var S=0,I=a.length;S<I;S++)this._on(a[S],d,h,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[s(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[s(a)],this},_propagateEvent:function(a){for(var d in this._eventParents)this._eventParents[d].fire(a.type,t({layer:a.target,propagatedFrom:a.target},a),!0)}};Zn.addEventListener=Zn.on,Zn.removeEventListener=Zn.clearAllEventListeners=Zn.off,Zn.addOneTimeEventListener=Zn.once,Zn.fireEvent=Zn.fire,Zn.hasEventListeners=Zn.listens;var pd=xi.extend(Zn);function Le(a,d,h){this.x=h?Math.round(a):a,this.y=h?Math.round(d):d}var t1=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};Le.prototype={clone:function(){return new Le(this.x,this.y)},add:function(a){return this.clone()._add(xe(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(xe(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new Le(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new Le(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=t1(this.x),this.y=t1(this.y),this},distanceTo:function(a){a=xe(a);var d=a.x-this.x,h=a.y-this.y;return Math.sqrt(d*d+h*h)},equals:function(a){return a=xe(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=xe(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+f(this.x)+", "+f(this.y)+")"}};function xe(a,d,h){return a instanceof Le?a:P(a)?new Le(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new Le(a.x,a.y):new Le(a,d,h)}function Lt(a,d){if(a)for(var h=d?[a,d]:a,y=0,S=h.length;y<S;y++)this.extend(h[y])}Lt.prototype={extend:function(a){var d,h;if(!a)return this;if(a instanceof Le||typeof a[0]=="number"||"x"in a)d=h=xe(a);else if(a=di(a),d=a.min,h=a.max,!d||!h)return this;return!this.min&&!this.max?(this.min=d.clone(),this.max=h.clone()):(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(a){return xe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return xe(this.min.x,this.max.y)},getTopRight:function(){return xe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var d,h;return typeof a[0]=="number"||a instanceof Le?a=xe(a):a=di(a),a instanceof Lt?(d=a.min,h=a.max):d=h=a,d.x>=this.min.x&&h.x<=this.max.x&&d.y>=this.min.y&&h.y<=this.max.y},intersects:function(a){a=di(a);var d=this.min,h=this.max,y=a.min,S=a.max,I=S.x>=d.x&&y.x<=h.x,O=S.y>=d.y&&y.y<=h.y;return I&&O},overlaps:function(a){a=di(a);var d=this.min,h=this.max,y=a.min,S=a.max,I=S.x>d.x&&y.x<h.x,O=S.y>d.y&&y.y<h.y;return I&&O},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var d=this.min,h=this.max,y=Math.abs(d.x-h.x)*a,S=Math.abs(d.y-h.y)*a;return di(xe(d.x-y,d.y-S),xe(h.x+y,h.y+S))},equals:function(a){return a?(a=di(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function di(a,d){return!a||a instanceof Lt?a:new Lt(a,d)}function ui(a,d){if(a)for(var h=d?[a,d]:a,y=0,S=h.length;y<S;y++)this.extend(h[y])}ui.prototype={extend:function(a){var d=this._southWest,h=this._northEast,y,S;if(a instanceof ht)y=a,S=a;else if(a instanceof ui){if(y=a._southWest,S=a._northEast,!y||!S)return this}else return a?this.extend(Ye(a)||Jt(a)):this;return!d&&!h?(this._southWest=new ht(y.lat,y.lng),this._northEast=new ht(S.lat,S.lng)):(d.lat=Math.min(y.lat,d.lat),d.lng=Math.min(y.lng,d.lng),h.lat=Math.max(S.lat,h.lat),h.lng=Math.max(S.lng,h.lng)),this},pad:function(a){var d=this._southWest,h=this._northEast,y=Math.abs(d.lat-h.lat)*a,S=Math.abs(d.lng-h.lng)*a;return new ui(new ht(d.lat-y,d.lng-S),new ht(h.lat+y,h.lng+S))},getCenter:function(){return new ht((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ht(this.getNorth(),this.getWest())},getSouthEast:function(){return new ht(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof ht||"lat"in a?a=Ye(a):a=Jt(a);var d=this._southWest,h=this._northEast,y,S;return a instanceof ui?(y=a.getSouthWest(),S=a.getNorthEast()):y=S=a,y.lat>=d.lat&&S.lat<=h.lat&&y.lng>=d.lng&&S.lng<=h.lng},intersects:function(a){a=Jt(a);var d=this._southWest,h=this._northEast,y=a.getSouthWest(),S=a.getNorthEast(),I=S.lat>=d.lat&&y.lat<=h.lat,O=S.lng>=d.lng&&y.lng<=h.lng;return I&&O},overlaps:function(a){a=Jt(a);var d=this._southWest,h=this._northEast,y=a.getSouthWest(),S=a.getNorthEast(),I=S.lat>d.lat&&y.lat<h.lat,O=S.lng>d.lng&&y.lng<h.lng;return I&&O},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,d){return a?(a=Jt(a),this._southWest.equals(a.getSouthWest(),d)&&this._northEast.equals(a.getNorthEast(),d)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Jt(a,d){return a instanceof ui?a:new ui(a,d)}function ht(a,d,h){if(isNaN(a)||isNaN(d))throw new Error("Invalid LatLng object: ("+a+", "+d+")");this.lat=+a,this.lng=+d,h!==void 0&&(this.alt=+h)}ht.prototype={equals:function(a,d){if(!a)return!1;a=Ye(a);var h=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return h<=(d===void 0?1e-9:d)},toString:function(a){return"LatLng("+f(this.lat,a)+", "+f(this.lng,a)+")"},distanceTo:function(a){return Yo.distance(this,Ye(a))},wrap:function(){return Yo.wrapLatLng(this)},toBounds:function(a){var d=180*a/40075017,h=d/Math.cos(Math.PI/180*this.lat);return Jt([this.lat-d,this.lng-h],[this.lat+d,this.lng+h])},clone:function(){return new ht(this.lat,this.lng,this.alt)}};function Ye(a,d,h){return a instanceof ht?a:P(a)&&typeof a[0]!="object"?a.length===3?new ht(a[0],a[1],a[2]):a.length===2?new ht(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new ht(a.lat,"lng"in a?a.lng:a.lon,a.alt):d===void 0?null:new ht(a,d,h)}var yo={latLngToPoint:function(a,d){var h=this.projection.project(a),y=this.scale(d);return this.transformation._transform(h,y)},pointToLatLng:function(a,d){var h=this.scale(d),y=this.transformation.untransform(a,h);return this.projection.unproject(y)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var d=this.projection.bounds,h=this.scale(a),y=this.transformation.transform(d.min,h),S=this.transformation.transform(d.max,h);return new Lt(y,S)},infinite:!1,wrapLatLng:function(a){var d=this.wrapLng?c(a.lng,this.wrapLng,!0):a.lng,h=this.wrapLat?c(a.lat,this.wrapLat,!0):a.lat,y=a.alt;return new ht(h,d,y)},wrapLatLngBounds:function(a){var d=a.getCenter(),h=this.wrapLatLng(d),y=d.lat-h.lat,S=d.lng-h.lng;if(y===0&&S===0)return a;var I=a.getSouthWest(),O=a.getNorthEast(),j=new ht(I.lat-y,I.lng-S),$=new ht(O.lat-y,O.lng-S);return new ui(j,$)}},Yo=t({},yo,{wrapLng:[-180,180],R:6371e3,distance:function(a,d){var h=Math.PI/180,y=a.lat*h,S=d.lat*h,I=Math.sin((d.lat-a.lat)*h/2),O=Math.sin((d.lng-a.lng)*h/2),j=I*I+Math.cos(y)*Math.cos(S)*O*O,$=2*Math.atan2(Math.sqrt(j),Math.sqrt(1-j));return this.R*$}}),n1=6378137,O0={R:n1,MAX_LATITUDE:85.0511287798,project:function(a){var d=Math.PI/180,h=this.MAX_LATITUDE,y=Math.max(Math.min(h,a.lat),-h),S=Math.sin(y*d);return new Le(this.R*a.lng*d,this.R*Math.log((1+S)/(1-S))/2)},unproject:function(a){var d=180/Math.PI;return new ht((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*d,a.x*d/this.R)},bounds:function(){var a=n1*Math.PI;return new Lt([-a,-a],[a,a])}()};function N0(a,d,h,y){if(P(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=d,this._c=h,this._d=y}N0.prototype={transform:function(a,d){return this._transform(a.clone(),d)},_transform:function(a,d){return d=d||1,a.x=d*(this._a*a.x+this._b),a.y=d*(this._c*a.y+this._d),a},untransform:function(a,d){return d=d||1,new Le((a.x/d-this._b)/this._a,(a.y/d-this._d)/this._c)}};function hd(a,d,h,y){return new N0(a,d,h,y)}var L0=t({},Yo,{code:"EPSG:3857",projection:O0,transformation:function(){var a=.5/(Math.PI*O0.R);return hd(a,.5,-a,.5)}()}),NF=t({},L0,{code:"EPSG:900913"});function i1(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function r1(a,d){var h="",y,S,I,O,j,$;for(y=0,I=a.length;y<I;y++){for(j=a[y],S=0,O=j.length;S<O;S++)$=j[S],h+=(S?"L":"M")+$.x+" "+$.y;h+=d?pe.svg?"z":"x":""}return h||"M0 0"}var F0=document.documentElement.style,Ap="ActiveXObject"in window,LF=Ap&&!document.addEventListener,o1="msLaunchUri"in navigator&&!("documentMode"in document),z0=Or("webkit"),s1=Or("android"),a1=Or("android 2")||Or("android 3"),FF=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),zF=s1&&Or("Google")&&FF<537&&!("AudioNode"in window),V0=!!window.opera,l1=!o1&&Or("chrome"),c1=Or("gecko")&&!z0&&!V0&&!Ap,VF=!l1&&Or("safari"),d1=Or("phantom"),u1="OTransition"in F0,jF=navigator.platform.indexOf("Win")===0,f1=Ap&&"transition"in F0,j0="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!a1,p1="MozPerspective"in F0,BF=!window.L_DISABLE_3D&&(f1||j0||p1)&&!u1&&!d1,gd=typeof orientation<"u"||Or("mobile"),UF=gd&&z0,HF=gd&&j0,h1=!window.PointerEvent&&window.MSPointerEvent,g1=!!(window.PointerEvent||h1),m1="ontouchstart"in window||!!window.TouchEvent,WF=!window.L_NO_TOUCH&&(m1||g1),$F=gd&&V0,qF=gd&&c1,GF=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ZF=function(){var a=!1;try{var d=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",u,d),window.removeEventListener("testPassiveEventSupport",u,d)}catch{}return a}(),YF=function(){return!!document.createElement("canvas").getContext}(),B0=!!(document.createElementNS&&i1("svg").createSVGRect),QF=!!B0&&function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),KF=!B0&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var d=a.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch{return!1}}(),JF=navigator.platform.indexOf("Mac")===0,XF=navigator.platform.indexOf("Linux")===0;function Or(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var pe={ie:Ap,ielt9:LF,edge:o1,webkit:z0,android:s1,android23:a1,androidStock:zF,opera:V0,chrome:l1,gecko:c1,safari:VF,phantom:d1,opera12:u1,win:jF,ie3d:f1,webkit3d:j0,gecko3d:p1,any3d:BF,mobile:gd,mobileWebkit:UF,mobileWebkit3d:HF,msPointer:h1,pointer:g1,touch:WF,touchNative:m1,mobileOpera:$F,mobileGecko:qF,retina:GF,passiveEvents:ZF,canvas:YF,svg:B0,vml:KF,inlineSvg:QF,mac:JF,linux:XF},v1=pe.msPointer?"MSPointerDown":"pointerdown",_1=pe.msPointer?"MSPointerMove":"pointermove",y1=pe.msPointer?"MSPointerUp":"pointerup",b1=pe.msPointer?"MSPointerCancel":"pointercancel",U0={touchstart:v1,touchmove:_1,touchend:y1,touchcancel:b1},w1={touchstart:o3,touchmove:Rp,touchend:Rp,touchcancel:Rp},pl={},S1=!1;function e3(a,d,h){return d==="touchstart"&&r3(),w1[d]?(h=w1[d].bind(this,h),a.addEventListener(U0[d],h,!1),h):(console.warn("wrong event specified:",d),u)}function t3(a,d,h){if(!U0[d]){console.warn("wrong event specified:",d);return}a.removeEventListener(U0[d],h,!1)}function n3(a){pl[a.pointerId]=a}function i3(a){pl[a.pointerId]&&(pl[a.pointerId]=a)}function C1(a){delete pl[a.pointerId]}function r3(){S1||(document.addEventListener(v1,n3,!0),document.addEventListener(_1,i3,!0),document.addEventListener(y1,C1,!0),document.addEventListener(b1,C1,!0),S1=!0)}function Rp(a,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){d.touches=[];for(var h in pl)d.touches.push(pl[h]);d.changedTouches=[d],a(d)}}function o3(a,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&Mn(d),Rp(a,d)}function s3(a){var d={},h,y;for(y in a)h=a[y],d[y]=h&&h.bind?h.bind(a):h;return a=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}var a3=200;function l3(a,d){a.addEventListener("dblclick",d);var h=0,y;function S(I){if(I.detail!==1){y=I.detail;return}if(!(I.pointerType==="mouse"||I.sourceCapabilities&&!I.sourceCapabilities.firesTouchEvents)){var O=M1(I);if(!(O.some(function($){return $ instanceof HTMLLabelElement&&$.attributes.for})&&!O.some(function($){return $ instanceof HTMLInputElement||$ instanceof HTMLSelectElement}))){var j=Date.now();j-h<=a3?(y++,y===2&&d(s3(I))):y=1,h=j}}}return a.addEventListener("click",S),{dblclick:d,simDblclick:S}}function c3(a,d){a.removeEventListener("dblclick",d.dblclick),a.removeEventListener("click",d.simDblclick)}var H0=Np(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),md=Np(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),E1=md==="webkitTransition"||md==="OTransition"?md+"End":"transitionend";function x1(a){return typeof a=="string"?document.getElementById(a):a}function vd(a,d){var h=a.style[d]||a.currentStyle&&a.currentStyle[d];if((!h||h==="auto")&&document.defaultView){var y=document.defaultView.getComputedStyle(a,null);h=y?y[d]:null}return h==="auto"?null:h}function Je(a,d,h){var y=document.createElement(a);return y.className=d||"",h&&h.appendChild(y),y}function Ft(a){var d=a.parentNode;d&&d.removeChild(a)}function kp(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function hl(a){var d=a.parentNode;d&&d.lastChild!==a&&d.appendChild(a)}function gl(a){var d=a.parentNode;d&&d.firstChild!==a&&d.insertBefore(a,d.firstChild)}function W0(a,d){if(a.classList!==void 0)return a.classList.contains(d);var h=Op(a);return h.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(h)}function Ue(a,d){if(a.classList!==void 0)for(var h=w(d),y=0,S=h.length;y<S;y++)a.classList.add(h[y]);else if(!W0(a,d)){var I=Op(a);$0(a,(I?I+" ":"")+d)}}function Gt(a,d){a.classList!==void 0?a.classList.remove(d):$0(a,m((" "+Op(a)+" ").replace(" "+d+" "," ")))}function $0(a,d){a.className.baseVal===void 0?a.className=d:a.className.baseVal=d}function Op(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function Fi(a,d){"opacity"in a.style?a.style.opacity=d:"filter"in a.style&&d3(a,d)}function d3(a,d){var h=!1,y="DXImageTransform.Microsoft.Alpha";try{h=a.filters.item(y)}catch{if(d===1)return}d=Math.round(d*100),h?(h.Enabled=d!==100,h.Opacity=d):a.style.filter+=" progid:"+y+"(opacity="+d+")"}function Np(a){for(var d=document.documentElement.style,h=0;h<a.length;h++)if(a[h]in d)return a[h];return!1}function Fs(a,d,h){var y=d||new Le(0,0);a.style[H0]=(pe.ie3d?"translate("+y.x+"px,"+y.y+"px)":"translate3d("+y.x+"px,"+y.y+"px,0)")+(h?" scale("+h+")":"")}function Xt(a,d){a._leaflet_pos=d,pe.any3d?Fs(a,d):(a.style.left=d.x+"px",a.style.top=d.y+"px")}function zs(a){return a._leaflet_pos||new Le(0,0)}var _d,yd,q0;if("onselectstart"in document)_d=function(){Fe(window,"selectstart",Mn)},yd=function(){Ct(window,"selectstart",Mn)};else{var bd=Np(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);_d=function(){if(bd){var a=document.documentElement.style;q0=a[bd],a[bd]="none"}},yd=function(){bd&&(document.documentElement.style[bd]=q0,q0=void 0)}}function G0(){Fe(window,"dragstart",Mn)}function Z0(){Ct(window,"dragstart",Mn)}var Lp,Y0;function Q0(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(Fp(),Lp=a,Y0=a.style.outlineStyle,a.style.outlineStyle="none",Fe(window,"keydown",Fp))}function Fp(){Lp&&(Lp.style.outlineStyle=Y0,Lp=void 0,Y0=void 0,Ct(window,"keydown",Fp))}function D1(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function K0(a){var d=a.getBoundingClientRect();return{x:d.width/a.offsetWidth||1,y:d.height/a.offsetHeight||1,boundingClientRect:d}}var u3={__proto__:null,TRANSFORM:H0,TRANSITION:md,TRANSITION_END:E1,get:x1,getStyle:vd,create:Je,remove:Ft,empty:kp,toFront:hl,toBack:gl,hasClass:W0,addClass:Ue,removeClass:Gt,setClass:$0,getClass:Op,setOpacity:Fi,testProp:Np,setTransform:Fs,setPosition:Xt,getPosition:zs,get disableTextSelection(){return _d},get enableTextSelection(){return yd},disableImageDrag:G0,enableImageDrag:Z0,preventOutline:Q0,restoreOutline:Fp,getSizedParentNode:D1,getScale:K0};function Fe(a,d,h,y){if(d&&typeof d=="object")for(var S in d)X0(a,S,d[S],h);else{d=w(d);for(var I=0,O=d.length;I<O;I++)X0(a,d[I],h,y)}return this}var Nr="_leaflet_events";function Ct(a,d,h,y){if(arguments.length===1)I1(a),delete a[Nr];else if(d&&typeof d=="object")for(var S in d)ey(a,S,d[S],h);else if(d=w(d),arguments.length===2)I1(a,function(j){return U(d,j)!==-1});else for(var I=0,O=d.length;I<O;I++)ey(a,d[I],h,y);return this}function I1(a,d){for(var h in a[Nr]){var y=h.split(/\d/)[0];(!d||d(y))&&ey(a,y,null,null,h)}}var J0={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function X0(a,d,h,y){var S=d+s(h)+(y?"_"+s(y):"");if(a[Nr]&&a[Nr][S])return this;var I=function(j){return h.call(y||a,j||window.event)},O=I;!pe.touchNative&&pe.pointer&&d.indexOf("touch")===0?I=e3(a,d,I):pe.touch&&d==="dblclick"?I=l3(a,I):"addEventListener"in a?d==="touchstart"||d==="touchmove"||d==="wheel"||d==="mousewheel"?a.addEventListener(J0[d]||d,I,pe.passiveEvents?{passive:!1}:!1):d==="mouseenter"||d==="mouseleave"?(I=function(j){j=j||window.event,ny(a,j)&&O(j)},a.addEventListener(J0[d],I,!1)):a.addEventListener(d,O,!1):a.attachEvent("on"+d,I),a[Nr]=a[Nr]||{},a[Nr][S]=I}function ey(a,d,h,y,S){S=S||d+s(h)+(y?"_"+s(y):"");var I=a[Nr]&&a[Nr][S];if(!I)return this;!pe.touchNative&&pe.pointer&&d.indexOf("touch")===0?t3(a,d,I):pe.touch&&d==="dblclick"?c3(a,I):"removeEventListener"in a?a.removeEventListener(J0[d]||d,I,!1):a.detachEvent("on"+d,I),a[Nr][S]=null}function Vs(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function ty(a){return X0(a,"wheel",Vs),this}function wd(a){return Fe(a,"mousedown touchstart dblclick contextmenu",Vs),a._leaflet_disable_click=!0,this}function Mn(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function js(a){return Mn(a),Vs(a),this}function M1(a){if(a.composedPath)return a.composedPath();for(var d=[],h=a.target;h;)d.push(h),h=h.parentNode;return d}function T1(a,d){if(!d)return new Le(a.clientX,a.clientY);var h=K0(d),y=h.boundingClientRect;return new Le((a.clientX-y.left)/h.x-d.clientLeft,(a.clientY-y.top)/h.y-d.clientTop)}var f3=pe.linux&&pe.chrome?window.devicePixelRatio:pe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function P1(a){return pe.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/f3:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function ny(a,d){var h=d.relatedTarget;if(!h)return!0;try{for(;h&&h!==a;)h=h.parentNode}catch{return!1}return h!==a}var p3={__proto__:null,on:Fe,off:Ct,stopPropagation:Vs,disableScrollPropagation:ty,disableClickPropagation:wd,preventDefault:Mn,stop:js,getPropagationPath:M1,getMousePosition:T1,getWheelDelta:P1,isExternalTarget:ny,addListener:Fe,removeListener:Ct},A1=pd.extend({run:function(a,d,h,y){this.stop(),this._el=a,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(y||.5,.2),this._startPos=zs(a),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ct(this._animate,this),this._step()},_step:function(a){var d=+new Date-this._startTime,h=this._duration*1e3;d<h?this._runFrame(this._easeOut(d/h),a):(this._runFrame(1),this._complete())},_runFrame:function(a,d){var h=this._startPos.add(this._offset.multiplyBy(a));d&&h._round(),Xt(this._el,h),this.fire("step")},_complete:function(){Wt(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),Qe=pd.extend({options:{crs:L0,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,d){d=b(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=r(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(Ye(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=md&&pe.any3d&&!pe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Fe(this._proxy,E1,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,d,h){if(d=d===void 0?this._zoom:this._limitZoom(d),a=this._limitCenter(Ye(a),d,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=t({animate:h.animate},h.zoom),h.pan=t({animate:h.animate,duration:h.duration},h.pan));var y=this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,d,h.zoom):this._tryAnimatedPan(a,h.pan);if(y)return clearTimeout(this._sizeTimer),this}return this._resetView(a,d,h.pan&&h.pan.noMoveStart),this},setZoom:function(a,d){return this._loaded?this.setView(this.getCenter(),a,{zoom:d}):(this._zoom=a,this)},zoomIn:function(a,d){return a=a||(pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,d)},zoomOut:function(a,d){return a=a||(pe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,d)},setZoomAround:function(a,d,h){var y=this.getZoomScale(d),S=this.getSize().divideBy(2),I=a instanceof Le?a:this.latLngToContainerPoint(a),O=I.subtract(S).multiplyBy(1-1/y),j=this.containerPointToLatLng(S.add(O));return this.setView(j,d,{zoom:h})},_getBoundsCenterZoom:function(a,d){d=d||{},a=a.getBounds?a.getBounds():Jt(a);var h=xe(d.paddingTopLeft||d.padding||[0,0]),y=xe(d.paddingBottomRight||d.padding||[0,0]),S=this.getBoundsZoom(a,!1,h.add(y));if(S=typeof d.maxZoom=="number"?Math.min(d.maxZoom,S):S,S===1/0)return{center:a.getCenter(),zoom:S};var I=y.subtract(h).divideBy(2),O=this.project(a.getSouthWest(),S),j=this.project(a.getNorthEast(),S),$=this.unproject(O.add(j).divideBy(2).add(I),S);return{center:$,zoom:S}},fitBounds:function(a,d){if(a=Jt(a),!a.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(a,d);return this.setView(h.center,h.zoom,d)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,d){return this.setView(a,this._zoom,{pan:d})},panBy:function(a,d){if(a=xe(a).round(),d=d||{},!a.x&&!a.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new A1,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){Ue(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,h,d.duration||.25,d.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,d,h){if(h=h||{},h.animate===!1||!pe.any3d)return this.setView(a,d,h);this._stop();var y=this.project(this.getCenter()),S=this.project(a),I=this.getSize(),O=this._zoom;a=Ye(a),d=d===void 0?O:d;var j=Math.max(I.x,I.y),$=j*this.getZoomScale(O,d),X=S.distanceTo(y)||1,ae=1.42,be=ae*ae;function Ge(en){var Yp=en?-1:1,tz=en?$:j,nz=$*$-j*j+Yp*be*be*X*X,iz=2*tz*be*X,py=nz/iz,uI=Math.sqrt(py*py+1)-py,rz=uI<1e-9?-18:Math.log(uI);return rz}function Yn(en){return(Math.exp(en)-Math.exp(-en))/2}function bn(en){return(Math.exp(en)+Math.exp(-en))/2}function Vi(en){return Yn(en)/bn(en)}var fi=Ge(0);function wl(en){return j*(bn(fi)/bn(fi+ae*en))}function K3(en){return j*(bn(fi)*Vi(fi+ae*en)-Yn(fi))/be}function J3(en){return 1-Math.pow(1-en,1.5)}var X3=Date.now(),cI=(Ge(1)-fi)/ae,ez=h.duration?1e3*h.duration:1e3*cI*.8;function dI(){var en=(Date.now()-X3)/ez,Yp=J3(en)*cI;en<=1?(this._flyToFrame=ct(dI,this),this._move(this.unproject(y.add(S.subtract(y).multiplyBy(K3(Yp)/X)),O),this.getScaleZoom(j/wl(Yp),O),{flyTo:!0})):this._move(a,d)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),dI.call(this),this},flyToBounds:function(a,d){var h=this._getBoundsCenterZoom(a,d);return this.flyTo(h.center,h.zoom,d)},setMaxBounds:function(a){return a=Jt(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var d=this.options.minZoom;return this.options.minZoom=a,this._loaded&&d!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var d=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&d!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,d){this._enforcingBounds=!0;var h=this.getCenter(),y=this._limitCenter(h,this._zoom,Jt(a));return h.equals(y)||this.panTo(y,d),this._enforcingBounds=!1,this},panInside:function(a,d){d=d||{};var h=xe(d.paddingTopLeft||d.padding||[0,0]),y=xe(d.paddingBottomRight||d.padding||[0,0]),S=this.project(this.getCenter()),I=this.project(a),O=this.getPixelBounds(),j=di([O.min.add(h),O.max.subtract(y)]),$=j.getSize();if(!j.contains(I)){this._enforcingBounds=!0;var X=I.subtract(j.getCenter()),ae=j.extend(I).getSize().subtract($);S.x+=X.x<0?-ae.x:ae.x,S.y+=X.y<0?-ae.y:ae.y,this.panTo(this.unproject(S),d),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=t({animate:!1,pan:!0},a===!0?{animate:!0}:a);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),y=d.divideBy(2).round(),S=h.divideBy(2).round(),I=y.subtract(S);return!I.x&&!I.y?this:(a.animate&&a.pan?this.panBy(I):(a.pan&&this._rawPanBy(I),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=t({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=r(this._handleGeolocationResponse,this),h=r(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,h,a):navigator.geolocation.getCurrentPosition(d,h,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var d=a.code,h=a.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var d=a.coords.latitude,h=a.coords.longitude,y=new ht(d,h),S=y.toBounds(a.coords.accuracy*2),I=this._locateOptions;if(I.setView){var O=this.getBoundsZoom(S);this.setView(y,I.maxZoom?Math.min(O,I.maxZoom):O)}var j={latlng:y,bounds:S,timestamp:a.timestamp};for(var $ in a.coords)typeof a.coords[$]=="number"&&(j[$]=a.coords[$]);this.fire("locationfound",j)}},addHandler:function(a,d){if(!d)return this;var h=this[a]=new d(this);return this._handlers.push(h),this.options[a]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Ft(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Wt(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)Ft(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,d){var h="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),y=Je("div",h,d||this._mapPane);return a&&(this._panes[a]=y),y},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),d=this.unproject(a.getBottomLeft()),h=this.unproject(a.getTopRight());return new ui(d,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,d,h){a=Jt(a),h=xe(h||[0,0]);var y=this.getZoom()||0,S=this.getMinZoom(),I=this.getMaxZoom(),O=a.getNorthWest(),j=a.getSouthEast(),$=this.getSize().subtract(h),X=di(this.project(j,y),this.project(O,y)).getSize(),ae=pe.any3d?this.options.zoomSnap:1,be=$.x/X.x,Ge=$.y/X.y,Yn=d?Math.max(be,Ge):Math.min(be,Ge);return y=this.getScaleZoom(Yn,y),ae&&(y=Math.round(y/(ae/100))*(ae/100),y=d?Math.ceil(y/ae)*ae:Math.floor(y/ae)*ae),Math.max(S,Math.min(I,y))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Le(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,d){var h=this._getTopLeftPoint(a,d);return new Lt(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,d){var h=this.options.crs;return d=d===void 0?this._zoom:d,h.scale(a)/h.scale(d)},getScaleZoom:function(a,d){var h=this.options.crs;d=d===void 0?this._zoom:d;var y=h.zoom(a*h.scale(d));return isNaN(y)?1/0:y},project:function(a,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(Ye(a),d)},unproject:function(a,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(xe(a),d)},layerPointToLatLng:function(a){var d=xe(a).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(a){var d=this.project(Ye(a))._round();return d._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(Ye(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(Jt(a))},distance:function(a,d){return this.options.crs.distance(Ye(a),Ye(d))},containerPointToLayerPoint:function(a){return xe(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return xe(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var d=this.containerPointToLayerPoint(xe(a));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Ye(a)))},mouseEventToContainerPoint:function(a){return T1(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var d=this._container=x1(a);if(d){if(d._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Fe(d,"scroll",this._onScroll,this),this._containerId=s(d)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&pe.any3d,Ue(a,"leaflet-container"+(pe.touch?" leaflet-touch":"")+(pe.retina?" leaflet-retina":"")+(pe.ielt9?" leaflet-oldie":"")+(pe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=vd(a,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&d!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Xt(this._mapPane,new Le(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ue(a.markerPane,"leaflet-zoom-hide"),Ue(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,d,h){Xt(this._mapPane,new Le(0,0));var y=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var S=this._zoom!==d;this._moveStart(S,h)._move(a,d)._moveEnd(S),this.fire("viewreset"),y&&this.fire("load")},_moveStart:function(a,d){return a&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(a,d,h,y){d===void 0&&(d=this._zoom);var S=this._zoom!==d;return this._zoom=d,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),y?h&&h.pinch&&this.fire("zoom",h):((S||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Wt(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){Xt(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[s(this._container)]=this;var d=a?Ct:Fe;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),pe.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Wt(this._resizeRequest),this._resizeRequest=ct(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,d){for(var h=[],y,S=d==="mouseout"||d==="mouseover",I=a.target||a.srcElement,O=!1;I;){if(y=this._targets[s(I)],y&&(d==="click"||d==="preclick")&&this._draggableMoved(y)){O=!0;break}if(y&&y.listens(d,!0)&&(S&&!ny(I,a)||(h.push(y),S))||I===this._container)break;I=I.parentNode}return!h.length&&!O&&!S&&this.listens(d,!0)&&(h=[this]),h},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var d=a.target||a.srcElement;if(!(!this._loaded||d._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(d))){var h=a.type;h==="mousedown"&&Q0(d),this._fireDOMEvent(a,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,d,h){if(a.type==="click"){var y=t({},a);y.type="preclick",this._fireDOMEvent(y,y.type,h)}var S=this._findEventTargets(a,d);if(h){for(var I=[],O=0;O<h.length;O++)h[O].listens(d,!0)&&I.push(h[O]);S=I.concat(S)}if(S.length){d==="contextmenu"&&Mn(a);var j=S[0],$={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var X=j.getLatLng&&(!j._radius||j._radius<=10);$.containerPoint=X?this.latLngToContainerPoint(j.getLatLng()):this.mouseEventToContainerPoint(a),$.layerPoint=this.containerPointToLayerPoint($.containerPoint),$.latlng=X?j.getLatLng():this.layerPointToLatLng($.layerPoint)}for(O=0;O<S.length;O++)if(S[O].fire(d,$,!0),$.originalEvent._stopped||S[O].options.bubblingMouseEvents===!1&&U(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,d=this._handlers.length;a<d;a++)this._handlers[a].disable()},whenReady:function(a,d){return this._loaded?a.call(d||this,{target:this}):this.on("load",a,d),this},_getMapPanePos:function(){return zs(this._mapPane)||new Le(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,d){var h=a&&d!==void 0?this._getNewPixelOrigin(a,d):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,d){var h=this.getSize()._divideBy(2);return this.project(a,d)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,d,h){var y=this._getNewPixelOrigin(h,d);return this.project(a,d)._subtract(y)},_latLngBoundsToNewLayerBounds:function(a,d,h){var y=this._getNewPixelOrigin(h,d);return di([this.project(a.getSouthWest(),d)._subtract(y),this.project(a.getNorthWest(),d)._subtract(y),this.project(a.getSouthEast(),d)._subtract(y),this.project(a.getNorthEast(),d)._subtract(y)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,d,h){if(!h)return a;var y=this.project(a,d),S=this.getSize().divideBy(2),I=new Lt(y.subtract(S),y.add(S)),O=this._getBoundsOffset(I,h,d);return Math.abs(O.x)<=1&&Math.abs(O.y)<=1?a:this.unproject(y.add(O),d)},_limitOffset:function(a,d){if(!d)return a;var h=this.getPixelBounds(),y=new Lt(h.min.add(a),h.max.add(a));return a.add(this._getBoundsOffset(y,d))},_getBoundsOffset:function(a,d,h){var y=di(this.project(d.getNorthEast(),h),this.project(d.getSouthWest(),h)),S=y.min.subtract(a.min),I=y.max.subtract(a.max),O=this._rebound(S.x,-I.x),j=this._rebound(S.y,-I.y);return new Le(O,j)},_rebound:function(a,d){return a+d>0?Math.round(a-d)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(d))},_limitZoom:function(a){var d=this.getMinZoom(),h=this.getMaxZoom(),y=pe.any3d?this.options.zoomSnap:1;return y&&(a=Math.round(a/y)*y),Math.max(d,Math.min(h,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Gt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,d){var h=this._getCenterOffset(a)._trunc();return(d&&d.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,d),!0)},_createAnimProxy:function(){var a=this._proxy=Je("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(d){var h=H0,y=this._proxy.style[h];Fs(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),y===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Ft(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),d=this.getZoom();Fs(this._proxy,this.project(a,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,d,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var y=this.getZoomScale(d),S=this._getCenterOffset(a)._divideBy(1-1/y);return h.animate!==!0&&!this.getSize().contains(S)?!1:(ct(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(a,d,!0)},this),!0)},_animateZoom:function(a,d,h,y){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=d,Ue(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:d,noUpdate:y}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(r(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Gt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function h3(a,d){return new Qe(a,d)}var or=xi.extend({options:{position:"topright"},initialize:function(a){b(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var d=this._map;return d&&d.removeControl(this),this.options.position=a,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var d=this._container=this.onAdd(a),h=this.getPosition(),y=a._controlCorners[h];return Ue(d,"leaflet-control"),h.indexOf("bottom")!==-1?y.insertBefore(d,y.firstChild):y.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Ft(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),Sd=function(a){return new or(a)};Qe.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},d="leaflet-",h=this._controlContainer=Je("div",d+"control-container",this._container);function y(S,I){var O=d+S+" "+d+I;a[S+I]=Je("div",O,h)}y("top","left"),y("top","right"),y("bottom","left"),y("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)Ft(this._controlCorners[a]);Ft(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var R1=or.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,d,h,y){return h<y?-1:y<h?1:0}},initialize:function(a,d,h){b(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var y in a)this._addLayer(a[y],y);for(y in d)this._addLayer(d[y],y,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return or.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,d){return this._addLayer(a,d),this._map?this._update():this},addOverlay:function(a,d){return this._addLayer(a,d,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var d=this._getLayer(s(a));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){Ue(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(Ue(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):Gt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Gt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",d=this._container=Je("div",a),h=this.options.collapsed;d.setAttribute("aria-haspopup",!0),wd(d),ty(d);var y=this._section=Je("section",a+"-list");h&&(this._map.on("click",this.collapse,this),Fe(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var S=this._layersLink=Je("a",a+"-toggle",d);S.href="#",S.title="Layers",S.setAttribute("role","button"),Fe(S,{keydown:function(I){I.keyCode===13&&this._expandSafely()},click:function(I){Mn(I),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=Je("div",a+"-base",y),this._separator=Je("div",a+"-separator",y),this._overlaysList=Je("div",a+"-overlays",y),d.appendChild(y)},_getLayer:function(a){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&s(this._layers[d].layer)===a)return this._layers[d]},_addLayer:function(a,d,h){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:d,overlay:h}),this.options.sortLayers&&this._layers.sort(r(function(y,S){return this.options.sortFunction(y.layer,S.layer,y.name,S.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;kp(this._baseLayersList),kp(this._overlaysList),this._layerControlInputs=[];var a,d,h,y,S=0;for(h=0;h<this._layers.length;h++)y=this._layers[h],this._addItem(y),d=d||y.overlay,a=a||!y.overlay,S+=y.overlay?0:1;return this.options.hideSingleBase&&(a=a&&S>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=d&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var d=this._getLayer(s(a.target)),h=d.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;h&&this._map.fire(h,d)},_createRadioElement:function(a,d){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(d?' checked="checked"':"")+"/>",y=document.createElement("div");return y.innerHTML=h,y.firstChild},_addItem:function(a){var d=document.createElement("label"),h=this._map.hasLayer(a.layer),y;a.overlay?(y=document.createElement("input"),y.type="checkbox",y.className="leaflet-control-layers-selector",y.defaultChecked=h):y=this._createRadioElement("leaflet-base-layers_"+s(this),h),this._layerControlInputs.push(y),y.layerId=s(a.layer),Fe(y,"click",this._onInputClick,this);var S=document.createElement("span");S.innerHTML=" "+a.name;var I=document.createElement("span");d.appendChild(I),I.appendChild(y),I.appendChild(S);var O=a.overlay?this._overlaysList:this._baseLayersList;return O.appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,d,h,y=[],S=[];this._handlingClick=!0;for(var I=a.length-1;I>=0;I--)d=a[I],h=this._getLayer(d.layerId).layer,d.checked?y.push(h):d.checked||S.push(h);for(I=0;I<S.length;I++)this._map.hasLayer(S[I])&&this._map.removeLayer(S[I]);for(I=0;I<y.length;I++)this._map.hasLayer(y[I])||this._map.addLayer(y[I]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,d,h,y=this._map.getZoom(),S=a.length-1;S>=0;S--)d=a[S],h=this._getLayer(d.layerId).layer,d.disabled=h.options.minZoom!==void 0&&y<h.options.minZoom||h.options.maxZoom!==void 0&&y>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,Fe(a,"click",Mn),this.expand();var d=this;setTimeout(function(){Ct(a,"click",Mn),d._preventClick=!1})}}),g3=function(a,d,h){return new R1(a,d,h)},iy=or.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var d="leaflet-control-zoom",h=Je("div",d+" leaflet-bar"),y=this.options;return this._zoomInButton=this._createButton(y.zoomInText,y.zoomInTitle,d+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(y.zoomOutText,y.zoomOutTitle,d+"-out",h,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,d,h,y,S){var I=Je("a",h,y);return I.innerHTML=a,I.href="#",I.title=d,I.setAttribute("role","button"),I.setAttribute("aria-label",d),wd(I),Fe(I,"click",js),Fe(I,"click",S,this),Fe(I,"click",this._refocusOnMap,this),I},_updateDisabled:function(){var a=this._map,d="leaflet-disabled";Gt(this._zoomInButton,d),Gt(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(Ue(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(Ue(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});Qe.mergeOptions({zoomControl:!0}),Qe.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new iy,this.addControl(this.zoomControl))});var m3=function(a){return new iy(a)},k1=or.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var d="leaflet-control-scale",h=Je("div",d),y=this.options;return this._addScales(y,d+"-line",h),a.on(y.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),h},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,d,h){a.metric&&(this._mScale=Je("div",d,h)),a.imperial&&(this._iScale=Je("div",d,h))},_update:function(){var a=this._map,d=a.getSize().y/2,h=a.distance(a.containerPointToLatLng([0,d]),a.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(h)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var d=this._getRoundNum(a),h=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,h,d/a)},_updateImperial:function(a){var d=a*3.2808399,h,y,S;d>5280?(h=d/5280,y=this._getRoundNum(h),this._updateScale(this._iScale,y+" mi",y/h)):(S=this._getRoundNum(d),this._updateScale(this._iScale,S+" ft",S/d))},_updateScale:function(a,d,h){a.style.width=Math.round(this.options.maxWidth*h)+"px",a.innerHTML=d},_getRoundNum:function(a){var d=Math.pow(10,(Math.floor(a)+"").length-1),h=a/d;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,d*h}}),v3=function(a){return new k1(a)},_3='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ry=or.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(pe.inlineSvg?_3+" ":"")+"Leaflet</a>"},initialize:function(a){b(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=Je("div","leaflet-control-attribution"),wd(this._container);for(var d in a._layers)a._layers[d].getAttribution&&this.addAttribution(a._layers[d].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var d in this._attributions)this._attributions[d]&&a.push(d);var h=[];this.options.prefix&&h.push(this.options.prefix),a.length&&h.push(a.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});Qe.mergeOptions({attributionControl:!0}),Qe.addInitHook(function(){this.options.attributionControl&&new ry().addTo(this)});var y3=function(a){return new ry(a)};or.Layers=R1,or.Zoom=iy,or.Scale=k1,or.Attribution=ry,Sd.layers=g3,Sd.zoom=m3,Sd.scale=v3,Sd.attribution=y3;var Lr=xi.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Lr.addTo=function(a,d){return a.addHandler(d,this),this};var b3={Events:Zn},O1=pe.touch?"touchstart mousedown":"mousedown",Qo=pd.extend({options:{clickTolerance:3},initialize:function(a,d,h,y){b(this,y),this._element=a,this._dragStartTarget=d||a,this._preventOutline=h},enable:function(){this._enabled||(Fe(this._dragStartTarget,O1,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Qo._dragging===this&&this.finishDrag(!0),Ct(this._dragStartTarget,O1,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!W0(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){Qo._dragging===this&&this.finishDrag();return}if(!(Qo._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(Qo._dragging=this,this._preventOutline&&Q0(this._element),G0(),_d(),!this._moving)){this.fire("down");var d=a.touches?a.touches[0]:a,h=D1(this._element);this._startPoint=new Le(d.clientX,d.clientY),this._startPos=zs(this._element),this._parentScale=K0(h);var y=a.type==="mousedown";Fe(document,y?"mousemove":"touchmove",this._onMove,this),Fe(document,y?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var d=a.touches&&a.touches.length===1?a.touches[0]:a,h=new Le(d.clientX,d.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,Mn(a),this._moved||(this.fire("dragstart"),this._moved=!0,Ue(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ue(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),Xt(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){Gt(document.body,"leaflet-dragging"),this._lastTarget&&(Gt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ct(document,"mousemove touchmove",this._onMove,this),Ct(document,"mouseup touchend touchcancel",this._onUp,this),Z0(),yd();var d=this._moved&&this._moving;this._moving=!1,Qo._dragging=!1,d&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function N1(a,d,h){var y,S=[1,4,2,8],I,O,j,$,X,ae,be,Ge;for(I=0,ae=a.length;I<ae;I++)a[I]._code=Bs(a[I],d);for(j=0;j<4;j++){for(be=S[j],y=[],I=0,ae=a.length,O=ae-1;I<ae;O=I++)$=a[I],X=a[O],$._code&be?X._code&be||(Ge=zp(X,$,be,d,h),Ge._code=Bs(Ge,d),y.push(Ge)):(X._code&be&&(Ge=zp(X,$,be,d,h),Ge._code=Bs(Ge,d),y.push(Ge)),y.push($));a=y}return a}function L1(a,d){var h,y,S,I,O,j,$,X,ae;if(!a||a.length===0)throw new Error("latlngs not passed");zi(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var be=Ye([0,0]),Ge=Jt(a),Yn=Ge.getNorthWest().distanceTo(Ge.getSouthWest())*Ge.getNorthEast().distanceTo(Ge.getNorthWest());Yn<1700&&(be=oy(a));var bn=a.length,Vi=[];for(h=0;h<bn;h++){var fi=Ye(a[h]);Vi.push(d.project(Ye([fi.lat-be.lat,fi.lng-be.lng])))}for(j=$=X=0,h=0,y=bn-1;h<bn;y=h++)S=Vi[h],I=Vi[y],O=S.y*I.x-I.y*S.x,$+=(S.x+I.x)*O,X+=(S.y+I.y)*O,j+=O*3;j===0?ae=Vi[0]:ae=[$/j,X/j];var wl=d.unproject(xe(ae));return Ye([wl.lat+be.lat,wl.lng+be.lng])}function oy(a){for(var d=0,h=0,y=0,S=0;S<a.length;S++){var I=Ye(a[S]);d+=I.lat,h+=I.lng,y++}return Ye([d/y,h/y])}var w3={__proto__:null,clipPolygon:N1,polygonCenter:L1,centroid:oy};function F1(a,d){if(!d||!a.length)return a.slice();var h=d*d;return a=E3(a,h),a=C3(a,h),a}function z1(a,d,h){return Math.sqrt(Cd(a,d,h,!0))}function S3(a,d,h){return Cd(a,d,h)}function C3(a,d){var h=a.length,y=typeof Uint8Array<"u"?Uint8Array:Array,S=new y(h);S[0]=S[h-1]=1,sy(a,S,d,0,h-1);var I,O=[];for(I=0;I<h;I++)S[I]&&O.push(a[I]);return O}function sy(a,d,h,y,S){var I=0,O,j,$;for(j=y+1;j<=S-1;j++)$=Cd(a[j],a[y],a[S],!0),$>I&&(O=j,I=$);I>h&&(d[O]=1,sy(a,d,h,y,O),sy(a,d,h,O,S))}function E3(a,d){for(var h=[a[0]],y=1,S=0,I=a.length;y<I;y++)x3(a[y],a[S])>d&&(h.push(a[y]),S=y);return S<I-1&&h.push(a[I-1]),h}var V1;function j1(a,d,h,y,S){var I=y?V1:Bs(a,h),O=Bs(d,h),j,$,X;for(V1=O;;){if(!(I|O))return[a,d];if(I&O)return!1;j=I||O,$=zp(a,d,j,h,S),X=Bs($,h),j===I?(a=$,I=X):(d=$,O=X)}}function zp(a,d,h,y,S){var I=d.x-a.x,O=d.y-a.y,j=y.min,$=y.max,X,ae;return h&8?(X=a.x+I*($.y-a.y)/O,ae=$.y):h&4?(X=a.x+I*(j.y-a.y)/O,ae=j.y):h&2?(X=$.x,ae=a.y+O*($.x-a.x)/I):h&1&&(X=j.x,ae=a.y+O*(j.x-a.x)/I),new Le(X,ae,S)}function Bs(a,d){var h=0;return a.x<d.min.x?h|=1:a.x>d.max.x&&(h|=2),a.y<d.min.y?h|=4:a.y>d.max.y&&(h|=8),h}function x3(a,d){var h=d.x-a.x,y=d.y-a.y;return h*h+y*y}function Cd(a,d,h,y){var S=d.x,I=d.y,O=h.x-S,j=h.y-I,$=O*O+j*j,X;return $>0&&(X=((a.x-S)*O+(a.y-I)*j)/$,X>1?(S=h.x,I=h.y):X>0&&(S+=O*X,I+=j*X)),O=a.x-S,j=a.y-I,y?O*O+j*j:new Le(S,I)}function zi(a){return!P(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function B1(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),zi(a)}function U1(a,d){var h,y,S,I,O,j,$,X;if(!a||a.length===0)throw new Error("latlngs not passed");zi(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var ae=Ye([0,0]),be=Jt(a),Ge=be.getNorthWest().distanceTo(be.getSouthWest())*be.getNorthEast().distanceTo(be.getNorthWest());Ge<1700&&(ae=oy(a));var Yn=a.length,bn=[];for(h=0;h<Yn;h++){var Vi=Ye(a[h]);bn.push(d.project(Ye([Vi.lat-ae.lat,Vi.lng-ae.lng])))}for(h=0,y=0;h<Yn-1;h++)y+=bn[h].distanceTo(bn[h+1])/2;if(y===0)X=bn[0];else for(h=0,I=0;h<Yn-1;h++)if(O=bn[h],j=bn[h+1],S=O.distanceTo(j),I+=S,I>y){$=(I-y)/S,X=[j.x-$*(j.x-O.x),j.y-$*(j.y-O.y)];break}var fi=d.unproject(xe(X));return Ye([fi.lat+ae.lat,fi.lng+ae.lng])}var D3={__proto__:null,simplify:F1,pointToSegmentDistance:z1,closestPointOnSegment:S3,clipSegment:j1,_getEdgeIntersection:zp,_getBitCode:Bs,_sqClosestPointOnSegment:Cd,isFlat:zi,_flat:B1,polylineCenter:U1},ay={project:function(a){return new Le(a.lng,a.lat)},unproject:function(a){return new ht(a.y,a.x)},bounds:new Lt([-180,-90],[180,90])},ly={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Lt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var d=Math.PI/180,h=this.R,y=a.lat*d,S=this.R_MINOR/h,I=Math.sqrt(1-S*S),O=I*Math.sin(y),j=Math.tan(Math.PI/4-y/2)/Math.pow((1-O)/(1+O),I/2);return y=-h*Math.log(Math.max(j,1e-10)),new Le(a.lng*d*h,y)},unproject:function(a){for(var d=180/Math.PI,h=this.R,y=this.R_MINOR/h,S=Math.sqrt(1-y*y),I=Math.exp(-a.y/h),O=Math.PI/2-2*Math.atan(I),j=0,$=.1,X;j<15&&Math.abs($)>1e-7;j++)X=S*Math.sin(O),X=Math.pow((1-X)/(1+X),S/2),$=Math.PI/2-2*Math.atan(I*X)-O,O+=$;return new ht(O*d,a.x*d/h)}},I3={__proto__:null,LonLat:ay,Mercator:ly,SphericalMercator:O0},M3=t({},Yo,{code:"EPSG:3395",projection:ly,transformation:function(){var a=.5/(Math.PI*ly.R);return hd(a,.5,-a,.5)}()}),H1=t({},Yo,{code:"EPSG:4326",projection:ay,transformation:hd(1/180,1,-1/180,.5)}),T3=t({},yo,{projection:ay,transformation:hd(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,d){var h=d.lng-a.lng,y=d.lat-a.lat;return Math.sqrt(h*h+y*y)},infinite:!0});yo.Earth=Yo,yo.EPSG3395=M3,yo.EPSG3857=L0,yo.EPSG900913=NF,yo.EPSG4326=H1,yo.Simple=T3;var sr=pd.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[s(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[s(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var d=a.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var h=this.getEvents();d.on(h,this),this.once("remove",function(){d.off(h,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});Qe.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var d=s(a);return this._layers[d]?this:(this._layers[d]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var d=s(a);return this._layers[d]?(this._loaded&&a.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return s(a)in this._layers},eachLayer:function(a,d){for(var h in this._layers)a.call(d,this._layers[h]);return this},_addLayers:function(a){a=a?P(a)?a:[a]:[];for(var d=0,h=a.length;d<h;d++)this.addLayer(a[d])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[s(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var d=s(a);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,d=-1/0,h=this._getZoomSpan();for(var y in this._zoomBoundLayers){var S=this._zoomBoundLayers[y].options;a=S.minZoom===void 0?a:Math.min(a,S.minZoom),d=S.maxZoom===void 0?d:Math.max(d,S.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=a===1/0?void 0:a,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ml=sr.extend({initialize:function(a,d){b(this,d),this._layers={};var h,y;if(a)for(h=0,y=a.length;h<y;h++)this.addLayer(a[h])},addLayer:function(a){var d=this.getLayerId(a);return this._layers[d]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var d=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(a){var d=typeof a=="number"?a:this.getLayerId(a);return d in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var d=Array.prototype.slice.call(arguments,1),h,y;for(h in this._layers)y=this._layers[h],y[a]&&y[a].apply(y,d);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,d){for(var h in this._layers)a.call(d,this._layers[h]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return s(a)}}),P3=function(a,d){return new ml(a,d)},bo=ml.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),ml.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),ml.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new ui;for(var d in this._layers){var h=this._layers[d];a.extend(h.getBounds?h.getBounds():h.getLatLng())}return a}}),A3=function(a,d){return new bo(a,d)},vl=xi.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){b(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,d){var h=this._getIconUrl(a);if(!h){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var y=this._createImg(h,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(y,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),y},_setIconStyles:function(a,d){var h=this.options,y=h[d+"Size"];typeof y=="number"&&(y=[y,y]);var S=xe(y),I=xe(d==="shadow"&&h.shadowAnchor||h.iconAnchor||S&&S.divideBy(2,!0));a.className="leaflet-marker-"+d+" "+(h.className||""),I&&(a.style.marginLeft=-I.x+"px",a.style.marginTop=-I.y+"px"),S&&(a.style.width=S.x+"px",a.style.height=S.y+"px")},_createImg:function(a,d){return d=d||document.createElement("img"),d.src=a,d},_getIconUrl:function(a){return pe.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function R3(a){return new vl(a)}var Ed=vl.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof Ed.imagePath!="string"&&(Ed.imagePath=this._detectIconPath()),(this.options.imagePath||Ed.imagePath)+vl.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var d=function(h,y,S){var I=y.exec(h);return I&&I[S]};return a=d(a,/^url\((['"])?(.+)\1\)$/,2),a&&d(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=Je("div","leaflet-default-icon-path",document.body),d=vd(a,"background-image")||vd(a,"backgroundImage");if(document.body.removeChild(a),d=this._stripUrl(d),d)return d;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),W1=Lr.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new Qo(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ue(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Gt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var d=this._marker,h=d._map,y=this._marker.options.autoPanSpeed,S=this._marker.options.autoPanPadding,I=zs(d._icon),O=h.getPixelBounds(),j=h.getPixelOrigin(),$=di(O.min._subtract(j).add(S),O.max._subtract(j).subtract(S));if(!$.contains(I)){var X=xe((Math.max($.max.x,I.x)-$.max.x)/(O.max.x-$.max.x)-(Math.min($.min.x,I.x)-$.min.x)/(O.min.x-$.min.x),(Math.max($.max.y,I.y)-$.max.y)/(O.max.y-$.max.y)-(Math.min($.min.y,I.y)-$.min.y)/(O.min.y-$.min.y)).multiplyBy(y);h.panBy(X,{animate:!1}),this._draggable._newPos._add(X),this._draggable._startPos._add(X),Xt(d._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=ct(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(Wt(this._panRequest),this._panRequest=ct(this._adjustPan.bind(this,a)))},_onDrag:function(a){var d=this._marker,h=d._shadow,y=zs(d._icon),S=d._map.layerPointToLatLng(y);h&&Xt(h,y),d._latlng=S,a.latlng=S,a.oldLatLng=this._oldLatLng,d.fire("move",a).fire("drag",a)},_onDragEnd:function(a){Wt(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),Vp=sr.extend({options:{icon:new Ed,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,d){b(this,d),this._latlng=Ye(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var d=this._latlng;return this._latlng=Ye(a),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=a.icon.createIcon(this._icon),y=!1;h!==this._icon&&(this._icon&&this._removeIcon(),y=!0,a.title&&(h.title=a.title),h.tagName==="IMG"&&(h.alt=a.alt||"")),Ue(h,d),a.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Fe(h,"focus",this._panOnFocus,this);var S=a.icon.createShadow(this._shadow),I=!1;S!==this._shadow&&(this._removeShadow(),I=!0),S&&(Ue(S,d),S.alt=""),this._shadow=S,a.opacity<1&&this._updateOpacity(),y&&this.getPane().appendChild(this._icon),this._initInteraction(),S&&I&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ct(this._icon,"focus",this._panOnFocus,this),Ft(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Ft(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&Xt(this._icon,a),this._shadow&&Xt(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(Ue(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),W1)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new W1(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&Fi(this._icon,a),this._shadow&&Fi(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var d=this.options.icon.options,h=d.iconSize?xe(d.iconSize):xe(0,0),y=d.iconAnchor?xe(d.iconAnchor):xe(0,0);a.panInside(this._latlng,{paddingTopLeft:y,paddingBottomRight:h.subtract(y)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function k3(a,d){return new Vp(a,d)}var Ko=sr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return b(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),jp=Ko.extend({options:{fill:!0,radius:10},initialize:function(a,d){b(this,d),this._latlng=Ye(a),this._radius=this.options.radius},setLatLng:function(a){var d=this._latlng;return this._latlng=Ye(a),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var d=a&&a.radius||this._radius;return Ko.prototype.setStyle.call(this,a),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,d=this._radiusY||a,h=this._clickTolerance(),y=[a+h,d+h];this._pxBounds=new Lt(this._point.subtract(y),this._point.add(y))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function O3(a,d){return new jp(a,d)}var cy=jp.extend({initialize:function(a,d,h){if(typeof d=="number"&&(d=t({},h,{radius:d})),b(this,d),this._latlng=Ye(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new ui(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:Ko.prototype.setStyle,_project:function(){var a=this._latlng.lng,d=this._latlng.lat,h=this._map,y=h.options.crs;if(y.distance===Yo.distance){var S=Math.PI/180,I=this._mRadius/Yo.R/S,O=h.project([d+I,a]),j=h.project([d-I,a]),$=O.add(j).divideBy(2),X=h.unproject($).lat,ae=Math.acos((Math.cos(I*S)-Math.sin(d*S)*Math.sin(X*S))/(Math.cos(d*S)*Math.cos(X*S)))/S;(isNaN(ae)||ae===0)&&(ae=I/Math.cos(Math.PI/180*d)),this._point=$.subtract(h.getPixelOrigin()),this._radius=isNaN(ae)?0:$.x-h.project([X,a-ae]).x,this._radiusY=$.y-O.y}else{var be=y.unproject(y.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(be).x}this._updateBounds()}});function N3(a,d,h){return new cy(a,d,h)}var wo=Ko.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,d){b(this,d),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var d=1/0,h=null,y=Cd,S,I,O=0,j=this._parts.length;O<j;O++)for(var $=this._parts[O],X=1,ae=$.length;X<ae;X++){S=$[X-1],I=$[X];var be=y(a,S,I,!0);be<d&&(d=be,h=y(a,S,I))}return h&&(h.distance=Math.sqrt(d)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return U1(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,d){return d=d||this._defaultShape(),a=Ye(a),d.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new ui,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return zi(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var d=[],h=zi(a),y=0,S=a.length;y<S;y++)h?(d[y]=Ye(a[y]),this._bounds.extend(d[y])):d[y]=this._convertLatLngs(a[y]);return d},_project:function(){var a=new Lt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),d=new Le(a,a);this._rawPxBounds&&(this._pxBounds=new Lt([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(a,d,h){var y=a[0]instanceof ht,S=a.length,I,O;if(y){for(O=[],I=0;I<S;I++)O[I]=this._map.latLngToLayerPoint(a[I]),h.extend(O[I]);d.push(O)}else for(I=0;I<S;I++)this._projectLatlngs(a[I],d,h)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var d=this._parts,h,y,S,I,O,j,$;for(h=0,S=0,I=this._rings.length;h<I;h++)for($=this._rings[h],y=0,O=$.length;y<O-1;y++)j=j1($[y],$[y+1],a,y,!0),j&&(d[S]=d[S]||[],d[S].push(j[0]),(j[1]!==$[y+1]||y===O-2)&&(d[S].push(j[1]),S++))}},_simplifyPoints:function(){for(var a=this._parts,d=this.options.smoothFactor,h=0,y=a.length;h<y;h++)a[h]=F1(a[h],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,d){var h,y,S,I,O,j,$=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(h=0,I=this._parts.length;h<I;h++)for(j=this._parts[h],y=0,O=j.length,S=O-1;y<O;S=y++)if(!(!d&&y===0)&&z1(a,j[S],j[y])<=$)return!0;return!1}});function L3(a,d){return new wo(a,d)}wo._flat=B1;var _l=wo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return L1(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var d=wo.prototype._convertLatLngs.call(this,a),h=d.length;return h>=2&&d[0]instanceof ht&&d[0].equals(d[h-1])&&d.pop(),d},_setLatLngs:function(a){wo.prototype._setLatLngs.call(this,a),zi(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return zi(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,d=this.options.weight,h=new Le(d,d);if(a=new Lt(a.min.subtract(h),a.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var y=0,S=this._rings.length,I;y<S;y++)I=N1(this._rings[y],a,!0),I.length&&this._parts.push(I)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var d=!1,h,y,S,I,O,j,$,X;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(I=0,$=this._parts.length;I<$;I++)for(h=this._parts[I],O=0,X=h.length,j=X-1;O<X;j=O++)y=h[O],S=h[j],y.y>a.y!=S.y>a.y&&a.x<(S.x-y.x)*(a.y-y.y)/(S.y-y.y)+y.x&&(d=!d);return d||wo.prototype._containsPoint.call(this,a,!0)}});function F3(a,d){return new _l(a,d)}var So=bo.extend({initialize:function(a,d){b(this,d),this._layers={},a&&this.addData(a)},addData:function(a){var d=P(a)?a:a.features,h,y,S;if(d){for(h=0,y=d.length;h<y;h++)S=d[h],(S.geometries||S.geometry||S.features||S.coordinates)&&this.addData(S);return this}var I=this.options;if(I.filter&&!I.filter(a))return this;var O=Bp(a,I);return O?(O.feature=Wp(a),O.defaultOptions=O.options,this.resetStyle(O),I.onEachFeature&&I.onEachFeature(a,O),this.addLayer(O)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=t({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(d){this._setLayerStyle(d,a)},this)},_setLayerStyle:function(a,d){a.setStyle&&(typeof d=="function"&&(d=d(a.feature)),a.setStyle(d))}});function Bp(a,d){var h=a.type==="Feature"?a.geometry:a,y=h?h.coordinates:null,S=[],I=d&&d.pointToLayer,O=d&&d.coordsToLatLng||dy,j,$,X,ae;if(!y&&!h)return null;switch(h.type){case"Point":return j=O(y),$1(I,a,j,d);case"MultiPoint":for(X=0,ae=y.length;X<ae;X++)j=O(y[X]),S.push($1(I,a,j,d));return new bo(S);case"LineString":case"MultiLineString":return $=Up(y,h.type==="LineString"?0:1,O),new wo($,d);case"Polygon":case"MultiPolygon":return $=Up(y,h.type==="Polygon"?1:2,O),new _l($,d);case"GeometryCollection":for(X=0,ae=h.geometries.length;X<ae;X++){var be=Bp({geometry:h.geometries[X],type:"Feature",properties:a.properties},d);be&&S.push(be)}return new bo(S);case"FeatureCollection":for(X=0,ae=h.features.length;X<ae;X++){var Ge=Bp(h.features[X],d);Ge&&S.push(Ge)}return new bo(S);default:throw new Error("Invalid GeoJSON object.")}}function $1(a,d,h,y){return a?a(d,h):new Vp(h,y&&y.markersInheritOptions&&y)}function dy(a){return new ht(a[1],a[0],a[2])}function Up(a,d,h){for(var y=[],S=0,I=a.length,O;S<I;S++)O=d?Up(a[S],d-1,h):(h||dy)(a[S]),y.push(O);return y}function uy(a,d){return a=Ye(a),a.alt!==void 0?[f(a.lng,d),f(a.lat,d),f(a.alt,d)]:[f(a.lng,d),f(a.lat,d)]}function Hp(a,d,h,y){for(var S=[],I=0,O=a.length;I<O;I++)S.push(d?Hp(a[I],zi(a[I])?0:d-1,h,y):uy(a[I],y));return!d&&h&&S.length>0&&S.push(S[0].slice()),S}function yl(a,d){return a.feature?t({},a.feature,{geometry:d}):Wp(d)}function Wp(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var fy={toGeoJSON:function(a){return yl(this,{type:"Point",coordinates:uy(this.getLatLng(),a)})}};Vp.include(fy),cy.include(fy),jp.include(fy),wo.include({toGeoJSON:function(a){var d=!zi(this._latlngs),h=Hp(this._latlngs,d?1:0,!1,a);return yl(this,{type:(d?"Multi":"")+"LineString",coordinates:h})}}),_l.include({toGeoJSON:function(a){var d=!zi(this._latlngs),h=d&&!zi(this._latlngs[0]),y=Hp(this._latlngs,h?2:d?1:0,!0,a);return d||(y=[y]),yl(this,{type:(h?"Multi":"")+"Polygon",coordinates:y})}}),ml.include({toMultiPoint:function(a){var d=[];return this.eachLayer(function(h){d.push(h.toGeoJSON(a).geometry.coordinates)}),yl(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(a){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(a);var h=d==="GeometryCollection",y=[];return this.eachLayer(function(S){if(S.toGeoJSON){var I=S.toGeoJSON(a);if(h)y.push(I.geometry);else{var O=Wp(I);O.type==="FeatureCollection"?y.push.apply(y,O.features):y.push(O)}}}),h?yl(this,{geometries:y,type:"GeometryCollection"}):{type:"FeatureCollection",features:y}}});function q1(a,d){return new So(a,d)}var z3=q1,$p=sr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,d,h){this._url=a,this._bounds=Jt(d),b(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ue(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Ft(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&hl(this._image),this},bringToBack:function(){return this._map&&gl(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=Jt(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",d=this._image=a?this._url:Je("img");if(Ue(d,"leaflet-image-layer"),this._zoomAnimated&&Ue(d,"leaflet-zoom-animated"),this.options.className&&Ue(d,this.options.className),d.onselectstart=u,d.onmousemove=u,d.onload=r(this.fire,this,"load"),d.onerror=r(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=d.src;return}d.src=this._url,d.alt=this.options.alt},_animateZoom:function(a){var d=this._map.getZoomScale(a.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;Fs(this._image,h,d)},_reset:function(){var a=this._image,d=new Lt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=d.getSize();Xt(a,d.min),a.style.width=h.x+"px",a.style.height=h.y+"px"},_updateOpacity:function(){Fi(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),V3=function(a,d,h){return new $p(a,d,h)},G1=$p.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",d=this._image=a?this._url:Je("video");if(Ue(d,"leaflet-image-layer"),this._zoomAnimated&&Ue(d,"leaflet-zoom-animated"),this.options.className&&Ue(d,this.options.className),d.onselectstart=u,d.onmousemove=u,d.onloadeddata=r(this.fire,this,"load"),a){for(var h=d.getElementsByTagName("source"),y=[],S=0;S<h.length;S++)y.push(h[S].src);this._url=h.length>0?y:[d.src];return}P(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var I=0;I<this._url.length;I++){var O=Je("source");O.src=this._url[I],d.appendChild(O)}}});function j3(a,d,h){return new G1(a,d,h)}var Z1=$p.extend({_initImage:function(){var a=this._image=this._url;Ue(a,"leaflet-image-layer"),this._zoomAnimated&&Ue(a,"leaflet-zoom-animated"),this.options.className&&Ue(a,this.options.className),a.onselectstart=u,a.onmousemove=u}});function B3(a,d,h){return new Z1(a,d,h)}var Fr=sr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,d){a&&(a instanceof ht||P(a))?(this._latlng=Ye(a),b(this,d)):(b(this,a),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&Fi(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&Fi(this._container,1),this.bringToFront(),this.options.interactive&&(Ue(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(Fi(this._container,0),this._removeTimeout=setTimeout(r(Ft,void 0,this._container),200)):Ft(this._container),this.options.interactive&&(Gt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=Ye(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&hl(this._container),this},bringToBack:function(){return this._map&&gl(this._container),this},_prepareOpen:function(a){var d=this._source;if(!d._map)return!1;if(d instanceof bo){d=null;var h=this._source._layers;for(var y in h)if(h[y]._map){d=h[y];break}if(!d)return!1;this._source=d}if(!a)if(d.getCenter)a=d.getCenter();else if(d.getLatLng)a=d.getLatLng();else if(d.getBounds)a=d.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")a.innerHTML=d;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),d=xe(this.options.offset),h=this._getAnchor();this._zoomAnimated?Xt(this._container,a.add(h)):d=d.add(a).add(h);var y=this._containerBottom=-d.y,S=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=y+"px",this._container.style.left=S+"px"}},_getAnchor:function(){return[0,0]}});Qe.include({_initOverlay:function(a,d,h,y){var S=d;return S instanceof a||(S=new a(y).setContent(d)),h&&S.setLatLng(h),S}}),sr.include({_initOverlay:function(a,d,h,y){var S=h;return S instanceof a?(b(S,y),S._source=this):(S=d&&!y?d:new a(y,this),S.setContent(h)),S}});var qp=Fr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,Fr.prototype.openOn.call(this,a)},onAdd:function(a){Fr.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ko||this._source.on("preclick",Vs))},onRemove:function(a){Fr.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ko||this._source.off("preclick",Vs))},getEvents:function(){var a=Fr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",d=this._container=Je("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=Je("div",a+"-content-wrapper",d);if(this._contentNode=Je("div",a+"-content",h),wd(d),ty(this._contentNode),Fe(d,"contextmenu",Vs),this._tipContainer=Je("div",a+"-tip-container",d),this._tip=Je("div",a+"-tip",this._tipContainer),this.options.closeButton){var y=this._closeButton=Je("a",a+"-close-button",d);y.setAttribute("role","button"),y.setAttribute("aria-label","Close popup"),y.href="#close",y.innerHTML='<span aria-hidden="true">&#215;</span>',Fe(y,"click",function(S){Mn(S),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,d=a.style;d.width="",d.whiteSpace="nowrap";var h=a.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),d.width=h+1+"px",d.whiteSpace="",d.height="";var y=a.offsetHeight,S=this.options.maxHeight,I="leaflet-popup-scrolled";S&&y>S?(d.height=S+"px",Ue(a,I)):Gt(a,I),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),h=this._getAnchor();Xt(this._container,d.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,d=parseInt(vd(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+d,y=this._containerWidth,S=new Le(this._containerLeft,-h-this._containerBottom);S._add(zs(this._container));var I=a.layerPointToContainerPoint(S),O=xe(this.options.autoPanPadding),j=xe(this.options.autoPanPaddingTopLeft||O),$=xe(this.options.autoPanPaddingBottomRight||O),X=a.getSize(),ae=0,be=0;I.x+y+$.x>X.x&&(ae=I.x+y-X.x+$.x),I.x-ae-j.x<0&&(ae=I.x-j.x),I.y+h+$.y>X.y&&(be=I.y+h-X.y+$.y),I.y-be-j.y<0&&(be=I.y-j.y),(ae||be)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([ae,be]))}},_getAnchor:function(){return xe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),U3=function(a,d){return new qp(a,d)};Qe.mergeOptions({closePopupOnClick:!0}),Qe.include({openPopup:function(a,d,h){return this._initOverlay(qp,a,d,h).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),sr.include({bindPopup:function(a,d){return this._popup=this._initOverlay(qp,this._popup,a,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof bo||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){js(a);var d=a.layer||a.target;if(this._popup._source===d&&!(d instanceof Ko)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=d,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var Gp=Fr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){Fr.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){Fr.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=Fr.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",d=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Je("div",d),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+s(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var d,h,y=this._map,S=this._container,I=y.latLngToContainerPoint(y.getCenter()),O=y.layerPointToContainerPoint(a),j=this.options.direction,$=S.offsetWidth,X=S.offsetHeight,ae=xe(this.options.offset),be=this._getAnchor();j==="top"?(d=$/2,h=X):j==="bottom"?(d=$/2,h=0):j==="center"?(d=$/2,h=X/2):j==="right"?(d=0,h=X/2):j==="left"?(d=$,h=X/2):O.x<I.x?(j="right",d=0,h=X/2):(j="left",d=$+(ae.x+be.x)*2,h=X/2),a=a.subtract(xe(d,h,!0)).add(ae).add(be),Gt(S,"leaflet-tooltip-right"),Gt(S,"leaflet-tooltip-left"),Gt(S,"leaflet-tooltip-top"),Gt(S,"leaflet-tooltip-bottom"),Ue(S,"leaflet-tooltip-"+j),Xt(S,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&Fi(this._container,a)},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(d)},_getAnchor:function(){return xe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),H3=function(a,d){return new Gp(a,d)};Qe.include({openTooltip:function(a,d,h){return this._initOverlay(Gp,a,d,h).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),sr.include({bindTooltip:function(a,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Gp,this._tooltip,a,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var d=a?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[d](h),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof bo||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var d=typeof a.getElement=="function"&&a.getElement();d&&(Fe(d,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),Fe(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var d=typeof a.getElement=="function"&&a.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var d=this;this._map.once("moveend",function(){d._openOnceFlag=!1,d._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var d=a.latlng,h,y;this._tooltip.options.sticky&&a.originalEvent&&(h=this._map.mouseEventToContainerPoint(a.originalEvent),y=this._map.containerPointToLayerPoint(h),d=this._map.layerPointToLatLng(y)),this._tooltip.setLatLng(d)}});var Y1=vl.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var d=a&&a.tagName==="DIV"?a:document.createElement("div"),h=this.options;if(h.html instanceof Element?(kp(d),d.appendChild(h.html)):d.innerHTML=h.html!==!1?h.html:"",h.bgPos){var y=xe(h.bgPos);d.style.backgroundPosition=-y.x+"px "+-y.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});function W3(a){return new Y1(a)}vl.Default=Ed;var xd=sr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:pe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){b(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),Ft(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(hl(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(gl(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=l(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof Le?a:new Le(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var d=this.getPane().children,h=-a(-1/0,1/0),y=0,S=d.length,I;y<S;y++)I=d[y].style.zIndex,d[y]!==this._container&&I&&(h=a(h,+I));isFinite(h)&&(this.options.zIndex=h+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!pe.ielt9){Fi(this._container,this.options.opacity);var a=+new Date,d=!1,h=!1;for(var y in this._tiles){var S=this._tiles[y];if(!(!S.current||!S.loaded)){var I=Math.min(1,(a-S.loaded)/200);Fi(S.el,I),I<1?d=!0:(S.active?h=!0:this._onOpaqueTile(S),S.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),d&&(Wt(this._fadeFrame),this._fadeFrame=ct(this._updateOpacity,this))}},_onOpaqueTile:u,_initContainer:function(){this._container||(this._container=Je("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,d=this.options.maxZoom;if(a!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===a?(this._levels[h].el.style.zIndex=d-Math.abs(a-h),this._onUpdateLevel(h)):(Ft(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var y=this._levels[a],S=this._map;return y||(y=this._levels[a]={},y.el=Je("div","leaflet-tile-container leaflet-zoom-animated",this._container),y.el.style.zIndex=d,y.origin=S.project(S.unproject(S.getPixelOrigin()),a).round(),y.zoom=a,this._setZoomTransform(y,S.getCenter(),S.getZoom()),u(y.el.offsetWidth),this._onCreateLevel(y)),this._level=y,y}},_onUpdateLevel:u,_onRemoveLevel:u,_onCreateLevel:u,_pruneTiles:function(){if(this._map){var a,d,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)d=this._tiles[a],d.retain=d.current;for(a in this._tiles)if(d=this._tiles[a],d.current&&!d.active){var y=d.coords;this._retainParent(y.x,y.y,y.z,y.z-5)||this._retainChildren(y.x,y.y,y.z,y.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var d in this._tiles)this._tiles[d].coords.z===a&&this._removeTile(d)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)Ft(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,d,h,y){var S=Math.floor(a/2),I=Math.floor(d/2),O=h-1,j=new Le(+S,+I);j.z=+O;var $=this._tileCoordsToKey(j),X=this._tiles[$];return X&&X.active?(X.retain=!0,!0):(X&&X.loaded&&(X.retain=!0),O>y?this._retainParent(S,I,O,y):!1)},_retainChildren:function(a,d,h,y){for(var S=2*a;S<2*a+2;S++)for(var I=2*d;I<2*d+2;I++){var O=new Le(S,I);O.z=h+1;var j=this._tileCoordsToKey(O),$=this._tiles[j];if($&&$.active){$.retain=!0;continue}else $&&$.loaded&&($.retain=!0);h+1<y&&this._retainChildren(S,I,h+1,y)}},_resetView:function(a){var d=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var d=this.options;return d.minNativeZoom!==void 0&&a<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<a?d.maxNativeZoom:a},_setView:function(a,d,h,y){var S=Math.round(d);this.options.maxZoom!==void 0&&S>this.options.maxZoom||this.options.minZoom!==void 0&&S<this.options.minZoom?S=void 0:S=this._clampZoom(S);var I=this.options.updateWhenZooming&&S!==this._tileZoom;(!y||I)&&(this._tileZoom=S,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),S!==void 0&&this._update(a),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(a,d)},_setZoomTransforms:function(a,d){for(var h in this._levels)this._setZoomTransform(this._levels[h],a,d)},_setZoomTransform:function(a,d,h){var y=this._map.getZoomScale(h,a.zoom),S=a.origin.multiplyBy(y).subtract(this._map._getNewPixelOrigin(d,h)).round();pe.any3d?Fs(a.el,S,y):Xt(a.el,S)},_resetGrid:function(){var a=this._map,d=a.options.crs,h=this._tileSize=this.getTileSize(),y=this._tileZoom,S=this._map.getPixelWorldBounds(this._tileZoom);S&&(this._globalTileRange=this._pxBoundsToTileRange(S)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,d.wrapLng[0]],y).x/h.x),Math.ceil(a.project([0,d.wrapLng[1]],y).x/h.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([d.wrapLat[0],0],y).y/h.x),Math.ceil(a.project([d.wrapLat[1],0],y).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var d=this._map,h=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),y=d.getZoomScale(h,this._tileZoom),S=d.project(a,this._tileZoom).floor(),I=d.getSize().divideBy(y*2);return new Lt(S.subtract(I),S.add(I))},_update:function(a){var d=this._map;if(d){var h=this._clampZoom(d.getZoom());if(a===void 0&&(a=d.getCenter()),this._tileZoom!==void 0){var y=this._getTiledPixelBounds(a),S=this._pxBoundsToTileRange(y),I=S.getCenter(),O=[],j=this.options.keepBuffer,$=new Lt(S.getBottomLeft().subtract([j,-j]),S.getTopRight().add([j,-j]));if(!(isFinite(S.min.x)&&isFinite(S.min.y)&&isFinite(S.max.x)&&isFinite(S.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var X in this._tiles){var ae=this._tiles[X].coords;(ae.z!==this._tileZoom||!$.contains(new Le(ae.x,ae.y)))&&(this._tiles[X].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(a,h);return}for(var be=S.min.y;be<=S.max.y;be++)for(var Ge=S.min.x;Ge<=S.max.x;Ge++){var Yn=new Le(Ge,be);if(Yn.z=this._tileZoom,!!this._isValidTile(Yn)){var bn=this._tiles[this._tileCoordsToKey(Yn)];bn?bn.current=!0:O.push(Yn)}}if(O.sort(function(fi,wl){return fi.distanceTo(I)-wl.distanceTo(I)}),O.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Vi=document.createDocumentFragment();for(Ge=0;Ge<O.length;Ge++)this._addTile(O[Ge],Vi);this._level.el.appendChild(Vi)}}}},_isValidTile:function(a){var d=this._map.options.crs;if(!d.infinite){var h=this._globalTileRange;if(!d.wrapLng&&(a.x<h.min.x||a.x>h.max.x)||!d.wrapLat&&(a.y<h.min.y||a.y>h.max.y))return!1}if(!this.options.bounds)return!0;var y=this._tileCoordsToBounds(a);return Jt(this.options.bounds).overlaps(y)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var d=this._map,h=this.getTileSize(),y=a.scaleBy(h),S=y.add(h),I=d.unproject(y,a.z),O=d.unproject(S,a.z);return[I,O]},_tileCoordsToBounds:function(a){var d=this._tileCoordsToNwSe(a),h=new ui(d[0],d[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var d=a.split(":"),h=new Le(+d[0],+d[1]);return h.z=+d[2],h},_removeTile:function(a){var d=this._tiles[a];d&&(Ft(d.el),delete this._tiles[a],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){Ue(a,"leaflet-tile");var d=this.getTileSize();a.style.width=d.x+"px",a.style.height=d.y+"px",a.onselectstart=u,a.onmousemove=u,pe.ielt9&&this.options.opacity<1&&Fi(a,this.options.opacity)},_addTile:function(a,d){var h=this._getTilePos(a),y=this._tileCoordsToKey(a),S=this.createTile(this._wrapCoords(a),r(this._tileReady,this,a));this._initTile(S),this.createTile.length<2&&ct(r(this._tileReady,this,a,null,S)),Xt(S,h),this._tiles[y]={el:S,coords:a,current:!0},d.appendChild(S),this.fire("tileloadstart",{tile:S,coords:a})},_tileReady:function(a,d,h){d&&this.fire("tileerror",{error:d,tile:h,coords:a});var y=this._tileCoordsToKey(a);h=this._tiles[y],h&&(h.loaded=+new Date,this._map._fadeAnimated?(Fi(h.el,0),Wt(this._fadeFrame),this._fadeFrame=ct(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),d||(Ue(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),pe.ielt9||!this._map._fadeAnimated?ct(this._pruneTiles,this):setTimeout(r(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var d=new Le(this._wrapX?c(a.x,this._wrapX):a.x,this._wrapY?c(a.y,this._wrapY):a.y);return d.z=a.z,d},_pxBoundsToTileRange:function(a){var d=this.getTileSize();return new Lt(a.min.unscaleBy(d).floor(),a.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function $3(a){return new xd(a)}var bl=xd.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,d){this._url=a,d=b(this,d),d.detectRetina&&pe.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,d){return this._url===a&&d===void 0&&(d=!0),this._url=a,d||this.redraw(),this},createTile:function(a,d){var h=document.createElement("img");return Fe(h,"load",r(this._tileOnLoad,this,d,h)),Fe(h,"error",r(this._tileOnError,this,d,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(a),h},getTileUrl:function(a){var d={r:pe.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-a.y;this.options.tms&&(d.y=h),d["-y"]=h}return M(this._url,t(d,this.options))},_tileOnLoad:function(a,d){pe.ielt9?setTimeout(r(a,this,null,d),0):a(null,d)},_tileOnError:function(a,d,h){var y=this.options.errorTileUrl;y&&d.getAttribute("src")!==y&&(d.src=y),a(h,d)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,d=this.options.maxZoom,h=this.options.zoomReverse,y=this.options.zoomOffset;return h&&(a=d-a),a+y},_getSubdomain:function(a){var d=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var a,d;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(d=this._tiles[a].el,d.onload=u,d.onerror=u,!d.complete)){d.src=K;var h=this._tiles[a].coords;Ft(d),delete this._tiles[a],this.fire("tileabort",{tile:d,coords:h})}},_removeTile:function(a){var d=this._tiles[a];if(d)return d.el.setAttribute("src",K),xd.prototype._removeTile.call(this,a)},_tileReady:function(a,d,h){if(!(!this._map||h&&h.getAttribute("src")===K))return xd.prototype._tileReady.call(this,a,d,h)}});function Q1(a,d){return new bl(a,d)}var K1=bl.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,d){this._url=a;var h=t({},this.defaultWmsParams);for(var y in d)y in this.options||(h[y]=d[y]);d=b(this,d);var S=d.detectRetina&&pe.retina?2:1,I=this.getTileSize();h.width=I.x*S,h.height=I.y*S,this.wmsParams=h},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,bl.prototype.onAdd.call(this,a)},getTileUrl:function(a){var d=this._tileCoordsToNwSe(a),h=this._crs,y=di(h.project(d[0]),h.project(d[1])),S=y.min,I=y.max,O=(this._wmsVersion>=1.3&&this._crs===H1?[S.y,S.x,I.y,I.x]:[S.x,S.y,I.x,I.y]).join(","),j=bl.prototype.getTileUrl.call(this,a);return j+D(this.wmsParams,j,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+O},setParams:function(a,d){return t(this.wmsParams,a),d||this.redraw(),this}});function q3(a,d){return new K1(a,d)}bl.WMS=K1,Q1.wms=q3;var Co=sr.extend({options:{padding:.1},initialize:function(a){b(this,a),s(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ue(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,d){var h=this._map.getZoomScale(d,this._zoom),y=this._map.getSize().multiplyBy(.5+this.options.padding),S=this._map.project(this._center,d),I=y.multiplyBy(-h).add(S).subtract(this._map._getNewPixelOrigin(a,d));pe.any3d?Fs(this._container,I,h):Xt(this._container,I)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,d=this._map.getSize(),h=this._map.containerPointToLayerPoint(d.multiplyBy(-a)).round();this._bounds=new Lt(h,h.add(d.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),J1=Co.extend({options:{tolerance:0},getEvents:function(){var a=Co.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Co.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");Fe(a,"mousemove",this._onMouseMove,this),Fe(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Fe(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){Wt(this._redrawRequest),delete this._ctx,Ft(this._container),Ct(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var d in this._layers)a=this._layers[d],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Co.prototype._update.call(this);var a=this._bounds,d=this._container,h=a.getSize(),y=pe.retina?2:1;Xt(d,a.min),d.width=y*h.x,d.height=y*h.y,d.style.width=h.x+"px",d.style.height=h.y+"px",pe.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){Co.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[s(a)]=a;var d=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var d=a._order,h=d.next,y=d.prev;h?h.prev=y:this._drawLast=y,y?y.next=h:this._drawFirst=h,delete a._order,delete this._layers[s(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var d=a.options.dashArray.split(/[, ]+/),h=[],y,S;for(S=0;S<d.length;S++){if(y=Number(d[S]),isNaN(y))return;h.push(y)}a.options._dashArray=h}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||ct(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var d=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Lt,this._redrawBounds.extend(a._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(a._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var d=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,d=this._redrawBounds;if(this._ctx.save(),d){var h=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var y=this._drawFirst;y;y=y.next)a=y.layer,(!d||a._pxBounds&&a._pxBounds.intersects(d))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,d){if(this._drawing){var h,y,S,I,O=a._parts,j=O.length,$=this._ctx;if(j){for($.beginPath(),h=0;h<j;h++){for(y=0,S=O[h].length;y<S;y++)I=O[h][y],$[y?"lineTo":"moveTo"](I.x,I.y);d&&$.closePath()}this._fillStroke($,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var d=a._point,h=this._ctx,y=Math.max(Math.round(a._radius),1),S=(Math.max(Math.round(a._radiusY),1)||y)/y;S!==1&&(h.save(),h.scale(1,S)),h.beginPath(),h.arc(d.x,d.y/S,y,0,Math.PI*2,!1),S!==1&&h.restore(),this._fillStroke(h,a)}},_fillStroke:function(a,d){var h=d.options;h.fill&&(a.globalAlpha=h.fillOpacity,a.fillStyle=h.fillColor||h.color,a.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(a.setLineDash&&a.setLineDash(d.options&&d.options._dashArray||[]),a.globalAlpha=h.opacity,a.lineWidth=h.weight,a.strokeStyle=h.color,a.lineCap=h.lineCap,a.lineJoin=h.lineJoin,a.stroke())},_onClick:function(a){for(var d=this._map.mouseEventToLayerPoint(a),h,y,S=this._drawFirst;S;S=S.next)h=S.layer,h.options.interactive&&h._containsPoint(d)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(h))&&(y=h);this._fireEvent(y?[y]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var d=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,d)}},_handleMouseOut:function(a){var d=this._hoveredLayer;d&&(Gt(this._container,"leaflet-interactive"),this._fireEvent([d],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,d){if(!this._mouseHoverThrottled){for(var h,y,S=this._drawFirst;S;S=S.next)h=S.layer,h.options.interactive&&h._containsPoint(d)&&(y=h);y!==this._hoveredLayer&&(this._handleMouseOut(a),y&&(Ue(this._container,"leaflet-interactive"),this._fireEvent([y],a,"mouseover"),this._hoveredLayer=y)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(r(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,d,h){this._map._fireDOMEvent(d,h||d.type,a)},_bringToFront:function(a){var d=a._order;if(d){var h=d.next,y=d.prev;if(h)h.prev=y;else return;y?y.next=h:h&&(this._drawFirst=h),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(a)}},_bringToBack:function(a){var d=a._order;if(d){var h=d.next,y=d.prev;if(y)y.next=h;else return;h?h.prev=y:y&&(this._drawLast=y),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(a)}}});function X1(a){return pe.canvas?new J1(a):null}var Dd=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),G3={_initContainer:function(){this._container=Je("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Co.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var d=a._container=Dd("shape");Ue(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",a._path=Dd("path"),d.appendChild(a._path),this._updateStyle(a),this._layers[s(a)]=a},_addPath:function(a){var d=a._container;this._container.appendChild(d),a.options.interactive&&a.addInteractiveTarget(d)},_removePath:function(a){var d=a._container;Ft(d),a.removeInteractiveTarget(d),delete this._layers[s(a)]},_updateStyle:function(a){var d=a._stroke,h=a._fill,y=a.options,S=a._container;S.stroked=!!y.stroke,S.filled=!!y.fill,y.stroke?(d||(d=a._stroke=Dd("stroke")),S.appendChild(d),d.weight=y.weight+"px",d.color=y.color,d.opacity=y.opacity,y.dashArray?d.dashStyle=P(y.dashArray)?y.dashArray.join(" "):y.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=y.lineCap.replace("butt","flat"),d.joinstyle=y.lineJoin):d&&(S.removeChild(d),a._stroke=null),y.fill?(h||(h=a._fill=Dd("fill")),S.appendChild(h),h.color=y.fillColor||y.color,h.opacity=y.fillOpacity):h&&(S.removeChild(h),a._fill=null)},_updateCircle:function(a){var d=a._point.round(),h=Math.round(a._radius),y=Math.round(a._radiusY||h);this._setPath(a,a._empty()?"M0 0":"AL "+d.x+","+d.y+" "+h+","+y+" 0,"+65535*360)},_setPath:function(a,d){a._path.v=d},_bringToFront:function(a){hl(a._container)},_bringToBack:function(a){gl(a._container)}},Zp=pe.vml?Dd:i1,Id=Co.extend({_initContainer:function(){this._container=Zp("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Zp("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Ft(this._container),Ct(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Co.prototype._update.call(this);var a=this._bounds,d=a.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,h.setAttribute("width",d.x),h.setAttribute("height",d.y)),Xt(h,a.min),h.setAttribute("viewBox",[a.min.x,a.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(a){var d=a._path=Zp("path");a.options.className&&Ue(d,a.options.className),a.options.interactive&&Ue(d,"leaflet-interactive"),this._updateStyle(a),this._layers[s(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){Ft(a._path),a.removeInteractiveTarget(a._path),delete this._layers[s(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var d=a._path,h=a.options;d&&(h.stroke?(d.setAttribute("stroke",h.color),d.setAttribute("stroke-opacity",h.opacity),d.setAttribute("stroke-width",h.weight),d.setAttribute("stroke-linecap",h.lineCap),d.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?d.setAttribute("stroke-dasharray",h.dashArray):d.removeAttribute("stroke-dasharray"),h.dashOffset?d.setAttribute("stroke-dashoffset",h.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),h.fill?(d.setAttribute("fill",h.fillColor||h.color),d.setAttribute("fill-opacity",h.fillOpacity),d.setAttribute("fill-rule",h.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(a,d){this._setPath(a,r1(a._parts,d))},_updateCircle:function(a){var d=a._point,h=Math.max(Math.round(a._radius),1),y=Math.max(Math.round(a._radiusY),1)||h,S="a"+h+","+y+" 0 1,0 ",I=a._empty()?"M0 0":"M"+(d.x-h)+","+d.y+S+h*2+",0 "+S+-h*2+",0 ";this._setPath(a,I)},_setPath:function(a,d){a._path.setAttribute("d",d)},_bringToFront:function(a){hl(a._path)},_bringToBack:function(a){gl(a._path)}});pe.vml&&Id.include(G3);function eI(a){return pe.svg||pe.vml?new Id(a):null}Qe.include({getRenderer:function(a){var d=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var d=this._paneRenderers[a];return d===void 0&&(d=this._createRenderer({pane:a}),this._paneRenderers[a]=d),d},_createRenderer:function(a){return this.options.preferCanvas&&X1(a)||eI(a)}});var tI=_l.extend({initialize:function(a,d){_l.prototype.initialize.call(this,this._boundsToLatLngs(a),d)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=Jt(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function Z3(a,d){return new tI(a,d)}Id.create=Zp,Id.pointsToPath=r1,So.geometryToLayer=Bp,So.coordsToLatLng=dy,So.coordsToLatLngs=Up,So.latLngToCoords=uy,So.latLngsToCoords=Hp,So.getFeature=yl,So.asFeature=Wp,Qe.mergeOptions({boxZoom:!0});var nI=Lr.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){Fe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ct(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Ft(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),_d(),G0(),this._startPoint=this._map.mouseEventToContainerPoint(a),Fe(document,{contextmenu:js,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=Je("div","leaflet-zoom-box",this._container),Ue(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var d=new Lt(this._point,this._startPoint),h=d.getSize();Xt(this._box,d.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(Ft(this._box),Gt(this._container,"leaflet-crosshair")),yd(),Z0(),Ct(document,{contextmenu:js,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(r(this._resetState,this),0);var d=new ui(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Qe.addInitHook("addHandler","boxZoom",nI),Qe.mergeOptions({doubleClickZoom:!0});var iI=Lr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var d=this._map,h=d.getZoom(),y=d.options.zoomDelta,S=a.originalEvent.shiftKey?h-y:h+y;d.options.doubleClickZoom==="center"?d.setZoom(S):d.setZoomAround(a.containerPoint,S)}});Qe.addInitHook("addHandler","doubleClickZoom",iI),Qe.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var rI=Lr.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new Qo(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}Ue(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Gt(this._map._container,"leaflet-grab"),Gt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=Jt(this._map.options.maxBounds);this._offsetLimit=di(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var d=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(d),this._prunePositions(d)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,d){return a-(a-d)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;a.x<d.min.x&&(a.x=this._viscousLimit(a.x,d.min.x)),a.y<d.min.y&&(a.y=this._viscousLimit(a.y,d.min.y)),a.x>d.max.x&&(a.x=this._viscousLimit(a.x,d.max.x)),a.y>d.max.y&&(a.y=this._viscousLimit(a.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,d=Math.round(a/2),h=this._initialWorldOffset,y=this._draggable._newPos.x,S=(y-d+h)%a+d-h,I=(y+d+h)%a-d-h,O=Math.abs(S+h)<Math.abs(I+h)?S:I;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=O},_onDragEnd:function(a){var d=this._map,h=d.options,y=!h.inertia||a.noInertia||this._times.length<2;if(d.fire("dragend",a),y)d.fire("moveend");else{this._prunePositions(+new Date);var S=this._lastPos.subtract(this._positions[0]),I=(this._lastTime-this._times[0])/1e3,O=h.easeLinearity,j=S.multiplyBy(O/I),$=j.distanceTo([0,0]),X=Math.min(h.inertiaMaxSpeed,$),ae=j.multiplyBy(X/$),be=X/(h.inertiaDeceleration*O),Ge=ae.multiplyBy(-be/2).round();!Ge.x&&!Ge.y?d.fire("moveend"):(Ge=d._limitOffset(Ge,d.options.maxBounds),ct(function(){d.panBy(Ge,{duration:be,easeLinearity:O,noMoveStart:!0,animate:!0})}))}}});Qe.addInitHook("addHandler","dragging",rI),Qe.mergeOptions({keyboard:!0,keyboardPanDelta:80});var oI=Lr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),Fe(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ct(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,d=document.documentElement,h=a.scrollTop||d.scrollTop,y=a.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(y,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var d=this._panKeys={},h=this.keyCodes,y,S;for(y=0,S=h.left.length;y<S;y++)d[h.left[y]]=[-1*a,0];for(y=0,S=h.right.length;y<S;y++)d[h.right[y]]=[a,0];for(y=0,S=h.down.length;y<S;y++)d[h.down[y]]=[0,a];for(y=0,S=h.up.length;y<S;y++)d[h.up[y]]=[0,-1*a]},_setZoomDelta:function(a){var d=this._zoomKeys={},h=this.keyCodes,y,S;for(y=0,S=h.zoomIn.length;y<S;y++)d[h.zoomIn[y]]=a;for(y=0,S=h.zoomOut.length;y<S;y++)d[h.zoomOut[y]]=-a},_addHooks:function(){Fe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ct(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var d=a.keyCode,h=this._map,y;if(d in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(y=this._panKeys[d],a.shiftKey&&(y=xe(y).multiplyBy(3)),h.options.maxBounds&&(y=h._limitOffset(xe(y),h.options.maxBounds)),h.options.worldCopyJump){var S=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(y)));h.panTo(S)}else h.panBy(y)}else if(d in this._zoomKeys)h.setZoom(h.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[d]);else if(d===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;js(a)}}});Qe.addInitHook("addHandler","keyboard",oI),Qe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var sI=Lr.extend({addHooks:function(){Fe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ct(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var d=P1(a),h=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var y=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r(this._performZoom,this),y),js(a)},_performZoom:function(){var a=this._map,d=a.getZoom(),h=this._map.options.zoomSnap||0;a._stop();var y=this._delta/(this._map.options.wheelPxPerZoomLevel*4),S=4*Math.log(2/(1+Math.exp(-Math.abs(y))))/Math.LN2,I=h?Math.ceil(S/h)*h:S,O=a._limitZoom(d+(this._delta>0?I:-I))-d;this._delta=0,this._startTime=null,O&&(a.options.scrollWheelZoom==="center"?a.setZoom(d+O):a.setZoomAround(this._lastMousePos,d+O))}});Qe.addInitHook("addHandler","scrollWheelZoom",sI);var Y3=600;Qe.mergeOptions({tapHold:pe.touchNative&&pe.safari&&pe.mobile,tapTolerance:15});var aI=Lr.extend({addHooks:function(){Fe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ct(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var d=a.touches[0];this._startPos=this._newPos=new Le(d.clientX,d.clientY),this._holdTimeout=setTimeout(r(function(){this._cancel(),this._isTapValid()&&(Fe(document,"touchend",Mn),Fe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),Y3),Fe(document,"touchend touchcancel contextmenu",this._cancel,this),Fe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){Ct(document,"touchend",Mn),Ct(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),Ct(document,"touchend touchcancel contextmenu",this._cancel,this),Ct(document,"touchmove",this._onMove,this)},_onMove:function(a){var d=a.touches[0];this._newPos=new Le(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,d){var h=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});h._simulated=!0,d.target.dispatchEvent(h)}});Qe.addInitHook("addHandler","tapHold",aI),Qe.mergeOptions({touchZoom:pe.touch,bounceAtZoomLimits:!0});var lI=Lr.extend({addHooks:function(){Ue(this._map._container,"leaflet-touch-zoom"),Fe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Gt(this._map._container,"leaflet-touch-zoom"),Ct(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var d=this._map;if(!(!a.touches||a.touches.length!==2||d._animatingZoom||this._zooming)){var h=d.mouseEventToContainerPoint(a.touches[0]),y=d.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(h.add(y)._divideBy(2))),this._startDist=h.distanceTo(y),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),Fe(document,"touchmove",this._onTouchMove,this),Fe(document,"touchend touchcancel",this._onTouchEnd,this),Mn(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var d=this._map,h=d.mouseEventToContainerPoint(a.touches[0]),y=d.mouseEventToContainerPoint(a.touches[1]),S=h.distanceTo(y)/this._startDist;if(this._zoom=d.getScaleZoom(S,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&S<1||this._zoom>d.getMaxZoom()&&S>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,S===1)return}else{var I=h._add(y)._divideBy(2)._subtract(this._centerPoint);if(S===1&&I.x===0&&I.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(I),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),Wt(this._animRequest);var O=r(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ct(O,this,!0),Mn(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Wt(this._animRequest),Ct(document,"touchmove",this._onTouchMove,this),Ct(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Qe.addInitHook("addHandler","touchZoom",lI),Qe.BoxZoom=nI,Qe.DoubleClickZoom=iI,Qe.Drag=rI,Qe.Keyboard=oI,Qe.ScrollWheelZoom=sI,Qe.TapHold=aI,Qe.TouchZoom=lI,n.Bounds=Lt,n.Browser=pe,n.CRS=yo,n.Canvas=J1,n.Circle=cy,n.CircleMarker=jp,n.Class=xi,n.Control=or,n.DivIcon=Y1,n.DivOverlay=Fr,n.DomEvent=p3,n.DomUtil=u3,n.Draggable=Qo,n.Evented=pd,n.FeatureGroup=bo,n.GeoJSON=So,n.GridLayer=xd,n.Handler=Lr,n.Icon=vl,n.ImageOverlay=$p,n.LatLng=ht,n.LatLngBounds=ui,n.Layer=sr,n.LayerGroup=ml,n.LineUtil=D3,n.Map=Qe,n.Marker=Vp,n.Mixin=b3,n.Path=Ko,n.Point=Le,n.PolyUtil=w3,n.Polygon=_l,n.Polyline=wo,n.Popup=qp,n.PosAnimation=A1,n.Projection=I3,n.Rectangle=tI,n.Renderer=Co,n.SVG=Id,n.SVGOverlay=Z1,n.TileLayer=bl,n.Tooltip=Gp,n.Transformation=N0,n.Util=Li,n.VideoOverlay=G1,n.bind=r,n.bounds=di,n.canvas=X1,n.circle=N3,n.circleMarker=O3,n.control=Sd,n.divIcon=W3,n.extend=t,n.featureGroup=A3,n.geoJSON=q1,n.geoJson=z3,n.gridLayer=$3,n.icon=R3,n.imageOverlay=V3,n.latLng=Ye,n.latLngBounds=Jt,n.layerGroup=P3,n.map=h3,n.marker=k3,n.point=xe,n.polygon=F3,n.polyline=L3,n.popup=U3,n.rectangle=Z3,n.setOptions=b,n.stamp=s,n.svg=eI,n.svgOverlay=B3,n.tileLayer=Q1,n.tooltip=H3,n.transformation=hd,n.version=e,n.videoOverlay=j3;var Q3=window.L;n.noConflict=function(){return window.L=Q3,this},window.L=n})});var AF=ar((C0,PF)=>{"use strict";(function(n,e){typeof C0=="object"&&typeof PF<"u"?e(C0):typeof define=="function"&&define.amd?define(["exports"],e):(n=n||self,e((n.Leaflet=n.Leaflet||{},n.Leaflet.markercluster={})))})(C0,function(n){"use strict";var e=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(i){L.Util.setOptions(this,i),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var r=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,r?this._withAnimation:this._noAnimation),this._markerCluster=r?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(i){if(i instanceof L.LayerGroup)return this.addLayers([i]);if(!i.getLatLng)return this._nonPointGroup.addLayer(i),this.fire("layeradd",{layer:i}),this;if(!this._map)return this._needsClustering.push(i),this.fire("layeradd",{layer:i}),this;if(this.hasLayer(i))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(i,this._maxZoom),this.fire("layeradd",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var r=i,o=this._zoom;if(i.__parent)for(;r.__parent._zoom>=o;)r=r.__parent;return this._currentShownBounds.contains(r.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(i,r):this._animationAddLayerNonAnimated(i,r)),this},removeLayer:function(i){return i instanceof L.LayerGroup?this.removeLayers([i]):i.getLatLng?this._map?i.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(i)),this._removeLayer(i,!0),this.fire("layerremove",{layer:i}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),i.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(i)&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,i)&&this.hasLayer(i)&&this._needsRemoving.push({layer:i,latlng:i._latlng}),this.fire("layerremove",{layer:i}),this):(this._nonPointGroup.removeLayer(i),this.fire("layerremove",{layer:i}),this)},addLayers:function(i,r){if(!L.Util.isArray(i))return this.addLayer(i);var o=this._featureGroup,s=this._nonPointGroup,l=this.options.chunkedLoading,c=this.options.chunkInterval,u=this.options.chunkProgress,f=i.length,m=0,w=!0,b;if(this._map){var D=new Date().getTime(),T=L.bind(function(){var P=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();m<f;m++){if(l&&m%200===0){var U=new Date().getTime()-P;if(U>c)break}if(b=i[m],b instanceof L.LayerGroup){w&&(i=i.slice(),w=!1),this._extractNonGroupLayers(b,i),f=i.length;continue}if(!b.getLatLng){s.addLayer(b),r||this.fire("layeradd",{layer:b});continue}if(!this.hasLayer(b)&&(this._addLayer(b,this._maxZoom),r||this.fire("layeradd",{layer:b}),b.__parent&&b.__parent.getChildCount()===2)){var K=b.__parent.getAllChildMarkers(),W=K[0]===b?K[1]:K[0];o.removeLayer(W)}}u&&u(m,f,new Date().getTime()-D),m===f?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(T,this.options.chunkDelay)},this);T()}else for(var M=this._needsClustering;m<f;m++){if(b=i[m],b instanceof L.LayerGroup){w&&(i=i.slice(),w=!1),this._extractNonGroupLayers(b,i),f=i.length;continue}if(!b.getLatLng){s.addLayer(b);continue}this.hasLayer(b)||M.push(b)}return this},removeLayers:function(i){var r,o,s=i.length,l=this._featureGroup,c=this._nonPointGroup,u=!0;if(!this._map){for(r=0;r<s;r++){if(o=i[r],o instanceof L.LayerGroup){u&&(i=i.slice(),u=!1),this._extractNonGroupLayers(o,i),s=i.length;continue}this._arraySplice(this._needsClustering,o),c.removeLayer(o),this.hasLayer(o)&&this._needsRemoving.push({layer:o,latlng:o._latlng}),this.fire("layerremove",{layer:o})}return this}if(this._unspiderfy){this._unspiderfy();var f=i.slice(),m=s;for(r=0;r<m;r++){if(o=f[r],o instanceof L.LayerGroup){this._extractNonGroupLayers(o,f),m=f.length;continue}this._unspiderfyLayer(o)}}for(r=0;r<s;r++){if(o=i[r],o instanceof L.LayerGroup){u&&(i=i.slice(),u=!1),this._extractNonGroupLayers(o,i),s=i.length;continue}if(!o.__parent){c.removeLayer(o),this.fire("layerremove",{layer:o});continue}this._removeLayer(o,!0,!0),this.fire("layerremove",{layer:o}),l.hasLayer(o)&&(l.removeLayer(o),o.clusterShow&&o.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(i){i.off(this._childMarkerEventHandlers,this),delete i.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var i=new L.LatLngBounds;this._topClusterLevel&&i.extend(this._topClusterLevel._bounds);for(var r=this._needsClustering.length-1;r>=0;r--)i.extend(this._needsClustering[r].getLatLng());return i.extend(this._nonPointGroup.getBounds()),i},eachLayer:function(i,r){var o=this._needsClustering.slice(),s=this._needsRemoving,l,c,u;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(o),c=o.length-1;c>=0;c--){for(l=!0,u=s.length-1;u>=0;u--)if(s[u].layer===o[c]){l=!1;break}l&&i.call(r,o[c])}this._nonPointGroup.eachLayer(i,r)},getLayers:function(){var i=[];return this.eachLayer(function(r){i.push(r)}),i},getLayer:function(i){var r=null;return i=parseInt(i,10),this.eachLayer(function(o){L.stamp(o)===i&&(r=o)}),r},hasLayer:function(i){if(!i)return!1;var r,o=this._needsClustering;for(r=o.length-1;r>=0;r--)if(o[r]===i)return!0;for(o=this._needsRemoving,r=o.length-1;r>=0;r--)if(o[r].layer===i)return!1;return!!(i.__parent&&i.__parent._group===this)||this._nonPointGroup.hasLayer(i)},zoomToShowLayer:function(i,r){var o=this._map;typeof r!="function"&&(r=function(){});var s=function(){(o.hasLayer(i)||o.hasLayer(i.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",s,this),this.off("animationend",s,this),o.hasLayer(i)?r():i.__parent._icon&&(this.once("spiderfied",r,this),i.__parent.spiderfy()))};i._icon&&this._map.getBounds().contains(i.getLatLng())?r():i.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",s,this),this._map.panTo(i.getLatLng())):(this._map.on("moveend",s,this),this.on("animationend",s,this),i.__parent.zoomToBounds())},onAdd:function(i){this._map=i;var r,o,s;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(i),this._nonPointGroup.addTo(i),this._gridClusters||this._generateInitialClusters(),this._maxLat=i.options.crs.projection.MAX_LATITUDE,r=0,o=this._needsRemoving.length;r<o;r++)s=this._needsRemoving[r],s.newlatlng=s.layer._latlng,s.layer._latlng=s.latlng;for(r=0,o=this._needsRemoving.length;r<o;r++)s=this._needsRemoving[r],this._removeLayer(s.layer,!0),s.layer._latlng=s.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),o=this._needsClustering,this._needsClustering=[],this.addLayers(o,!0)},onRemove:function(i){i.off("zoomend",this._zoomEnd,this),i.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(i){for(var r=i;r&&!r._icon;)r=r.__parent;return r||null},_arraySplice:function(i,r){for(var o=i.length-1;o>=0;o--)if(i[o]===r)return i.splice(o,1),!0},_removeFromGridUnclustered:function(i,r){for(var o=this._map,s=this._gridUnclustered,l=Math.floor(this._map.getMinZoom());r>=l&&s[r].removeObject(i,o.project(i.getLatLng(),r));r--);},_childMarkerDragStart:function(i){i.target.__dragStart=i.target._latlng},_childMarkerMoved:function(i){if(!this._ignoreMove&&!i.target.__dragStart){var r=i.target._popup&&i.target._popup.isOpen();this._moveChild(i.target,i.oldLatLng,i.latlng),r&&i.target.openPopup()}},_moveChild:function(i,r,o){i._latlng=r,this.removeLayer(i),i._latlng=o,this.addLayer(i)},_childMarkerDragEnd:function(i){var r=i.target.__dragStart;delete i.target.__dragStart,r&&this._moveChild(i.target,r,i.target._latlng)},_removeLayer:function(i,r,o){var s=this._gridClusters,l=this._gridUnclustered,c=this._featureGroup,u=this._map,f=Math.floor(this._map.getMinZoom());r&&this._removeFromGridUnclustered(i,this._maxZoom);var m=i.__parent,w=m._markers,b;for(this._arraySplice(w,i);m&&(m._childCount--,m._boundsNeedUpdate=!0,!(m._zoom<f));)r&&m._childCount<=1?(b=m._markers[0]===i?m._markers[1]:m._markers[0],s[m._zoom].removeObject(m,u.project(m._cLatLng,m._zoom)),l[m._zoom].addObject(b,u.project(b.getLatLng(),m._zoom)),this._arraySplice(m.__parent._childClusters,m),m.__parent._markers.push(b),b.__parent=m.__parent,m._icon&&(c.removeLayer(m),o||c.addLayer(b))):m._iconNeedsUpdate=!0,m=m.__parent;delete i.__parent},_isOrIsParent:function(i,r){for(;r;){if(i===r)return!0;r=r.parentNode}return!1},fire:function(i,r,o){if(r&&r.layer instanceof L.MarkerCluster){if(r.originalEvent&&this._isOrIsParent(r.layer._icon,r.originalEvent.relatedTarget))return;i="cluster"+i}L.FeatureGroup.prototype.fire.call(this,i,r,o)},listens:function(i,r){return L.FeatureGroup.prototype.listens.call(this,i,r)||L.FeatureGroup.prototype.listens.call(this,"cluster"+i,r)},_defaultIconCreateFunction:function(i){var r=i.getChildCount(),o=" marker-cluster-";return r<10?o+="small":r<100?o+="medium":o+="large",new L.DivIcon({html:"<div><span>"+r+"</span></div>",className:"marker-cluster"+o,iconSize:new L.Point(40,40)})},_bindEvents:function(){var i=this._map,r=this.options.spiderfyOnMaxZoom,o=this.options.showCoverageOnHover,s=this.options.zoomToBoundsOnClick,l=this.options.spiderfyOnEveryZoom;(r||s||l)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),o&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),i.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(i){var r=i.layer,o=r;if(!(i.type==="clusterkeypress"&&i.originalEvent&&i.originalEvent.keyCode!==13)){for(;o._childClusters.length===1;)o=o._childClusters[0];o._zoom===this._maxZoom&&o._childCount===r._childCount&&this.options.spiderfyOnMaxZoom?r.spiderfy():this.options.zoomToBoundsOnClick&&r.zoomToBounds(),this.options.spiderfyOnEveryZoom&&r.spiderfy(),i.originalEvent&&i.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(i){var r=this._map;this._inZoomAnimation||(this._shownPolygon&&r.removeLayer(this._shownPolygon),i.layer.getChildCount()>2&&i.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(i.layer.getConvexHull(),this.options.polygonOptions),r.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var i=this.options.spiderfyOnMaxZoom,r=this.options.showCoverageOnHover,o=this.options.zoomToBoundsOnClick,s=this.options.spiderfyOnEveryZoom,l=this._map;(i||o||s)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),r&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),l.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var i=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,i),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),i),this._currentShownBounds=i}},_generateInitialClusters:function(){var i=Math.ceil(this._map.getMaxZoom()),r=Math.floor(this._map.getMinZoom()),o=this.options.maxClusterRadius,s=o;typeof o!="function"&&(s=function(){return o}),this.options.disableClusteringAtZoom!==null&&(i=this.options.disableClusteringAtZoom-1),this._maxZoom=i,this._gridClusters={},this._gridUnclustered={};for(var l=i;l>=r;l--)this._gridClusters[l]=new L.DistanceGrid(s(l)),this._gridUnclustered[l]=new L.DistanceGrid(s(l));this._topClusterLevel=new this._markerCluster(this,r-1)},_addLayer:function(i,r){var o=this._gridClusters,s=this._gridUnclustered,l=Math.floor(this._map.getMinZoom()),c,u;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(i),i.on(this._childMarkerEventHandlers,this);r>=l;r--){c=this._map.project(i.getLatLng(),r);var f=o[r].getNearObject(c);if(f){f._addChild(i),i.__parent=f;return}if(f=s[r].getNearObject(c),f){var m=f.__parent;m&&this._removeLayer(f,!1);var w=new this._markerCluster(this,r,f,i);o[r].addObject(w,this._map.project(w._cLatLng,r)),f.__parent=w,i.__parent=w;var b=w;for(u=r-1;u>m._zoom;u--)b=new this._markerCluster(this,u,b),o[u].addObject(b,this._map.project(f.getLatLng(),u));m._addChild(b),this._removeFromGridUnclustered(f,r);return}s[r].addObject(i,c)}this._topClusterLevel._addChild(i),i.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(i){i instanceof L.MarkerCluster&&i._iconNeedsUpdate&&i._updateIcon()})},_enqueue:function(i){this._queue.push(i),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var i=0;i<this._queue.length;i++)this._queue[i].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var i=Math.round(this._map._zoom);this._processQueue(),this._zoom<i&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,i)):this._zoom>i?(this._animationStart(),this._animationZoomOut(this._zoom,i)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(i){var r=this._maxLat;return r!==void 0&&(i.getNorth()>=r&&(i._northEast.lat=1/0),i.getSouth()<=-r&&(i._southWest.lat=-1/0)),i},_animationAddLayerNonAnimated:function(i,r){if(r===i)this._featureGroup.addLayer(i);else if(r._childCount===2){r._addToMap();var o=r.getAllChildMarkers();this._featureGroup.removeLayer(o[0]),this._featureGroup.removeLayer(o[1])}else r._updateIcon()},_extractNonGroupLayers:function(i,r){var o=i.getLayers(),s=0,l;for(r=r||[];s<o.length;s++){if(l=o[s],l instanceof L.LayerGroup){this._extractNonGroupLayers(l,r);continue}r.push(l)}return r},_overrideMarkerIcon:function(i){var r=i.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[i]}});return r}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(i,r){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,r,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(i,r){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i),this._topClusterLevel._recursivelyAddChildrenToMap(null,r,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(i,r){this._animationAddLayerNonAnimated(i,r)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(i,r){var o=this._getExpandedVisibleBounds(),s=this._featureGroup,l=Math.floor(this._map.getMinZoom()),c;this._ignoreMove=!0,this._topClusterLevel._recursively(o,i,l,function(u){var f=u._latlng,m=u._markers,w;for(o.contains(f)||(f=null),u._isSingleParent()&&i+1===r?(s.removeLayer(u),u._recursivelyAddChildrenToMap(null,r,o)):(u.clusterHide(),u._recursivelyAddChildrenToMap(f,r,o)),c=m.length-1;c>=0;c--)w=m[c],o.contains(w._latlng)||s.removeLayer(w)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(o,r),s.eachLayer(function(u){!(u instanceof L.MarkerCluster)&&u._icon&&u.clusterShow()}),this._topClusterLevel._recursively(o,i,r,function(u){u._recursivelyRestoreChildPositions(r)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(o,i,l,function(u){s.removeLayer(u),u.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(i,r){this._animationZoomOutSingle(this._topClusterLevel,i-1,r),this._topClusterLevel._recursivelyAddChildrenToMap(null,r,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),i,this._getExpandedVisibleBounds())},_animationAddLayer:function(i,r){var o=this,s=this._featureGroup;s.addLayer(i),r!==i&&(r._childCount>2?(r._updateIcon(),this._forceLayout(),this._animationStart(),i._setPos(this._map.latLngToLayerPoint(r.getLatLng())),i.clusterHide(),this._enqueue(function(){s.removeLayer(i),i.clusterShow(),o._animationEnd()})):(this._forceLayout(),o._animationStart(),o._animationZoomOutSingle(r,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(i,r,o){var s=this._getExpandedVisibleBounds(),l=Math.floor(this._map.getMinZoom());i._recursivelyAnimateChildrenInAndAddSelfToMap(s,l,r+1,o);var c=this;this._forceLayout(),i._recursivelyBecomeVisible(s,o),this._enqueue(function(){if(i._childCount===1){var u=i._markers[0];this._ignoreMove=!0,u.setLatLng(u.getLatLng()),this._ignoreMove=!1,u.clusterShow&&u.clusterShow()}else i._recursively(s,o,l,function(f){f._recursivelyRemoveChildrenFromMap(s,l,r+1)});c._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(i){return new L.MarkerClusterGroup(i)};var t=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(i,r,o,s){L.Marker.prototype.initialize.call(this,o?o._cLatLng||o.getLatLng():new L.LatLng(0,0),{icon:this,pane:i.options.clusterPane}),this._group=i,this._zoom=r,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,o&&this._addChild(o),s&&this._addChild(s)},getAllChildMarkers:function(i,r){i=i||[];for(var o=this._childClusters.length-1;o>=0;o--)this._childClusters[o].getAllChildMarkers(i,r);for(var s=this._markers.length-1;s>=0;s--)r&&this._markers[s].__dragStart||i.push(this._markers[s]);return i},getChildCount:function(){return this._childCount},zoomToBounds:function(i){for(var r=this._childClusters.slice(),o=this._group._map,s=o.getBoundsZoom(this._bounds),l=this._zoom+1,c=o.getZoom(),u;r.length>0&&s>l;){l++;var f=[];for(u=0;u<r.length;u++)f=f.concat(r[u]._childClusters);r=f}s>l?this._group._map.setView(this._latlng,l):s<=c?this._group._map.setView(this._latlng,c+1):this._group._map.fitBounds(this._bounds,i)},getBounds:function(){var i=new L.LatLngBounds;return i.extend(this._bounds),i},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(i,r){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(i),i instanceof L.MarkerCluster?(r||(this._childClusters.push(i),i.__parent=this),this._childCount+=i._childCount):(r||this._markers.push(i),this._childCount++),this.__parent&&this.__parent._addChild(i,!0)},_setClusterCenter:function(i){this._cLatLng||(this._cLatLng=i._cLatLng||i._latlng)},_resetBounds:function(){var i=this._bounds;i._southWest&&(i._southWest.lat=1/0,i._southWest.lng=1/0),i._northEast&&(i._northEast.lat=-1/0,i._northEast.lng=-1/0)},_recalculateBounds:function(){var i=this._markers,r=this._childClusters,o=0,s=0,l=this._childCount,c,u,f,m;if(l!==0){for(this._resetBounds(),c=0;c<i.length;c++)f=i[c]._latlng,this._bounds.extend(f),o+=f.lat,s+=f.lng;for(c=0;c<r.length;c++)u=r[c],u._boundsNeedUpdate&&u._recalculateBounds(),this._bounds.extend(u._bounds),f=u._wLatLng,m=u._childCount,o+=f.lat*m,s+=f.lng*m;this._latlng=this._wLatLng=new L.LatLng(o/l,s/l),this._boundsNeedUpdate=!1}},_addToMap:function(i){i&&(this._backupLatlng=this._latlng,this.setLatLng(i)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(i,r,o){this._recursively(i,this._group._map.getMinZoom(),o-1,function(s){var l=s._markers,c,u;for(c=l.length-1;c>=0;c--)u=l[c],u._icon&&(u._setPos(r),u.clusterHide())},function(s){var l=s._childClusters,c,u;for(c=l.length-1;c>=0;c--)u=l[c],u._icon&&(u._setPos(r),u.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(i,r,o,s){this._recursively(i,s,r,function(l){l._recursivelyAnimateChildrenIn(i,l._group._map.latLngToLayerPoint(l.getLatLng()).round(),o),l._isSingleParent()&&o-1===s?(l.clusterShow(),l._recursivelyRemoveChildrenFromMap(i,r,o)):l.clusterHide(),l._addToMap()})},_recursivelyBecomeVisible:function(i,r){this._recursively(i,this._group._map.getMinZoom(),r,null,function(o){o.clusterShow()})},_recursivelyAddChildrenToMap:function(i,r,o){this._recursively(o,this._group._map.getMinZoom()-1,r,function(s){if(r!==s._zoom)for(var l=s._markers.length-1;l>=0;l--){var c=s._markers[l];o.contains(c._latlng)&&(i&&(c._backupLatlng=c.getLatLng(),c.setLatLng(i),c.clusterHide&&c.clusterHide()),s._group._featureGroup.addLayer(c))}},function(s){s._addToMap(i)})},_recursivelyRestoreChildPositions:function(i){for(var r=this._markers.length-1;r>=0;r--){var o=this._markers[r];o._backupLatlng&&(o.setLatLng(o._backupLatlng),delete o._backupLatlng)}if(i-1===this._zoom)for(var s=this._childClusters.length-1;s>=0;s--)this._childClusters[s]._restorePosition();else for(var l=this._childClusters.length-1;l>=0;l--)this._childClusters[l]._recursivelyRestoreChildPositions(i)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(i,r,o,s){var l,c;this._recursively(i,r-1,o-1,function(u){for(c=u._markers.length-1;c>=0;c--)l=u._markers[c],(!s||!s.contains(l._latlng))&&(u._group._featureGroup.removeLayer(l),l.clusterShow&&l.clusterShow())},function(u){for(c=u._childClusters.length-1;c>=0;c--)l=u._childClusters[c],(!s||!s.contains(l._latlng))&&(u._group._featureGroup.removeLayer(l),l.clusterShow&&l.clusterShow())})},_recursively:function(i,r,o,s,l){var c=this._childClusters,u=this._zoom,f,m;if(r<=u&&(s&&s(this),l&&u===o&&l(this)),u<r||u<o)for(f=c.length-1;f>=0;f--)m=c[f],m._boundsNeedUpdate&&m._recalculateBounds(),i.intersects(m._bounds)&&m._recursively(i,r,o,s,l)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var i=this.options.opacity;return this.setOpacity(0),this.options.opacity=i,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(i){this._cellSize=i,this._sqCellSize=i*i,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(i,r){var o=this._getCoord(r.x),s=this._getCoord(r.y),l=this._grid,c=l[s]=l[s]||{},u=c[o]=c[o]||[],f=L.Util.stamp(i);this._objectPoint[f]=r,u.push(i)},updateObject:function(i,r){this.removeObject(i),this.addObject(i,r)},removeObject:function(i,r){var o=this._getCoord(r.x),s=this._getCoord(r.y),l=this._grid,c=l[s]=l[s]||{},u=c[o]=c[o]||[],f,m;for(delete this._objectPoint[L.Util.stamp(i)],f=0,m=u.length;f<m;f++)if(u[f]===i)return u.splice(f,1),m===1&&delete c[o],!0},eachObject:function(i,r){var o,s,l,c,u,f,m,w=this._grid;for(o in w){u=w[o];for(s in u)for(f=u[s],l=0,c=f.length;l<c;l++)m=i.call(r,f[l]),m&&(l--,c--)}},getNearObject:function(i){var r=this._getCoord(i.x),o=this._getCoord(i.y),s,l,c,u,f,m,w,b,D=this._objectPoint,T=this._sqCellSize,M=null;for(s=o-1;s<=o+1;s++)if(u=this._grid[s],u){for(l=r-1;l<=r+1;l++)if(f=u[l],f)for(c=0,m=f.length;c<m;c++)w=f[c],b=this._sqDist(D[L.Util.stamp(w)],i),(b<T||b<=T&&M===null)&&(T=b,M=w)}return M},_getCoord:function(i){var r=Math.floor(i/this._cellSize);return isFinite(r)?r:i},_sqDist:function(i,r){var o=r.x-i.x,s=r.y-i.y;return o*o+s*s}},function(){L.QuickHull={getDistant:function(i,r){var o=r[1].lat-r[0].lat,s=r[0].lng-r[1].lng;return s*(i.lat-r[0].lat)+o*(i.lng-r[0].lng)},findMostDistantPointFromBaseLine:function(i,r){var o=0,s=null,l=[],c,u,f;for(c=r.length-1;c>=0;c--){if(u=r[c],f=this.getDistant(u,i),f>0)l.push(u);else continue;f>o&&(o=f,s=u)}return{maxPoint:s,newPoints:l}},buildConvexHull:function(i,r){var o=[],s=this.findMostDistantPointFromBaseLine(i,r);return s.maxPoint?(o=o.concat(this.buildConvexHull([i[0],s.maxPoint],s.newPoints)),o=o.concat(this.buildConvexHull([s.maxPoint,i[1]],s.newPoints)),o):[i[0]]},getConvexHull:function(i){var r=!1,o=!1,s=!1,l=!1,c=null,u=null,f=null,m=null,w=null,b=null,D;for(D=i.length-1;D>=0;D--){var T=i[D];(r===!1||T.lat>r)&&(c=T,r=T.lat),(o===!1||T.lat<o)&&(u=T,o=T.lat),(s===!1||T.lng>s)&&(f=T,s=T.lng),(l===!1||T.lng<l)&&(m=T,l=T.lng)}o!==r?(b=u,w=c):(b=m,w=f);var M=[].concat(this.buildConvexHull([b,w],i),this.buildConvexHull([w,b],i));return M}}}(),L.MarkerCluster.include({getConvexHull:function(){var i=this.getAllChildMarkers(),r=[],o,s;for(s=i.length-1;s>=0;s--)o=i[s].getLatLng(),r.push(o);return L.QuickHull.getConvexHull(r)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var i=this.getAllChildMarkers(null,!0),r=this._group,o=r._map,s=o.latLngToLayerPoint(this._latlng),l;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?l=this._group.options.spiderfyShapePositions(i.length,s):i.length>=this._circleSpiralSwitchover?l=this._generatePointsSpiral(i.length,s):(s.y+=10,l=this._generatePointsCircle(i.length,s)),this._animationSpiderfy(i,l)}},unspiderfy:function(i){this._group._inZoomAnimation||(this._animationUnspiderfy(i),this._group._spiderfied=null)},_generatePointsCircle:function(i,r){var o=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+i),s=o/this._2PI,l=this._2PI/i,c=[],u,f;for(s=Math.max(s,35),c.length=i,u=0;u<i;u++)f=this._circleStartAngle+u*l,c[u]=new L.Point(r.x+s*Math.cos(f),r.y+s*Math.sin(f))._round();return c},_generatePointsSpiral:function(i,r){var o=this._group.options.spiderfyDistanceMultiplier,s=o*this._spiralLengthStart,l=o*this._spiralFootSeparation,c=o*this._spiralLengthFactor*this._2PI,u=0,f=[],m;for(f.length=i,m=i;m>=0;m--)m<i&&(f[m]=new L.Point(r.x+s*Math.cos(u),r.y+s*Math.sin(u))._round()),u+=l/s+m*5e-4,s+=c/u;return f},_noanimationUnspiderfy:function(){var i=this._group,r=i._map,o=i._featureGroup,s=this.getAllChildMarkers(null,!0),l,c;for(i._ignoreMove=!0,this.setOpacity(1),c=s.length-1;c>=0;c--)l=s[c],o.removeLayer(l),l._preSpiderfyLatlng&&(l.setLatLng(l._preSpiderfyLatlng),delete l._preSpiderfyLatlng),l.setZIndexOffset&&l.setZIndexOffset(0),l._spiderLeg&&(r.removeLayer(l._spiderLeg),delete l._spiderLeg);i.fire("unspiderfied",{cluster:this,markers:s}),i._ignoreMove=!1,i._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(i,r){var o=this._group,s=o._map,l=o._featureGroup,c=this._group.options.spiderLegPolylineOptions,u,f,m,w;for(o._ignoreMove=!0,u=0;u<i.length;u++)w=s.layerPointToLatLng(r[u]),f=i[u],m=new L.Polyline([this._latlng,w],c),s.addLayer(m),f._spiderLeg=m,f._preSpiderfyLatlng=f._latlng,f.setLatLng(w),f.setZIndexOffset&&f.setZIndexOffset(1e6),l.addLayer(f);this.setOpacity(.3),o._ignoreMove=!1,o.fire("spiderfied",{cluster:this,markers:i})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(i,r){var o=this,s=this._group,l=s._map,c=s._featureGroup,u=this._latlng,f=l.latLngToLayerPoint(u),m=L.Path.SVG,w=L.extend({},this._group.options.spiderLegPolylineOptions),b=w.opacity,D,T,M,P,U,K;for(b===void 0&&(b=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),m?(w.opacity=0,w.className=(w.className||"")+" leaflet-cluster-spider-leg"):w.opacity=b,s._ignoreMove=!0,D=0;D<i.length;D++)T=i[D],K=l.layerPointToLatLng(r[D]),M=new L.Polyline([u,K],w),l.addLayer(M),T._spiderLeg=M,m&&(P=M._path,U=P.getTotalLength()+.1,P.style.strokeDasharray=U,P.style.strokeDashoffset=U),T.setZIndexOffset&&T.setZIndexOffset(1e6),T.clusterHide&&T.clusterHide(),c.addLayer(T),T._setPos&&T._setPos(f);for(s._forceLayout(),s._animationStart(),D=i.length-1;D>=0;D--)K=l.layerPointToLatLng(r[D]),T=i[D],T._preSpiderfyLatlng=T._latlng,T.setLatLng(K),T.clusterShow&&T.clusterShow(),m&&(M=T._spiderLeg,P=M._path,P.style.strokeDashoffset=0,M.setStyle({opacity:b}));this.setOpacity(.3),s._ignoreMove=!1,setTimeout(function(){s._animationEnd(),s.fire("spiderfied",{cluster:o,markers:i})},200)},_animationUnspiderfy:function(i){var r=this,o=this._group,s=o._map,l=o._featureGroup,c=i?s._latLngToNewLayerPoint(this._latlng,i.zoom,i.center):s.latLngToLayerPoint(this._latlng),u=this.getAllChildMarkers(null,!0),f=L.Path.SVG,m,w,b,D,T,M;for(o._ignoreMove=!0,o._animationStart(),this.setOpacity(1),w=u.length-1;w>=0;w--)m=u[w],m._preSpiderfyLatlng&&(m.closePopup(),m.setLatLng(m._preSpiderfyLatlng),delete m._preSpiderfyLatlng,M=!0,m._setPos&&(m._setPos(c),M=!1),m.clusterHide&&(m.clusterHide(),M=!1),M&&l.removeLayer(m),f&&(b=m._spiderLeg,D=b._path,T=D.getTotalLength()+.1,D.style.strokeDashoffset=T,b.setStyle({opacity:0})));o._ignoreMove=!1,setTimeout(function(){var P=0;for(w=u.length-1;w>=0;w--)m=u[w],m._spiderLeg&&P++;for(w=u.length-1;w>=0;w--)m=u[w],m._spiderLeg&&(m.clusterShow&&m.clusterShow(),m.setZIndexOffset&&m.setZIndexOffset(0),P>1&&l.removeLayer(m),s.removeLayer(m._spiderLeg),delete m._spiderLeg);o._animationEnd(),o.fire("unspiderfied",{cluster:r,markers:u})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(i){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(i))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(i){this._spiderfied&&this._spiderfied.unspiderfy(i)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(i){i._spiderLeg&&(this._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow(),i.setZIndexOffset&&i.setZIndexOffset(0),this._map.removeLayer(i._spiderLeg),delete i._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(i){return i?i instanceof L.MarkerClusterGroup?i=i._topClusterLevel.getAllChildMarkers():i instanceof L.LayerGroup?i=i._layers:i instanceof L.MarkerCluster?i=i.getAllChildMarkers():i instanceof L.Marker&&(i=[i]):i=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(i),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(i),this},_flagParentsIconsNeedUpdate:function(i){var r,o;for(r in i)for(o=i[r].__parent;o;)o._iconNeedsUpdate=!0,o=o.__parent},_refreshSingleMarkerModeMarkers:function(i){var r,o;for(r in i)o=i[r],this.hasLayer(o)&&o.setIcon(this._overrideMarkerIcon(o))}}),L.Marker.include({refreshIconOptions:function(i,r){var o=this.options.icon;return L.setOptions(o,i),this.setIcon(o),r&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),n.MarkerClusterGroup=e,n.MarkerCluster=t,Object.defineProperty(n,"__esModule",{value:!0})})});var my;function Qp(){return my}function zr(n){let e=my;return my=n,e}var gI=Symbol("NotFound");function Cl(n){return n===gI||n?.name==="\u0275NotFound"}function th(n,e){return Object.is(n,e)}var dn=null,Kp=!1,vy=1,az=null,zn=Symbol("SIGNAL");function Be(n){let e=dn;return dn=n,e}function nh(){return dn}var Us={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function El(n){if(Kp)throw new Error("");if(dn===null)return;dn.consumerOnSignalRead(n);let e=dn.nextProducerIndex++;if(sh(dn),e<dn.producerNode.length&&dn.producerNode[e]!==n&&Td(dn)){let t=dn.producerNode[e];oh(t,dn.producerIndexOfThis[e])}dn.producerNode[e]!==n&&(dn.producerNode[e]=n,dn.producerIndexOfThis[e]=Td(dn)?vI(n,dn,e):0),dn.producerLastReadVersion[e]=n.version}function mI(){vy++}function ih(n){if(!(Td(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===vy)){if(!n.producerMustRecompute(n)&&!Pd(n)){eh(n);return}n.producerRecomputeValue(n),eh(n)}}function _y(n){if(n.liveConsumerNode===void 0)return;let e=Kp;Kp=!0;try{for(let t of n.liveConsumerNode)t.dirty||lz(t)}finally{Kp=e}}function yy(){return dn?.consumerAllowSignalWrites!==!1}function lz(n){n.dirty=!0,_y(n),n.consumerMarkedDirty?.(n)}function eh(n){n.dirty=!1,n.lastCleanEpoch=vy}function Hs(n){return n&&(n.nextProducerIndex=0),Be(n)}function xl(n,e){if(Be(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Td(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)oh(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Pd(n){sh(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(ih(t),i!==t.version))return!0}return!1}function rh(n){if(sh(n),Td(n))for(let e=0;e<n.producerNode.length;e++)oh(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function vI(n,e,t){if(_I(n),n.liveConsumerNode.length===0&&yI(n))for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=vI(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function oh(n,e){if(_I(n),n.liveConsumerNode.length===1&&yI(n))for(let i=0;i<n.producerNode.length;i++)oh(n.producerNode[i],n.producerIndexOfThis[i]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];sh(r),r.producerIndexOfThis[i]=e}}function Td(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function sh(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function _I(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function yI(n){return n.producerNode!==void 0}function ah(n){az?.(n)}function lh(n,e){let t=Object.create(cz);t.computation=n,e!==void 0&&(t.equal=e);let i=()=>{if(ih(t),El(t),t.value===Md)throw t.error;return t.value};return i[zn]=t,ah(t),i}var Jp=Symbol("UNSET"),Xp=Symbol("COMPUTING"),Md=Symbol("ERRORED"),cz=ne(B({},Us),{value:Jp,dirty:!0,error:null,equal:th,kind:"computed",producerMustRecompute(n){return n.value===Jp||n.value===Xp},producerRecomputeValue(n){if(n.value===Xp)throw new Error("");let e=n.value;n.value=Xp;let t=Hs(n),i,r=!1;try{i=n.computation(),Be(null),r=e!==Jp&&e!==Md&&i!==Md&&n.equal(e,i)}catch(o){i=Md,n.error=o}finally{xl(n,t)}if(r){n.value=e;return}n.value=i,n.version++}});function dz(){throw new Error}var bI=dz;function wI(n){bI(n)}function by(n){bI=n}var uz=null;function wy(n,e){let t=Object.create(ch);t.value=n,e!==void 0&&(t.equal=e);let i=()=>SI(t);return i[zn]=t,ah(t),[i,s=>Dl(t,s),s=>Sy(t,s)]}function SI(n){return El(n),n.value}function Dl(n,e){yy()||wI(n),n.equal(n.value,e)||(n.value=e,fz(n))}function Sy(n,e){yy()||wI(n),Dl(n,e(n.value))}var ch=ne(B({},Us),{equal:th,value:void 0,kind:"signal"});function fz(n){n.version++,mI(),_y(n),uz?.(n)}function Ae(n){return typeof n=="function"}function Il(n){let t=n(i=>{Error.call(i),i.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var dh=Il(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Ws(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var et=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:i}=this;if(Ae(i))try{i()}catch(o){e=o instanceof dh?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{CI(o)}catch(s){e=e??[],s instanceof dh?e=[...e,...s.errors]:e.push(s)}}if(e)throw new dh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)CI(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ws(t,e)}remove(e){let{_finalizers:t}=this;t&&Ws(t,e),e instanceof n&&e._removeParent(this)}};et.EMPTY=(()=>{let n=new et;return n.closed=!0,n})();var Cy=et.EMPTY;function uh(n){return n instanceof et||n&&"closed"in n&&Ae(n.remove)&&Ae(n.add)&&Ae(n.unsubscribe)}function CI(n){Ae(n)?n():n.unsubscribe()}var lr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ml={setTimeout(n,e,...t){let{delegate:i}=Ml;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Ml;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function fh(n){Ml.setTimeout(()=>{let{onUnhandledError:e}=lr;if(e)e(n);else throw n})}function Ad(){}var EI=Ey("C",void 0,void 0);function xI(n){return Ey("E",void 0,n)}function DI(n){return Ey("N",n,void 0)}function Ey(n,e,t){return{kind:n,value:e,error:t}}var $s=null;function Tl(n){if(lr.useDeprecatedSynchronousErrorHandling){let e=!$s;if(e&&($s={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:i}=$s;if($s=null,t)throw i}}else n()}function II(n){lr.useDeprecatedSynchronousErrorHandling&&$s&&($s.errorThrown=!0,$s.error=n)}var qs=class extends et{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,uh(e)&&e.add(this)):this.destination=gz}static create(e,t,i){return new Pl(e,t,i)}next(e){this.isStopped?Dy(DI(e),this):this._next(e)}error(e){this.isStopped?Dy(xI(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Dy(EI,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},pz=Function.prototype.bind;function xy(n,e){return pz.call(n,e)}var Iy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){ph(i)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){ph(i)}else ph(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ph(t)}}},Pl=class extends qs{constructor(e,t,i){super();let r;if(Ae(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let o;this&&lr.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&xy(e.next,o),error:e.error&&xy(e.error,o),complete:e.complete&&xy(e.complete,o)}):r=e}this.destination=new Iy(r)}};function ph(n){lr.useDeprecatedSynchronousErrorHandling?II(n):fh(n)}function hz(n){throw n}function Dy(n,e){let{onStoppedNotification:t}=lr;t&&Ml.setTimeout(()=>t(n,e))}var gz={closed:!0,next:Ad,error:hz,complete:Ad};var Al=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Qn(n){return n}function My(...n){return Ty(n)}function Ty(n){return n.length===0?Qn:n.length===1?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}var De=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){let o=vz(t)?t:new Pl(t,i,r);return Tl(()=>{let{operator:s,source:l}=this;o.add(s?s.call(o,l):l?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return i=MI(i),new i((r,o)=>{let s=new Pl({next:l=>{try{t(l)}catch(c){o(c),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(t)}[Al](){return this}pipe(...t){return Ty(t)(this)}toPromise(t){return t=MI(t),new t((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function MI(n){var e;return(e=n??lr.Promise)!==null&&e!==void 0?e:Promise}function mz(n){return n&&Ae(n.next)&&Ae(n.error)&&Ae(n.complete)}function vz(n){return n&&n instanceof qs||mz(n)&&uh(n)}function Py(n){return Ae(n?.lift)}function He(n){return e=>{if(Py(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Re(n,e,t,i,r){return new Ay(n,e,t,i,r)}var Ay=class extends qs{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(l){try{t(l)}catch(c){e.error(c)}}:super._next,this._error=r?function(l){try{r(l)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Rl(){return He((n,e)=>{let t=null;n._refCount++;let i=Re(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let r=n._connection,o=t;t=null,r&&(!o||r===o)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}var kl=class extends De{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Py(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new et;let t=this.getSubject();e.add(this.source.subscribe(Re(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=et.EMPTY)}return e}refCount(){return Rl()(this)}};var Ol={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame,{delegate:i}=Ol;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);let r=e(o=>{t=void 0,n(o)});return new et(()=>t?.(r))},requestAnimationFrame(...n){let{delegate:e}=Ol;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){let{delegate:e}=Ol;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0};var TI=Il(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var _e=(()=>{class n extends De{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let i=new hh(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new TI}next(t){Tl(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(t)}})}error(t){Tl(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Tl(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:i,isStopped:r,observers:o}=this;return i||r?Cy:(this.currentObservers=null,o.push(t),new et(()=>{this.currentObservers=null,Ws(o,t)}))}_checkFinalizedStatuses(t){let{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){let t=new De;return t.source=this,t}}return n.create=(e,t)=>new hh(e,t),n})(),hh=class extends _e{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)}error(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:Cy}};var Zt=class extends _e{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var Ry={now(){return(Ry.delegate||Date).now()},delegate:void 0};var gh=class extends et{constructor(e,t){super()}schedule(e,t=0){return this}};var Rd={setInterval(n,e,...t){let{delegate:i}=Rd;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Rd;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Nl=class extends gh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;let r=this.id,o=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,i=0){return Rd.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return t;t!=null&&Rd.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(e,t);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i=!1,r;try{this.work(e)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Ws(i,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Ll=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}};Ll.now=Ry.now;var Fl=class extends Ll{constructor(e,t=Ll.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}};var Gs=new Fl(Nl),PI=Gs;var mh=class extends Nl{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return i!==null&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=Ol.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(i!=null?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);let{actions:o}=e;t!=null&&t===e._scheduled&&((r=o[o.length-1])===null||r===void 0?void 0:r.id)!==t&&(Ol.cancelAnimationFrame(t),e._scheduled=void 0)}};var vh=class extends Fl{flush(e){this._active=!0;let t;e?t=e.id:(t=this._scheduled,this._scheduled=void 0);let{actions:i}=this,r;e=e||i.shift();do if(r=e.execute(e.state,e.delay))break;while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}};var _h=new vh(mh);var Vn=new De(n=>n.complete());function yh(n){return n&&Ae(n.schedule)}function ky(n){return n[n.length-1]}function bh(n){return Ae(ky(n))?n.pop():void 0}function Vr(n){return yh(ky(n))?n.pop():void 0}function AI(n,e){return typeof ky(n)=="number"?n.pop():e}function kI(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(f){try{u(i.next(f))}catch(m){s(m)}}function c(f){try{u(i.throw(f))}catch(m){s(m)}}function u(f){f.done?o(f.value):r(f.value).then(l,c)}u((i=i.apply(n,e||[])).next())})}function RI(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zs(n){return this instanceof Zs?(this.v=n,this):new Zs(n)}function OI(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(b){return function(D){return Promise.resolve(D).then(b,m)}}function l(b,D){i[b]&&(r[b]=function(T){return new Promise(function(M,P){o.push([b,T,M,P])>1||c(b,T)})},D&&(r[b]=D(r[b])))}function c(b,D){try{u(i[b](D))}catch(T){w(o[0][3],T)}}function u(b){b.value instanceof Zs?Promise.resolve(b.value.v).then(f,m):w(o[0][2],b)}function f(b){c("next",b)}function m(b){c("throw",b)}function w(b,D){b(D),o.shift(),o.length&&c(o[0][0],o[0][1])}}function NI(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof RI=="function"?RI(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(l,c){s=n[o](s),r(l,c,s.done,s.value)})}}function r(o,s,l,c){Promise.resolve(c).then(function(u){o({value:u,done:l})},s)}}var wh=n=>n&&typeof n.length=="number"&&typeof n!="function";function Sh(n){return Ae(n?.then)}function Ch(n){return Ae(n[Al])}function Eh(n){return Symbol.asyncIterator&&Ae(n?.[Symbol.asyncIterator])}function xh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function _z(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Dh=_z();function Ih(n){return Ae(n?.[Dh])}function Mh(n){return OI(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:i,done:r}=yield Zs(t.read());if(r)return yield Zs(void 0);yield yield Zs(i)}}finally{t.releaseLock()}})}function Th(n){return Ae(n?.getReader)}function At(n){if(n instanceof De)return n;if(n!=null){if(Ch(n))return yz(n);if(wh(n))return bz(n);if(Sh(n))return wz(n);if(Eh(n))return LI(n);if(Ih(n))return Sz(n);if(Th(n))return Cz(n)}throw xh(n)}function yz(n){return new De(e=>{let t=n[Al]();if(Ae(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function bz(n){return new De(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function wz(n){return new De(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,fh)})}function Sz(n){return new De(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function LI(n){return new De(e=>{Ez(n,e).catch(t=>e.error(t))})}function Cz(n){return LI(Mh(n))}function Ez(n,e){var t,i,r,o;return kI(this,void 0,void 0,function*(){try{for(t=NI(n);i=yield t.next(),!i.done;){let s=i.value;if(e.next(s),e.closed)return}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function pi(n,e,t,i=0,r=!1){let o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function Ph(n,e=0){return He((t,i)=>{t.subscribe(Re(i,r=>pi(i,n,()=>i.next(r),e),()=>pi(i,n,()=>i.complete(),e),r=>pi(i,n,()=>i.error(r),e)))})}function Ah(n,e=0){return He((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function FI(n,e){return At(n).pipe(Ah(e),Ph(e))}function zI(n,e){return At(n).pipe(Ah(e),Ph(e))}function VI(n,e){return new De(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function jI(n,e){return new De(t=>{let i;return pi(t,e,()=>{i=n[Dh](),pi(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){t.error(s);return}o?t.complete():t.next(r)},0,!0)}),()=>Ae(i?.return)&&i.return()})}function Rh(n,e){if(!n)throw new Error("Iterable cannot be null");return new De(t=>{pi(t,e,()=>{let i=n[Symbol.asyncIterator]();pi(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function BI(n,e){return Rh(Mh(n),e)}function UI(n,e){if(n!=null){if(Ch(n))return FI(n,e);if(wh(n))return VI(n,e);if(Sh(n))return zI(n,e);if(Eh(n))return Rh(n,e);if(Ih(n))return jI(n,e);if(Th(n))return BI(n,e)}throw xh(n)}function _t(n,e){return e?UI(n,e):At(n)}function ge(...n){let e=Vr(n);return _t(n,e)}function zl(n,e){let t=Ae(n)?n:()=>n,i=r=>r.error(t());return new De(e?r=>e.schedule(i,0,r):i)}function kh(n){return!!n&&(n instanceof De||Ae(n.lift)&&Ae(n.subscribe))}var Eo=Il(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function HI(n){return n instanceof Date&&!isNaN(n)}function ke(n,e){return He((t,i)=>{let r=0;t.subscribe(Re(i,o=>{i.next(n.call(e,o,r++))}))})}var{isArray:xz}=Array;function Dz(n,e){return xz(e)?n(...e):n(e)}function Oh(n){return ke(e=>Dz(n,e))}var{isArray:Iz}=Array,{getPrototypeOf:Mz,prototype:Tz,keys:Pz}=Object;function Nh(n){if(n.length===1){let e=n[0];if(Iz(e))return{args:e,keys:null};if(Az(e)){let t=Pz(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}function Az(n){return n&&typeof n=="object"&&Mz(n)===Tz}function Lh(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Ys(...n){let e=Vr(n),t=bh(n),{args:i,keys:r}=Nh(n);if(i.length===0)return _t([],e);let o=new De(Rz(i,e,r?s=>Lh(r,s):Qn));return t?o.pipe(Oh(t)):o}function Rz(n,e,t=Qn){return i=>{WI(e,()=>{let{length:r}=n,o=new Array(r),s=r,l=r;for(let c=0;c<r;c++)WI(e,()=>{let u=_t(n[c],e),f=!1;u.subscribe(Re(i,m=>{o[c]=m,f||(f=!0,l--),l||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function WI(n,e,t){n?pi(t,n,e):e()}function $I(n,e,t,i,r,o,s,l){let c=[],u=0,f=0,m=!1,w=()=>{m&&!c.length&&!u&&e.complete()},b=T=>u<i?D(T):c.push(T),D=T=>{o&&e.next(T),u++;let M=!1;At(t(T,f++)).subscribe(Re(e,P=>{r?.(P),o?b(P):e.next(P)},()=>{M=!0},void 0,()=>{if(M)try{for(u--;c.length&&u<i;){let P=c.shift();s?pi(e,s,()=>D(P)):D(P)}w()}catch(P){e.error(P)}}))};return n.subscribe(Re(e,b,()=>{m=!0,w()})),()=>{l?.()}}function Yt(n,e,t=1/0){return Ae(e)?Yt((i,r)=>ke((o,s)=>e(i,o,r,s))(At(n(i,r))),t):(typeof e=="number"&&(t=e),He((i,r)=>$I(i,r,n,t)))}function jr(n=1/0){return Yt(Qn,n)}function qI(){return jr(1)}function Vl(...n){return qI()(_t(n,Vr(n)))}function kd(n){return new De(e=>{At(n()).subscribe(e)})}function Oy(...n){let e=bh(n),{args:t,keys:i}=Nh(n),r=new De(o=>{let{length:s}=t;if(!s){o.complete();return}let l=new Array(s),c=s,u=s;for(let f=0;f<s;f++){let m=!1;At(t[f]).subscribe(Re(o,w=>{m||(m=!0,u--),l[f]=w},()=>c--,void 0,()=>{(!c||!m)&&(u||o.next(i?Lh(i,l):l),o.complete())}))}});return e?r.pipe(Oh(e)):r}function Fh(n=0,e,t=PI){let i=-1;return e!=null&&(yh(e)?t=e:i=e),new De(r=>{let o=HI(n)?+n-t.now():n;o<0&&(o=0);let s=0;return t.schedule(function(){r.closed||(r.next(s++),0<=i?this.schedule(void 0,i):r.complete())},o)})}function Ny(n=0,e=Gs){return n<0&&(n=0),Fh(n,n,e)}function Od(...n){let e=Vr(n),t=AI(n,1/0),i=n;return i.length?i.length===1?At(i[0]):jr(t)(_t(i,e)):Vn}function wn(n,e){return He((t,i)=>{let r=0;t.subscribe(Re(i,o=>n.call(e,o,r++)&&i.next(o)))})}function GI(n){return He((e,t)=>{let i=!1,r=null,o=null,s=!1,l=()=>{if(o?.unsubscribe(),o=null,i){i=!1;let u=r;r=null,t.next(u)}s&&t.complete()},c=()=>{o=null,s&&t.complete()};e.subscribe(Re(t,u=>{i=!0,r=u,o||At(n(u)).subscribe(o=Re(t,l,c))},()=>{s=!0,(!i||!o||o.closed)&&t.complete()}))})}function zh(n,e=Gs){return GI(()=>Fh(n,e))}function xo(n){return He((e,t)=>{let i=null,r=!1,o;i=e.subscribe(Re(t,void 0,void 0,s=>{o=At(n(s,xo(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function ZI(n,e,t,i,r){return(o,s)=>{let l=t,c=e,u=0;o.subscribe(Re(s,f=>{let m=u++;c=l?n(c,f,m):(l=!0,f),i&&s.next(c)},r&&(()=>{l&&s.next(c),s.complete()})))}}function Br(n,e){return Ae(e)?Yt(n,e,1):Yt(n,1)}function Nd(n,e=Gs){return He((t,i)=>{let r=null,o=null,s=null,l=()=>{if(r){r.unsubscribe(),r=null;let u=o;o=null,i.next(u)}};function c(){let u=s+n,f=e.now();if(f<u){r=this.schedule(void 0,u-f),i.add(r);return}l()}t.subscribe(Re(i,u=>{o=u,s=e.now(),r||(r=e.schedule(c,n),i.add(r))},()=>{l(),i.complete()},void 0,()=>{o=r=null}))})}function Jo(n){return He((e,t)=>{let i=!1;e.subscribe(Re(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function cr(n){return n<=0?()=>Vn:He((e,t)=>{let i=0;e.subscribe(Re(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function jl(n,e=Qn){return n=n??kz,He((t,i)=>{let r,o=!0;t.subscribe(Re(i,s=>{let l=e(s);(o||!n(r,l))&&(o=!1,r=l,i.next(s))}))})}function kz(n,e){return n===e}function Vh(n=Oz){return He((e,t)=>{let i=!1;e.subscribe(Re(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function Oz(){return new Eo}function Xo(n){return He((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Do(n,e){let t=arguments.length>=2;return i=>i.pipe(n?wn((r,o)=>n(r,o,i)):Qn,cr(1),t?Jo(e):Vh(()=>new Eo))}function Bl(n){return n<=0?()=>Vn:He((e,t)=>{let i=[];e.subscribe(Re(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Ly(n,e){let t=arguments.length>=2;return i=>i.pipe(n?wn((r,o)=>n(r,o,i)):Qn,Bl(1),t?Jo(e):Vh(()=>new Eo))}function Fy(n,e){return He(ZI(n,e,arguments.length>=2,!0))}function dr(...n){let e=Vr(n);return He((t,i)=>{(e?Vl(n,t,e):Vl(n,t)).subscribe(i)})}function Sn(n,e){return He((t,i)=>{let r=null,o=0,s=!1,l=()=>s&&!r&&i.complete();t.subscribe(Re(i,c=>{r?.unsubscribe();let u=0,f=o++;At(n(c,f)).subscribe(r=Re(i,m=>i.next(e?e(c,m,f,u++):m),()=>{r=null,l()}))},()=>{s=!0,l()}))})}function Kn(n){return He((e,t)=>{At(n).subscribe(Re(t,()=>t.complete(),Ad)),!t.closed&&e.subscribe(t)})}function tn(n,e,t){let i=Ae(n)||e||t?{next:n,error:e,complete:t}:n;return i?He((r,o)=>{var s;(s=i.subscribe)===null||s===void 0||s.call(i);let l=!0;r.subscribe(Re(o,c=>{var u;(u=i.next)===null||u===void 0||u.call(i,c),o.next(c)},()=>{var c;l=!1,(c=i.complete)===null||c===void 0||c.call(i),o.complete()},c=>{var u;l=!1,(u=i.error)===null||u===void 0||u.call(i,c),o.error(c)},()=>{var c,u;l&&((c=i.unsubscribe)===null||c===void 0||c.call(i)),(u=i.finalize)===null||u===void 0||u.call(i)}))}):Qn}function YI(n){let e=Be(null);try{return n()}finally{Be(e)}}var Wh="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",oe=class extends Error{code;constructor(e,t){super(ns(e,t)),this.code=e}};function Nz(n){return`NG0${Math.abs(n)}`}function ns(n,e){return`${Nz(n)}${e?": "+e:""}`}var Po=globalThis;function rt(n){for(let e in n)if(n[e]===rt)return e;throw Error("")}function JI(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Mo(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Mo).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let i=t.indexOf(`
`);return i>=0?t.slice(0,i):t}function $h(n,e){return n?e?`${n} ${e}`:n:e||""}var Lz=rt({__forward_ref__:rt});function Rt(n){return n.__forward_ref__=Rt,n.toString=function(){return Mo(this())},n}function Tn(n){return Qy(n)?n():n}function Qy(n){return typeof n=="function"&&n.hasOwnProperty(Lz)&&n.__forward_ref__===Rt}function XI(n,e){n==null&&Ky(e,n,null,"!=")}function Ky(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(i==null?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}function Q(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function nn(n){return{providers:n.providers||[],imports:n.imports||[]}}function jd(n){return Fz(n,qh)}function Jy(n){return jd(n)!==null}function Fz(n,e){return n.hasOwnProperty(e)&&n[e]||null}function zz(n){let e=n?.[qh]??null;return e||null}function Vy(n){return n&&n.hasOwnProperty(Bh)?n[Bh]:null}var qh=rt({\u0275prov:rt}),Bh=rt({\u0275inj:rt}),se=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Q({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Xy(n){return n&&!!n.\u0275providers}var eb=rt({\u0275cmp:rt}),tb=rt({\u0275dir:rt}),nb=rt({\u0275pipe:rt}),ib=rt({\u0275mod:rt}),zd=rt({\u0275fac:rt}),ea=rt({__NG_ELEMENT_ID__:rt}),QI=rt({__NG_ENV_ID__:rt});function Ur(n){return typeof n=="string"?n:n==null?"":String(n)}function Uh(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Ur(n)}var rb=rt({ngErrorCode:rt}),eM=rt({ngErrorMessage:rt}),Fd=rt({ngTokenPath:rt});function ob(n,e){return tM("",-200,e)}function Gh(n,e){throw new oe(-201,!1)}function Vz(n,e){n[Fd]??=[];let t=n[Fd],i;typeof e=="object"&&"multi"in e&&e?.multi===!0?(XI(e.provide,"Token with multi: true should have a provide property"),i=Uh(e.provide)):i=Uh(e),t[0]!==i&&n[Fd].unshift(i)}function jz(n,e){let t=n[Fd],i=n[rb],r=n[eM]||n.message;return n.message=Uz(r,i,t,e),n}function tM(n,e,t){let i=new oe(e,n);return i[rb]=e,i[eM]=n,t&&(i[Fd]=t),i}function Bz(n){return n[rb]}function Uz(n,e,t=[],i=null){let r="";t&&t.length>1&&(r=` Path: ${t.join(" -> ")}.`);let o=i?` Source: ${i}.`:"";return ns(e,`${n}${o}${r}`)}var jy;function nM(){return jy}function Jn(n){let e=jy;return jy=n,e}function sb(n,e,t){let i=jd(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(t&8)return null;if(e!==void 0)return e;Gh(n,"Injector")}var Hz={},Qs=Hz,By="__NG_DI_FLAG__",Uy=class{injector;constructor(e){this.injector=e}retrieve(e,t){let i=Ks(t)||0;try{return this.injector.get(e,i&8?null:Qs,i)}catch(r){if(Cl(r))return r;throw r}}};function Wz(n,e=0){let t=Qp();if(t===void 0)throw new oe(-203,!1);if(t===null)return sb(n,void 0,e);{let i=$z(e),r=t.retrieve(n,i);if(Cl(r)){if(i.optional)return null;throw r}return r}}function te(n,e=0){return(nM()||Wz)(Tn(n),e)}function V(n,e){return te(n,Ks(e))}function Ks(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function $z(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Hy(n){let e=[];for(let t=0;t<n.length;t++){let i=Tn(n[t]);if(Array.isArray(i)){if(i.length===0)throw new oe(900,!1);let r,o=0;for(let s=0;s<i.length;s++){let l=i[s],c=qz(l);typeof c=="number"?c===-1?r=l.token:o|=c:r=l}e.push(te(r,o))}else e.push(te(i))}return e}function ab(n,e){return n[By]=e,n.prototype[By]=e,n}function qz(n){return n[By]}function es(n,e){let t=n.hasOwnProperty(zd);return t?n[zd]:null}function iM(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function rM(n){return n.flat(Number.POSITIVE_INFINITY)}function Zh(n,e){n.forEach(t=>Array.isArray(t)?Zh(t,e):e(t))}function lb(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Bd(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function oM(n,e){let t=[];for(let i=0;i<n;i++)t.push(e);return t}function sM(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(r===1)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;){let o=r-2;n[r]=n[o],r--}n[e]=t,n[e+1]=i}}function Yh(n,e,t){let i=Hl(n,e);return i>=0?n[i|1]=t:(i=~i,sM(n,i,e,t)),i}function Qh(n,e){let t=Hl(n,e);if(t>=0)return n[t|1]}function Hl(n,e){return Gz(n,e,1)}function Gz(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){let o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}var is={},Xn=[],Ao=new se(""),cb=new se("",-1),db=new se(""),Vd=class{get(e,t=Qs){if(t===Qs){let r=tM("",-201);throw r.name="\u0275NotFound",r}return t}};function ub(n){return n[ib]||null}function Hr(n){return n[eb]||null}function fb(n){return n[tb]||null}function aM(n){return n[nb]||null}function Wr(n){return{\u0275providers:n}}function lM(n){return Wr([{provide:Ao,multi:!0,useValue:n}])}function cM(...n){return{\u0275providers:pb(!0,n),\u0275fromNgModule:!0}}function pb(n,...e){let t=[],i=new Set,r,o=s=>{t.push(s)};return Zh(e,s=>{let l=s;Hh(l,o,[],i)&&(r||=[],r.push(l))}),r!==void 0&&dM(r,o),t}function dM(n,e){for(let t=0;t<n.length;t++){let{ngModule:i,providers:r}=n[t];hb(r,o=>{e(o,i)})}}function Hh(n,e,t,i){if(n=Tn(n),!n)return!1;let r=null,o=Vy(n),s=!o&&Hr(n);if(!o&&!s){let c=n.ngModule;if(o=Vy(c),o)r=c;else return!1}else{if(s&&!s.standalone)return!1;r=n}let l=i.has(r);if(s){if(l)return!1;if(i.add(r),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let u of c)Hh(u,e,t,i)}}else if(o){if(o.imports!=null&&!l){i.add(r);let u;try{Zh(o.imports,f=>{Hh(f,e,t,i)&&(u||=[],u.push(f))})}finally{}u!==void 0&&dM(u,e)}if(!l){let u=es(r)||(()=>new r);e({provide:r,useFactory:u,deps:Xn},r),e({provide:db,useValue:r,multi:!0},r),e({provide:Ao,useValue:()=>te(r),multi:!0},r)}let c=o.providers;if(c!=null&&!l){let u=n;hb(c,f=>{e(f,u)})}}else return!1;return r!==n&&n.providers!==void 0}function hb(n,e){for(let t of n)Xy(t)&&(t=t.\u0275providers),Array.isArray(t)?hb(t,e):e(t)}var Zz=rt({provide:String,useValue:rt});function uM(n){return n!==null&&typeof n=="object"&&Zz in n}function Yz(n){return!!(n&&n.useExisting)}function Qz(n){return!!(n&&n.useFactory)}function Js(n){return typeof n=="function"}function fM(n){return!!n.useClass}var Ud=new se(""),jh={},KI={},zy;function Wl(){return zy===void 0&&(zy=new Vd),zy}var zt=class{},Xs=class extends zt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,$y(e,s=>this.processProvider(s)),this.records.set(cb,Ul(void 0,this)),r.has("environment")&&this.records.set(zt,Ul(void 0,this));let o=this.records.get(Ud);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(db,Xn,{self:!0}))}retrieve(e,t){let i=Ks(t)||0;try{return this.get(e,Qs,i)}catch(r){if(Cl(r))return r;throw r}}destroy(){Ld(this),this._destroyed=!0;let e=Be(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Be(e)}}onDestroy(e){return Ld(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Ld(this);let t=zr(this),i=Jn(void 0),r;try{return e()}finally{zr(t),Jn(i)}}get(e,t=Qs,i){if(Ld(this),e.hasOwnProperty(QI))return e[QI](this);let r=Ks(i),o,s=zr(this),l=Jn(void 0);try{if(!(r&4)){let u=this.records.get(e);if(u===void 0){let f=tV(e)&&jd(e);f&&this.injectableDefInScope(f)?u=Ul(Wy(e),jh):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u,r)}let c=r&2?Wl():this.parent;return t=r&8&&t===Qs?null:t,c.get(e,t)}catch(c){let u=Bz(c);throw u===-200||u===-201?new oe(u,null):c}finally{Jn(l),zr(s)}}resolveInjectorInitializers(){let e=Be(null),t=zr(this),i=Jn(void 0),r;try{let o=this.get(Ao,Xn,{self:!0});for(let s of o)s()}finally{zr(t),Jn(i),Be(e)}}toString(){let e=[],t=this.records;for(let i of t.keys())e.push(Mo(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Tn(e);let t=Js(e)?e:Tn(e&&e.provide),i=Jz(e);if(!Js(e)&&e.multi===!0){let r=this.records.get(t);r||(r=Ul(void 0,jh,!0),r.factory=()=>Hy(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t,i){let r=Be(null);try{if(t.value===KI)throw ob(Mo(e));return t.value===jh&&(t.value=KI,t.value=t.factory(void 0,i)),typeof t.value=="object"&&t.value&&eV(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Be(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Tn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Wy(n){let e=jd(n),t=e!==null?e.factory:es(n);if(t!==null)return t;if(n instanceof se)throw new oe(204,!1);if(n instanceof Function)return Kz(n);throw new oe(204,!1)}function Kz(n){if(n.length>0)throw new oe(204,!1);let t=zz(n);return t!==null?()=>t.factory(n):()=>new n}function Jz(n){if(uM(n))return Ul(void 0,n.useValue);{let e=gb(n);return Ul(e,jh)}}function gb(n,e,t){let i;if(Js(n)){let r=Tn(n);return es(r)||Wy(r)}else if(uM(n))i=()=>Tn(n.useValue);else if(Qz(n))i=()=>n.useFactory(...Hy(n.deps||[]));else if(Yz(n))i=(r,o)=>te(Tn(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=Tn(n&&(n.useClass||n.provide));if(Xz(n))i=()=>new r(...Hy(n.deps));else return es(r)||Wy(r)}return i}function Ld(n){if(n.destroyed)throw new oe(205,!1)}function Ul(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Xz(n){return!!n.deps}function eV(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function tV(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function $y(n,e){for(let t of n)Array.isArray(t)?$y(t,e):t&&Xy(t)?$y(t.\u0275providers,e):e(t)}function En(n,e){let t;n instanceof Xs?(Ld(n),t=n):t=new Uy(n);let i,r=zr(t),o=Jn(void 0);try{return e()}finally{zr(r),Jn(o)}}function pM(){return nM()!==void 0||Qp()!=null}var fr=0,we=1,Ce=2,Cn=3,ji=4,ei=5,$l=6,ql=7,jn=8,ta=9,$r=10,Mt=11,Gl=12,mb=13,na=14,hi=15,rs=16,ia=17,qr=18,Hd=19,vb=20,Io=21,Kh=22,Wd=23,Di=24,ra=25,Qt=26,hM=1;var os=7,$d=8,oa=9,ti=10;function Gr(n){return Array.isArray(n)&&typeof n[hM]=="object"}function pr(n){return Array.isArray(n)&&n[hM]===!0}function _b(n){return(n.flags&4)!==0}function ss(n){return n.componentOffset>-1}function Zl(n){return(n.flags&1)===1}function Zr(n){return!!n.template}function Yl(n){return(n[Ce]&512)!==0}function sa(n){return(n[Ce]&256)===256}var yb="svg",gM="math";function Bi(n){for(;Array.isArray(n);)n=n[fr];return n}function bb(n,e){return Bi(e[n])}function hr(n,e){return Bi(e[n.index])}function Jh(n,e){return n.data[e]}function wb(n,e){return n[e]}function Sb(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}function Ui(n,e){let t=e[n];return Gr(t)?t:t[fr]}function mM(n){return(n[Ce]&4)===4}function Xh(n){return(n[Ce]&128)===128}function vM(n){return pr(n[Cn])}function as(n,e){return e==null?null:n[e]}function Cb(n){n[ia]=0}function Eb(n){n[Ce]&1024||(n[Ce]|=1024,Xh(n)&&Ql(n))}function _M(n,e){for(;n>0;)e=e[na],n--;return e}function qd(n){return!!(n[Ce]&9216||n[Di]?.dirty)}function eg(n){n[$r].changeDetectionScheduler?.notify(8),n[Ce]&64&&(n[Ce]|=1024),qd(n)&&Ql(n)}function Ql(n){n[$r].changeDetectionScheduler?.notify(0);let e=ts(n);for(;e!==null&&!(e[Ce]&8192||(e[Ce]|=8192,!Xh(e)));)e=ts(e)}function xb(n,e){if(sa(n))throw new oe(911,!1);n[Io]===null&&(n[Io]=[]),n[Io].push(e)}function yM(n,e){if(n[Io]===null)return;let t=n[Io].indexOf(e);t!==-1&&n[Io].splice(t,1)}function ts(n){let e=n[Cn];return pr(e)?e[Cn]:e}function Db(n){return n[ql]??=[]}function Ib(n){return n.cleanup??=[]}function bM(n,e,t,i){let r=Db(e);r.push(t),n.firstCreatePass&&Ib(n).push(i,r.length-1)}var ze={lFrame:AM(null),bindingsEnabled:!0,skipHydrationRootTNode:null},Gd=function(n){return n[n.Off=0]="Off",n[n.Exhaustive=1]="Exhaustive",n[n.OnlyDirtyViews=2]="OnlyDirtyViews",n}(Gd||{}),nV=0,qy=!1;function wM(){return ze.lFrame.elementDepthCount}function SM(){ze.lFrame.elementDepthCount++}function Mb(){ze.lFrame.elementDepthCount--}function tg(){return ze.bindingsEnabled}function Tb(){return ze.skipHydrationRootTNode!==null}function Pb(n){return ze.skipHydrationRootTNode===n}function Ab(){ze.skipHydrationRootTNode=null}function Ie(){return ze.lFrame.lView}function rn(){return ze.lFrame.tView}function A(n){return ze.lFrame.contextLView=n,n[jn]}function R(n){return ze.lFrame.contextLView=null,n}function fn(){let n=Rb();for(;n!==null&&n.type===64;)n=n.parent;return n}function Rb(){return ze.lFrame.currentTNode}function CM(){let n=ze.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Kl(n,e){let t=ze.lFrame;t.currentTNode=n,t.isParent=e}function kb(){return ze.lFrame.isParent}function Ob(){ze.lFrame.isParent=!1}function EM(){return ze.lFrame.contextLView}function Nb(n){Ky("Must never be called in production mode"),nV=n}function Lb(){return qy}function Fb(n){let e=qy;return qy=n,e}function ng(){let n=ze.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function zb(){return ze.lFrame.bindingIndex}function xM(n){return ze.lFrame.bindingIndex=n}function Zd(){return ze.lFrame.bindingIndex++}function Yd(n){let e=ze.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function DM(){return ze.lFrame.inI18n}function IM(n,e){let t=ze.lFrame;t.bindingIndex=t.bindingRootIndex=n,ig(e)}function MM(){return ze.lFrame.currentDirectiveIndex}function ig(n){ze.lFrame.currentDirectiveIndex=n}function TM(n){let e=ze.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Vb(){return ze.lFrame.currentQueryIndex}function rg(n){ze.lFrame.currentQueryIndex=n}function iV(n){let e=n[we];return e.type===2?e.declTNode:e.type===1?n[ei]:null}function jb(n,e,t){if(t&4){let r=e,o=n;for(;r=r.parent,r===null&&!(t&1);)if(r=iV(o),r===null||(o=o[na],r.type&10))break;if(r===null)return!1;e=r,n=o}let i=ze.lFrame=PM();return i.currentTNode=e,i.lView=n,!0}function og(n){let e=PM(),t=n[we];ze.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function PM(){let n=ze.lFrame,e=n===null?null:n.child;return e===null?AM(n):e}function AM(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function RM(){let n=ze.lFrame;return ze.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Bb=RM;function sg(){let n=RM();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function kM(n){return(ze.lFrame.contextLView=_M(n,ze.lFrame.contextLView))[jn]}function Yr(){return ze.lFrame.selectedIndex}function ls(n){ze.lFrame.selectedIndex=n}function ag(){let n=ze.lFrame;return Jh(n.tView,n.selectedIndex)}function xn(){ze.lFrame.currentNamespace=yb}function Bn(){rV()}function rV(){ze.lFrame.currentNamespace=null}function OM(){return ze.lFrame.currentNamespace}var NM=!0;function lg(){return NM}function Qd(n){NM=n}function Gy(n,e=null,t=null,i){let r=Ub(n,e,t,i);return r.resolveInjectorInitializers(),r}function Ub(n,e=null,t=null,i,r=new Set){let o=[t||Xn,cM(n)];return i=i||(typeof n=="object"?void 0:Mo(n)),new Xs(o,e||Wl(),i||null,r)}var un=class n{static THROW_IF_NOT_FOUND=Qs;static NULL=new Vd;static create(e,t){if(Array.isArray(e))return Gy({name:""},t,e,"");{let i=e.name??"";return Gy({name:i},e.parent,e.providers,i)}}static \u0275prov=Q({token:n,providedIn:"any",factory:()=>te(cb)});static __NG_ELEMENT_ID__=-1},ot=new se(""),Ii=(()=>{class n{static __NG_ELEMENT_ID__=oV;static __NG_ENV_ID__=t=>t}return n})(),Zy=class extends Ii{_lView;constructor(e){super(),this._lView=e}get destroyed(){return sa(this._lView)}onDestroy(e){let t=this._lView;return xb(t,e),()=>yM(t,e)}};function oV(){return new Zy(Ie())}var ur=class{_console=console;handleError(e){this._console.error("ERROR",e)}},ni=new se("",{providedIn:"root",factory:()=>{let n=V(zt),e;return t=>{n.destroyed&&!e?setTimeout(()=>{throw t}):(e??=n.get(ur),e.handleError(t))}}}),LM={provide:Ao,useValue:()=>void V(ur),multi:!0},sV=new se("",{providedIn:"root",factory:()=>{let n=V(ot).defaultView;if(!n)return;let e=V(ni),t=o=>{e(o.reason),o.preventDefault()},i=o=>{o.error?e(o.error):e(new Error(o.message,{cause:o})),o.preventDefault()},r=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",i)};typeof Zone<"u"?Zone.root.run(r):r(),V(Ii).onDestroy(()=>{n.removeEventListener("error",i),n.removeEventListener("unhandledrejection",t)})}});function Hb(){return Wr([lM(()=>void V(sV))])}function Wb(n){return typeof n=="function"&&n[zn]!==void 0}function Un(n,e){let[t,i,r]=wy(n,e?.equal),o=t,s=o[zn];return o.set=i,o.update=r,o.asReadonly=FM.bind(o),o}function FM(){let n=this[zn];if(n.readonlyFn===void 0){let e=()=>this();e[zn]=n,n.readonlyFn=e}return n.readonlyFn}function $b(n){return Wb(n)&&typeof n.set=="function"}var To=class{},Kd=new se("",{providedIn:"root",factory:()=>!1});var qb=new se(""),Gb=new se("");var cg=(()=>{class n{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=aV}return n})();function aV(){return new cg(Ie(),fn())}var Qr=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Zt(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new De(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=Q({token:n,providedIn:"root",factory:()=>new n})}return n})(),Jd=(()=>{class n{internalPendingTasks=V(Qr);scheduler=V(To);errorHandler=V(ni);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let i=this.add();t().catch(this.errorHandler).finally(i)}static \u0275prov=Q({token:n,providedIn:"root",factory:()=>new n})}return n})();function Xd(...n){}var Zb=(()=>{class n{static \u0275prov=Q({token:n,providedIn:"root",factory:()=>new Yy})}return n})(),Yy=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,i=this.queues.get(t);i.has(e)&&(i.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let i=this.queues.get(t);i.has(e)||i.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,i]of this.queues)t===null?e||=this.flushQueue(i):e||=t.run(()=>this.flushQueue(i));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let i of e)i.dirty&&(this.dirtyEffectCount--,t=!0,i.run());return t}};function ic(n){return{toString:n}.toString()}var dg="__parameters__";function pV(n){return function(...t){if(n){let i=n(...t);for(let r in i)this[r]=i[r]}}}function uT(n,e,t){return ic(()=>{let i=pV(e);function r(...o){if(this instanceof r)return i.apply(this,o),this;let s=new r(...o);return l.annotation=s,l;function l(c,u,f){let m=c.hasOwnProperty(dg)?c[dg]:Object.defineProperty(c,dg,{value:[]})[dg];for(;m.length<=f;)m.push(null);return(m[f]=m[f]||[]).push(s),c}}return r.prototype.ngMetadataName=n,r.annotationCls=r,r})}var Lg=ab(uT("Optional"),8);var kw=ab(uT("SkipSelf"),4);function hV(n){return typeof n=="function"}var vg=class{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}};function fT(n,e,t,i){e!==null?e.applyValueToInputSignal(e,i):n[t]=i}var Dn=(()=>{let n=()=>pT;return n.ngInherit=!0,n})();function pT(n){return n.type.prototype.ngOnChanges&&(n.setInput=mV),gV}function gV(){let n=gT(this),e=n?.current;if(e){let t=n.previous;if(t===is)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function mV(n,e,t,i,r){let o=this.declaredInputs[i],s=gT(n)||vV(n,{previous:is,current:null}),l=s.current||(s.current={}),c=s.previous,u=c[o];l[o]=new vg(u&&u.currentValue,t,c===is),fT(n,e,r,t)}var hT="__ngSimpleChanges__";function gT(n){return n[hT]||null}function vV(n,e){return n[hT]=e}var zM=[];var dt=function(n,e=null,t){for(let i=0;i<zM.length;i++){let r=zM[i];r(n,e,t)}};function _V(n,e,t){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){let s=pT(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}r&&(t.preOrderHooks??=[]).push(0-n,r),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function mT(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:l,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:f}=o;s&&(n.contentHooks??=[]).push(-t,s),l&&((n.contentHooks??=[]).push(t,l),(n.contentCheckHooks??=[]).push(t,l)),c&&(n.viewHooks??=[]).push(-t,c),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),f!=null&&(n.destroyHooks??=[]).push(t,f)}}function pg(n,e,t){vT(n,e,3,t)}function hg(n,e,t,i){(n[Ce]&3)===t&&vT(n,e,t,i)}function Yb(n,e){let t=n[Ce];(t&3)===e&&(t&=16383,t+=1,n[Ce]=t)}function vT(n,e,t,i){let r=i!==void 0?n[ia]&65535:0,o=i??-1,s=e.length-1,l=0;for(let c=r;c<s;c++)if(typeof e[c+1]=="number"){if(l=e[c],i!=null&&l>=i)break}else e[c]<0&&(n[ia]+=65536),(l<o||o==-1)&&(yV(n,t,e,c),n[ia]=(n[ia]&4294901760)+c+2),c++}function VM(n,e){dt(4,n,e);let t=Be(null);try{e.call(n)}finally{Be(t),dt(5,n,e)}}function yV(n,e,t,i){let r=t[i]<0,o=t[i+1],s=r?-t[i]:t[i],l=n[s];r?n[Ce]>>14<n[ia]>>16&&(n[Ce]&3)===e&&(n[Ce]+=16384,VM(l,o)):VM(l,o)}var Xl=-1,ca=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i,r){this.factory=e,this.name=r,this.canSeeViewProviders=t,this.injectImpl=i}};function bV(n){return(n.flags&8)!==0}function wV(n){return(n.flags&16)!==0}function SV(n,e,t){let i=0;for(;i<t.length;){let r=t[i];if(typeof r=="number"){if(r!==0)break;i++;let o=t[i++],s=t[i++],l=t[i++];n.setAttribute(e,s,l,o)}else{let o=r,s=t[++i];CV(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),i++}}return i}function _T(n){return n===3||n===4||n===6}function CV(n){return n.charCodeAt(0)===64}function ec(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?t=r:t===0||(t===-1||t===2?jM(n,t,r,null,e[++i]):jM(n,t,r,null,null))}}return n}function jM(n,e,t,i,r){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let l=n[o++];if(typeof l=="number"){if(l===e){s=-1;break}else if(l>e){s=o-1;break}}}for(;o<n.length;){let l=n[o];if(typeof l=="number")break;if(l===t){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r)}function yT(n){return n!==Xl}function _g(n){return n&32767}function EV(n){return n>>16}function yg(n,e){let t=EV(n),i=e;for(;t>0;)i=i[na],t--;return i}var sw=!0;function bg(n){let e=sw;return sw=n,e}var xV=256,bT=xV-1,wT=5,DV=0,Kr={};function IV(n,e,t){let i;typeof t=="string"?i=t.charCodeAt(0)||0:t.hasOwnProperty(ea)&&(i=t[ea]),i==null&&(i=t[ea]=DV++);let r=i&bT,o=1<<r;e.data[n+(r>>wT)]|=o}function wg(n,e){let t=ST(n,e);if(t!==-1)return t;let i=e[we];i.firstCreatePass&&(n.injectorIndex=e.length,Qb(i.data,n),Qb(e,null),Qb(i.blueprint,null));let r=Ow(n,e),o=n.injectorIndex;if(yT(r)){let s=_g(r),l=yg(r,e),c=l[we].data;for(let u=0;u<8;u++)e[o+u]=l[s+u]|c[s+u]}return e[o+8]=r,o}function Qb(n,e){n.push(0,0,0,0,0,0,0,0,e)}function ST(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Ow(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;r!==null;){if(i=IT(r),i===null)return Xl;if(t++,r=r[na],i.injectorIndex!==-1)return i.injectorIndex|t<<16}return Xl}function aw(n,e,t){IV(n,e,t)}function MV(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let i=t.length,r=0;for(;r<i;){let o=t[r];if(_T(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function CT(n,e,t){if(t&8||n!==void 0)return n;Gh(e,"NodeInjector")}function ET(n,e,t,i){if(t&8&&i===void 0&&(i=null),(t&3)===0){let r=n[ta],o=Jn(void 0);try{return r?r.get(e,i,t&8):sb(e,i,t&8)}finally{Jn(o)}}return CT(i,e,t)}function xT(n,e,t,i=0,r){if(n!==null){if(e[Ce]&2048&&!(i&2)){let s=RV(n,e,t,i,Kr);if(s!==Kr)return s}let o=DT(n,e,t,i,Kr);if(o!==Kr)return o}return ET(e,t,i,r)}function DT(n,e,t,i,r){let o=PV(t);if(typeof o=="function"){if(!jb(e,n,i))return i&1?CT(r,t,i):ET(e,t,i,r);try{let s;if(s=o(i),s==null&&!(i&8))Gh(t);else return s}finally{Bb()}}else if(typeof o=="number"){let s=null,l=ST(n,e),c=Xl,u=i&1?e[hi][ei]:null;for((l===-1||i&4)&&(c=l===-1?Ow(n,e):e[l+8],c===Xl||!UM(i,!1)?l=-1:(s=e[we],l=_g(c),e=yg(c,e)));l!==-1;){let f=e[we];if(BM(o,l,f.data)){let m=TV(l,e,t,s,i,u);if(m!==Kr)return m}c=e[l+8],c!==Xl&&UM(i,e[we].data[l+8]===u)&&BM(o,l,e)?(s=f,l=_g(c),e=yg(c,e)):l=-1}}return r}function TV(n,e,t,i,r,o){let s=e[we],l=s.data[n+8],c=i==null?ss(l)&&sw:i!=s&&(l.type&3)!==0,u=r&1&&o===l,f=gg(l,s,t,c,u);return f!==null?nu(e,s,f,l,r):Kr}function gg(n,e,t,i,r){let o=n.providerIndexes,s=e.data,l=o&1048575,c=n.directiveStart,u=n.directiveEnd,f=o>>20,m=i?l:l+f,w=r?l+f:u;for(let b=m;b<w;b++){let D=s[b];if(b<c&&t===D||b>=c&&D.type===t)return b}if(r){let b=s[c];if(b&&Zr(b)&&b.type===t)return c}return null}function nu(n,e,t,i,r){let o=n[t],s=e.data;if(o instanceof ca){let l=o;if(l.resolving){let b=Uh(s[t]);throw ob(b)}let c=bg(l.canSeeViewProviders);l.resolving=!0;let u=s[t].type||s[t],f,m=l.injectImpl?Jn(l.injectImpl):null,w=jb(n,i,0);try{o=n[t]=l.factory(void 0,r,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&_V(t,s[t],e)}finally{m!==null&&Jn(m),bg(c),l.resolving=!1,Bb()}}return o}function PV(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(ea)?n[ea]:void 0;return typeof e=="number"?e>=0?e&bT:AV:e}function BM(n,e,t){let i=1<<n;return!!(t[e+(n>>wT)]&i)}function UM(n,e){return!(n&2)&&!(n&1&&e)}var la=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return xT(this._tNode,this._lView,e,Ks(i),t)}};function AV(){return new la(fn(),Ie())}function In(n){return ic(()=>{let e=n.prototype.constructor,t=e[zd]||lw(e),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[zd]||lw(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function lw(n){return Qy(n)?()=>{let e=lw(Tn(n));return e&&e()}:es(n)}function RV(n,e,t,i,r){let o=n,s=e;for(;o!==null&&s!==null&&s[Ce]&2048&&!Yl(s);){let l=DT(o,s,t,i|2,Kr);if(l!==Kr)return l;let c=o.parent;if(!c){let u=s[vb];if(u){let f=u.get(t,Kr,i);if(f!==Kr)return f}c=IT(s),s=s[na]}o=c}return r}function IT(n){let e=n[we],t=e.type;return t===2?e.declTNode:t===1?n[ei]:null}function su(n){return MV(fn(),n)}function kV(){return rc(fn(),Ie())}function rc(n,e){return new ft(hr(n,e))}var ft=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=kV}return n})();function OV(n){return n instanceof ft?n.nativeElement:n}function NV(){return this._results[Symbol.iterator]()}var Sg=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new _e}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let i=rM(e);(this._changesDetected=!iM(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=NV};function MT(n){return(n.flags&128)===128}var Nw=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Nw||{}),TT=new Map,LV=0;function FV(){return LV++}function zV(n){TT.set(n[Hd],n)}function cw(n){TT.delete(n[Hd])}var HM="__ngContext__";function tc(n,e){Gr(e)?(n[HM]=e[Hd],zV(e)):n[HM]=e}function PT(n){return RT(n[Gl])}function AT(n){return RT(n[ji])}function RT(n){for(;n!==null&&!pr(n);)n=n[ji];return n}var dw;function Lw(n){dw=n}function kT(){if(dw!==void 0)return dw;if(typeof document<"u")return document;throw new oe(210,!1)}var oc=new se("",{providedIn:"root",factory:()=>VV}),VV="ng",Fg=new se(""),us=new se("",{providedIn:"platform",factory:()=>"unknown"});var zg=new se("",{providedIn:"root",factory:()=>kT().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var jV="h",BV="b";var OT=!1,NT=new se("",{providedIn:"root",factory:()=>OT});var UV=(n,e,t,i)=>{};function HV(n,e,t,i){UV(n,e,t,i)}function Vg(n){return(n.flags&32)===32}var WV=()=>null;function LT(n,e,t=!1){return WV(n,e,t)}function FT(n,e){let t=n.contentQueries;if(t!==null){let i=Be(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s!==-1){let l=n.data[s];rg(o),l.contentQueries(2,e[s],s)}}}finally{Be(i)}}}function uw(n,e,t){rg(0);let i=Be(null);try{e(n,t)}finally{Be(i)}}function Fw(n,e,t){if(_b(e)){let i=Be(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let s=r;s<o;s++){let l=n.data[s];if(l.contentQueries){let c=t[s];l.contentQueries(1,c,s)}}}finally{Be(i)}}}var Ro=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Ro||{});var ug;function $V(){if(ug===void 0&&(ug=null,Po.trustedTypes))try{ug=Po.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return ug}function WM(n){return $V()?.createScriptURL(n)||n}var Cg=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Wh})`}};function sc(n){return n instanceof Cg?n.changingThisBreaksApplicationSecurity:n}function zw(n,e){let t=zT(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Wh})`)}return t===e}function zT(n){return n instanceof Cg&&n.getTypeName()||null}var qV=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function VT(n){return n=String(n),n.match(qV)?n:"unsafe:"+n}var jg=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(jg||{});function kt(n){let e=BT();return e?e.sanitize(jg.URL,n)||"":zw(n,"URL")?sc(n):VT(Ur(n))}function jT(n){let e=BT();if(e)return WM(e.sanitize(jg.RESOURCE_URL,n)||"");if(zw(n,"ResourceURL"))return WM(sc(n));throw new oe(904,!1)}function GV(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?jT:kt}function Vw(n,e,t){return GV(e,t)(n)}function BT(){let n=Ie();return n&&n[$r].sanitizer}var ZV=/^>|^->|<!--|-->|--!>|<!-$/g,YV=/(<|>)/g,QV="\u200B$1\u200B";function KV(n){return n.replace(ZV,e=>e.replace(YV,QV))}function jw(n){return n.ownerDocument}function UT(n){return n instanceof Function?n():n}function JV(n,e,t){let i=n.length;for(;;){let r=n.indexOf(e,t);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}var HT="ng-template";function XV(n,e,t,i){let r=0;if(i){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&JV(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(Bw(n))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Bw(n){return n.type===4&&n.value!==HT}function ej(n,e,t){let i=n.type===4&&!t?HT:n.value;return e===i}function tj(n,e,t){let i=4,r=n.attrs,o=r!==null?rj(r):0,s=!1;for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="number"){if(!s&&!gr(i)&&!gr(c))return!1;if(s&&gr(c))continue;s=!1,i=c|i&1;continue}if(!s)if(i&4){if(i=2|i&1,c!==""&&!ej(n,c,t)||c===""&&e.length===1){if(gr(i))return!1;s=!0}}else if(i&8){if(r===null||!XV(n,r,c,t)){if(gr(i))return!1;s=!0}}else{let u=e[++l],f=nj(c,r,Bw(n),t);if(f===-1){if(gr(i))return!1;s=!0;continue}if(u!==""){let m;if(f>o?m="":m=r[f+1].toLowerCase(),i&2&&u!==m){if(gr(i))return!1;s=!0}}}}return gr(i)||s}function gr(n){return(n&1)===0}function nj(n,e,t,i){if(e===null)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){let s=e[r];if(s===n)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let l=e[++r];for(;typeof l=="string";)l=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return oj(e,n)}function WT(n,e,t=!1){for(let i=0;i<e.length;i++)if(tj(n,e[i],t))return!0;return!1}function ij(n){let e=n.attrs;if(e!=null){let t=e.indexOf(5);if((t&1)===0)return e[t+1]}return null}function rj(n){for(let e=0;e<n.length;e++){let t=n[e];if(_T(t))return e}return n.length}function oj(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let i=n[t];if(typeof i=="number")return-1;if(i===e)return t;t++}return-1}function sj(n,e){e:for(let t=0;t<e.length;t++){let i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function $M(n,e){return n?":not("+e.trim()+")":e}function aj(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(i&2){let l=n[++t];r+="["+s+(l.length>0?'="'+l+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!gr(s)&&(e+=$M(o,r),r=""),i=s,o=o||!gr(i);t++}return r!==""&&(e+=$M(o,r)),e}function lj(n){return n.map(aj).join(",")}function cj(n){let e=[],t=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&e.push(o,n[++i]):r===8&&t.push(o);else{if(!gr(r))break;r=o}i++}return t.length&&e.push(1,...t),e}var Hn={};function dj(n,e){return n.createText(e)}function uj(n,e,t){n.setValue(e,t)}function fj(n,e){return n.createComment(KV(e))}function $T(n,e,t){return n.createElement(e,t)}function Eg(n,e,t,i,r){n.insertBefore(e,t,i,r)}function qT(n,e,t){n.appendChild(e,t)}function qM(n,e,t,i,r){i!==null?Eg(n,e,t,i,r):qT(n,e,t)}function pj(n,e,t){n.removeChild(null,e,t)}function hj(n,e,t){n.setAttribute(e,"style",t)}function gj(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function GT(n,e,t){let{mergedAttrs:i,classes:r,styles:o}=t;i!==null&&SV(n,e,i),r!==null&&gj(n,e,r),o!==null&&hj(n,e,o)}function Uw(n,e,t,i,r,o,s,l,c,u,f){let m=Qt+i,w=m+r,b=mj(m,w),D=typeof u=="function"?u():u;return b[we]={type:n,blueprint:b,template:t,queries:null,viewQuery:l,declTNode:e,data:b.slice().fill(null,m),bindingStartIndex:m,expandoStartIndex:w,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:D,incompleteFirstPass:!1,ssrId:f}}function mj(n,e){let t=[];for(let i=0;i<e;i++)t.push(i<n?null:Hn);return t}function vj(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Uw(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Hw(n,e,t,i,r,o,s,l,c,u,f){let m=e.blueprint.slice();return m[fr]=r,m[Ce]=i|4|128|8|64|1024,(u!==null||n&&n[Ce]&2048)&&(m[Ce]|=2048),Cb(m),m[Cn]=m[na]=n,m[jn]=t,m[$r]=s||n&&n[$r],m[Mt]=l||n&&n[Mt],m[ta]=c||n&&n[ta]||null,m[ei]=o,m[Hd]=FV(),m[$l]=f,m[vb]=u,m[hi]=e.type==2?n[hi]:m,m}function _j(n,e,t){let i=hr(e,n),r=vj(t),o=n[$r].rendererFactory,s=Ww(n,Hw(n,r,null,ZT(t),i,e,null,o.createRenderer(i,t),null,null,null));return n[e.index]=s}function ZT(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function YT(n,e,t,i){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function Ww(n,e){return n[Gl]?n[mb][ji]=e:n[Gl]=e,n[mb]=e,e}function _(n=1){QT(rn(),Ie(),Yr()+n,!1)}function QT(n,e,t,i){if(!i)if((e[Ce]&3)===3){let o=n.preOrderCheckHooks;o!==null&&pg(e,o,t)}else{let o=n.preOrderHooks;o!==null&&hg(e,o,0,t)}ls(t)}var Bg=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Bg||{});function fw(n,e,t,i){let r=Be(null);try{let[o,s,l]=n.inputs[t],c=null;(s&Bg.SignalBased)!==0&&(c=e[o][zn]),c!==null&&c.transformFn!==void 0?i=c.transformFn(i):l!==null&&(i=l.call(e,i)),n.setInput!==null?n.setInput(e,c,i,t,o):fT(e,c,o,i)}finally{Be(r)}}var vr=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(vr||{}),yj;function $w(n,e){return yj(n,e)}function Jl(n,e,t,i,r){if(i!=null){let o,s=!1;pr(i)?o=i:Gr(i)&&(s=!0,i=i[fr]);let l=Bi(i);n===0&&t!==null?r==null?qT(e,t,l):Eg(e,t,l,r||null,!0):n===1&&t!==null?Eg(e,t,l,r||null,!0):n===2?pj(e,l,s):n===3&&e.destroyNode(l),o!=null&&Tj(e,n,o,t,r)}}function bj(n,e){KT(n,e),e[fr]=null,e[ei]=null}function wj(n,e,t,i,r,o){i[fr]=r,i[ei]=e,Ug(n,i,t,1,r,o)}function KT(n,e){e[$r].changeDetectionScheduler?.notify(9),Ug(n,e,e[Mt],2,null,null)}function Sj(n){let e=n[Gl];if(!e)return Kb(n[we],n);for(;e;){let t=null;if(Gr(e))t=e[Gl];else{let i=e[ti];i&&(t=i)}if(!t){for(;e&&!e[ji]&&e!==n;)Gr(e)&&Kb(e[we],e),e=e[Cn];e===null&&(e=n),Gr(e)&&Kb(e[we],e),t=e&&e[ji]}e=t}}function qw(n,e){let t=n[oa],i=t.indexOf(e);t.splice(i,1)}function JT(n,e){if(sa(e))return;let t=e[Mt];t.destroyNode&&Ug(n,e,t,3,null,null),Sj(e)}function Kb(n,e){if(sa(e))return;let t=Be(null);try{e[Ce]&=-129,e[Ce]|=256,e[Di]&&rh(e[Di]),Ej(n,e),Cj(n,e),e[we].type===1&&e[Mt].destroy();let i=e[rs];if(i!==null&&pr(e[Cn])){i!==e[Cn]&&qw(i,e);let r=e[qr];r!==null&&r.detachView(n)}cw(e)}finally{Be(t)}}function Cj(n,e){let t=n.cleanup,i=e[ql];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let l=t[s+3];l>=0?i[l]():i[-l].unsubscribe(),s+=2}else{let l=i[t[s+1]];t[s].call(l)}i!==null&&(e[ql]=null);let r=e[Io];if(r!==null){e[Io]=null;for(let s=0;s<r.length;s++){let l=r[s];l()}}let o=e[Wd];if(o!==null){e[Wd]=null;for(let s of o)s.destroy()}}function Ej(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let i=0;i<t.length;i+=2){let r=e[t[i]];if(!(r instanceof ca)){let o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let l=r[o[s]],c=o[s+1];dt(4,l,c);try{c.call(l)}finally{dt(5,l,c)}}else{dt(4,r,o);try{o.call(r)}finally{dt(5,r,o)}}}}}function XT(n,e,t){return xj(n,e.parent,t)}function xj(n,e,t){let i=e;for(;i!==null&&i.type&168;)e=i,i=e.parent;if(i===null)return t[fr];if(ss(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Ro.None||r===Ro.Emulated)return null}return hr(i,t)}function eP(n,e,t){return Ij(n,e,t)}function Dj(n,e,t){return n.type&40?hr(n,t):null}var Ij=Dj,GM;function Gw(n,e,t,i){let r=XT(n,i,e),o=e[Mt],s=i.parent||e[ei],l=eP(s,i,e);if(r!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)qM(o,r,t[c],l,!1);else qM(o,r,t,l,!1);GM!==void 0&&GM(o,i,e,t,r)}function eu(n,e){if(e!==null){let t=e.type;if(t&3)return hr(e,n);if(t&4)return pw(-1,n[e.index]);if(t&8){let i=e.child;if(i!==null)return eu(n,i);{let r=n[e.index];return pr(r)?pw(-1,r):Bi(r)}}else{if(t&128)return eu(n,e.next);if(t&32)return $w(e,n)()||Bi(n[e.index]);{let i=tP(n,e);if(i!==null){if(Array.isArray(i))return i[0];let r=ts(n[hi]);return eu(r,i)}else return eu(n,e.next)}}}return null}function tP(n,e){if(e!==null){let i=n[hi][ei],r=e.projection;return i.projection[r]}return null}function pw(n,e){let t=ti+n+1;if(t<e.length){let i=e[t],r=i[we].firstChild;if(r!==null)return eu(i,r)}return e[os]}function Zw(n,e,t,i,r,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let l=i[t.index],c=t.type;if(s&&e===0&&(l&&tc(Bi(l),i),t.flags|=2),!Vg(t))if(c&8)Zw(n,e,t.child,i,r,o,!1),Jl(e,n,r,l,o);else if(c&32){let u=$w(t,i),f;for(;f=u();)Jl(e,n,r,f,o);Jl(e,n,r,l,o)}else c&16?nP(n,e,i,t,r,o):Jl(e,n,r,l,o);t=s?t.projectionNext:t.next}}function Ug(n,e,t,i,r,o){Zw(t,i,n.firstChild,e,r,o,!1)}function Mj(n,e,t){let i=e[Mt],r=XT(n,t,e),o=t.parent||e[ei],s=eP(o,t,e);nP(i,0,e,t,r,s)}function nP(n,e,t,i,r,o){let s=t[hi],c=s[ei].projection[i.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let f=c[u];Jl(e,n,r,f,o)}else{let u=c,f=s[Cn];MT(i)&&(u.flags|=128),Zw(n,e,u,f,r,o,!0)}}function Tj(n,e,t,i,r){let o=t[os],s=Bi(t);o!==s&&Jl(e,n,i,o,r);for(let l=ti;l<t.length;l++){let c=t[l];Ug(c[we],c,n,e,i,o)}}function Pj(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=i.indexOf("-")===-1?void 0:vr.DashCase;r==null?n.removeStyle(t,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=vr.Important),n.setStyle(t,i,r,o))}}function iP(n,e,t,i,r){let o=Yr(),s=i&2;try{ls(-1),s&&e.length>Qt&&QT(n,e,Qt,!1),dt(s?2:0,r,t),t(i,r)}finally{ls(o),dt(s?3:1,r,t)}}function Hg(n,e,t){Fj(n,e,t),(t.flags&64)===64&&zj(n,e,t)}function au(n,e,t=hr){let i=e.localNames;if(i!==null){let r=e.index+1;for(let o=0;o<i.length;o+=2){let s=i[o+1],l=s===-1?t(e,n):n[s];n[r++]=l}}}function Aj(n,e,t,i){let o=i.get(NT,OT)||t===Ro.ShadowDom,s=n.selectRootElement(e,o);return Rj(s),s}function Rj(n){kj(n)}var kj=()=>null;function Oj(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function rP(n,e,t,i,r,o){let s=e[we];if(Jw(n,s,e,t,i)){ss(n)&&Lj(e,n.index);return}n.type&3&&(t=Oj(t)),Nj(n,e,t,i,r,o)}function Nj(n,e,t,i,r,o){if(n.type&3){let s=hr(n,e);i=o!=null?o(i,n.value||"",t):i,r.setProperty(s,t,i)}else n.type&12}function Lj(n,e){let t=Ui(e,n);t[Ce]&16||(t[Ce]|=64)}function Fj(n,e,t){let i=t.directiveStart,r=t.directiveEnd;ss(t)&&_j(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||wg(t,e);let o=t.initialInputs;for(let s=i;s<r;s++){let l=n.data[s],c=nu(e,n,s,t);if(tc(c,e),o!==null&&Uj(e,s-i,c,l,t,o),Zr(l)){let u=Ui(t.index,e);u[jn]=nu(e,n,s,t)}}}function zj(n,e,t){let i=t.directiveStart,r=t.directiveEnd,o=t.index,s=MM();try{ls(o);for(let l=i;l<r;l++){let c=n.data[l],u=e[l];ig(l),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&Vj(c,u)}}finally{ls(-1),ig(s)}}function Vj(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function Yw(n,e){let t=n.directiveRegistry,i=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];WT(e,o.selectors,!1)&&(i??=[],Zr(o)?i.unshift(o):i.push(o))}return i}function jj(n,e,t,i,r,o){let s=hr(n,e);Bj(e[Mt],s,o,n.value,t,i,r)}function Bj(n,e,t,i,r,o,s){if(o==null)n.removeAttribute(e,r,t);else{let l=s==null?Ur(o):s(o,i||"",r);n.setAttribute(e,r,l,t)}}function Uj(n,e,t,i,r,o){let s=o[e];if(s!==null)for(let l=0;l<s.length;l+=2){let c=s[l],u=s[l+1];fw(i,t,c,u)}}function Qw(n,e,t,i,r){let o=Qt+t,s=e[we],l=r(s,e,n,i,t);e[o]=l,Kl(n,!0);let c=n.type===2;return c?(GT(e[Mt],l,n),(wM()===0||Zl(n))&&tc(l,e),SM()):tc(l,e),lg()&&(!c||!Vg(n))&&Gw(s,e,l,n),n}function Kw(n){let e=n;return kb()?Ob():(e=e.parent,Kl(e,!1)),e}function Hj(n,e){let t=n[ta];if(!t)return;t.get(ni,null)?.(e)}function Jw(n,e,t,i,r){let o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],l=!1;if(s)for(let c=0;c<s.length;c+=2){let u=s[c],f=s[c+1],m=e.data[u];fw(m,t[u],f,r),l=!0}if(o)for(let c of o){let u=t[c],f=e.data[c];fw(f,u,i,r),l=!0}return l}function Wj(n,e){let t=Ui(e,n),i=t[we];$j(i,t);let r=t[fr];r!==null&&t[$l]===null&&(t[$l]=LT(r,t[ta])),dt(18),Xw(i,t,t[jn]),dt(19,t[jn])}function $j(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function Xw(n,e,t){og(e);try{let i=n.viewQuery;i!==null&&uw(1,i,t);let r=n.template;r!==null&&iP(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[qr]?.finishViewCreation(n),n.staticContentQueries&&FT(n,e),n.staticViewQueries&&uw(2,n.viewQuery,t);let o=n.components;o!==null&&qj(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ce]&=-5,sg()}}function qj(n,e){for(let t=0;t<e.length;t++)Wj(n,e[t])}function oP(n,e,t,i){let r=Be(null);try{let o=e.tView,l=n[Ce]&4096?4096:16,c=Hw(n,o,t,l,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),u=n[e.index];c[rs]=u;let f=n[qr];return f!==null&&(c[qr]=f.createEmbeddedView(o)),Xw(o,c,t),c}finally{Be(r)}}function hw(n,e){return!e||e.firstChild===null||MT(n)}var ZM=!1,Gj=new se("");function iu(n,e,t,i,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&i.push(Bi(o)),pr(o)&&sP(o,i);let s=t.type;if(s&8)iu(n,e,t.child,i);else if(s&32){let l=$w(t,e),c;for(;c=l();)i.push(c)}else if(s&16){let l=tP(e,t);if(Array.isArray(l))i.push(...l);else{let c=ts(e[hi]);iu(c[we],c,l,i,!0)}}t=r?t.projectionNext:t.next}return i}function sP(n,e){for(let t=ti;t<n.length;t++){let i=n[t],r=i[we].firstChild;r!==null&&iu(i[we],i,r,e)}n[os]!==n[fr]&&e.push(n[os])}function aP(n){if(n[ra]!==null){for(let e of n[ra])e.impl.addSequence(e);n[ra].length=0}}var lP=[];function Zj(n){return n[Di]??Yj(n)}function Yj(n){let e=lP.pop()??Object.create(Kj);return e.lView=n,e}function Qj(n){n.lView[Di]!==n&&(n.lView=null,lP.push(n))}var Kj=ne(B({},Us),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Ql(n.lView)},consumerOnSignalRead(){this.lView[Di]=this}});function Jj(n){let e=n[Di]??Object.create(Xj);return e.lView=n,e}var Xj=ne(B({},Us),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=ts(n.lView);for(;e&&!cP(e[we]);)e=ts(e);e&&Eb(e)},consumerOnSignalRead(){this.lView[Di]=this}});function cP(n){return n.type!==2}function dP(n){if(n[Wd]===null)return;let e=!0;for(;e;){let t=!1;for(let i of n[Wd])i.dirty&&(t=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(n[Ce]&8192)}}var eB=100;function eS(n,e=0){let i=n[$r].rendererFactory,r=!1;r||i.begin?.();try{tB(n,e)}finally{r||i.end?.()}}function tB(n,e){let t=Lb();try{Fb(!0),gw(n,e);let i=0;for(;qd(n);){if(i===eB)throw new oe(103,!1);i++,gw(n,1)}}finally{Fb(t)}}function uP(n,e){Nb(e?Gd.Exhaustive:Gd.OnlyDirtyViews);try{eS(n)}finally{Nb(Gd.Off)}}function nB(n,e,t,i){if(sa(e))return;let r=e[Ce],o=!1,s=!1;og(e);let l=!0,c=null,u=null;o||(cP(n)?(u=Zj(e),c=Hs(u)):nh()===null?(l=!1,u=Jj(e),c=Hs(u)):e[Di]&&(rh(e[Di]),e[Di]=null));try{Cb(e),xM(n.bindingStartIndex),t!==null&&iP(n,e,t,2,i);let f=(r&3)===3;if(!o)if(f){let b=n.preOrderCheckHooks;b!==null&&pg(e,b,null)}else{let b=n.preOrderHooks;b!==null&&hg(e,b,0,null),Yb(e,0)}if(s||iB(e),dP(e),fP(e,0),n.contentQueries!==null&&FT(n,e),!o)if(f){let b=n.contentCheckHooks;b!==null&&pg(e,b)}else{let b=n.contentHooks;b!==null&&hg(e,b,1),Yb(e,1)}oB(n,e);let m=n.components;m!==null&&hP(e,m,0);let w=n.viewQuery;if(w!==null&&uw(2,w,i),!o)if(f){let b=n.viewCheckHooks;b!==null&&pg(e,b)}else{let b=n.viewHooks;b!==null&&hg(e,b,2),Yb(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Kh]){for(let b of e[Kh])b();e[Kh]=null}o||(aP(e),e[Ce]&=-73)}catch(f){throw o||Ql(e),f}finally{u!==null&&(xl(u,c),l&&Qj(u)),sg()}}function fP(n,e){for(let t=PT(n);t!==null;t=AT(t))for(let i=ti;i<t.length;i++){let r=t[i];pP(r,e)}}function iB(n){for(let e=PT(n);e!==null;e=AT(e)){if(!(e[Ce]&2))continue;let t=e[oa];for(let i=0;i<t.length;i++){let r=t[i];Eb(r)}}}function rB(n,e,t){dt(18);let i=Ui(e,n);pP(i,t),dt(19,i[jn])}function pP(n,e){Xh(n)&&gw(n,e)}function gw(n,e){let i=n[we],r=n[Ce],o=n[Di],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(o?.dirty&&Pd(o)),s||=!1,o&&(o.dirty=!1),n[Ce]&=-9217,s)nB(i,n,i.template,n[jn]);else if(r&8192){let l=Be(null);try{dP(n),fP(n,1);let c=i.components;c!==null&&hP(n,c,1),aP(n)}finally{Be(l)}}}function hP(n,e,t){for(let i=0;i<e.length;i++)rB(n,e[i],t)}function oB(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let i=0;i<t.length;i++){let r=t[i];if(r<0)ls(~r);else{let o=r,s=t[++i],l=t[++i];IM(s,o);let c=e[o];dt(24,c),l(2,c),dt(25,c)}}}finally{ls(-1)}}function tS(n,e){let t=Lb()?64:1088;for(n[$r].changeDetectionScheduler?.notify(e);n;){n[Ce]|=t;let i=ts(n);if(Yl(n)&&!i)return n;n=i}return null}function gP(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function mP(n,e,t,i=!0){let r=e[we];if(sB(r,e,n,t),i){let s=pw(t,n),l=e[Mt],c=l.parentNode(n[os]);c!==null&&wj(r,n[ei],l,e,c,s)}let o=e[$l];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function mw(n,e){if(n.length<=ti)return;let t=ti+e,i=n[t];if(i){let r=i[rs];r!==null&&r!==n&&qw(r,i),e>0&&(n[t-1][ji]=i[ji]);let o=Bd(n,ti+e);bj(i[we],i);let s=o[qr];s!==null&&s.detachView(o[we]),i[Cn]=null,i[ji]=null,i[Ce]&=-129}return i}function sB(n,e,t,i){let r=ti+i,o=t.length;i>0&&(t[r-1][ji]=e),i<o-ti?(e[ji]=t[r],lb(t,ti+i,e)):(t.push(e),e[ji]=null),e[Cn]=t;let s=e[rs];s!==null&&t!==s&&vP(s,e);let l=e[qr];l!==null&&l.insertView(n),eg(e),e[Ce]|=128}function vP(n,e){let t=n[oa],i=e[Cn];if(Gr(i))n[Ce]|=2;else{let r=i[Cn][hi];e[hi]!==r&&(n[Ce]|=2)}t===null?n[oa]=[e]:t.push(e)}var cs=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[we];return iu(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[jn]}set context(e){this._lView[jn]=e}get destroyed(){return sa(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Cn];if(pr(e)){let t=e[$d],i=t?t.indexOf(this):-1;i>-1&&(mw(e,i),Bd(t,i))}this._attachedToViewContainer=!1}JT(this._lView[we],this._lView)}onDestroy(e){xb(this._lView,e)}markForCheck(){tS(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Ce]&=-129}reattach(){eg(this._lView),this._lView[Ce]|=128}detectChanges(){this._lView[Ce]|=1024,eS(this._lView)}checkNoChanges(){return;try{this.exhaustive??=this._lView[ta].get(Gj,ZM)}catch{this.exhaustive=ZM}}attachToViewContainerRef(){if(this._appRef)throw new oe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Yl(this._lView),t=this._lView[rs];t!==null&&!e&&qw(t,this._lView),KT(this._lView[we],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new oe(902,!1);this._appRef=e;let t=Yl(this._lView),i=this._lView[rs];i!==null&&!t&&vP(i,this._lView),eg(this._lView)}};var Jr=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=aB;constructor(t,i,r){this._declarationLView=t,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,i){return this.createEmbeddedViewImpl(t,i)}createEmbeddedViewImpl(t,i,r){let o=oP(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:i,dehydratedView:r});return new cs(o)}}return n})();function aB(){return Wg(fn(),Ie())}function Wg(n,e){return n.type&4?new Jr(e,n,rc(n,e)):null}function ac(n,e,t,i,r){let o=n.data[e];if(o===null)o=lB(n,e,t,i,r),DM()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=i,o.attrs=r;let s=CM();o.injectorIndex=s===null?-1:s.injectorIndex}return Kl(o,!0),o}function lB(n,e,t,i,r){let o=Rb(),s=kb(),l=s?o:o&&o.parent,c=n.data[e]=dB(n,l,t,e,i,r);return cB(n,c,o,s),c}function cB(n,e,t,i){n.firstChild===null&&(n.firstChild=e),t!==null&&(i?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function dB(n,e,t,i,r,o){let s=e?e.injectorIndex:-1,l=0;return Tb()&&(l|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:l,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var Kae=new RegExp(`^(\\d+)*(${BV}|${jV})*(.*)`);var uB=()=>null;function vw(n,e){return uB(n,e)}var _P=class{},$g=class{},_w=class{resolveComponentFactory(e){throw new oe(917,!1)}},lu=class{static NULL=new _w},Mi=class{},Wn=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>fB()}return n})();function fB(){let n=Ie(),e=fn(),t=Ui(e.index,n);return(Gr(t)?t:n)[Mt]}var yP=(()=>{class n{static \u0275prov=Q({token:n,providedIn:"root",factory:()=>null})}return n})();var mg={},yw=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){let r=this.injector.get(e,mg,i);return r!==mg||t===mg?r:this.parentInjector.get(e,t,i)}};function xg(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let l=e[s];if(typeof l=="number")o=l;else if(o==1)r=$h(r,l);else if(o==2){let c=l,u=e[++s];i=$h(i,c+": "+u+";")}}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function z(n,e=0){let t=Ie();if(t===null)return te(n,e);let i=fn();return xT(i,t,Tn(n),e)}function nS(){let n="invalid";throw new Error(n)}function bP(n,e,t,i,r){let o=i===null?null:{"":-1},s=r(n,t);if(s!==null){let l=s,c=null,u=null;for(let f of s)if(f.resolveHostDirectives!==null){[l,c,u]=f.resolveHostDirectives(s);break}gB(n,e,t,l,o,c,u)}o!==null&&i!==null&&pB(t,i,o)}function pB(n,e,t){let i=n.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new oe(-301,!1);i.push(e[r],o)}}function hB(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function gB(n,e,t,i,r,o,s){let l=i.length,c=!1;for(let w=0;w<l;w++){let b=i[w];!c&&Zr(b)&&(c=!0,hB(n,t,w)),aw(wg(t,e),n,b.type)}wB(t,n.data.length,l);for(let w=0;w<l;w++){let b=i[w];b.providersResolver&&b.providersResolver(b)}let u=!1,f=!1,m=YT(n,e,l,null);l>0&&(t.directiveToIndex=new Map);for(let w=0;w<l;w++){let b=i[w];if(t.mergedAttrs=ec(t.mergedAttrs,b.hostAttrs),vB(n,t,e,m,b),bB(m,b,r),s!==null&&s.has(b)){let[T,M]=s.get(b);t.directiveToIndex.set(b.type,[m,T+t.directiveStart,M+t.directiveStart])}else(o===null||!o.has(b))&&t.directiveToIndex.set(b.type,m);b.contentQueries!==null&&(t.flags|=4),(b.hostBindings!==null||b.hostAttrs!==null||b.hostVars!==0)&&(t.flags|=64);let D=b.type.prototype;!u&&(D.ngOnChanges||D.ngOnInit||D.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),u=!0),!f&&(D.ngOnChanges||D.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),f=!0),m++}mB(n,t,o)}function mB(n,e,t){for(let i=e.directiveStart;i<e.directiveEnd;i++){let r=n.data[i];if(t===null||!t.has(r))YM(0,e,r,i),YM(1,e,r,i),KM(e,i,!1);else{let o=t.get(r);QM(0,e,o,i),QM(1,e,o,i),KM(e,i,!0)}}}function YM(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(i),wP(e,o)}}function QM(n,e,t,i){let r=n===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],l;n===0?l=e.hostDirectiveInputs??={}:l=e.hostDirectiveOutputs??={},l[s]??=[],l[s].push(i,o),wP(e,s)}}function wP(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function KM(n,e,t){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!t&&r===null||t&&o===null||Bw(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,l=0;for(;l<i.length;){let c=i[l];if(c===0){l+=4;continue}else if(c===5){l+=2;continue}else if(typeof c=="number")break;if(!t&&r.hasOwnProperty(c)){let u=r[c];for(let f of u)if(f===e){s??=[],s.push(c,i[l+1]);break}}else if(t&&o.hasOwnProperty(c)){let u=o[c];for(let f=0;f<u.length;f+=2)if(u[f]===e){s??=[],s.push(u[f+1],i[l+1]);break}}l+=2}n.initialInputs??=[],n.initialInputs.push(s)}function vB(n,e,t,i,r){n.data[i]=r;let o=r.factory||(r.factory=es(r.type,!0)),s=new ca(o,Zr(r),z,null);n.blueprint[i]=s,t[i]=s,_B(n,e,i,YT(n,t,r.hostVars,Hn),r)}function _B(n,e,t,i,r){let o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let l=~e.index;yB(s)!=l&&s.push(l),s.push(t,i,o)}}function yB(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function bB(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Zr(e)&&(t[""]=n)}}function wB(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function iS(n,e,t,i,r,o,s,l){let c=e[we],u=c.consts,f=as(u,s),m=ac(c,n,t,i,f);return o&&bP(c,e,m,as(u,l),r),m.mergedAttrs=ec(m.mergedAttrs,m.attrs),m.attrs!==null&&xg(m,m.attrs,!1),m.mergedAttrs!==null&&xg(m,m.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,m),m}function rS(n,e){mT(n,e),_b(e)&&n.queries.elementEnd(e)}function SB(n,e,t,i,r,o){let s=e.consts,l=as(s,r),c=ac(e,n,t,i,l);if(c.mergedAttrs=ec(c.mergedAttrs,c.attrs),o!=null){let u=as(s,o);c.localNames=[];for(let f=0;f<u.length;f+=2)c.localNames.push(u[f],-1)}return c.attrs!==null&&xg(c,c.attrs,!1),c.mergedAttrs!==null&&xg(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function oS(n){return qg(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function SP(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),i;for(;!(i=t.next()).done;)e(i.value)}}function qg(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function sS(n,e,t){return n[e]=t}function CB(n,e){return n[e]}function Xr(n,e,t){if(t===Hn)return!1;let i=n[e];return Object.is(i,t)?!1:(n[e]=t,!0)}function aS(n,e,t,i){let r=Xr(n,e,t);return Xr(n,e+1,i)||r}function EB(n,e,t,i,r){let o=aS(n,e,t,i);return Xr(n,e+2,r)||o}function Jb(n,e,t){return function i(r){let o=ss(n)?Ui(n.index,e):e;tS(o,5);let s=e[jn],l=JM(e,s,t,r),c=i.__ngNextListenerFn__;for(;c;)l=JM(e,s,c,r)&&l,c=c.__ngNextListenerFn__;return l}}function JM(n,e,t,i){let r=Be(null);try{return dt(6,e,t),t(i)!==!1}catch(o){return Hj(n,o),!1}finally{dt(7,e,t),Be(r)}}function xB(n,e,t,i,r,o,s,l){let c=Zl(n),u=!1,f=null;if(!i&&c&&(f=DB(e,t,o,n.index)),f!==null){let m=f.__ngLastListenerFn__||f;m.__ngNextListenerFn__=s,f.__ngLastListenerFn__=s,u=!0}else{let m=hr(n,t),w=i?i(m):m;HV(t,w,o,l);let b=r.listen(w,o,l),D=i?T=>i(Bi(T[n.index])):n.index;CP(D,e,t,o,l,b,!1)}return u}function DB(n,e,t,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===t&&r[o+1]===i){let l=e[ql],c=r[o+2];return l&&l.length>c?l[c]:null}typeof s=="string"&&(o+=2)}return null}function CP(n,e,t,i,r,o,s){let l=e.firstCreatePass?Ib(e):null,c=Db(t),u=c.length;c.push(r,o),l&&l.push(i,n,u,(u+1)*(s?-1:1))}function XM(n,e,t,i,r,o){let s=e[t],l=e[we],u=l.data[t].outputs[i],m=s[u].subscribe(o);CP(n.index,l,e,r,o,m,!0)}var bw=Symbol("BINDING");var Dg=class extends lu{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Hr(e);return new ds(t,this.ngModule)}};function IB(n){return Object.keys(n).map(e=>{let[t,i,r]=n[e],o={propName:t,templateName:e,isSignal:(i&Bg.SignalBased)!==0};return r&&(o.transform=r),o})}function MB(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function TB(n,e,t){let i=e instanceof zt?e:e?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new yw(t,i):t}function PB(n){let e=n.get(Mi,null);if(e===null)throw new oe(407,!1);let t=n.get(yP,null),i=n.get(To,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:i,ngReflect:!1}}function AB(n,e){let t=(n.selectors[0][0]||"div").toLowerCase();return $T(e,t,t==="svg"?yb:t==="math"?gM:null)}var ds=class extends $g{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=IB(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=MB(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=lj(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,i,r,o,s){dt(22);let l=Be(null);try{let c=this.componentDef,u=RB(i,c,s,o),f=TB(c,r||this.ngModule,e),m=PB(f),w=m.rendererFactory.createRenderer(null,c),b=i?Aj(w,i,c.encapsulation,f):AB(c,w),D=s?.some(eT)||o?.some(P=>typeof P!="function"&&P.bindings.some(eT)),T=Hw(null,u,null,512|ZT(c),null,null,m,w,f,null,LT(b,f,!0));T[Qt]=b,og(T);let M=null;try{let P=iS(Qt,T,2,"#host",()=>u.directiveRegistry,!0,0);b&&(GT(w,b,P),tc(b,T)),Hg(u,T,P),Fw(u,P,T),rS(u,P),t!==void 0&&OB(P,this.ngContentSelectors,t),M=Ui(P.index,T),T[jn]=M[jn],Xw(u,T,null)}catch(P){throw M!==null&&cw(M),cw(T),P}finally{dt(23),sg()}return new Ig(this.componentType,T,!!D)}finally{Be(l)}}};function RB(n,e,t,i){let r=n?["ng-version","20.1.3"]:cj(e.selectors[0]),o=null,s=null,l=0;if(t)for(let f of t)l+=f[bw].requiredVars,f.create&&(f.targetIdx=0,(o??=[]).push(f)),f.update&&(f.targetIdx=0,(s??=[]).push(f));if(i)for(let f=0;f<i.length;f++){let m=i[f];if(typeof m!="function")for(let w of m.bindings){l+=w[bw].requiredVars;let b=f+1;w.create&&(w.targetIdx=b,(o??=[]).push(w)),w.update&&(w.targetIdx=b,(s??=[]).push(w))}}let c=[e];if(i)for(let f of i){let m=typeof f=="function"?f:f.type,w=fb(m);c.push(w)}return Uw(0,null,kB(o,s),1,l,c,null,null,null,[r],null)}function kB(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let i of n)i.create();if(t&2&&e)for(let i of e)i.update()}}function eT(n){let e=n[bw].kind;return e==="input"||e==="twoWay"}var Ig=class extends _P{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,i){super(),this._rootLView=t,this._hasInputBindings=i,this._tNode=Jh(t[we],Qt),this.location=rc(this._tNode,t),this.instance=Ui(this._tNode.index,t)[jn],this.hostView=this.changeDetectorRef=new cs(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=Jw(i,r[we],r,e,t);this.previousInputValues.set(e,t);let s=Ui(i.index,r);tS(s,1)}get injector(){return new la(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function OB(n,e,t){let i=n.projection=[];for(let r=0;r<e.length;r++){let o=t[r];i.push(o!=null&&o.length?Array.from(o):null)}}var Ti=(()=>{class n{static __NG_ELEMENT_ID__=NB}return n})();function NB(){let n=fn();return xP(n,Ie())}var LB=Ti,EP=class extends LB{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return rc(this._hostTNode,this._hostLView)}get injector(){return new la(this._hostTNode,this._hostLView)}get parentInjector(){let e=Ow(this._hostTNode,this._hostLView);if(yT(e)){let t=yg(e,this._hostLView),i=_g(e),r=t[we].data[i+8];return new la(r,t)}else return new la(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=tT(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ti}createEmbeddedView(e,t,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let s=vw(this._lContainer,e.ssrId),l=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(l,r,hw(this._hostTNode,s)),l}createComponent(e,t,i,r,o,s,l){let c=e&&!hV(e),u;if(c)u=t;else{let M=t||{};u=M.index,i=M.injector,r=M.projectableNodes,o=M.environmentInjector||M.ngModuleRef,s=M.directives,l=M.bindings}let f=c?e:new ds(Hr(e)),m=i||this.parentInjector;if(!o&&f.ngModule==null){let P=(c?m:this.parentInjector).get(zt,null);P&&(o=P)}let w=Hr(f.componentType??{}),b=vw(this._lContainer,w?.id??null),D=b?.firstChild??null,T=f.create(m,r,D,o,s,l);return this.insertImpl(T.hostView,u,hw(this._hostTNode,b)),T}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){let r=e._lView;if(vM(r)){let l=this.indexOf(e);if(l!==-1)this.detach(l);else{let c=r[Cn],u=new EP(c,c[ei],c[Cn]);u.detach(u.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return mP(s,r,o,i),e.attachToViewContainerRef(),lb(Xb(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=tT(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),i=mw(this._lContainer,t);i&&(Bd(Xb(this._lContainer),t),JT(i[we],i))}detach(e){let t=this._adjustIndex(e,-1),i=mw(this._lContainer,t);return i&&Bd(Xb(this._lContainer),t)!=null?new cs(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function tT(n){return n[$d]}function Xb(n){return n[$d]||(n[$d]=[])}function xP(n,e){let t,i=e[n.index];return pr(i)?t=i:(t=gP(i,e,null,n),e[n.index]=t,Ww(e,t)),zB(t,e,n,i),new EP(t,n,e)}function FB(n,e){let t=n[Mt],i=t.createComment(""),r=hr(e,n),o=t.parentNode(r);return Eg(t,o,i,t.nextSibling(r),!1),i}var zB=BB,VB=()=>!1;function jB(n,e,t){return VB(n,e,t)}function BB(n,e,t,i){if(n[os])return;let r;t.type&8?r=Bi(i):r=FB(e,t),n[os]=r}var ww=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},Sw=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let i=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){let s=t.getByIndex(o),l=this.queries[s.indexInDeclarationView];r.push(l.clone())}return new n(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)lS(e,t).matches!==null&&this.queries[t].setDirty()}},Mg=class{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,typeof e=="string"?this.predicate=YB(e):this.predicate=e}},Cw=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){let r=t!==null?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Ew=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==t;)i=i.parent;return t===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(e,t,UB(t,o)),this.matchTNodeWithReadOption(e,t,gg(t,e,o,!1,!1))}else i===Jr?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,gg(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===ft||r===Ti||r===Jr&&t.type&4)this.addMatch(t.index,-2);else{let o=gg(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function UB(n,e){let t=n.localNames;if(t!==null){for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1]}return null}function HB(n,e){return n.type&11?rc(n,e):n.type&4?Wg(n,e):null}function WB(n,e,t,i){return t===-1?HB(e,n):t===-2?$B(n,e,i):nu(n,n[we],t,e)}function $B(n,e,t){if(t===ft)return rc(e,n);if(t===Jr)return Wg(e,n);if(t===Ti)return xP(e,n)}function DP(n,e,t,i){let r=e[qr].queries[i];if(r.matches===null){let o=n.data,s=t.matches,l=[];for(let c=0;s!==null&&c<s.length;c+=2){let u=s[c];if(u<0)l.push(null);else{let f=o[u];l.push(WB(e,f,s[c+1],t.metadata.read))}}r.matches=l}return r.matches}function xw(n,e,t,i){let r=n.queries.getByIndex(t),o=r.matches;if(o!==null){let s=DP(n,e,r,t);for(let l=0;l<o.length;l+=2){let c=o[l];if(c>0)i.push(s[l/2]);else{let u=o[l+1],f=e[-c];for(let m=ti;m<f.length;m++){let w=f[m];w[rs]===w[Cn]&&xw(w[we],w,u,i)}if(f[oa]!==null){let m=f[oa];for(let w=0;w<m.length;w++){let b=m[w];xw(b[we],b,u,i)}}}}}return i}function qB(n,e){return n[qr].queries[e].queryList}function IP(n,e,t){let i=new Sg((t&4)===4);return bM(n,e,i,i.destroy),(e[qr]??=new Sw).queries.push(new ww(i))-1}function GB(n,e,t){let i=rn();return i.firstCreatePass&&(MP(i,new Mg(n,e,t),-1),(e&2)===2&&(i.staticViewQueries=!0)),IP(i,Ie(),e)}function ZB(n,e,t,i){let r=rn();if(r.firstCreatePass){let o=fn();MP(r,new Mg(e,t,i),o.index),QB(r,n),(t&2)===2&&(r.staticContentQueries=!0)}return IP(r,Ie(),t)}function YB(n){return n.split(",").map(e=>e.trim())}function MP(n,e,t){n.queries===null&&(n.queries=new Cw),n.queries.track(new Ew(e,t))}function QB(n,e){let t=n.contentQueries||(n.contentQueries=[]),i=t.length?t[t.length-1]:-1;e!==i&&t.push(n.queries.length-1,e)}function lS(n,e){return n.queries.getByIndex(e)}function KB(n,e){let t=n[we],i=lS(t,e);return i.crossesNgTemplate?xw(t,n,e,[]):DP(t,n,i,e)}var nT=new Set;function fa(n){nT.has(n)||(nT.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var da=class{},Gg=class{};var Tg=class extends da{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Dg(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=ub(e);this._bootstrapComponents=UT(o.bootstrap),this._r3Injector=Ub(e,t,[{provide:da,useValue:this},{provide:lu,useValue:this.componentFactoryResolver},...i],Mo(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Pg=class extends Gg{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Tg(this.moduleType,e,[])}};var ru=class extends da{injector;componentFactoryResolver=new Dg(this);instance=null;constructor(e){super();let t=new Xs([...e.providers,{provide:da,useValue:this},{provide:lu,useValue:this.componentFactoryResolver}],e.parent||Wl(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function lc(n,e,t=null){return new ru({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var JB=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let i=pb(!1,t.type),r=i.length>0?lc([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Q({token:n,providedIn:"environment",factory:()=>new n(te(zt))})}return n})();function he(n){return ic(()=>{let e=TP(n),t=ne(B({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Nw.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(JB).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Ro.Emulated,styles:n.styles||Xn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&fa("NgStandalone"),PP(t);let i=n.dependencies;return t.directiveDefs=iT(i,XB),t.pipeDefs=iT(i,aM),t.id=n4(t),t})}function XB(n){return Hr(n)||fb(n)}function pn(n){return ic(()=>({type:n.type,bootstrap:n.bootstrap||Xn,declarations:n.declarations||Xn,imports:n.imports||Xn,exports:n.exports||Xn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function e4(n,e){if(n==null)return is;let t={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,s,l,c;Array.isArray(r)?(l=r[0],o=r[1],s=r[2]??o,c=r[3]||null):(o=r,s=r,l=Bg.None,c=null),t[o]=[i,l,c],e[o]=s}return t}function t4(n){if(n==null)return is;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Ee(n){return ic(()=>{let e=TP(n);return PP(e),e})}function cu(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function TP(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||is,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Xn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:e4(n.inputs,e),outputs:t4(n.outputs),debugInfo:null}}function PP(n){n.features?.forEach(e=>e(n))}function iT(n,e){return n?()=>{let t=typeof n=="function"?n():n,i=[];for(let r of t){let o=e(r);o!==null&&i.push(o)}return i}:null}function n4(n){let e=0,t=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function i4(n){return Object.getPrototypeOf(n.prototype).constructor}function Et(n){let e=i4(n.type),t=!0,i=[n];for(;e;){let r;if(Zr(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new oe(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);let s=n;s.inputs=ew(n.inputs),s.declaredInputs=ew(n.declaredInputs),s.outputs=ew(n.outputs);let l=r.hostBindings;l&&l4(n,l);let c=r.viewQuery,u=r.contentQueries;if(c&&s4(n,c),u&&a4(n,u),r4(n,r),JI(n.outputs,r.outputs),Zr(r)&&r.data.animation){let f=n.data;f.animation=(f.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let l=o[s];l&&l.ngInherit&&l(n),l===Et&&(t=!1)}}e=Object.getPrototypeOf(e)}o4(i)}function r4(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let i=e.inputs[t];i!==void 0&&(n.inputs[t]=i,n.declaredInputs[t]=e.declaredInputs[t])}}function o4(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=ec(r.hostAttrs,t=ec(t,r.hostAttrs))}}function ew(n){return n===is?{}:n===Xn?[]:n}function s4(n,e){let t=n.viewQuery;t?n.viewQuery=(i,r)=>{e(i,r),t(i,r)}:n.viewQuery=e}function a4(n,e){let t=n.contentQueries;t?n.contentQueries=(i,r,o)=>{e(i,r,o),t(i,r,o)}:n.contentQueries=e}function l4(n,e){let t=n.hostBindings;t?n.hostBindings=(i,r)=>{e(i,r),t(i,r)}:n.hostBindings=e}function AP(n,e,t,i,r,o,s,l){if(t.firstCreatePass){n.mergedAttrs=ec(n.mergedAttrs,n.attrs);let f=n.tView=Uw(2,n,r,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),f.queries=t.queries.embeddedTView(n))}l&&(n.flags|=l),Kl(n,!1);let c=u4(t,e,n,i);lg()&&Gw(t,e,c,n),tc(c,e);let u=gP(c,e,c,n);e[i+Qt]=u,Ww(e,u),jB(u,n,e)}function c4(n,e,t,i,r,o,s,l,c,u,f){let m=t+Qt,w;return e.firstCreatePass?(w=ac(e,m,4,s||null,l||null),tg()&&bP(e,n,w,as(e.consts,u),Yw),mT(e,w)):w=e.data[m],AP(w,n,e,t,i,r,o,c),Zl(w)&&Hg(e,n,w),u!=null&&au(n,w,f),w}function d4(n,e,t,i,r,o,s,l,c,u,f){let m=t+Qt,w;if(e.firstCreatePass){if(w=ac(e,m,4,s||null,l||null),u!=null){let b=as(e.consts,u);w.localNames=[];for(let D=0;D<b.length;D+=2)w.localNames.push(b[D],-1)}}else w=e.data[m];return AP(w,n,e,t,i,r,o,c),u!=null&&au(n,w,f),w}function N(n,e,t,i,r,o,s,l){let c=Ie(),u=rn(),f=as(u.consts,o);return c4(c,u,n,e,t,i,r,f,void 0,s,l),N}var u4=f4;function f4(n,e,t,i){return Qd(!0),e[Mt].createComment("")}var Zg=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(Zg||{}),pa=new se(""),RP=!1,Dw=class extends _e{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,pM()&&(this.destroyRef=V(Ii,{optional:!0})??void 0,this.pendingTasks=V(Qr,{optional:!0})??void 0)}emit(e){let t=Be(null);try{super.next(e)}finally{Be(t)}}subscribe(e,t,i){let r=e,o=t||(()=>null),s=i;if(e&&typeof e=="object"){let c=e;r=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let l=super.subscribe({next:r,error:o,complete:s});return e instanceof et&&e.add(l),l}wrapInTimeout(e){return t=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},ye=Dw;function kP(n){let e,t;function i(){n=Xd;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function rT(n){return queueMicrotask(()=>n()),()=>{n=Xd}}var cS="isAngularZone",Ag=cS+"_ID",p4=0,ut=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new ye(!1);onMicrotaskEmpty=new ye(!1);onStable=new ye(!1);onError=new ye(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=RP}=e;if(typeof Zone>"u")throw new oe(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,m4(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(cS)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new oe(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new oe(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,h4,Xd,Xd);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}},h4={};function dS(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function g4(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){kP(()=>{n.callbackScheduled=!1,Iw(n),n.isCheckStableRunning=!0,dS(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Iw(n)}function m4(n){let e=()=>{g4(n)},t=p4++;n._inner=n._inner.fork({name:"angular",properties:{[cS]:!0,[Ag]:t,[Ag+t]:!0},onInvokeTask:(i,r,o,s,l,c)=>{if(v4(c))return i.invokeTask(o,s,l,c);try{return oT(n),i.invokeTask(o,s,l,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),sT(n)}},onInvoke:(i,r,o,s,l,c,u)=>{try{return oT(n),i.invoke(o,s,l,c,u)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!_4(c)&&e(),sT(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Iw(n),dS(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Iw(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function oT(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function sT(n){n._nesting--,dS(n)}var Rg=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new ye;onMicrotaskEmpty=new ye;onStable=new ye;onError=new ye;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}};function v4(n){return OP(n,"__ignore_ng_zone__")}function _4(n){return OP(n,"__scheduler_tick__")}function OP(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var uS=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Q({token:n,providedIn:"root",factory:()=>new n})}return n})(),NP=[0,1,2,3],LP=(()=>{class n{ngZone=V(ut);scheduler=V(To);errorHandler=V(ur,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){V(pa,{optional:!0})}execute(){let t=this.sequences.size>0;t&&dt(16),this.executing=!0;for(let i of NP)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&dt(17)}register(t){let{view:i}=t;i!==void 0?((i[ra]??=[]).push(t),Ql(i),i[Ce]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(Zg.AFTER_NEXT_RENDER,t):t()}static \u0275prov=Q({token:n,providedIn:"root",factory:()=>new n})}return n})(),kg=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,o,s=null){this.impl=e,this.hooks=t,this.view=i,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[ra];e&&(this.view[ra]=e.filter(t=>t!==this))}};function fs(n,e){let t=e?.injector??V(un);return fa("NgAfterNextRender"),b4(n,t,e,!0)}function y4(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function b4(n,e,t,i){let r=e.get(uS);r.impl??=e.get(LP);let o=e.get(pa,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(Ii):null,l=e.get(cg,null,{optional:!0}),c=new kg(r.impl,y4(n),l?.view,i,s,o?.snapshot(null));return r.impl.register(c),c}var fS=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var pS=new se("");function ps(n){return!!n&&typeof n.then=="function"}function hS(n){return!!n&&typeof n.subscribe=="function"}var gS=new se("");function Yg(n){return Wr([{provide:gS,multi:!0,useValue:n}])}var mS=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=V(gS,{optional:!0})??[];injector=V(un);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=En(this.injector,r);if(ps(o))t.push(o);else if(hS(o)){let s=new Promise((l,c)=>{o.subscribe({complete:l,error:c})});t.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),t.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),du=new se("");function FP(){by(()=>{let n="";throw new oe(600,n)})}function zP(n){return n.isBoundToModule}var w4=10;var Hi=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=V(ni);afterRenderManager=V(uS);zonelessEnabled=V(Kd);rootEffectScheduler=V(Zb);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new _e;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=V(Qr);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(ke(t=>!t))}constructor(){V(pa,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=V(zt);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){return this.bootstrapImpl(t,i)}bootstrapImpl(t,i,r=un.NULL){return this._injector.get(ut).run(()=>{dt(10);let s=t instanceof $g;if(!this._injector.get(mS).done){let D="";throw new oe(405,D)}let c;s?c=t:c=this._injector.get(lu).resolveComponentFactory(t),this.componentTypes.push(c.componentType);let u=zP(c)?void 0:this._injector.get(da),f=i||c.selector,m=c.create(r,[],f,u),w=m.location.nativeElement,b=m.injector.get(pS,null);return b?.registerApplication(w),m.onDestroy(()=>{this.detachView(m.hostView),tu(this.components,m),b?.unregisterApplication(w)}),this._loadComponent(m),dt(11,m),m})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){dt(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(Zg.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new oe(101,!1);let t=Be(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Be(t),this.afterTick.next(),dt(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Mi,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<w4;)dt(14),this.synchronizeOnce(),dt(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!qd(r))continue;let o=i&&!this.zonelessEnabled?0:1;eS(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>qd(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){let i=t;tu(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(du,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>tu(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new oe(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function tu(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function hn(n,e,t,i){let r=Ie(),o=Zd();if(Xr(r,o,e)){let s=rn(),l=ag();jj(l,r,n,e,t,i)}return hn}function x(n,e,t){let i=Ie(),r=Zd();if(Xr(i,r,e)){let o=rn(),s=ag();rP(s,i,n,e,i[Mt],t)}return x}function Mw(n,e,t,i,r){Jw(e,n,t,r?"class":"style",i)}function g(n,e,t,i){let r=Ie(),o=r[we],s=n+Qt,l=o.firstCreatePass?iS(s,r,2,e,Yw,tg(),t,i):o.data[s];if(Qw(l,r,n,e,VP),Zl(l)){let c=r[we];Hg(c,r,l),Fw(c,l,r)}return i!=null&&au(r,l),g}function p(){let n=rn(),e=fn(),t=Kw(e);return n.firstCreatePass&&rS(n,t),Pb(t)&&Ab(),Mb(),t.classesWithoutHost!=null&&bV(t)&&Mw(n,t,Ie(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&wV(t)&&Mw(n,t,Ie(),t.stylesWithoutHost,!1),p}function ie(n,e,t,i){return g(n,e,t,i),p(),ie}function uu(n,e,t,i){let r=Ie(),o=r[we],s=n+Qt,l=o.firstCreatePass?SB(s,o,2,e,t,i):o.data[s];return Qw(l,r,n,e,VP),i!=null&&au(r,l),uu}function fu(){let n=fn(),e=Kw(n);return Pb(e)&&Ab(),Mb(),fu}var VP=(n,e,t,i,r)=>(Qd(!0),$T(e[Mt],i,OM()));function tt(n,e,t){let i=Ie(),r=i[we],o=n+Qt,s=r.firstCreatePass?iS(o,i,8,"ng-container",Yw,tg(),e,t):r.data[o];if(Qw(s,i,n,"ng-container",S4),Zl(s)){let l=i[we];Hg(l,i,s),Fw(l,s,i)}return t!=null&&au(i,s),tt}function nt(){let n=rn(),e=fn(),t=Kw(e);return n.firstCreatePass&&rS(n,t),nt}function ko(n,e,t){return tt(n,e,t),nt(),ko}var S4=(n,e,t,i,r)=>(Qd(!0),fj(e[Mt],""));function ee(){return Ie()}var aa=void 0;function C4(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var E4=["en",[["a","p"],["AM","PM"],aa],[["AM","PM"],aa,aa],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],aa,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],aa,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",aa,"{1} 'at' {0}",aa],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",C4],tw={};function ii(n){let e=x4(n),t=aT(e);if(t)return t;let i=e.split("-")[0];if(t=aT(i),t)return t;if(i==="en")return E4;throw new oe(701,!1)}function aT(n){return n in tw||(tw[n]=Po.ng&&Po.ng.common&&Po.ng.common.locales&&Po.ng.common.locales[n]),tw[n]}var Vt=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(Vt||{});function x4(n){return n.toLowerCase().replace(/_/g,"-")}var pu="en-US",D4="USD";var I4=pu;function jP(n){typeof n=="string"&&(I4=n.toLowerCase().replace(/_/g,"-"))}function F(n,e,t){let i=Ie(),r=rn(),o=fn();return BP(r,i,i[Mt],o,n,e,t),F}function BP(n,e,t,i,r,o,s){let l=!0,c=null;if((i.type&3||s)&&(c??=Jb(i,e,o),xB(i,n,e,s,t,r,o,c)&&(l=!1)),l){let u=i.outputs?.[r],f=i.hostDirectiveOutputs?.[r];if(f&&f.length)for(let m=0;m<f.length;m+=2){let w=f[m],b=f[m+1];c??=Jb(i,e,o),XM(i,e,w,b,r,c)}if(u&&u.length)for(let m of u)c??=Jb(i,e,o),XM(i,e,m,r,r,c)}}function E(n=1){return kM(n)}function M4(n,e){let t=null,i=ij(n);for(let r=0;r<e.length;r++){let o=e[r];if(o==="*"){t=r;continue}if(i===null?WT(n,o,!0):sj(i,o))return r}return t}function Qg(n){let e=Ie()[hi][ei];if(!e.projection){let t=n?n.length:1,i=e.projection=oM(t,null),r=i.slice(),o=e.child;for(;o!==null;){if(o.type!==128){let s=n?M4(o,n):0;s!==null&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o)}o=o.next}}}function Kg(n,e=0,t,i,r,o){let s=Ie(),l=rn(),c=i?n+1:null;c!==null&&d4(s,l,c,i,r,o,null,t);let u=ac(l,Qt+n,16,null,t||null);u.projection===null&&(u.projection=e),Ob();let m=!s[$l]||Tb();s[hi][ei].projection[u.projection]===null&&c!==null?T4(s,l,c):m&&!Vg(u)&&Mj(l,s,u)}function T4(n,e,t){let i=Qt+t,r=e.data[i],o=n[i],s=vw(o,r.tView.ssrId),l=oP(n,r,void 0,{dehydratedView:s});mP(o,l,0,hw(r,s))}function gn(n,e,t,i){ZB(n,e,t,i)}function cc(n,e,t){GB(n,e,t)}function jt(n){let e=Ie(),t=rn(),i=Vb();rg(i+1);let r=lS(t,i);if(n.dirty&&mM(e)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=KB(e,i);n.reset(o,OV),n.notifyOnChanges()}return!0}return!1}function Bt(){return qB(Ie(),Vb())}function Ve(n){let e=EM();return wb(e,Qt+n)}function fg(n,e){return n<<17|e<<2}function ua(n){return n>>17&32767}function P4(n){return(n&2)==2}function A4(n,e){return n&131071|e<<17}function Tw(n){return n|2}function nc(n){return(n&131068)>>2}function nw(n,e){return n&-131069|e<<2}function R4(n){return(n&1)===1}function Pw(n){return n|1}function k4(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,l=ua(s),c=nc(s);n[i]=t;let u=!1,f;if(Array.isArray(t)){let m=t;f=m[1],(f===null||Hl(m,f)>0)&&(u=!0)}else f=t;if(r)if(c!==0){let w=ua(n[l+1]);n[i+1]=fg(w,l),w!==0&&(n[w+1]=nw(n[w+1],i)),n[l+1]=A4(n[l+1],i)}else n[i+1]=fg(l,0),l!==0&&(n[l+1]=nw(n[l+1],i)),l=i;else n[i+1]=fg(c,0),l===0?l=i:n[c+1]=nw(n[c+1],i),c=i;u&&(n[i+1]=Tw(n[i+1])),lT(n,f,i,!0),lT(n,f,i,!1),O4(e,f,n,i,o),s=fg(l,c),o?e.classBindings=s:e.styleBindings=s}function O4(n,e,t,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Hl(o,e)>=0&&(t[i+1]=Pw(t[i+1]))}function lT(n,e,t,i){let r=n[t+1],o=e===null,s=i?ua(r):nc(r),l=!1;for(;s!==0&&(l===!1||o);){let c=n[s],u=n[s+1];N4(c,e)&&(l=!0,n[s+1]=i?Pw(u):Tw(u)),s=i?ua(u):nc(u)}l&&(n[t+1]=i?Tw(r):Pw(r))}function N4(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Hl(n,e)>=0:!1}var mr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function L4(n){return n.substring(mr.key,mr.keyEnd)}function F4(n){return z4(n),UP(n,HP(n,0,mr.textEnd))}function UP(n,e){let t=mr.textEnd;return t===e?-1:(e=mr.keyEnd=V4(n,mr.key=e,t),HP(n,e,t))}function z4(n){mr.key=0,mr.keyEnd=0,mr.value=0,mr.valueEnd=0,mr.textEnd=n.length}function HP(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function V4(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function Oo(n,e,t){return WP(n,e,t,!1),Oo}function Oe(n,e){return WP(n,e,null,!0),Oe}function hs(n){B4(G4,j4,n,!0)}function j4(n,e){for(let t=F4(e);t>=0;t=UP(e,t))Yh(n,L4(e),!0)}function WP(n,e,t,i){let r=Ie(),o=rn(),s=Yd(2);if(o.firstUpdatePass&&qP(o,n,s,i),e!==Hn&&Xr(r,s,e)){let l=o.data[Yr()];GP(o,l,r,r[Mt],n,r[s+1]=Y4(e,t),i,s)}}function B4(n,e,t,i){let r=rn(),o=Yd(2);r.firstUpdatePass&&qP(r,null,o,i);let s=Ie();if(t!==Hn&&Xr(s,o,t)){let l=r.data[Yr()];if(ZP(l,i)&&!$P(r,o)){let c=i?l.classesWithoutHost:l.stylesWithoutHost;c!==null&&(t=$h(c,t||"")),Mw(r,l,s,t,i)}else Z4(r,l,s,s[Mt],s[o+1],s[o+1]=q4(n,e,t),i,o)}}function $P(n,e){return e>=n.expandoStartIndex}function qP(n,e,t,i){let r=n.data;if(r[t+1]===null){let o=r[Yr()],s=$P(n,t);ZP(o,i)&&e===null&&!s&&(e=!1),e=U4(r,o,e,i),k4(r,o,e,t,s,i)}}function U4(n,e,t,i){let r=TM(n),o=i?e.residualClasses:e.residualStyles;if(r===null)(i?e.classBindings:e.styleBindings)===0&&(t=iw(null,n,e,t,i),t=ou(t,e.attrs,i),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==r)if(t=iw(r,n,e,t,i),o===null){let c=H4(n,e,i);c!==void 0&&Array.isArray(c)&&(c=iw(null,n,e,c[1],i),c=ou(c,e.attrs,i),W4(n,e,i,c))}else o=$4(n,e,i)}return o!==void 0&&(i?e.residualClasses=o:e.residualStyles=o),t}function H4(n,e,t){let i=t?e.classBindings:e.styleBindings;if(nc(i)!==0)return n[ua(i)]}function W4(n,e,t,i){let r=t?e.classBindings:e.styleBindings;n[ua(r)]=i}function $4(n,e,t){let i,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let s=n[o].hostAttrs;i=ou(i,s,t)}return ou(i,e.attrs,t)}function iw(n,e,t,i,r){let o=null,s=t.directiveEnd,l=t.directiveStylingLast;for(l===-1?l=t.directiveStart:l++;l<s&&(o=e[l],i=ou(i,o.hostAttrs,r),o!==n);)l++;return n!==null&&(t.directiveStylingLast=l),i}function ou(n,e,t){let i=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?r=s:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),Yh(n,s,t?!0:e[++o]))}return n===void 0?null:n}function q4(n,e,t){if(t==null||t==="")return Xn;let i=[],r=sc(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&e(i,r);return i}function G4(n,e,t){let i=String(e);i!==""&&!i.includes(" ")&&Yh(n,i,t)}function Z4(n,e,t,i,r,o,s,l){r===Hn&&(r=Xn);let c=0,u=0,f=0<r.length?r[0]:null,m=0<o.length?o[0]:null;for(;f!==null||m!==null;){let w=c<r.length?r[c+1]:void 0,b=u<o.length?o[u+1]:void 0,D=null,T;f===m?(c+=2,u+=2,w!==b&&(D=m,T=b)):m===null||f!==null&&f<m?(c+=2,D=f):(u+=2,D=m,T=b),D!==null&&GP(n,e,t,i,D,T,s,l),f=c<r.length?r[c]:null,m=u<o.length?o[u]:null}}function GP(n,e,t,i,r,o,s,l){if(!(e.type&3))return;let c=n.data,u=c[l+1],f=R4(u)?cT(c,e,t,r,nc(u),s):void 0;if(!Og(f)){Og(o)||P4(u)&&(o=cT(c,null,t,r,l,s));let m=bb(Yr(),t);Pj(i,s,m,r,o)}}function cT(n,e,t,i,r,o){let s=e===null,l;for(;r>0;){let c=n[r],u=Array.isArray(c),f=u?c[1]:c,m=f===null,w=t[r+1];w===Hn&&(w=m?Xn:void 0);let b=m?Qh(w,i):f===i?w:void 0;if(u&&!Og(b)&&(b=Qh(c,i)),Og(b)&&(l=b,s))return l;let D=n[r+1];r=s?ua(D):nc(D)}if(e!==null){let c=o?e.residualClasses:e.residualStyles;c!=null&&(l=Qh(c,i))}return l}function Og(n){return n!==void 0}function Y4(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Mo(sc(n)))),n}function ZP(n,e){return(n.flags&(e?8:16))!==0}function v(n,e=""){let t=Ie(),i=rn(),r=n+Qt,o=i.firstCreatePass?ac(i,r,1,e,null):i.data[r],s=Q4(i,t,o,e,n);t[r]=s,lg()&&Gw(i,t,s,o),Kl(o,!1)}var Q4=(n,e,t,i,r)=>(Qd(!0),dj(e[Mt],i));function YP(n,e,t,i=""){return Xr(n,Zd(),t)?e+Ur(t)+i:Hn}function QP(n,e,t,i,r,o=""){let s=zb(),l=aS(n,s,t,r);return Yd(2),l?e+Ur(t)+i+Ur(r)+o:Hn}function K4(n,e,t,i,r,o,s,l=""){let c=zb(),u=EB(n,c,t,r,s);return Yd(3),u?e+Ur(t)+i+Ur(r)+o+Ur(s)+l:Hn}function q(n){return J("",n),q}function J(n,e,t){let i=Ie(),r=YP(i,n,e,t);return r!==Hn&&vS(i,Yr(),r),J}function yt(n,e,t,i,r){let o=Ie(),s=QP(o,n,e,t,i,r);return s!==Hn&&vS(o,Yr(),s),yt}function No(n,e,t,i,r,o,s){let l=Ie(),c=K4(l,n,e,t,i,r,o,s);return c!==Hn&&vS(l,Yr(),c),No}function vS(n,e,t){let i=bb(e,n);uj(n[Mt],i,t)}function G(n,e,t){$b(e)&&(e=e());let i=Ie(),r=Zd();if(Xr(i,r,e)){let o=rn(),s=ag();rP(s,i,n,e,i[Mt],t)}return G}function Y(n,e){let t=$b(n);return t&&n.set(e),t}function Z(n,e){let t=Ie(),i=rn(),r=fn();return BP(i,t,t[Mt],r,n,e),Z}function ha(n,e,t=""){return YP(Ie(),n,e,t)}function Jg(n,e,t,i,r=""){return QP(Ie(),n,e,t,i,r)}function J4(n,e,t){let i=rn();if(i.firstCreatePass){let r=Zr(n);Aw(t,i.data,i.blueprint,r,!0),Aw(e,i.data,i.blueprint,r,!1)}}function Aw(n,e,t,i,r){if(n=Tn(n),Array.isArray(n))for(let o=0;o<n.length;o++)Aw(n[o],e,t,i,r);else{let o=rn(),s=Ie(),l=fn(),c=Js(n)?n:Tn(n.provide),u=gb(n),f=l.providerIndexes&1048575,m=l.directiveStart,w=l.providerIndexes>>20;if(Js(n)||!n.multi){let b=new ca(u,r,z,null),D=ow(c,e,r?f:f+w,m);D===-1?(aw(wg(l,s),o,c),rw(o,n,e.length),e.push(c),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(b),s.push(b)):(t[D]=b,s[D]=b)}else{let b=ow(c,e,f+w,m),D=ow(c,e,f,f+w),T=b>=0&&t[b],M=D>=0&&t[D];if(r&&!M||!r&&!T){aw(wg(l,s),o,c);let P=tU(r?eU:X4,t.length,r,i,u,n);!r&&M&&(t[D].providerFactory=P),rw(o,n,e.length,0),e.push(c),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),t.push(P),s.push(P)}else{let P=KP(t[r?D:b],u,!r&&i);rw(o,n,b>-1?b:D,P)}!r&&i&&M&&t[D].componentProviders++}}}function rw(n,e,t,i){let r=Js(e),o=fM(e);if(r||o){let c=(o?Tn(e.useClass):e).prototype.ngOnDestroy;if(c){let u=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){let f=u.indexOf(t);f===-1?u.push(t,[i,c]):u[f+1].push(i,c)}else u.push(t,c)}}}function KP(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function ow(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function X4(n,e,t,i,r){return Rw(this.multi,[])}function eU(n,e,t,i,r){let o=this.multi,s;if(this.providerFactory){let l=this.providerFactory.componentProviders,c=nu(i,i[we],this.providerFactory.index,r);s=c.slice(0,l),Rw(o,s);for(let u=l;u<c.length;u++)s.push(c[u])}else s=[],Rw(o,s);return s}function Rw(n,e){for(let t=0;t<n.length;t++){let i=n[t];e.push(i())}return e}function tU(n,e,t,i,r,o){let s=new ca(n,t,z,null);return s.multi=[],s.index=e,s.componentProviders=0,KP(s,r,i&&!t),s}function Tt(n,e=[]){return t=>{t.providersResolver=(i,r)=>J4(i,r?r(n):n,e)}}function _S(n,e,t){let i=ng()+n,r=Ie();return r[i]===Hn?sS(r,i,t?e.call(t):e()):CB(r,i)}function Wi(n,e,t,i){return nU(Ie(),ng(),n,e,t,i)}function JP(n,e){let t=n[e];return t===Hn?void 0:t}function nU(n,e,t,i,r,o){let s=e+t;return Xr(n,s,r)?sS(n,s+1,o?i.call(o,r):i(r)):JP(n,s+1)}function iU(n,e,t,i,r,o,s){let l=e+t;return aS(n,l,r,o)?sS(n,l+2,s?i.call(s,r,o):i(r,o)):JP(n,l+2)}function Me(n,e){let t=rn(),i,r=n+Qt;t.firstCreatePass?(i=rU(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];let o=i.factory||(i.factory=es(i.type,!0)),s,l=Jn(z);try{let c=bg(!1),u=o();return bg(c),Sb(t,Ie(),r,u),u}finally{Jn(l)}}function rU(n,e){if(e)for(let t=e.length-1;t>=0;t--){let i=e[t];if(n===i.name)return i}}function Te(n,e,t,i){let r=n+Qt,o=Ie(),s=wb(o,r);return oU(o,r)?iU(o,ng(),e,s.transform,t,i,s):s.transform(t,i)}function oU(n,e){return n[we].data[e].pure}function $t(n,e){return Wg(n,e)}var Ng=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},yS=(()=>{class n{compileModuleSync(t){return new Pg(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let i=this.compileModuleSync(t),r=ub(t),o=UT(r.declarations).reduce((s,l)=>{let c=Hr(l);return c&&s.push(new ds(c)),s},[]);return new Ng(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var sU=(()=>{class n{zone=V(ut);changeDetectionScheduler=V(To);applicationRef=V(Hi);applicationErrorHandler=V(ni);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(t){this.applicationErrorHandler(t)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),XP=new se("",{factory:()=>!1});function bS({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new ut(ne(B({},SS()),{scheduleInRootZone:t})),[{provide:ut,useFactory:n},{provide:Ao,multi:!0,useFactory:()=>{let i=V(sU,{optional:!0});return()=>i.initialize()}},{provide:Ao,multi:!0,useFactory:()=>{let i=V(aU);return()=>{i.initialize()}}},e===!0?{provide:qb,useValue:!0}:[],{provide:Gb,useValue:t??RP},{provide:ni,useFactory:()=>{let i=V(ut),r=V(zt),o;return s=>{i.runOutsideAngular(()=>{r.destroyed&&!o?setTimeout(()=>{throw s}):(o??=r.get(ur),o.handleError(s))})}}}]}function wS(n){let e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,i=bS({ngZoneFactory:()=>{let r=SS(n);return r.scheduleInRootZone=t,r.shouldCoalesceEventChangeDetection&&fa("NgZone_CoalesceEvent"),new ut(r)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return Wr([{provide:XP,useValue:!0},{provide:Kd,useValue:!1},i])}function SS(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var aU=(()=>{class n{subscription=new et;initialized=!1;zone=V(ut);pendingTasks=V(Qr);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ut.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ut.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var eA=(()=>{class n{applicationErrorHandler=V(ni);appRef=V(Hi);taskService=V(Qr);ngZone=V(ut);zonelessEnabled=V(Kd);tracing=V(pa,{optional:!0});disableScheduling=V(qb,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new et;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Ag):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(V(Gb,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Rg||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let i=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,i=!0;break}case 12:{this.appRef.dirtyFlags|=16,i=!0;break}case 13:{this.appRef.dirtyFlags|=2,i=!0;break}case 11:{i=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;let r=this.useMicrotaskScheduler?rT:kP;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Ag+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.taskService.remove(t),this.applicationErrorHandler(i)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,rT(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lU(){return typeof $localize<"u"&&$localize.locale||pu}var ga=new se("",{providedIn:"root",factory:()=>V(ga,{optional:!0,skipSelf:!0})||lU()}),CS=new se("",{providedIn:"root",factory:()=>D4});function gi(n){return YI(n)}function ma(n,e){return lh(n,e?.equal)}var tA=class{[zn];constructor(e){this[zn]=e}destroy(){this[zn].destroy()}};var aA=Symbol("InputSignalNode#UNSET"),SU=ne(B({},ch),{transformFn:void 0,applyValueToInputSignal(n,e){Dl(n,e)}});function lA(n,e){let t=Object.create(SU);t.value=n,t.transformFn=e?.transform;function i(){if(El(t),t.value===aA){let r=null;throw new oe(-950,r)}return t.value}return i[zn]=t,i}var em=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>su(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}},CU=new se("");CU.__NG_ELEMENT_ID__=n=>{let e=fn();if(e===null)throw new oe(204,!1);if(e.type&2)return e.value;if(n&8)return null;throw new oe(204,!1)};function nA(n,e){return lA(n,e)}function EU(n){return lA(aA,n)}var cA=(nA.required=EU,nA);var ES=new se(""),xU=new se("");function hu(n){return!n.moduleRef}function DU(n){let e=hu(n)?n.r3Injector:n.moduleRef.injector,t=e.get(ut);return t.run(()=>{hu(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=e.get(ni),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:i})}),hu(n)){let o=()=>e.destroy(),s=n.platformInjector.get(ES);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(ES);s.add(o),n.moduleRef.onDestroy(()=>{tu(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return MU(i,t,()=>{let o=e.get(Qr),s=o.add(),l=e.get(mS);return l.runInitializers(),l.donePromise.then(()=>{let c=e.get(ga,pu);if(jP(c||pu),!e.get(xU,!0))return hu(n)?e.get(Hi):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(hu(n)){let f=e.get(Hi);return n.rootComponent!==void 0&&f.bootstrap(n.rootComponent),f}else return IU?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void o.remove(s))})})}var IU;function MU(n,e,t){try{let i=t();return ps(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n(i)),i}}var Xg=null;function TU(n=[],e){return un.create({name:e,providers:[{provide:Ud,useValue:"platform"},{provide:ES,useValue:new Set([()=>Xg=null])},...n]})}function PU(n=[]){if(Xg)return Xg;let e=TU(n);return Xg=e,FP(),AU(e),e}function AU(n){let e=n.get(Fg,null);En(n,()=>{e?.forEach(t=>t())})}var Pn=(()=>{class n{static __NG_ELEMENT_ID__=RU}return n})();function RU(n){return kU(fn(),Ie(),(n&16)===16)}function kU(n,e,t){if(ss(n)&&!t){let i=Ui(n.index,e);return new cs(i,i)}else if(n.type&175){let i=e[hi];return new cs(i,e)}return null}var xS=class{constructor(){}supports(e){return oS(e)}create(e){return new DS(e)}},OU=(n,e)=>e,DS=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||OU}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){let s=!i||t&&t.currentIndex<iA(i,r,o)?t:i,l=iA(s,r,o),c=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,s.previousIndex==null)r++;else{o||(o=[]);let u=l-r,f=c-r;if(u!=f){for(let w=0;w<u;w++){let b=w<o.length?o[w]:o[w]=0,D=b+w;f<=D&&D<u&&(o[w]=b+1)}let m=s.previousIndex;o[m]=f-u}}l!==c&&e(s,l,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!oS(e))throw new oe(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,i=!1,r,o,s;if(Array.isArray(e)){this.length=e.length;for(let l=0;l<this.length;l++)o=e[l],s=this._trackByFn(l,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,l),i=!0):(i&&(t=this._verifyReinsertion(t,o,s,l)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else r=0,SP(e,l=>{s=this._trackByFn(r,l),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,l,s,r),i=!0):(i&&(t=this._verifyReinsertion(t,l,s,r)),Object.is(t.item,l)||this._addIdentityChange(t,l)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(i,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new IS(t,i),o,r)),e}_verifyReinsertion(e,t,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,o=e._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new tm),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,i=e._next;return t===null?this._itHead=i:t._next=i,i===null?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new tm),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},IS=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},MS=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;i!==null;i=i._nextDup)if((t===null||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){let t=e._prevDup,i=e._nextDup;return t===null?this._head=i:t._nextDup=i,i===null?this._tail=t:i._prevDup=t,this._head===null}},tm=class{map=new Map;put(e){let t=e.trackById,i=this.map.get(t);i||(i=new MS,this.map.set(t,i)),i.add(e)}get(e,t){let i=e,r=this.map.get(i);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function iA(n,e,t){let i=n.previousIndex;if(i===null)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}var TS=class{constructor(){}supports(e){return e instanceof Map||qg(e)}create(){return new PS}},PS=class{_records=new Map;_mapHead=null;_appendAfter=null;_previousMapHead=null;_changesHead=null;_changesTail=null;_additionsHead=null;_additionsTail=null;_removalsHead=null;_removalsTail=null;get isDirty(){return this._additionsHead!==null||this._changesHead!==null||this._removalsHead!==null}forEachItem(e){let t;for(t=this._mapHead;t!==null;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;t!==null;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;t!==null;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}diff(e){if(!e)e=new Map;else if(!(e instanceof Map||qg(e)))throw new oe(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{let o=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,o)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;i!==null;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){let i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){let r=this._records.get(e);this._maybeAddToChanges(r,t);let o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}let i=new AS(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;e!==null;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;e!=null;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){this._additionsHead===null?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){this._changesHead===null?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}},AS=class{key;previousValue=null;currentValue=null;_nextPrevious=null;_next=null;_prev=null;_nextAdded=null;_nextRemoved=null;_nextChanged=null;constructor(e){this.key=e}};function rA(){return new nm([new xS])}var nm=(()=>{class n{factories;static \u0275prov=Q({token:n,providedIn:"root",factory:rA});constructor(t){this.factories=t}static create(t,i){if(i!=null){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||rA()),deps:[[n,new kw,new Lg]]}}find(t){let i=this.factories.find(r=>r.supports(t));if(i!=null)return i;throw new oe(901,!1)}}return n})();function oA(){return new RS([new TS])}var RS=(()=>{class n{static \u0275prov=Q({token:n,providedIn:"root",factory:oA});factories;constructor(t){this.factories=t}static create(t,i){if(i){let r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||oA()),deps:[[n,new kw,new Lg]]}}find(t){let i=this.factories.find(r=>r.supports(t));if(i)return i;throw new oe(901,!1)}}return n})();function dA(n){dt(8);try{let{rootComponent:e,appProviders:t,platformProviders:i}=n,r=PU(i),o=[bS({}),{provide:To,useExisting:eA},LM,...t||[]],s=new ru({providers:o,parent:r,debugName:"",runEnvironmentInitializers:!1});return DU({r3Injector:s.injector,platformInjector:r,rootComponent:e})}catch(e){return Promise.reject(e)}finally{dt(9)}}function An(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function kS(n,e=NaN){return!isNaN(parseFloat(n))&&!isNaN(Number(n))?Number(n):e}function uA(n,e){let t=Hr(n),i=e.elementInjector||Wl();return new ds(t).create(i,e.projectableNodes,e.hostElement,e.environmentInjector,e.directives,e.bindings)}function fA(n){let e=Hr(n);if(!e)return null;let t=new ds(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var gA=null;function $i(){return gA}function OS(n){gA??=n}var gu=class{},mu=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:()=>V(mA),providedIn:"platform"})}return n})(),NS=new se(""),mA=(()=>{class n extends mu{_location;_history;_doc=V(ot);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return $i().getBaseHref(this._doc)}onPopState(t){let i=$i().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=$i().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function im(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function pA(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function _r(n){return n&&n[0]!=="?"?`?${n}`:n}var yr=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:()=>V(om),providedIn:"root"})}return n})(),rm=new se(""),om=(()=>{class n extends yr{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??V(ot).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return im(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+_r(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+_r(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+_r(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(te(mu),te(rm,8))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),eo=(()=>{class n{_subject=new _e;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=FU(pA(hA(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+_r(i))}normalize(t){return n.stripTrailingSlash(LU(this._basePath,hA(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+_r(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+_r(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=_r;static joinWithSlash=im;static stripTrailingSlash=pA;static \u0275fac=function(i){return new(i||n)(te(yr))};static \u0275prov=Q({token:n,factory:()=>NU(),providedIn:"root"})}return n})();function NU(){return new eo(te(yr))}function LU(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function hA(n){return n.replace(/\/index.html$/,"")}function FU(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var US=(()=>{class n extends yr{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(t){let i=im(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+_r(o))||this._platformLocation.pathname;this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+_r(o))||this._platformLocation.pathname;this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(te(mu),te(rm,8))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),CA={ADP:[void 0,void 0,0],AFN:[void 0,"\u060B",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058F",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20BC"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09F3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xA5","\xA5"],COP:[void 0,"$",2],CRC:[void 0,"\u20A1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010D",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xA3"],ESP:[void 0,"\u20A7",0],EUR:["\u20AC"],FJD:[void 0,"$"],FKP:[void 0,"\xA3"],GBP:["\xA3"],GEL:[void 0,"\u20BE"],GHS:[void 0,"GH\u20B5"],GIP:[void 0,"\xA3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20AA"],INR:["\u20B9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xA5",void 0,0],KHR:[void 0,"\u17DB"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20A9",0],KRW:["\u20A9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20B8"],LAK:[void 0,"\u20AD",0],LBP:[void 0,"L\xA3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20AE",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20A6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20B1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20B2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20BD"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xA3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xA3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xA3",0],THB:[void 0,"\u0E3F"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20BA"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20B4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20AB",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202FCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xA4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]},gm=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(gm||{});var $n=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}($n||{}),gt=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(gt||{}),mi=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(mi||{}),Rn={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function EA(n){return ii(n)[Vt.LocaleId]}function xA(n,e,t){let i=ii(n),r=[i[Vt.DayPeriodsFormat],i[Vt.DayPeriodsStandalone]],o=qi(r,e);return qi(o,t)}function DA(n,e,t){let i=ii(n),r=[i[Vt.DaysFormat],i[Vt.DaysStandalone]],o=qi(r,e);return qi(o,t)}function IA(n,e,t){let i=ii(n),r=[i[Vt.MonthsFormat],i[Vt.MonthsStandalone]],o=qi(r,e);return qi(o,t)}function MA(n,e){let i=ii(n)[Vt.Eras];return qi(i,e)}function vu(n,e){let t=ii(n);return qi(t[Vt.DateFormat],e)}function _u(n,e){let t=ii(n);return qi(t[Vt.TimeFormat],e)}function yu(n,e){let i=ii(n)[Vt.DateTimeFormat];return qi(i,e)}function wr(n,e){let t=ii(n),i=t[Vt.NumberSymbols][e];if(typeof i>"u"){if(e===Rn.CurrencyDecimal)return t[Vt.NumberSymbols][Rn.Decimal];if(e===Rn.CurrencyGroup)return t[Vt.NumberSymbols][Rn.Group]}return i}function HS(n,e){return ii(n)[Vt.NumberFormats][e]}function zU(n){return ii(n)[Vt.Currencies]}function TA(n){if(!n[Vt.ExtraData])throw new oe(2303,!1)}function PA(n){let e=ii(n);return TA(e),(e[Vt.ExtraData][2]||[]).map(i=>typeof i=="string"?LS(i):[LS(i[0]),LS(i[1])])}function AA(n,e,t){let i=ii(n);TA(i);let r=[i[Vt.ExtraData][0],i[Vt.ExtraData][1]],o=qi(r,e)||[];return qi(o,t)||[]}function qi(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new oe(2304,!1)}function LS(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}function RA(n,e,t="en"){let i=zU(t)[n]||CA[n]||[],r=i[1];return e==="narrow"&&typeof r=="string"?r:i[0]||n}var VU=2;function kA(n){let e,t=CA[n];return t&&(e=t[2]),typeof e=="number"?e:VU}var jU=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,sm={},BU=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function OA(n,e,t,i){let r=QU(n);e=Lo(t,e)||e;let s=[],l;for(;e;)if(l=BU.exec(e),l){s=s.concat(l.slice(1));let f=s.pop();if(!f)break;e=f}else{s.push(e);break}let c=r.getTimezoneOffset();i&&(c=LA(i,c),r=YU(r,i));let u="";return s.forEach(f=>{let m=GU(f);u+=m?m(r,t,c):f==="''"?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function um(n,e,t){let i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function Lo(n,e){let t=EA(n);if(sm[t]??={},sm[t][e])return sm[t][e];let i="";switch(e){case"shortDate":i=vu(n,mi.Short);break;case"mediumDate":i=vu(n,mi.Medium);break;case"longDate":i=vu(n,mi.Long);break;case"fullDate":i=vu(n,mi.Full);break;case"shortTime":i=_u(n,mi.Short);break;case"mediumTime":i=_u(n,mi.Medium);break;case"longTime":i=_u(n,mi.Long);break;case"fullTime":i=_u(n,mi.Full);break;case"short":let r=Lo(n,"shortTime"),o=Lo(n,"shortDate");i=am(yu(n,mi.Short),[r,o]);break;case"medium":let s=Lo(n,"mediumTime"),l=Lo(n,"mediumDate");i=am(yu(n,mi.Medium),[s,l]);break;case"long":let c=Lo(n,"longTime"),u=Lo(n,"longDate");i=am(yu(n,mi.Long),[c,u]);break;case"full":let f=Lo(n,"fullTime"),m=Lo(n,"fullDate");i=am(yu(n,mi.Full),[f,m]);break}return i&&(sm[t][e]=i),i}function am(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return e!=null&&i in e?e[i]:t})),n}function br(n,e,t="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return i&&(s=s.slice(s.length-e)),o+s}function UU(n,e){return br(n,3).substring(0,e)}function on(n,e,t=0,i=!1,r=!1){return function(o,s){let l=HU(n,o);if((t>0||l>-t)&&(l+=t),n===3)l===0&&t===-12&&(l=12);else if(n===6)return UU(l,e);let c=wr(s,Rn.MinusSign);return br(l,e,c,i,r)}}function HU(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new oe(2301,!1)}}function xt(n,e,t=$n.Format,i=!1){return function(r,o){return WU(r,o,n,e,t,i)}}function WU(n,e,t,i,r,o){switch(t){case 2:return IA(e,r,i)[n.getMonth()];case 1:return DA(e,r,i)[n.getDay()];case 0:let s=n.getHours(),l=n.getMinutes();if(o){let u=PA(e),f=AA(e,r,i),m=u.findIndex(w=>{if(Array.isArray(w)){let[b,D]=w,T=s>=b.hours&&l>=b.minutes,M=s<D.hours||s===D.hours&&l<D.minutes;if(b.hours<D.hours){if(T&&M)return!0}else if(T||M)return!0}else if(w.hours===s&&w.minutes===l)return!0;return!1});if(m!==-1)return f[m]}return xA(e,r,i)[s<12?0:1];case 3:return MA(e,i)[n.getFullYear()<=0?0:1];default:let c=t;throw new oe(2302,!1)}}function lm(n){return function(e,t,i){let r=-1*i,o=wr(t,Rn.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+br(s,2,o)+br(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+br(s,1,o);case 2:return"GMT"+(r>=0?"+":"")+br(s,2,o)+":"+br(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+br(s,2,o)+":"+br(Math.abs(r%60),2,o);default:throw new oe(2302,!1)}}}var $U=0,dm=4;function qU(n){let e=um(n,$U,1).getDay();return um(n,0,1+(e<=dm?dm:dm+7)-e)}function NA(n){let e=n.getDay(),t=e===0?-3:dm-e;return um(n.getFullYear(),n.getMonth(),n.getDate()+t)}function FS(n,e=!1){return function(t,i){let r;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();r=1+Math.floor((s+o)/7)}else{let o=NA(t),s=qU(o.getFullYear()),l=o.getTime()-s.getTime();r=1+Math.round(l/6048e5)}return br(r,n,wr(i,Rn.MinusSign))}}function cm(n,e=!1){return function(t,i){let o=NA(t).getFullYear();return br(o,n,wr(i,Rn.MinusSign),e)}}var zS={};function GU(n){if(zS[n])return zS[n];let e;switch(n){case"G":case"GG":case"GGG":e=xt(3,gt.Abbreviated);break;case"GGGG":e=xt(3,gt.Wide);break;case"GGGGG":e=xt(3,gt.Narrow);break;case"y":e=on(0,1,0,!1,!0);break;case"yy":e=on(0,2,0,!0,!0);break;case"yyy":e=on(0,3,0,!1,!0);break;case"yyyy":e=on(0,4,0,!1,!0);break;case"Y":e=cm(1);break;case"YY":e=cm(2,!0);break;case"YYY":e=cm(3);break;case"YYYY":e=cm(4);break;case"M":case"L":e=on(1,1,1);break;case"MM":case"LL":e=on(1,2,1);break;case"MMM":e=xt(2,gt.Abbreviated);break;case"MMMM":e=xt(2,gt.Wide);break;case"MMMMM":e=xt(2,gt.Narrow);break;case"LLL":e=xt(2,gt.Abbreviated,$n.Standalone);break;case"LLLL":e=xt(2,gt.Wide,$n.Standalone);break;case"LLLLL":e=xt(2,gt.Narrow,$n.Standalone);break;case"w":e=FS(1);break;case"ww":e=FS(2);break;case"W":e=FS(1,!0);break;case"d":e=on(2,1);break;case"dd":e=on(2,2);break;case"c":case"cc":e=on(7,1);break;case"ccc":e=xt(1,gt.Abbreviated,$n.Standalone);break;case"cccc":e=xt(1,gt.Wide,$n.Standalone);break;case"ccccc":e=xt(1,gt.Narrow,$n.Standalone);break;case"cccccc":e=xt(1,gt.Short,$n.Standalone);break;case"E":case"EE":case"EEE":e=xt(1,gt.Abbreviated);break;case"EEEE":e=xt(1,gt.Wide);break;case"EEEEE":e=xt(1,gt.Narrow);break;case"EEEEEE":e=xt(1,gt.Short);break;case"a":case"aa":case"aaa":e=xt(0,gt.Abbreviated);break;case"aaaa":e=xt(0,gt.Wide);break;case"aaaaa":e=xt(0,gt.Narrow);break;case"b":case"bb":case"bbb":e=xt(0,gt.Abbreviated,$n.Standalone,!0);break;case"bbbb":e=xt(0,gt.Wide,$n.Standalone,!0);break;case"bbbbb":e=xt(0,gt.Narrow,$n.Standalone,!0);break;case"B":case"BB":case"BBB":e=xt(0,gt.Abbreviated,$n.Format,!0);break;case"BBBB":e=xt(0,gt.Wide,$n.Format,!0);break;case"BBBBB":e=xt(0,gt.Narrow,$n.Format,!0);break;case"h":e=on(3,1,-12);break;case"hh":e=on(3,2,-12);break;case"H":e=on(3,1);break;case"HH":e=on(3,2);break;case"m":e=on(4,1);break;case"mm":e=on(4,2);break;case"s":e=on(5,1);break;case"ss":e=on(5,2);break;case"S":e=on(6,1);break;case"SS":e=on(6,2);break;case"SSS":e=on(6,3);break;case"Z":case"ZZ":case"ZZZ":e=lm(0);break;case"ZZZZZ":e=lm(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=lm(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=lm(2);break;default:return null}return zS[n]=e,e}function LA(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function ZU(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function YU(n,e,t){let r=n.getTimezoneOffset(),o=LA(e,r);return ZU(n,-1*(o-r))}function QU(n){if(vA(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,s=1]=n.split("-").map(l=>+l);return um(r,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(jU))return KU(i)}let e=new Date(n);if(!vA(e))throw new oe(2302,!1);return e}function KU(n){let e=new Date(0),t=0,i=0,r=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,l=Number(n[5]||0)-i,c=Number(n[6]||0),u=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,l,c,u),e}function vA(n){return n instanceof Date&&!isNaN(n.valueOf())}var JU=/^(\d+)?\.((\d+)(-(\d+))?)?$/,_A=22,fm=".",bu="0",XU=";",e5=",",VS="#",yA="\xA4";function FA(n,e,t,i,r,o,s=!1){let l="",c=!1;if(!isFinite(n))l=wr(t,Rn.Infinity);else{let u=n5(n);s&&(u=t5(u));let f=e.minInt,m=e.minFrac,w=e.maxFrac;if(o){let U=o.match(JU);if(U===null)throw new oe(2306,!1);let K=U[1],W=U[3],re=U[5];K!=null&&(f=jS(K)),W!=null&&(m=jS(W)),re!=null?w=jS(re):W!=null&&m>w&&(w=m)}i5(u,m,w);let b=u.digits,D=u.integerLen,T=u.exponent,M=[];for(c=b.every(U=>!U);D<f;D++)b.unshift(0);for(;D<0;D++)b.unshift(0);D>0?M=b.splice(D,b.length):(M=b,b=[0]);let P=[];for(b.length>=e.lgSize&&P.unshift(b.splice(-e.lgSize,b.length).join(""));b.length>e.gSize;)P.unshift(b.splice(-e.gSize,b.length).join(""));b.length&&P.unshift(b.join("")),l=P.join(wr(t,i)),M.length&&(l+=wr(t,r)+M.join("")),T&&(l+=wr(t,Rn.Exponential)+"+"+T)}return n<0&&!c?l=e.negPre+l+e.negSuf:l=e.posPre+l+e.posSuf,l}function zA(n,e,t,i,r){let o=HS(e,gm.Currency),s=jA(o,wr(e,Rn.MinusSign));return s.minFrac=kA(i),s.maxFrac=s.minFrac,FA(n,s,e,Rn.CurrencyGroup,Rn.CurrencyDecimal,r).replace(yA,t).replace(yA,"").trim()}function VA(n,e,t){let i=HS(e,gm.Decimal),r=jA(i,wr(e,Rn.MinusSign));return FA(n,r,e,Rn.Group,Rn.Decimal,t)}function jA(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(XU),r=i[0],o=i[1],s=r.indexOf(fm)!==-1?r.split(fm):[r.substring(0,r.lastIndexOf(bu)+1),r.substring(r.lastIndexOf(bu)+1)],l=s[0],c=s[1]||"";t.posPre=l.substring(0,l.indexOf(VS));for(let f=0;f<c.length;f++){let m=c.charAt(f);m===bu?t.minFrac=t.maxFrac=f+1:m===VS?t.maxFrac=f+1:t.posSuf+=m}let u=l.split(e5);if(t.gSize=u[1]?u[1].length:0,t.lgSize=u[2]||u[1]?(u[2]||u[1]).length:0,o){let f=r.length-t.posPre.length-t.posSuf.length,m=o.indexOf(VS);t.negPre=o.substring(0,m).replace(/'/g,""),t.negSuf=o.slice(m+f).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function t5(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function n5(n){let e=Math.abs(n)+"",t=0,i,r,o,s,l;for((r=e.indexOf(fm))>-1&&(e=e.replace(fm,"")),(o=e.search(/e/i))>0?(r<0&&(r=o),r+=+e.slice(o+1),e=e.substring(0,o)):r<0&&(r=e.length),o=0;e.charAt(o)===bu;o++);if(o===(l=e.length))i=[0],r=1;else{for(l--;e.charAt(l)===bu;)l--;for(r-=o,i=[],s=0;o<=l;o++,s++)i[s]=Number(e.charAt(o))}return r>_A&&(i=i.splice(0,_A-1),t=r-1,r=1),{digits:i,exponent:t,integerLen:r}}function i5(n,e,t){if(e>t)throw new oe(2307,!1);let i=n.digits,r=i.length-n.integerLen,o=Math.min(Math.max(e,r),t),s=o+n.integerLen,l=i[s];if(s>0){i.splice(Math.max(n.integerLen,s));for(let m=s;m<i.length;m++)i[m]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,s=o+1),i[0]=0;for(let m=1;m<s;m++)i[m]=0}if(l>=5)if(s-1<0){for(let m=0;m>s;m--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[s-1]++;for(;r<Math.max(0,o);r++)i.push(0);let c=o!==0,u=e+n.integerLen,f=i.reduceRight(function(m,w,b,D){return w=w+m,D[b]=w<10?w:w-10,c&&(D[b]===0&&b>=u?D.pop():c=!1),w>=10?1:0},0);f&&(i.unshift(f),n.integerLen++)}function jS(n){let e=parseInt(n);if(isNaN(e))throw new oe(2305,!1);return e}var BS=/\s+/,bA=[],va=(()=>{class n{_ngEl;_renderer;initialClasses=bA;rawClass;stateMap=new Map;constructor(t,i){this._ngEl=t,this._renderer=i}set klass(t){this.initialClasses=t!=null?t.trim().split(BS):bA}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(BS):t}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let i of t)this._updateState(i,!0);else if(t!=null)for(let i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){let r=this.stateMap.get(t);r!==void 0?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){t=t.trim(),t.length>0&&t.split(BS).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||n)(z(ft),z(Wn))};static \u0275dir=Ee({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var pm=class{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Ze=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new pm(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)i.remove(o===null?void 0:o);else if(o!==null){let l=i.get(o);i.move(l,s),wA(l,r)}});for(let r=0,o=i.length;r<o;r++){let l=i.get(r).context;l.index=r,l.count=o,l.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);wA(o,r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(z(Ti),z(Jr),z(nm))};static \u0275dir=Ee({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function wA(n,e){n.context.$implicit=e.item}var Ne=(()=>{class n{_viewContainer;_context=new hm;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){SA(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){SA(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(z(Ti),z(Jr))};static \u0275dir=Ee({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),hm=class{$implicit=null;ngIf=null};function SA(n,e){if(n&&!n.createEmbeddedView)throw new oe(2020,!1)}var WS=(()=>{class n{_ngEl;_differs;_renderer;_ngStyle=null;_differ=null;constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){let t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){let[r,o]=t.split("."),s=r.indexOf("-")===-1?void 0:vr.DashCase;i!=null?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,s):this._renderer.removeStyle(this._ngEl.nativeElement,r,s)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static \u0275fac=function(i){return new(i||n)(z(ft),z(RS),z(Wn))};static \u0275dir=Ee({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}})}return n})(),$S=(()=>{class n{_viewContainerRef;_viewRef=null;ngTemplateOutletContext=null;ngTemplateOutlet=null;ngTemplateOutletInjector=null;constructor(t){this._viewContainerRef=t}ngOnChanges(t){if(this._shouldRecreateView(t)){let i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let r=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(t){return!!t.ngTemplateOutlet||!!t.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(t,i,r)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,i,r):!1,get:(t,i,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,r)}})}static \u0275fac=function(i){return new(i||n)(z(Ti))};static \u0275dir=Ee({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},features:[Dn]})}return n})();function qS(n,e){return new oe(2100,!1)}var r5="mediumDate",BA=new se(""),UA=new se(""),Pi=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,o){if(t==null||t===""||t!==t)return null;try{let s=i??this.defaultOptions?.dateFormat??r5,l=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return OA(t,s,o||this.locale,l)}catch(s){throw qS(n,s.message)}}static \u0275fac=function(i){return new(i||n)(z(ga,16),z(BA,24),z(UA,24))};static \u0275pipe=cu({name:"date",type:n,pure:!0})}return n})();var _a=(()=>{class n{_locale;constructor(t){this._locale=t}transform(t,i,r){if(!HA(t))return null;r||=this._locale;try{let o=WA(t);return VA(o,r,i)}catch(o){throw qS(n,o.message)}}static \u0275fac=function(i){return new(i||n)(z(ga,16))};static \u0275pipe=cu({name:"number",type:n,pure:!0})}return n})();var Sr=(()=>{class n{_locale;_defaultCurrencyCode;constructor(t,i="USD"){this._locale=t,this._defaultCurrencyCode=i}transform(t,i=this._defaultCurrencyCode,r="symbol",o,s){if(!HA(t))return null;s||=this._locale,typeof r=="boolean"&&(r=r?"symbol":"code");let l=i||this._defaultCurrencyCode;r!=="code"&&(r==="symbol"||r==="symbol-narrow"?l=RA(l,r==="symbol"?"wide":"narrow",s):l=r);try{let c=WA(t);return zA(c,s,l,i,o)}catch(c){throw qS(n,c.message)}}static \u0275fac=function(i){return new(i||n)(z(ga,16),z(CS,16))};static \u0275pipe=cu({name:"currency",type:n,pure:!0})}return n})();function HA(n){return!(n==null||n===""||n!==n)}function WA(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new oe(2309,!1);return n}var Se=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=pn({type:n});static \u0275inj=nn({})}return n})();function wu(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let i=t.indexOf("="),[r,o]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var ya=class{};var ZS="browser";function $A(n){return n===ZS}var qA=(()=>{class n{static \u0275prov=Q({token:n,providedIn:"root",factory:()=>new GS(V(ot),window)})}return n})(),GS=class{document;window;offset=()=>[0,0];constructor(e,t){this.document=e,this.window=t}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e,t){this.window.scrollTo(ne(B({},t),{left:e[0],top:e[1]}))}scrollToAnchor(e,t){let i=s5(this.document,e);i&&(this.scrollToElement(i,t),i.focus())}setHistoryScrollRestoration(e){try{this.window.history.scrollRestoration=e}catch{console.warn(ns(2400,!1))}}scrollToElement(e,t){let i=e.getBoundingClientRect(),r=i.left+this.window.pageXOffset,o=i.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(ne(B({},t),{left:r-s[0],top:o-s[1]}))}};function s5(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),r=i.currentNode;for(;r;){let o=r.shadowRoot;if(o){let s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}r=i.nextNode()}}return null}var vm=new se(""),XS=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r,o){return this._findPluginFor(i).addEventListener(t,i,r,o)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(o=>o.supports(t)),!i)throw new oe(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(te(vm),te(ut))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),Su=class{_doc;constructor(e){this._doc=e}manager},YS="ng-app-id";function GA(n){for(let e of n)e.remove()}function ZA(n,e){let t=e.createElement("style");return t.textContent=n,t}function a5(n,e,t,i){let r=n.head?.querySelectorAll(`style[${YS}="${e}"],link[${YS}="${e}"]`);if(r)for(let o of r)o.removeAttribute(YS),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function KS(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var eC=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,r,o={}){this.doc=t,this.appId=i,this.nonce=r,a5(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let r of t)this.addUsage(r,this.inline,ZA);i?.forEach(r=>this.addUsage(r,this.external,KS))}removeStyles(t,i){for(let r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){let o=i.get(t);o?o.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,i){let r=i.get(t);r&&(r.usage--,r.usage<=0&&(GA(r.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])GA(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(t,ZA(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(t,KS(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(te(ot),te(oc),te(zg,8),te(us))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),QS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},tC=/%COMP%/g;var QA="%COMP%",l5=`_nghost-${QA}`,c5=`_ngcontent-${QA}`,d5=!0,u5=new se("",{providedIn:"root",factory:()=>d5});function f5(n){return c5.replace(tC,n)}function p5(n){return l5.replace(tC,n)}function KA(n,e){return e.map(t=>t.replace(tC,n))}var nC=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,i,r,o,s,l,c,u=null,f=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=l,this.ngZone=c,this.nonce=u,this.tracingService=f,this.platformIsServer=!1,this.defaultRenderer=new Cu(t,s,c,this.platformIsServer,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,i);return r instanceof mm?r.applyToHost(t):r instanceof Eu&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let s=this.doc,l=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,m=this.platformIsServer,w=this.tracingService;switch(i.encapsulation){case Ro.Emulated:o=new mm(c,u,i,this.appId,f,s,l,m,w);break;case Ro.ShadowDom:return new JS(c,u,t,i,s,l,this.nonce,m,w);default:o=new Eu(c,u,i,f,s,l,m,w);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(te(XS),te(eC),te(oc),te(u5),te(ot),te(us),te(ut),te(zg),te(pa,8))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),Cu=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r,o){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(QS[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(YA(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(YA(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new oe(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let o=QS[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=QS[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(vr.DashCase|vr.Important)?e.style.setProperty(t,i,r&vr.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&vr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if(typeof e=="string"&&(e=$i().getGlobalEventTarget(this.doc,e),!e))throw new oe(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function YA(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var JS=class extends Cu{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,i,r,o,s,l,c,u){super(e,o,s,c,u),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let f=r.styles;f=KA(r.id,f);for(let w of f){let b=document.createElement("style");l&&b.setAttribute("nonce",l),b.textContent=w,this.shadowRoot.appendChild(b)}let m=r.getExternalStyles?.();if(m)for(let w of m){let b=KS(w,o);l&&b.setAttribute("nonce",l),this.shadowRoot.appendChild(b)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Eu=class extends Cu{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,o,s,l,c,u){super(e,o,s,l,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let f=i.styles;this.styles=u?KA(u,f):f,this.styleUrls=i.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},mm=class extends Eu{contentAttr;hostAttr;constructor(e,t,i,r,o,s,l,c,u){let f=r+"-"+i.id;super(e,t,i,o,s,l,c,u,f),this.contentAttr=f5(f),this.hostAttr=p5(f)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var _m=class n extends gu{supportsDOMEvents=!0;static makeCurrent(){OS(new n)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=h5();return t==null?null:g5(t)}resetBaseElement(){xu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return wu(document.cookie,e)}},xu=null;function h5(){return xu=xu||document.head.querySelector("base"),xu?xu.getAttribute("href"):null}function g5(n){return new URL(n,document.baseURI).pathname}var m5=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),XA=(()=>{class n extends Su{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,o){return t.addEventListener(i,r,o),()=>this.removeEventListener(t,i,r,o)}removeEventListener(t,i,r,o){return t.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(te(ot))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),JA=["alt","control","meta","shift"],v5={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_5={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},eR=(()=>{class n extends Su{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r,o){let s=n.parseEventName(i),l=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>$i().onAndCancel(t,s.domEventName,l,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),s="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),s="code."),JA.forEach(u=>{let f=i.indexOf(u);f>-1&&(i.splice(f,1),s+=u+".")}),s+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=r,c.fullKey=s,c}static matchEventFullKeyCode(t,i){let r=v5[t.key]||t.key,o="";return i.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),JA.forEach(s=>{if(s!==r){let l=_5[s];l(t)&&(o+=s+".")}}),o+=r,o===i)}static eventCallback(t,i,r){return o=>{n.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||n)(te(ot))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})();function iC(n,e){let t=B({rootComponent:n},y5(e));return dA(t)}function y5(n){return{appProviders:[...E5,...n?.providers??[]],platformProviders:C5}}function b5(){_m.makeCurrent()}function w5(){return new ur}function S5(){return Lw(document),document}var C5=[{provide:us,useValue:ZS},{provide:Fg,useValue:b5,multi:!0},{provide:ot,useFactory:S5}];var E5=[{provide:Ud,useValue:"root"},{provide:ur,useFactory:w5},{provide:vm,useClass:XA,multi:!0,deps:[ot]},{provide:vm,useClass:eR,multi:!0,deps:[ot]},nC,eC,XS,{provide:Mi,useExisting:nC},{provide:ya,useClass:m5},[]];var fc=class{},Du=class{},gs=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),o=t.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(l=>o.indexOf(l)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var bm=class{encodeKey(e){return tR(e)}encodeValue(e){return tR(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function x5(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{let o=r.indexOf("="),[s,l]=o==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,o)),e.decodeValue(r.slice(o+1))],c=t.get(s)||[];c.push(l),t.set(s,c)}),t}var D5=/%(\d[a-f0-9])/gi,I5={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function tR(n){return encodeURIComponent(n).replace(D5,(e,t)=>I5[t]??e)}function ym(n){return`${n}`}var Cr=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new bm,e.fromString){if(e.fromObject)throw new oe(2805,!1);this.map=x5(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let i=e.fromObject[t],r=Array.isArray(i)?i.map(ym):[ym(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(i=>{let r=e[i];Array.isArray(r)?r.forEach(o=>{t.push({param:i,value:o,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(ym(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],r=i.indexOf(ym(e.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var wm=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function M5(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function nR(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function iR(n){return typeof Blob<"u"&&n instanceof Blob}function rR(n){return typeof FormData<"u"&&n instanceof FormData}function T5(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var oR="Content-Type",sR="Accept",lR="X-Request-URL",cR="text/plain",dR="application/json",P5=`${dR}, ${cR}, */*`,dc=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,i,r){this.url=t,this.method=e.toUpperCase();let o;if(M5(this.method)||r?(this.body=i!==void 0?i:null,o=r):o=i,o){if(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,this.keepalive=!!o.keepalive,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),o.priority&&(this.priority=o.priority),o.cache&&(this.cache=o.cache),o.credentials&&(this.credentials=o.credentials),typeof o.timeout=="number"){if(o.timeout<1||!Number.isInteger(o.timeout))throw new Error("");this.timeout=o.timeout}o.mode&&(this.mode=o.mode),o.redirect&&(this.redirect=o.redirect),this.transferCache=o.transferCache}if(this.headers??=new gs,this.context??=new wm,!this.params)this.params=new Cr,this.urlWithParams=t;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=t;else{let l=t.indexOf("?"),c=l===-1?"?":l<t.length-1?"&":"";this.urlWithParams=t+c+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||nR(this.body)||iR(this.body)||rR(this.body)||T5(this.body)?this.body:this.body instanceof Cr?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||rR(this.body)?null:iR(this.body)?this.body.type||null:nR(this.body)?null:typeof this.body=="string"?cR:this.body instanceof Cr?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?dR:null}clone(e={}){let t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,o=e.keepalive??this.keepalive,s=e.priority||this.priority,l=e.cache||this.cache,c=e.mode||this.mode,u=e.redirect||this.redirect,f=e.credentials||this.credentials,m=e.transferCache??this.transferCache,w=e.timeout??this.timeout,b=e.body!==void 0?e.body:this.body,D=e.withCredentials??this.withCredentials,T=e.reportProgress??this.reportProgress,M=e.headers||this.headers,P=e.params||this.params,U=e.context??this.context;return e.setHeaders!==void 0&&(M=Object.keys(e.setHeaders).reduce((K,W)=>K.set(W,e.setHeaders[W]),M)),e.setParams&&(P=Object.keys(e.setParams).reduce((K,W)=>K.set(W,e.setParams[W]),P)),new n(t,i,b,{params:P,headers:M,context:U,reportProgress:T,responseType:r,withCredentials:D,transferCache:m,keepalive:o,cache:l,priority:s,timeout:w,mode:c,redirect:u,credentials:f})}},ba=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(ba||{}),pc=class{headers;status;statusText;url;ok;type;constructor(e,t=200,i="OK"){this.headers=e.headers||new gs,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Sm=class n extends pc{constructor(e={}){super(e)}type=ba.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Iu=class n extends pc{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=ba.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},uc=class extends pc{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},A5=200,R5=204;function rC(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache,keepalive:n.keepalive,priority:n.priority,cache:n.cache,mode:n.mode,redirect:n.redirect}}var Em=(()=>{class n{handler;constructor(t){this.handler=t}request(t,i,r={}){let o;if(t instanceof dc)o=t;else{let c;r.headers instanceof gs?c=r.headers:c=new gs(r.headers);let u;r.params&&(r.params instanceof Cr?u=r.params:u=new Cr({fromObject:r.params})),o=new dc(t,i,r.body!==void 0?r.body:null,{headers:c,context:r.context,params:u,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache,keepalive:r.keepalive,priority:r.priority,cache:r.cache,mode:r.mode,redirect:r.redirect,credentials:r.credentials})}let s=ge(o).pipe(Br(c=>this.handler.handle(c)));if(t instanceof dc||r.observe==="events")return s;let l=s.pipe(wn(c=>c instanceof Iu));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return l.pipe(ke(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new oe(2806,!1);return c.body}));case"blob":return l.pipe(ke(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new oe(2807,!1);return c.body}));case"text":return l.pipe(ke(c=>{if(c.body!==null&&typeof c.body!="string")throw new oe(2808,!1);return c.body}));case"json":default:return l.pipe(ke(c=>c.body))}case"response":return l;default:throw new oe(2809,!1)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:new Cr().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,rC(r,i))}post(t,i,r={}){return this.request("POST",t,rC(r,i))}put(t,i,r={}){return this.request("PUT",t,rC(r,i))}static \u0275fac=function(i){return new(i||n)(te(fc))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})();var k5=new se("");function uR(n,e){return e(n)}function O5(n,e){return(t,i)=>e.intercept(t,{handle:r=>n(r,i)})}function N5(n,e,t){return(i,r)=>En(t,()=>e(i,o=>n(o,r)))}var fR=new se(""),sC=new se(""),pR=new se(""),aC=new se("",{providedIn:"root",factory:()=>!0});function L5(){let n=null;return(e,t)=>{n===null&&(n=(V(fR,{optional:!0})??[]).reduceRight(O5,uR));let i=V(Jd);if(V(aC)){let o=i.add();return n(e,t).pipe(Xo(o))}else return n(e,t)}}var Cm=(()=>{class n extends fc{backend;injector;chain=null;pendingTasks=V(Jd);contributeToStability=V(aC);constructor(t,i){super(),this.backend=t,this.injector=i}handle(t){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(sC),...this.injector.get(pR,[])]));this.chain=i.reduceRight((r,o)=>N5(r,o,this.injector),uR)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(Xo(i))}else return this.chain(t,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||n)(te(Du),te(zt))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})();var F5=/^\)\]\}',?\n/,z5=RegExp(`^${lR}:`,"m");function V5(n){return"responseURL"in n&&n.responseURL?n.responseURL:z5.test(n.getAllResponseHeaders())?n.getResponseHeader(lR):null}var oC=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new oe(-2800,!1);let i=this.xhrFactory;return ge(null).pipe(Sn(()=>new De(o=>{let s=i.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((M,P)=>s.setRequestHeader(M,P.join(","))),t.headers.has(sR)||s.setRequestHeader(sR,P5),!t.headers.has(oR)){let M=t.detectContentTypeHeader();M!==null&&s.setRequestHeader(oR,M)}if(t.timeout&&(s.timeout=t.timeout),t.responseType){let M=t.responseType.toLowerCase();s.responseType=M!=="json"?M:"text"}let l=t.serializeBody(),c=null,u=()=>{if(c!==null)return c;let M=s.statusText||"OK",P=new gs(s.getAllResponseHeaders()),U=V5(s)||t.url;return c=new Sm({headers:P,status:s.status,statusText:M,url:U}),c},f=()=>{let{headers:M,status:P,statusText:U,url:K}=u(),W=null;P!==R5&&(W=typeof s.response>"u"?s.responseText:s.response),P===0&&(P=W?A5:0);let re=P>=200&&P<300;if(t.responseType==="json"&&typeof W=="string"){let fe=W;W=W.replace(F5,"");try{W=W!==""?JSON.parse(W):null}catch(ce){W=fe,re&&(re=!1,W={error:ce,text:W})}}re?(o.next(new Iu({body:W,headers:M,status:P,statusText:U,url:K||void 0})),o.complete()):o.error(new uc({error:W,headers:M,status:P,statusText:U,url:K||void 0}))},m=M=>{let{url:P}=u(),U=new uc({error:M,status:s.status||0,statusText:s.statusText||"Unknown Error",url:P||void 0});o.error(U)},w=m;t.timeout&&(w=M=>{let{url:P}=u(),U=new uc({error:new DOMException("Request timed out","TimeoutError"),status:s.status||0,statusText:s.statusText||"Request timeout",url:P||void 0});o.error(U)});let b=!1,D=M=>{b||(o.next(u()),b=!0);let P={type:ba.DownloadProgress,loaded:M.loaded};M.lengthComputable&&(P.total=M.total),t.responseType==="text"&&s.responseText&&(P.partialText=s.responseText),o.next(P)},T=M=>{let P={type:ba.UploadProgress,loaded:M.loaded};M.lengthComputable&&(P.total=M.total),o.next(P)};return s.addEventListener("load",f),s.addEventListener("error",m),s.addEventListener("timeout",w),s.addEventListener("abort",m),t.reportProgress&&(s.addEventListener("progress",D),l!==null&&s.upload&&s.upload.addEventListener("progress",T)),s.send(l),o.next({type:ba.Sent}),()=>{s.removeEventListener("error",m),s.removeEventListener("abort",m),s.removeEventListener("load",f),s.removeEventListener("timeout",w),t.reportProgress&&(s.removeEventListener("progress",D),l!==null&&s.upload&&s.upload.removeEventListener("progress",T)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(i){return new(i||n)(te(ya))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),hR=new se(""),j5="XSRF-TOKEN",B5=new se("",{providedIn:"root",factory:()=>j5}),U5="X-XSRF-TOKEN",H5=new se("",{providedIn:"root",factory:()=>U5}),Mu=class{},W5=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,i){this.doc=t,this.cookieName=i}getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=wu(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(i){return new(i||n)(te(ot),te(B5))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})();function $5(n,e){let t=n.url.toLowerCase();if(!V(hR)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let i=V(Mu).getToken(),r=V(H5);return i!=null&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}var lC=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(lC||{});function q5(n,e){return{\u0275kind:n,\u0275providers:e}}function xm(...n){let e=[Em,oC,Cm,{provide:fc,useExisting:Cm},{provide:Du,useFactory:()=>V(k5,{optional:!0})??V(oC)},{provide:sC,useValue:$5,multi:!0},{provide:hR,useValue:!0},{provide:Mu,useClass:W5}];for(let t of n)e.push(...t.\u0275providers);return Wr(e)}var aR=new se("");function gR(){return q5(lC.LegacyInterceptors,[{provide:aR,useFactory:L5},{provide:sC,useExisting:aR,multi:!0}])}var cC=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=pn({type:n});static \u0275inj=nn({providers:[xm(gR())]})}return n})();var Dm=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(te(ot))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var je="primary",Bu=Symbol("RouteTitle"),hC=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Ca(n){return new hC(n)}function ER(n,e,t){let i=t.path.split("/");if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let r={};for(let o=0;o<i.length;o++){let s=i[o],l=n[o];if(s[0]===":")r[s.substring(1)]=l;else if(s!==l.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Z5(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!to(n[t],e[t]))return!1;return!0}function to(n,e){let t=n?gC(n):void 0,i=e?gC(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!xR(n[r],e[r]))return!1;return!0}function gC(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function xR(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}else return n===e}function DR(n){return n.length>0?n[n.length-1]:null}function Fo(n){return kh(n)?n:ps(n)?_t(Promise.resolve(n)):ge(n)}var Y5={exact:MR,subset:TR},IR={exact:Q5,subset:K5,ignored:()=>!0};function vR(n,e,t){return Y5[t.paths](n.root,e.root,t.matrixParams)&&IR[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Q5(n,e){return to(n,e)}function MR(n,e,t){if(!wa(n.segments,e.segments)||!Tm(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!MR(n.children[i],e.children[i],t))return!1;return!0}function K5(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>xR(n[t],e[t]))}function TR(n,e,t){return PR(n,e,e.segments,t)}function PR(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!wa(r,t)||e.hasChildren()||!Tm(r,t,i))}else if(n.segments.length===t.length){if(!wa(n.segments,t)||!Tm(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!TR(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!wa(n.segments,r)||!Tm(n.segments,r,i)||!n.children[je]?!1:PR(n.children[je],e,o,i)}}function Tm(n,e,t){return e.every((i,r)=>IR[t](n[r].parameters,i.parameters))}var no=class{root;queryParams;fragment;_queryParamMap;constructor(e=new it([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=Ca(this.queryParams),this._queryParamMap}toString(){return eH.serialize(this)}},it=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Pm(this)}},ms=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Ca(this.parameters),this._parameterMap}toString(){return RR(this)}};function J5(n,e){return wa(n,e)&&n.every((t,i)=>to(t.parameters,e[i].parameters))}function wa(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function X5(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===je&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==je&&(t=t.concat(e(r,i)))}),t}var Ea=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:()=>new vs,providedIn:"root"})}return n})(),vs=class{parse(e){let t=new vC(e);return new no(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Tu(e.root,!0)}`,i=iH(e.queryParams),r=typeof e.fragment=="string"?`#${tH(e.fragment)}`:"";return`${t}${i}${r}`}},eH=new vs;function Pm(n){return n.segments.map(e=>RR(e)).join("/")}function Tu(n,e){if(!n.hasChildren())return Pm(n);if(e){let t=n.children[je]?Tu(n.children[je],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==je&&i.push(`${r}:${Tu(o,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=X5(n,(i,r)=>r===je?[Tu(n.children[je],!1)]:[`${r}:${Tu(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[je]!=null?`${Pm(n)}/${t[0]}`:`${Pm(n)}/(${t.join("//")})`}}function AR(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Im(n){return AR(n).replace(/%3B/gi,";")}function tH(n){return encodeURI(n)}function mC(n){return AR(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Am(n){return decodeURIComponent(n)}function _R(n){return Am(n.replace(/\+/g,"%20"))}function RR(n){return`${mC(n.path)}${nH(n.parameters)}`}function nH(n){return Object.entries(n).map(([e,t])=>`;${mC(e)}=${mC(t)}`).join("")}function iH(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${Im(t)}=${Im(r)}`).join("&"):`${Im(t)}=${Im(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var rH=/^[^\/()?;#]+/;function dC(n){let e=n.match(rH);return e?e[0]:""}var oH=/^[^\/()?;=#]+/;function sH(n){let e=n.match(oH);return e?e[0]:""}var aH=/^[^=?&#]+/;function lH(n){let e=n.match(aH);return e?e[0]:""}var cH=/^[^&#]+/;function dH(n){let e=n.match(cH);return e?e[0]:""}var vC=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new it([],{}):new it([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[je]=new it(e,t)),i}parseSegment(){let e=dC(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new oe(4009,!1);return this.capture(e),new ms(Am(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=sH(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=dC(this.remaining);r&&(i=r,this.capture(i))}e[Am(t)]=Am(i)}parseQueryParam(e){let t=lH(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let s=dH(this.remaining);s&&(i=s,this.capture(i))}let r=_R(t),o=_R(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=dC(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new oe(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=je);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[je]:new it([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new oe(4011,!1)}};function kR(n){return n.segments.length>0?new it([],{[je]:n}):n}function OR(n){let e={};for(let[i,r]of Object.entries(n.children)){let o=OR(r);if(i===je&&o.segments.length===0&&o.hasChildren())for(let[s,l]of Object.entries(o.children))e[s]=l;else(o.segments.length>0||o.hasChildren())&&(e[i]=o)}let t=new it(n.segments,e);return uH(t)}function uH(n){if(n.numberOfChildren===1&&n.children[je]){let e=n.children[je];return new it(n.segments.concat(e.segments),e.children)}return n}function _s(n){return n instanceof no}function NR(n,e,t=null,i=null){let r=LR(n);return FR(r,e,t,i)}function LR(n){let e;function t(o){let s={};for(let c of o.children){let u=t(c);s[c.outlet]=u}let l=new it(o.url,s);return o===n&&(e=l),l}let i=t(n.root),r=kR(i);return e??r}function FR(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(e.length===0)return uC(r,r,r,t,i);let o=fH(e);if(o.toRoot())return uC(r,r,new it([],{}),t,i);let s=pH(o,r,n),l=s.processChildren?Au(s.segmentGroup,s.index,o.commands):VR(s.segmentGroup,s.index,o.commands);return uC(r,s.segmentGroup,l,t,i)}function Rm(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function ku(n){return typeof n=="object"&&n!=null&&n.outlets}function uC(n,e,t,i,r){let o={};i&&Object.entries(i).forEach(([c,u])=>{o[c]=Array.isArray(u)?u.map(f=>`${f}`):`${u}`});let s;n===e?s=t:s=zR(n,e,t);let l=kR(OR(s));return new no(l,o,r)}function zR(n,e,t){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===e?i[r]=t:i[r]=zR(o,e,t)}),new it(n.segments,i)}var km=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Rm(i[0]))throw new oe(4003,!1);let r=i.find(ku);if(r&&r!==DR(i))throw new oe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function fH(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new km(!0,0,n);let e=0,t=!1,i=n.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let l={};return Object.entries(o.outlets).forEach(([c,u])=>{l[c]=typeof u=="string"?u.split("/"):u}),[...r,{outlets:l}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((l,c)=>{c==0&&l==="."||(c==0&&l===""?t=!0:l===".."?e++:l!=""&&r.push(l))}),r):[...r,o]},[]);return new km(t,e,i)}var mc=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function pH(n,e,t){if(n.isAbsolute)return new mc(e,!0,0);if(!t)return new mc(e,!1,NaN);if(t.parent===null)return new mc(t,!0,0);let i=Rm(n.commands[0])?0:1,r=t.segments.length-1+i;return hH(t,r,n.numberOfDoubleDots)}function hH(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new oe(4005,!1);r=i.segments.length}return new mc(i,!1,r-o)}function gH(n){return ku(n[0])?n[0].outlets:{[je]:n}}function VR(n,e,t){if(n??=new it([],{}),n.segments.length===0&&n.hasChildren())return Au(n,e,t);let i=mH(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new it(n.segments.slice(0,i.pathIndex),{});return o.children[je]=new it(n.segments.slice(i.pathIndex),n.children),Au(o,0,r)}else return i.match&&r.length===0?new it(n.segments,{}):i.match&&!n.hasChildren()?_C(n,e,t):i.match?Au(n,0,r):_C(n,e,t)}function Au(n,e,t){if(t.length===0)return new it(n.segments,{});{let i=gH(t),r={};if(Object.keys(i).some(o=>o!==je)&&n.children[je]&&n.numberOfChildren===1&&n.children[je].segments.length===0){let o=Au(n.children[je],e,t);return new it(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=VR(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{i[o]===void 0&&(r[o]=s)}),new it(n.segments,r)}}function mH(n,e,t){let i=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;let s=n.segments[r],l=t[i];if(ku(l))break;let c=`${l}`,u=i<t.length-1?t[i+1]:null;if(r>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!bR(c,u,s))return o;i+=2}else{if(!bR(c,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function _C(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(ku(o)){let c=vH(o.outlets);return new it(i,c)}if(r===0&&Rm(t[0])){let c=n.segments[e];i.push(new ms(c.path,yR(t[0]))),r++;continue}let s=ku(o)?o.outlets[je]:`${o}`,l=r<t.length-1?t[r+1]:null;s&&l&&Rm(l)?(i.push(new ms(s,yR(l))),r+=2):(i.push(new ms(s,{})),r++)}return new it(i,{})}function vH(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=_C(new it([],{}),0,i))}),e}function yR(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function bR(n,e,t){return n==t.path&&to(e,t.parameters)}var vc="imperative",vn=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(vn||{}),Ri=class{id;url;constructor(e,t){this.id=e,this.url=t}},io=class extends Ri{type=vn.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},mn=class extends Ri{urlAfterRedirects;type=vn.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ri=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n}(ri||{}),yc=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(yc||{}),Gi=class extends Ri{reason;code;type=vn.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ro=class extends Ri{reason;code;type=vn.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}},ys=class extends Ri{error;target;type=vn.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ou=class extends Ri{urlAfterRedirects;state;type=vn.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Om=class extends Ri{urlAfterRedirects;state;type=vn.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nm=class extends Ri{urlAfterRedirects;state;shouldActivate;type=vn.GuardsCheckEnd;constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Lm=class extends Ri{urlAfterRedirects;state;type=vn.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Fm=class extends Ri{urlAfterRedirects;state;type=vn.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},zm=class{route;type=vn.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Vm=class{route;type=vn.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},jm=class{snapshot;type=vn.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Bm=class{snapshot;type=vn.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Um=class{snapshot;type=vn.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Hm=class{snapshot;type=vn.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},bc=class{routerEvent;position;anchor;type=vn.Scroll;constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Nu=class{},wc=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function _H(n){return!(n instanceof Nu)&&!(n instanceof wc)}function yH(n,e){return n.providers&&!n._injector&&(n._injector=lc(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Er(n){return n.outlet||je}function bH(n,e){let t=n.filter(i=>Er(i)===e);return t.push(...n.filter(i=>Er(i)!==e)),t}function Ec(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Wm=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Ec(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new xa(this.rootInjector)}},xa=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Wm(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(te(zt))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),$m=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=yC(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=yC(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=bC(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return bC(e,this._root).map(t=>t.value)}};function yC(n,e){if(n===e.value)return e;for(let t of e.children){let i=yC(n,t);if(i)return i}return null}function bC(n,e){if(n===e.value)return[e];for(let t of e.children){let i=bC(n,t);if(i.length)return i.unshift(e),i}return[]}var Ai=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function gc(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Lu=class extends $m{snapshot;constructor(e,t){super(e),this.snapshot=t,MC(this,e)}toString(){return this.snapshot.toString()}};function jR(n){let e=wH(n),t=new Zt([new ms("",{})]),i=new Zt({}),r=new Zt({}),o=new Zt({}),s=new Zt(""),l=new qt(t,i,o,s,r,je,n,e.root);return l.snapshot=e.root,new Lu(new Ai(l,[]),e)}function wH(n){let e={},t={},i={},r="",o=new Sa([],e,i,r,t,je,n,null,{});return new Fu("",new Ai(o,[]))}var qt=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,o,s,l,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=l,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(ke(u=>u[Bu]))??ge(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ke(e=>Ca(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ke(e=>Ca(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function qm(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:B(B({},e.params),n.params),data:B(B({},e.data),n.data),resolve:B(B(B(B({},n.data),e.data),r?.data),n._resolvedData)}:i={params:B({},n.params),data:B({},n.data),resolve:B(B({},n.data),n._resolvedData??{})},r&&UR(r)&&(i.resolve[Bu]=r.title),i}var Sa=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Bu]}constructor(e,t,i,r,o,s,l,c,u){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=l,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ca(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ca(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Fu=class extends $m{url;constructor(e,t){super(t),this.url=e,MC(this,t)}toString(){return BR(this._root)}};function MC(n,e){e.value._routerState=n,e.children.forEach(t=>MC(n,t))}function BR(n){let e=n.children.length>0?` { ${n.children.map(BR).join(", ")} } `:"";return`${n.value}${e}`}function fC(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,to(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),to(e.params,t.params)||n.paramsSubject.next(t.params),Z5(e.url,t.url)||n.urlSubject.next(t.url),to(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function wC(n,e){let t=to(n.params,e.params)&&J5(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||wC(n.parent,e.parent))}function UR(n){return typeof n.title=="string"||n.title===null}var HR=new se(""),Uu=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=je;activateEvents=new ye;deactivateEvents=new ye;attachEvents=new ye;detachEvents=new ye;routerOutletData=cA(void 0);parentContexts=V(xa);location=V(Ti);changeDetector=V(Pn);inputBinder=V(Hu,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new oe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new oe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new oe(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new oe(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,c=new SC(t,l,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:c,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ee({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Dn]})}return n})(),SC=class{route;childContexts;parent;outletData;constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===qt?this.route:e===xa?this.childContexts:e===HR?this.outletData:this.parent.get(e,t)}},Hu=new se(""),TC=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:i}=t,r=Ys([i.queryParams,i.params,i.data]).pipe(Sn(([o,s,l],c)=>(l=B(B(B({},o),s),l),c===0?ge(l):Promise.resolve(l)))).subscribe(o=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(t);return}let s=fA(i.component);if(!s){this.unsubscribeFromRouteData(t);return}for(let{templateName:l}of s.inputs)t.activatedComponentRef.setInput(l,o[l])});this.outletDataSubscriptions.set(t,r)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),PC=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=he({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&ie(0,"router-outlet")},dependencies:[Uu],encapsulation:2})}return n})();function AC(n){let e=n.children&&n.children.map(AC),t=e?ne(B({},n),{children:e}):B({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==je&&(t.component=PC),t}function SH(n,e,t){let i=zu(n,e._root,t?t._root:void 0);return new Lu(i,e)}function zu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=CH(n,e,t);return new Ai(i,r)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(l=>zu(n,l)),s}}let i=EH(e.value),r=e.children.map(o=>zu(n,o));return new Ai(i,r)}}function CH(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return zu(n,i,r);return zu(n,i)})}function EH(n){return new qt(new Zt(n.url),new Zt(n.params),new Zt(n.queryParams),new Zt(n.fragment),new Zt(n.data),n.outlet,n.component,n)}var Sc=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},WR="ngNavigationCancelingError";function Gm(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=_s(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=$R(!1,ri.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function $R(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[WR]=!0,t.cancellationCode=e,t}function xH(n){return qR(n)&&_s(n.url)}function qR(n){return!!n&&n[WR]}var DH=(n,e,t,i)=>ke(r=>(new CC(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)),CC=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),fC(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=gc(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=gc(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){let s=i.outlet.detach(),l=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:l})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=gc(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=gc(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new Hm(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Bm(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,o=t?t.value:null;if(fC(r),r===o)if(r.component){let s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let l=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(l.contexts),s.attachRef=l.componentRef,s.route=l.route.value,s.outlet&&s.outlet.attach(l.componentRef,l.route.value),fC(l.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,i)}},Zm=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},_c=class{component;route;constructor(e,t){this.component=e,this.route=t}};function IH(n,e,t){let i=n._root,r=e?e._root:null;return Pu(i,r,t,[i.value])}function MH(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function xc(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!Jy(n)?n:e.get(n):i}function Pu(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=gc(e);return n.children.forEach(s=>{TH(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,l])=>Ru(l,t.getContext(s),r)),r}function TH(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,l=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=PH(s,o,o.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new Zm(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Pu(n,e,l?l.children:null,i,r):Pu(n,e,t,i,r),c&&l&&l.outlet&&l.outlet.isActivated&&r.canDeactivateChecks.push(new _c(l.outlet.component,s))}else s&&Ru(e,l,r),r.canActivateChecks.push(new Zm(i)),o.component?Pu(n,null,l?l.children:null,i,r):Pu(n,null,t,i,r);return r}function PH(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!wa(n.url,e.url);case"pathParamsOrQueryParamsChange":return!wa(n.url,e.url)||!to(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!wC(n,e)||!to(n.queryParams,e.queryParams);case"paramsChange":default:return!wC(n,e)}}function Ru(n,e,t){let i=gc(n),r=n.value;Object.entries(i).forEach(([o,s])=>{r.component?e?Ru(s,e.children.getContext(o),t):Ru(s,null,t):Ru(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new _c(e.outlet.component,r)):t.canDeactivateChecks.push(new _c(null,r)):t.canDeactivateChecks.push(new _c(null,r))}function Wu(n){return typeof n=="function"}function AH(n){return typeof n=="boolean"}function RH(n){return n&&Wu(n.canLoad)}function kH(n){return n&&Wu(n.canActivate)}function OH(n){return n&&Wu(n.canActivateChild)}function NH(n){return n&&Wu(n.canDeactivate)}function LH(n){return n&&Wu(n.canMatch)}function GR(n){return n instanceof Eo||n?.name==="EmptyError"}var Mm=Symbol("INITIAL_VALUE");function Cc(){return Sn(n=>Ys(n.map(e=>e.pipe(cr(1),dr(Mm)))).pipe(ke(e=>{for(let t of e)if(t!==!0){if(t===Mm)return Mm;if(t===!1||FH(t))return t}return!0}),wn(e=>e!==Mm),cr(1)))}function FH(n){return _s(n)||n instanceof Sc}function zH(n,e){return Yt(t=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?ge(ne(B({},t),{guardsResult:!0})):VH(s,i,r,n).pipe(Yt(l=>l&&AH(l)?jH(i,o,n,e):ge(l)),ke(l=>ne(B({},t),{guardsResult:l})))})}function VH(n,e,t,i){return _t(n).pipe(Yt(r=>$H(r.component,r.route,t,e,i)),Do(r=>r!==!0,!0))}function jH(n,e,t,i){return _t(e).pipe(Br(r=>Vl(UH(r.route.parent,i),BH(r.route,i),WH(n,r.path,t),HH(n,r.route,t))),Do(r=>r!==!0,!0))}function BH(n,e){return n!==null&&e&&e(new Um(n)),ge(!0)}function UH(n,e){return n!==null&&e&&e(new jm(n)),ge(!0)}function HH(n,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return ge(!0);let r=i.map(o=>kd(()=>{let s=Ec(e)??t,l=xc(o,s),c=kH(l)?l.canActivate(e,n):En(s,()=>l(e,n));return Fo(c).pipe(Do())}));return ge(r).pipe(Cc())}function WH(n,e,t){let i=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>MH(s)).filter(s=>s!==null).map(s=>kd(()=>{let l=s.guards.map(c=>{let u=Ec(s.node)??t,f=xc(c,u),m=OH(f)?f.canActivateChild(i,n):En(u,()=>f(i,n));return Fo(m).pipe(Do())});return ge(l).pipe(Cc())}));return ge(o).pipe(Cc())}function $H(n,e,t,i,r){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return ge(!0);let s=o.map(l=>{let c=Ec(e)??r,u=xc(l,c),f=NH(u)?u.canDeactivate(n,e,t,i):En(c,()=>u(n,e,t,i));return Fo(f).pipe(Do())});return ge(s).pipe(Cc())}function qH(n,e,t,i){let r=e.canLoad;if(r===void 0||r.length===0)return ge(!0);let o=r.map(s=>{let l=xc(s,n),c=RH(l)?l.canLoad(e,t):En(n,()=>l(e,t));return Fo(c)});return ge(o).pipe(Cc(),ZR(i))}function ZR(n){return My(tn(e=>{if(typeof e!="boolean")throw Gm(n,e)}),ke(e=>e===!0))}function GH(n,e,t,i){let r=e.canMatch;if(!r||r.length===0)return ge(!0);let o=r.map(s=>{let l=xc(s,n),c=LH(l)?l.canMatch(e,t):En(n,()=>l(e,t));return Fo(c)});return ge(o).pipe(Cc(),ZR(i))}var Vu=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},ju=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function hc(n){return zl(new Vu(n))}function ZH(n){return zl(new oe(4e3,!1))}function YH(n){return zl($R(!1,ri.GuardRejected))}var EC=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return ge(i);if(r.numberOfChildren>1||!r.children[je])return ZH(`${e.redirectTo}`);r=r.children[je]}}applyRedirectCommands(e,t,i,r,o){return QH(t,r,o).pipe(ke(s=>{if(s instanceof no)throw new ju(s);let l=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,i);if(s[0]==="/")throw new ju(l);return l}))}applyRedirectCreateUrlTree(e,t,i,r){let o=this.createSegmentGroup(e,t.root,i,r);return new no(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let l=o.substring(1);i[r]=t[l]}else i[r]=o}),i}createSegmentGroup(e,t,i,r){let o=this.createSegments(e,t.segments,i,r),s={};return Object.entries(t.children).forEach(([l,c])=>{s[l]=this.createSegmentGroup(e,c,i,r)}),new it(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new oe(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}};function QH(n,e,t){if(typeof n=="string")return ge(n);let i=n,{queryParams:r,fragment:o,routeConfig:s,url:l,outlet:c,params:u,data:f,title:m}=e;return Fo(En(t,()=>i({params:u,data:f,queryParams:r,fragment:o,routeConfig:s,url:l,outlet:c,title:m})))}var xC={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function KH(n,e,t,i,r){let o=YR(n,e,t);return o.matched?(i=yH(e,i),GH(i,e,t,r).pipe(ke(s=>s===!0?o:B({},xC)))):ge(o)}function YR(n,e,t){if(e.path==="**")return JH(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?B({},xC):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||ER)(t,n,e);if(!r)return B({},xC);let o={};Object.entries(r.posParams??{}).forEach(([l,c])=>{o[l]=c.path});let s=r.consumed.length>0?B(B({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function JH(n){return{matched:!0,parameters:n.length>0?DR(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function wR(n,e,t,i){return t.length>0&&t6(n,t,i)?{segmentGroup:new it(e,e6(i,new it(t,n.children))),slicedSegments:[]}:t.length===0&&n6(n,t,i)?{segmentGroup:new it(n.segments,XH(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new it(n.segments,n.children),slicedSegments:t}}function XH(n,e,t,i){let r={};for(let o of t)if(Qm(n,e,o)&&!i[Er(o)]){let s=new it([],{});r[Er(o)]=s}return B(B({},i),r)}function e6(n,e){let t={};t[je]=e;for(let i of n)if(i.path===""&&Er(i)!==je){let r=new it([],{});t[Er(i)]=r}return t}function t6(n,e,t){return t.some(i=>Qm(n,e,i)&&Er(i)!==je)}function n6(n,e,t){return t.some(i=>Qm(n,e,i))}function Qm(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function i6(n,e,t){return e.length===0&&!n.children[t]}var DC=class{};function r6(n,e,t,i,r,o,s="emptyOnly"){return new IC(n,e,t,i,r,s,o).recognize()}var o6=31,IC=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,o,s,l){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=l,this.applyRedirects=new EC(this.urlSerializer,this.urlTree)}noMatchError(e){return new oe(4002,`'${e.segmentGroup}'`)}recognize(){let e=wR(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ke(({children:t,rootSnapshot:i})=>{let r=new Ai(i,t),o=new Fu("",r),s=NR(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new Sa([],Object.freeze({}),Object.freeze(B({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),je,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,je,t).pipe(ke(i=>({children:i,rootSnapshot:t})),xo(i=>{if(i instanceof ju)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Vu?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,r,o){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i,o):this.processSegment(e,t,i,i.segments,r,!0,o).pipe(ke(s=>s instanceof Ai?[s]:[]))}processChildren(e,t,i,r){let o=[];for(let s of Object.keys(i.children))s==="primary"?o.unshift(s):o.push(s);return _t(o).pipe(Br(s=>{let l=i.children[s],c=bH(t,s);return this.processSegmentGroup(e,c,l,s,r)}),Fy((s,l)=>(s.push(...l),s)),Jo(null),Ly(),Yt(s=>{if(s===null)return hc(i);let l=QR(s);return s6(l),ge(l)}))}processSegment(e,t,i,r,o,s,l){return _t(t).pipe(Br(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,i,r,o,s,l).pipe(xo(u=>{if(u instanceof Vu)return ge(null);throw u}))),Do(c=>!!c),xo(c=>{if(GR(c))return i6(i,r,o)?ge(new DC):hc(i);throw c}))}processSegmentAgainstRoute(e,t,i,r,o,s,l,c){return Er(i)!==s&&(s===je||!Qm(r,o,i))?hc(r):i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,o,s,c):this.allowRedirects&&l?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,o,s,c):hc(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s,l){let{matched:c,parameters:u,consumedSegments:f,positionalParamSegments:m,remainingSegments:w}=YR(t,r,o);if(!c)return hc(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>o6&&(this.allowRedirects=!1));let b=new Sa(o,u,Object.freeze(B({},this.urlTree.queryParams)),this.urlTree.fragment,SR(r),Er(r),r.component??r._loadedComponent??null,r,CR(r)),D=qm(b,l,this.paramsInheritanceStrategy);return b.params=Object.freeze(D.params),b.data=Object.freeze(D.data),this.applyRedirects.applyRedirectCommands(f,r.redirectTo,m,b,e).pipe(Sn(M=>this.applyRedirects.lineralizeSegments(r,M)),Yt(M=>this.processSegment(e,i,t,M.concat(w),s,!1,l)))}matchSegmentAgainstRoute(e,t,i,r,o,s){let l=KH(t,i,r,e,this.urlSerializer);return i.path==="**"&&(t.children={}),l.pipe(Sn(c=>c.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(Sn(({routes:u})=>{let f=i._loadedInjector??e,{parameters:m,consumedSegments:w,remainingSegments:b}=c,D=new Sa(w,m,Object.freeze(B({},this.urlTree.queryParams)),this.urlTree.fragment,SR(i),Er(i),i.component??i._loadedComponent??null,i,CR(i)),T=qm(D,s,this.paramsInheritanceStrategy);D.params=Object.freeze(T.params),D.data=Object.freeze(T.data);let{segmentGroup:M,slicedSegments:P}=wR(t,w,b,u);if(P.length===0&&M.hasChildren())return this.processChildren(f,u,M,D).pipe(ke(K=>new Ai(D,K)));if(u.length===0&&P.length===0)return ge(new Ai(D,[]));let U=Er(i)===o;return this.processSegment(f,u,M,P,U?je:o,!0,D).pipe(ke(K=>new Ai(D,K instanceof Ai?[K]:[])))}))):hc(t)))}getChildConfig(e,t,i){return t.children?ge({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ge({routes:t._loadedRoutes,injector:t._loadedInjector}):qH(e,t,i,this.urlSerializer).pipe(Yt(r=>r?this.configLoader.loadChildren(e,t).pipe(tn(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):YH(t))):ge({routes:[],injector:e})}};function s6(n){n.sort((e,t)=>e.value.outlet===je?-1:t.value.outlet===je?1:e.value.outlet.localeCompare(t.value.outlet))}function a6(n){let e=n.value.routeConfig;return e&&e.path===""}function QR(n){let e=[],t=new Set;for(let i of n){if(!a6(i)){e.push(i);continue}let r=e.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=QR(i.children);e.push(new Ai(i.value,r))}return e.filter(i=>!t.has(i))}function SR(n){return n.data||{}}function CR(n){return n.resolve||{}}function l6(n,e,t,i,r,o){return Yt(s=>r6(n,e,t,i,s.extractedUrl,r,o).pipe(ke(({state:l,tree:c})=>ne(B({},s),{targetSnapshot:l,urlAfterRedirects:c}))))}function c6(n,e){return Yt(t=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return ge(t);let o=new Set(r.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let u of KR(c))s.add(u);let l=0;return _t(s).pipe(Br(c=>o.has(c)?d6(c,i,n,e):(c.data=qm(c,c.parent,n).resolve,ge(void 0))),tn(()=>l++),Bl(1),Yt(c=>l===s.size?ge(t):Vn))})}function KR(n){let e=n.children.map(t=>KR(t)).flat();return[n,...e]}function d6(n,e,t,i){let r=n.routeConfig,o=n._resolve;return r?.title!==void 0&&!UR(r)&&(o[Bu]=r.title),kd(()=>(n.data=qm(n,n.parent,t).resolve,u6(o,n,e,i).pipe(ke(s=>(n._resolvedData=s,n.data=B(B({},n.data),s),null)))))}function u6(n,e,t,i){let r=gC(n);if(r.length===0)return ge({});let o={};return _t(r).pipe(Yt(s=>f6(n[s],e,t,i).pipe(Do(),tn(l=>{if(l instanceof Sc)throw Gm(new vs,l);o[s]=l}))),Bl(1),ke(()=>o),xo(s=>GR(s)?Vn:zl(s)))}function f6(n,e,t,i){let r=Ec(e)??i,o=xc(n,r),s=o.resolve?o.resolve(e,t):En(r,()=>o(e,t));return Fo(s)}function pC(n){return Sn(e=>{let t=n(e);return t?_t(t).pipe(ke(()=>e)):ge(e)})}var RC=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===je);return i}getResolvedTitleForRoute(t){return t.data[Bu]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:()=>V(JR),providedIn:"root"})}return n})(),JR=(()=>{class n extends RC{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(te(Dm))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),bs=new se("",{providedIn:"root",factory:()=>({})}),Da=new se(""),Km=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=V(yS);loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return ge(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=Fo(En(t,()=>i.loadComponent())).pipe(ke(ek),tn(s=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s}),Xo(()=>{this.componentLoaders.delete(i)})),o=new kl(r,()=>new _e).pipe(Rl());return this.componentLoaders.set(i,o),o}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ge({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=XR(i,this.compiler,t,this.onLoadEndListener).pipe(Xo(()=>{this.childrenLoaders.delete(i)})),s=new kl(o,()=>new _e).pipe(Rl());return this.childrenLoaders.set(i,s),s}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function XR(n,e,t,i){return Fo(En(t,()=>n.loadChildren())).pipe(ke(ek),Yt(r=>r instanceof Gg||Array.isArray(r)?ge(r):_t(e.compileModuleAsync(r))),ke(r=>{i&&i(n);let o,s,l=!1;return Array.isArray(r)?(s=r,l=!0):(o=r.create(t).injector,s=o.get(Da,[],{optional:!0,self:!0}).flat()),{routes:s.map(AC),injector:o}}))}function p6(n){return n&&typeof n=="object"&&"default"in n}function ek(n){return p6(n)?n.default:n}var Jm=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:()=>V(h6),providedIn:"root"})}return n})(),h6=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),kC=new se(""),OC=new se("");function tk(n,e,t){let i=n.get(OC),r=n.get(ot);if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,new Promise(u=>setTimeout(u));let o,s=new Promise(u=>{o=u}),l=r.startViewTransition(()=>(o(),g6(n)));l.ready.catch(u=>{});let{onViewTransitionCreated:c}=i;return c&&En(n,()=>c({transition:l,from:e,to:t})),s}function g6(n){return new Promise(e=>{fs({read:()=>setTimeout(e)},{injector:n})})}var NC=new se(""),Xm=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new _e;transitionAbortWithErrorSubject=new _e;configLoader=V(Km);environmentInjector=V(zt);destroyRef=V(Ii);urlSerializer=V(Ea);rootContexts=V(xa);location=V(eo);inputBindingEnabled=V(Hu,{optional:!0})!==null;titleStrategy=V(RC);options=V(bs,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=V(Jm);createViewTransition=V(kC,{optional:!0});navigationErrorHandler=V(NC,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>ge(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new zm(r)),i=r=>this.events.next(new Vm(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;this.transitions?.next(ne(B({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:i}))}setupNavigations(t){return this.transitions=new Zt(null),this.transitions.pipe(wn(i=>i!==null),Sn(i=>{let r=!1;return ge(i).pipe(Sn(o=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",ri.SupersededByNewNavigation),Vn;this.currentTransition=i,this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?ne(B({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>o.abortController.abort()};let s=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),l=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!s&&l!=="reload"){let c="";return this.events.next(new ro(o.id,this.urlSerializer.serialize(o.rawUrl),c,yc.IgnoredSameUrlNavigation)),o.resolve(!1),Vn}if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return ge(o).pipe(Sn(c=>(this.events.next(new io(c.id,this.urlSerializer.serialize(c.extractedUrl),c.source,c.restoredState)),c.id!==this.navigationId?Vn:Promise.resolve(c))),l6(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),tn(c=>{i.targetSnapshot=c.targetSnapshot,i.urlAfterRedirects=c.urlAfterRedirects,this.currentNavigation=ne(B({},this.currentNavigation),{finalUrl:c.urlAfterRedirects});let u=new Ou(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}));if(s&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:c,extractedUrl:u,source:f,restoredState:m,extras:w}=o,b=new io(c,this.urlSerializer.serialize(u),f,m);this.events.next(b);let D=jR(this.rootComponentType).snapshot;return this.currentTransition=i=ne(B({},o),{targetSnapshot:D,urlAfterRedirects:u,extras:ne(B({},w),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=u,ge(i)}else{let c="";return this.events.next(new ro(o.id,this.urlSerializer.serialize(o.extractedUrl),c,yc.IgnoredByUrlHandlingStrategy)),o.resolve(!1),Vn}}),tn(o=>{let s=new Om(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(s)}),ke(o=>(this.currentTransition=i=ne(B({},o),{guards:IH(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),i)),zH(this.environmentInjector,o=>this.events.next(o)),tn(o=>{if(i.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Gm(this.urlSerializer,o.guardsResult);let s=new Nm(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(s)}),wn(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",ri.GuardRejected),!1)),pC(o=>{if(o.guards.canActivateChecks.length!==0)return ge(o).pipe(tn(s=>{let l=new Lm(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(l)}),Sn(s=>{let l=!1;return ge(s).pipe(c6(this.paramsInheritanceStrategy,this.environmentInjector),tn({next:()=>l=!0,complete:()=>{l||this.cancelNavigationTransition(s,"",ri.NoDataFromResolver)}}))}),tn(s=>{let l=new Fm(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(l)}))}),pC(o=>{let s=l=>{let c=[];if(l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent){let u=Ec(l)??this.environmentInjector;c.push(this.configLoader.loadComponent(u,l.routeConfig).pipe(tn(f=>{l.component=f}),ke(()=>{})))}for(let u of l.children)c.push(...s(u));return c};return Ys(s(o.targetSnapshot.root)).pipe(Jo(null),cr(1))}),pC(()=>this.afterPreactivation()),Sn(()=>{let{currentSnapshot:o,targetSnapshot:s}=i,l=this.createViewTransition?.(this.environmentInjector,o.root,s.root);return l?_t(l).pipe(ke(()=>i)):ge(i)}),ke(o=>{let s=SH(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=i=ne(B({},o),{targetRouterState:s}),this.currentNavigation.targetRouterState=s,i}),tn(()=>{this.events.next(new Nu)}),DH(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),cr(1),Kn(new De(o=>{let s=i.abortController.signal,l=()=>o.next();return s.addEventListener("abort",l),()=>s.removeEventListener("abort",l)}).pipe(wn(()=>!r&&!i.targetRouterState),tn(()=>{this.cancelNavigationTransition(i,i.abortController.signal.reason+"",ri.Aborted)}))),tn({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new mn(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),Kn(this.transitionAbortWithErrorSubject.pipe(tn(o=>{throw o}))),Xo(()=>{r||this.cancelNavigationTransition(i,"",ri.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation=null,this.currentTransition=null)}),xo(o=>{if(this.destroyed)return i.resolve(!1),Vn;if(r=!0,qR(o))this.events.next(new Gi(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode)),xH(o)?this.events.next(new wc(o.url,o.navigationBehaviorOptions)):i.resolve(!1);else{let s=new ys(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);try{let l=En(this.environmentInjector,()=>this.navigationErrorHandler?.(s));if(l instanceof Sc){let{message:c,cancellationCode:u}=Gm(this.urlSerializer,l);this.events.next(new Gi(i.id,this.urlSerializer.serialize(i.extractedUrl),c,u)),this.events.next(new wc(l.redirectTo,l.navigationBehaviorOptions))}else throw this.events.next(s),o}catch(l){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(l)}}return Vn}))}))}cancelNavigationTransition(t,i,r){let o=new Gi(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function m6(n){return n!==vc}var nk=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:()=>V(v6),providedIn:"root"})}return n})(),Ym=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},v6=(()=>{class n extends Ym{static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ik=(()=>{class n{urlSerializer=V(Ea);options=V(bs,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=V(eo);urlHandlingStrategy=V(Jm);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new no;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,s=r??o;return s instanceof no?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:r}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=t):this.rawUrlTree=r}routerState=jR(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:()=>V(_6),providedIn:"root"})}return n})(),_6=(()=>{class n extends ik{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof io?this.updateStateMemento():t instanceof ro?this.commitTransition(i):t instanceof Ou?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Nu?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Gi&&t.code!==ri.SupersededByNewNavigation&&t.code!==ri.Redirect?this.restoreHistory(i):t instanceof ys?this.restoreHistory(i,!0):t instanceof mn&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:r}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(t)||o){let l=this.browserPageId,c=B(B({},s),this.generateNgRouterState(r,l));this.location.replaceState(t,"",c)}else{let l=B(B({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",l)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ev(n,e){n.events.pipe(wn(t=>t instanceof mn||t instanceof Gi||t instanceof ys||t instanceof ro),ke(t=>t instanceof mn||t instanceof ro?0:(t instanceof Gi?t.code===ri.Redirect||t.code===ri.SupersededByNewNavigation:!1)?2:1),wn(t=>t!==2),cr(1)).subscribe(()=>{e()})}var y6={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},b6={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},We=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=V(fS);stateManager=V(ik);options=V(bs,{optional:!0})||{};pendingTasks=V(Qr);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=V(Xm);urlSerializer=V(Ea);location=V(eo);urlHandlingStrategy=V(Jm);injector=V(zt);_events=new _e;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=V(nk);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=V(Da,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!V(Hu,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new et;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Gi&&i.code!==ri.Redirect&&i.code!==ri.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof mn)this.navigated=!0;else if(i instanceof wc){let s=i.navigationBehaviorOptions,l=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),c=B({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||m6(r.source)},s);this.scheduleNavigation(l,vc,null,c,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}_H(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),vc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,r)=>{this.navigateToSyncWithBrowser(t,r,i)})}navigateToSyncWithBrowser(t,i,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let c=B({},r);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let l=this.parseUrl(t);this.scheduleNavigation(l,i,s,o).catch(c=>{this.disposed||this.injector.get(ni)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(AC),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:l,preserveFragment:c}=i,u=c?this.currentUrlTree.fragment:s,f=null;switch(l??this.options.defaultQueryParamsHandling){case"merge":f=B(B({},this.currentUrlTree.queryParams),o);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=o||null}f!==null&&(f=this.removeEmptyProps(f));let m;try{let w=r?r.snapshot:this.routerState.snapshot.root;m=LR(w)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),m=this.currentUrlTree.root}return FR(m,t,f,u??null)}navigateByUrl(t,i={skipLocationChange:!1}){let r=_s(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,vc,null,i)}navigate(t,i={skipLocationChange:!1}){return w6(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=B({},y6):i===!1?r=B({},b6):r=i,_s(t))return vR(this.currentUrlTree,t,r);let o=this.parseUrl(t);return vR(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(t,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let l,c,u;s?(l=s.resolve,c=s.reject,u=s.promise):u=new Promise((m,w)=>{l=m,c=w});let f=this.pendingTasks.add();return ev(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:l,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(m=>Promise.reject(m))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function w6(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new oe(4008,!1)}var sn=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=Un(null);get href(){return gi(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new _e;applicationErrorHandler=V(ni);options=V(bs,{optional:!0});constructor(t,i,r,o,s,l){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=l,this.reactiveHref.set(V(new em("href"),{optional:!0}));let c=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area"||!!(typeof customElements=="object"&&customElements.get(c)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let t=this.preserveFragment,i=r=>r==="merge"||r==="preserve";t||=i(this.queryParamsHandling),t||=!this.queryParamsHandling&&!i(this.options?.defaultQueryParamsHandling),t&&(this.subscription=this.router.events.subscribe(r=>{r instanceof mn&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(_s(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,o,s){let l=this.urlTree;if(l===null||this.isAnchorElement&&(t!==0||i||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(l,c)?.catch(u=>{this.applicationErrorHandler(u)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,t,i):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:_s(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(z(We),z(qt),su("tabindex"),z(Wn),z(ft),z(yr))};static \u0275dir=Ee({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&F("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),i&2&&hn("href",r.reactiveHref(),Vw)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",An],skipLocationChange:[2,"skipLocationChange","skipLocationChange",An],replaceUrl:[2,"replaceUrl","replaceUrl",An],routerLink:"routerLink"},features:[Dn]})}return n})(),FC=(()=>{class n{router;element;renderer;cdr;link;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new ye;constructor(t,i,r,o,s){this.router=t,this.element=i,this.renderer=r,this.cdr=o,this.link=s,this.routerEventsSubscription=t.events.subscribe(l=>{l instanceof mn&&this.update()})}ngAfterContentInit(){ge(this.links.changes,ge(null)).pipe(jr()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let t=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=_t(t).pipe(jr()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(t){let i=Array.isArray(t)?t:t.split(" ");this.classes=i.filter(r=>!!r)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let t=this.hasActiveLinks();this.classes.forEach(i=>{t?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),t&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.isActiveChange.emit(t))})}isLinkActive(t){let i=S6(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>{let o=r.urlTree;return o?t.isActive(o,i):!1}}hasActiveLinks(){let t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static \u0275fac=function(i){return new(i||n)(z(We),z(ft),z(Wn),z(Pn),z(sn,8))};static \u0275dir=Ee({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(i,r,o){if(i&1&&gn(o,sn,5),i&2){let s;jt(s=Bt())&&(r.links=s)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[Dn]})}return n})();function S6(n){return!!n.paths}var $u=class{};var rk=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(t,i,r,o){this.router=t,this.injector=i,this.preloadingStrategy=r,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(wn(t=>t instanceof mn),Br(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){let r=[];for(let o of i){o.providers&&!o._injector&&(o._injector=lc(o.providers,t,`Route: ${o.path}`));let s=o._injector??t,l=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&r.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&r.push(this.processRoutes(l,o.children??o._loadedRoutes))}return _t(r).pipe(jr())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;i.loadChildren&&i.canLoad===void 0?r=this.loader.loadChildren(t,i):r=ge(null);let o=r.pipe(Yt(s=>s===null?ge(void 0):(i._loadedRoutes=s.routes,i._loadedInjector=s.injector,this.processRoutes(s.injector??t,s.routes))));if(i.loadComponent&&!i._loadedComponent){let s=this.loader.loadComponent(t,i);return _t([o,s]).pipe(jr())}else return o})}static \u0275fac=function(i){return new(i||n)(te(We),te(zt),te($u),te(Km))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ok=new se(""),C6=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource=vc;restoredId=0;store={};constructor(t,i,r,o,s={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=o,this.options=s,s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof io?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof mn?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof ro&&t.code===yc.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof bc&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>C(this,null,function*(){yield new Promise(r=>{setTimeout(r),typeof requestAnimationFrame<"u"&&requestAnimationFrame(r)}),this.zone.run(()=>{this.transitions.events.next(new bc(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(i){nS()};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})();function zC(n,...e){return Wr([{provide:Da,multi:!0,useValue:n},[],{provide:qt,useFactory:sk,deps:[We]},{provide:du,multi:!0,useFactory:ak},e.map(t=>t.\u0275providers)])}function sk(n){return n.routerState.root}function qu(n,e){return{\u0275kind:n,\u0275providers:e}}function ak(){let n=V(un);return e=>{let t=n.get(Hi);if(e!==t.components[0])return;let i=n.get(We),r=n.get(lk);n.get(VC)===1&&i.initialNavigation(),n.get(uk,null,{optional:!0})?.setUpPreloading(),n.get(ok,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var lk=new se("",{factory:()=>new _e}),VC=new se("",{providedIn:"root",factory:()=>1});function ck(){let n=[{provide:VC,useValue:0},Yg(()=>{let e=V(un);return e.get(NS,Promise.resolve()).then(()=>new Promise(i=>{let r=e.get(We),o=e.get(lk);ev(r,()=>{i(!0)}),e.get(Xm).afterPreactivation=()=>(i(!0),o.closed?ge(void 0):o),r.initialNavigation()}))})];return qu(2,n)}function dk(){let n=[Yg(()=>{V(We).setUpLocationChangeListener()}),{provide:VC,useValue:2}];return qu(3,n)}var uk=new se("");function fk(n){return qu(0,[{provide:uk,useExisting:rk},{provide:$u,useExisting:n}])}function pk(){return qu(8,[TC,{provide:Hu,useExisting:TC}])}function hk(n){fa("NgRouterViewTransitions");let e=[{provide:kC,useValue:tk},{provide:OC,useValue:B({skipNextTransition:!!n?.skipInitialTransition},n)}];return qu(9,e)}var gk=[eo,{provide:Ea,useClass:vs},We,xa,{provide:qt,useFactory:sk,deps:[We]},Km,[]],bt=(()=>{class n{constructor(){}static forRoot(t,i){return{ngModule:n,providers:[gk,[],{provide:Da,multi:!0,useValue:t},[],i?.errorHandler?{provide:NC,useValue:i.errorHandler}:[],{provide:bs,useValue:i||{}},i?.useHash?x6():D6(),E6(),i?.preloadingStrategy?fk(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?I6(i):[],i?.bindToComponentInputs?pk().\u0275providers:[],i?.enableViewTransitions?hk().\u0275providers:[],M6()]}}static forChild(t){return{ngModule:n,providers:[{provide:Da,multi:!0,useValue:t}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=pn({type:n});static \u0275inj=nn({})}return n})();function E6(){return{provide:ok,useFactory:()=>{let n=V(qA),e=V(ut),t=V(bs),i=V(Xm),r=V(Ea);return t.scrollOffset&&n.setOffset(t.scrollOffset),new C6(r,i,n,e,t)}}}function x6(){return{provide:yr,useClass:US}}function D6(){return{provide:yr,useClass:om}}function I6(n){return[n.initialNavigation==="disabled"?dk().\u0275providers:[],n.initialNavigation==="enabledBlocking"?ck().\u0275providers:[]]}var LC=new se("");function M6(){return[{provide:LC,useFactory:ak},{provide:du,multi:!0,useExisting:LC}]}var mk=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>import("./chunk-N2HYM3BR.js").then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)};var Gu=class extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}},tv=class extends Gu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}},Zu=class extends Gu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}},Yu=class extends Gu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}},jC=function(n){return n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2",n}(jC||{});var T6=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(f){try{u(i.next(f))}catch(m){s(m)}}function c(f){try{u(i.throw(f))}catch(m){s(m)}}function u(f){f.done?o(f.value):r(f.value).then(l,c)}u((i=i.apply(n,e||[])).next())})},Qu=class{constructor(e,{headers:t={},customFetch:i,region:r=jC.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=mk(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var i;return T6(this,void 0,void 0,function*(){try{let{headers:r,method:o,body:s}=t,l={},{region:c}=t;c||(c=this.region);let u=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let f;s&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",f=s):typeof s=="string"?(l["Content-Type"]="text/plain",f=s):typeof FormData<"u"&&s instanceof FormData?f=s:(l["Content-Type"]="application/json",f=JSON.stringify(s)));let m=yield this.fetch(u.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),r),body:f}).catch(T=>{throw new tv(T)}),w=m.headers.get("x-relay-error");if(w&&w==="true")throw new Zu(m);if(!m.ok)throw new Yu(m);let b=((i=m.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),D;return b==="application/json"?D=yield m.json():b==="application/octet-stream"?D=yield m.blob():b==="text/event-stream"?D=m:b==="multipart/form-data"?D=yield m.formData():D=yield m.text(),{data:D,error:null,response:m}}catch(r){return{data:null,error:r,response:r instanceof Yu||r instanceof Zu?r.context:void 0}}})}};var Tk=gy(Mk(),1),{PostgrestClient:Pk,PostgrestQueryBuilder:ave,PostgrestFilterBuilder:lve,PostgrestTransformBuilder:cve,PostgrestBuilder:dve,PostgrestError:B6}=Tk.default;var JC=class{static dynamicRequire(e){try{return typeof process<"u"&&process.versions&&process.versions.node&&typeof hy<"u"?hy(e):null}catch{return null}}static detectEnvironment(){var e,t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){let i=parseInt(process.versions.node.split(".")[0]);if(i>=22)try{if(typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};let r=this.dynamicRequire("undici");if(r&&r.WebSocket)return{type:"native",constructor:r.WebSocket};throw new Error("undici not available")}catch{return{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:'Install the "ws" package or check your Node.js installation.'}}try{let r=this.dynamicRequire("ws");if(r)return{type:"ws",constructor:(t=r.WebSocket)!==null&&t!==void 0?t:r};throw new Error("ws package not available")}catch{return{type:"unsupported",error:`Node.js ${i} detected without WebSocket support.`,workaround:'Install the "ws" package: npm install ws'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){let i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{let e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}},XC=JC;var Ak="2.15.0";var Rk=`realtime-js/${Ak}`,kk="1.0.0";var rf=1e4,Ok=1e3,Nk=100,of=function(n){return n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed",n}(of||{}),_n=function(n){return n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving",n}(_n||{}),Zi=function(n){return n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token",n}(Zi||{}),eE=function(n){return n.websocket="websocket",n}(eE||{}),Ia=function(n){return n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed",n}(Ia||{});var ov=class{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){let t=new DataView(e),i=new TextDecoder;return this._decodeBroadcast(e,t,i)}_decodeBroadcast(e,t,i){let r=t.getUint8(1),o=t.getUint8(2),s=this.HEADER_LENGTH+2,l=i.decode(e.slice(s,s+r));s=s+r;let c=i.decode(e.slice(s,s+o));s=s+o;let u=JSON.parse(i.decode(e.slice(s,e.byteLength)));return{ref:null,topic:l,event:c,payload:u}}};var Ic=class{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var Pt=function(n){return n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange",n}(Pt||{}),nE=(n,e,t={})=>{var i;let r=(i=t.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(e).reduce((o,s)=>(o[s]=U6(s,n,e,r),o),{})},U6=(n,e,t,i)=>{let r=e.find(l=>l.name===n),o=r?.type,s=t[n];return o&&!i.includes(o)?Lk(o,s):tE(s)},Lk=(n,e)=>{if(n.charAt(0)==="_"){let t=n.slice(1,n.length);return q6(e,t)}switch(n){case Pt.bool:return H6(e);case Pt.float4:case Pt.float8:case Pt.int2:case Pt.int4:case Pt.int8:case Pt.numeric:case Pt.oid:return W6(e);case Pt.json:case Pt.jsonb:return $6(e);case Pt.timestamp:return G6(e);case Pt.abstime:case Pt.date:case Pt.daterange:case Pt.int4range:case Pt.int8range:case Pt.money:case Pt.reltime:case Pt.text:case Pt.time:case Pt.timestamptz:case Pt.timetz:case Pt.tsrange:case Pt.tstzrange:return tE(e);default:return tE(e)}},tE=n=>n,H6=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},W6=n=>{if(typeof n=="string"){let e=parseFloat(n);if(!Number.isNaN(e))return e}return n},$6=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},q6=(n,e)=>{if(typeof n!="string")return n;let t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let o,s=n.slice(1,t);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(l=>Lk(e,l))}return n},G6=n=>typeof n=="string"?n.replace(" ","T"):n,sv=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};var Mc=class{constructor(e,t,i={},r=rf){this.channel=e,this.event=t,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}};var sf=class n{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let i=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{let{onJoin:o,onLeave:s,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=n.syncState(this.state,r,o,s),this.pendingDiffs.forEach(c=>{this.state=n.syncDiff(this.state,c,o,s)}),this.pendingDiffs=[],l()}),this.channel._on(i.diff,{},r=>{let{onJoin:o,onLeave:s,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=n.syncDiff(this.state,r,o,s),l())}),this.onJoin((r,o,s)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:o,newPresences:s})}),this.onLeave((r,o,s)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,r){let o=this.cloneDeep(e),s=this.transformState(t),l={},c={};return this.map(o,(u,f)=>{s[u]||(c[u]=f)}),this.map(s,(u,f)=>{let m=o[u];if(m){let w=f.map(M=>M.presence_ref),b=m.map(M=>M.presence_ref),D=f.filter(M=>b.indexOf(M.presence_ref)<0),T=m.filter(M=>w.indexOf(M.presence_ref)<0);D.length>0&&(l[u]=D),T.length>0&&(c[u]=T)}else l[u]=f}),this.syncDiff(o,{joins:l,leaves:c},i,r)}static syncDiff(e,t,i,r){let{joins:o,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(o,(l,c)=>{var u;let f=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),f.length>0){let m=e[l].map(b=>b.presence_ref),w=f.filter(b=>m.indexOf(b.presence_ref)<0);e[l].unshift(...w)}i(l,f,c)}),this.map(s,(l,c)=>{let u=e[l];if(!u)return;let f=c.map(m=>m.presence_ref);u=u.filter(m=>f.indexOf(m.presence_ref)<0),e[l]=u,r(l,u,c),u.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{let r=e[i];return"metas"in r?t[i]=r.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):t[i]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var af=function(n){return n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system",n}(af||{}),zo=function(n){return n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR",n}(zo||{});var lf=class n{constructor(e,t={config:{}},i){this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=_n.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Mc(this,Zi.join,this.params,this.timeout),this.rejoinTimer=new Ic(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=_n.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=_n.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=_n.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=_n.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=_n.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Zi.reply,{},(r,o)=>{this._trigger(this._replyEventName(o),r)}),this.presence=new sf(this),this.broadcastEndpointURL=sv(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var i,r;if(this.socket.isConnected()||this.socket.connect(),this.state==_n.closed){let{config:{broadcast:o,presence:s,private:l}}=this.params,c=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(w=>w.filter))!==null&&r!==void 0?r:[],u=!!this.bindings[af.PRESENCE]&&this.bindings[af.PRESENCE].length>0,f={},m={broadcast:o,presence:Object.assign(Object.assign({},s),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(w=>e?.(zo.CHANNEL_ERROR,w)),this._onClose(()=>e?.(zo.CLOSED)),this.updateJoinPayload(Object.assign({config:m},f)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",b=>C(this,[b],function*({postgres_changes:w}){var D;if(this.socket.setAuth(),w===void 0){e?.(zo.SUBSCRIBED);return}else{let T=this.bindings.postgres_changes,M=(D=T?.length)!==null&&D!==void 0?D:0,P=[];for(let U=0;U<M;U++){let K=T[U],{filter:{event:W,schema:re,table:fe,filter:ce}}=K,le=w&&w[U];if(le&&le.event===W&&le.schema===re&&le.table===fe&&le.filter===ce)P.push(Object.assign(Object.assign({},K),{id:le.id}));else{this.unsubscribe(),this.state=_n.errored,e?.(zo.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=P,e&&e(zo.SUBSCRIBED);return}})).receive("error",w=>{this.state=_n.errored,e?.(zo.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(w).join(", ")||"error")))}).receive("timeout",()=>{e?.(zo.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(i){return C(this,arguments,function*(e,t={}){return yield this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)})}untrack(){return C(this,arguments,function*(e={}){return yield this.send({type:"presence",event:"untrack"},e)})}on(e,t,i){return this.state===_n.joined&&e===af.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,i)}send(i){return C(this,arguments,function*(e,t={}){var r,o;if(!this._canPush()&&e.type==="broadcast"){let{event:s,payload:l}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{let f=yield this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return yield(o=f.body)===null||o===void 0?void 0:o.cancel(),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,c,u;let f=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||u===void 0)&&u.ack)&&s("ok"),f.receive("ok",()=>s("ok")),f.receive("error",()=>s("error")),f.receive("timeout",()=>s("timed out"))})})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=_n.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Zi.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new Mc(this,Zi.leave,{},e),i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=_n.closed,this.bindings={}}_fetchWithTimeout(e,t,i){return C(this,null,function*(){let r=new AbortController,o=setTimeout(()=>r.abort(),i),s=yield this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(o),s})}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Mc(this,e,t,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Nk){let t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var r,o;let s=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:f}=Zi;if(i&&[l,c,u,f].indexOf(s)>=0&&i!==this._joinRef())return;let w=this._onMessage(s,t,i);if(t&&!w)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(b=>{var D,T,M;return((D=b.filter)===null||D===void 0?void 0:D.event)==="*"||((M=(T=b.filter)===null||T===void 0?void 0:T.event)===null||M===void 0?void 0:M.toLocaleLowerCase())===s}).map(b=>b.callback(w,i)):(o=this.bindings[s])===null||o===void 0||o.filter(b=>{var D,T,M,P,U,K;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in b){let W=b.id,re=(D=b.filter)===null||D===void 0?void 0:D.event;return W&&((T=t.ids)===null||T===void 0?void 0:T.includes(W))&&(re==="*"||re?.toLocaleLowerCase()===((M=t.data)===null||M===void 0?void 0:M.type.toLocaleLowerCase()))}else{let W=(U=(P=b?.filter)===null||P===void 0?void 0:P.event)===null||U===void 0?void 0:U.toLocaleLowerCase();return W==="*"||W===((K=t?.event)===null||K===void 0?void 0:K.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===s}).map(b=>{if(typeof w=="object"&&"ids"in w){let D=w.data,{schema:T,table:M,commit_timestamp:P,type:U,errors:K}=D;w=Object.assign(Object.assign({},{schema:T,table:M,commit_timestamp:P,eventType:U,new:{},old:{},errors:K}),this._getPayloadRecords(D))}b.callback(w,i)})}_isClosed(){return this.state===_n.closed}_isJoined(){return this.state===_n.joined}_isJoining(){return this.state===_n.joining}_isLeaving(){return this.state===_n.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){let r=e.toLocaleLowerCase(),o={type:r,filter:t,callback:i};return this.bindings[r]?this.bindings[r].push(o):this.bindings[r]=[o],this}_off(e,t){let i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var o;return!(((o=r.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===i&&n.isEqual(r.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let i in e)if(e[i]!==t[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Zi.close,{},e)}_onError(e){this._on(Zi.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=_n.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=nE(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=nE(e.columns,e.old_record)),t}};var Fk=()=>{},av={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Y6=[1e3,2e3,5e3,1e4],Q6=1e4,K6=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`,cf=class{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=rf,this.transport=null,this.heartbeatIntervalMs=av.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Fk,this.ref=0,this.reconnectTimer=null,this.logger=Fk,this.conn=null,this.sendBuffer=[],this.serializer=new ov,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let o;return r?o=r:typeof fetch>"u"?o=(...s)=>import("./chunk-N2HYM3BR.js").then(({default:l})=>l(...s)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...s)=>o(...s)},!(!((i=t?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${eE.websocket}`,this.httpEndpoint=sv(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=XC.createWebSocket(this.endpointURL())}catch(e){throw this._setConnectionState("disconnected"),new Error(`WebSocket not available: ${e.message}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:kk}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}removeChannel(e){return C(this,null,function*(){let t=yield e.unsubscribe();return this.channels.length===0&&this.disconnect(),t})}removeAllChannels(){return C(this,null,function*(){let e=yield Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e})}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case of.connecting:return Ia.Connecting;case of.open:return Ia.Open;case of.closing:return Ia.Closing;default:return Ia.Closed}}isConnected(){return this.connectionState()===Ia.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){let i=`realtime:${e}`,r=this.getChannels().find(o=>o.topic===i);if(r)return r;{let o=new lf(`realtime:${e}`,t,this);return this.channels.push(o),o}}push(e){let{topic:t,event:i,payload:r,ref:o}=e,s=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${i} (${o})`,r),this.isConnected()?s():this.sendBuffer.push(s)}setAuth(e=null){return C(this,null,function*(){this._authPromise=this._performAuth(e);try{yield this._authPromise}finally{this._authPromise=null}})}sendHeartbeat(){return C(this,null,function*(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Ok,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},av.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")})}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);let{topic:i,event:r,payload:o,ref:s}=t,l=s?`(${s})`:"",c=o.status||"";this.log("receive",`${c} ${i} ${r} ${l}`.trim(),o),this.channels.filter(u=>u._isMember(i)).forEach(u=>u._trigger(r,o,s)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Zi.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;let i=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${i}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{let i=new Blob([K6],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}_performAuth(e=null){return C(this,null,function*(){let t;e?t=e:this.accessToken?t=yield this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(i=>{let r={access_token:t,version:Rk};t&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(Zi.access_token,{access_token:t})}))})}_waitForAuthIfNeeded(){return C(this,null,function*(){this._authPromise&&(yield this._authPromise)})}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new Ic(()=>C(this,null,function*(){setTimeout(()=>C(this,null,function*(){yield this._waitForAuthIfNeeded(),this.isConnected()||this.connect()}),av.RECONNECT_DELAY)}),this.reconnectAfterMs)}_initializeOptions(e){var t,i,r,o,s,l,c,u;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e?.timeout)!==null&&i!==void 0?i:rf,this.heartbeatIntervalMs=(r=e?.heartbeatIntervalMs)!==null&&r!==void 0?r:av.HEARTBEAT_INTERVAL,this.worker=(o=e?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(s=e?.accessToken)!==null&&s!==void 0?s:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e?.reconnectAfterMs)!==null&&l!==void 0?l:f=>Y6[f-1]||Q6,this.encode=(c=e?.encode)!==null&&c!==void 0?c:(f,m)=>m(JSON.stringify(f)),this.decode=(u=e?.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}};var Tc=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function an(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var lv=class extends Tc{constructor(e,t,i){super(e),this.name="StorageApiError",this.status=t,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Ma=class extends Tc{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};var J6=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(f){try{u(i.next(f))}catch(m){s(m)}}function c(f){try{u(i.throw(f))}catch(m){s(m)}}function u(f){f.done?o(f.value):r(f.value).then(l,c)}u((i=i.apply(n,e||[])).next())})},dv=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>import("./chunk-N2HYM3BR.js").then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},zk=()=>J6(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield import("./chunk-N2HYM3BR.js")).Response:Response}),cv=n=>{if(Array.isArray(n))return n.map(t=>cv(t));if(typeof n=="function"||n!==Object(n))return n;let e={};return Object.entries(n).forEach(([t,i])=>{let r=t.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[r]=cv(i)}),e},Vk=n=>{if(typeof n!="object"||n===null)return!1;let e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Ta=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(f){try{u(i.next(f))}catch(m){s(m)}}function c(f){try{u(i.throw(f))}catch(m){s(m)}}function u(f){f.done?o(f.value):r(f.value).then(l,c)}u((i=i.apply(n,e||[])).next())})},iE=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),X6=(n,e,t)=>Ta(void 0,void 0,void 0,function*(){let i=yield zk();n instanceof i&&!t?.noResolveJson?n.json().then(r=>{let o=n.status||500,s=r?.statusCode||o+"";e(new lv(iE(r),o,s))}).catch(r=>{e(new Ma(iE(r),r))}):e(new Ma(iE(n),n))}),e8=(n,e,t,i)=>{let r={method:n,headers:e?.headers||{}};return n==="GET"||!i?r:(Vk(i)?(r.headers=Object.assign({"Content-Type":"application/json"},e?.headers),r.body=JSON.stringify(i)):r.body=i,Object.assign(Object.assign({},r),t))};function df(n,e,t,i,r,o){return Ta(this,void 0,void 0,function*(){return new Promise((s,l)=>{n(t,e8(e,i,r,o)).then(c=>{if(!c.ok)throw c;return i?.noResolveJson?c:c.json()}).then(c=>s(c)).catch(c=>X6(c,l,i))})})}function Pc(n,e,t,i){return Ta(this,void 0,void 0,function*(){return df(n,"GET",e,t,i)})}function xr(n,e,t,i,r){return Ta(this,void 0,void 0,function*(){return df(n,"POST",e,i,r,t)})}function uf(n,e,t,i,r){return Ta(this,void 0,void 0,function*(){return df(n,"PUT",e,i,r,t)})}function jk(n,e,t,i){return Ta(this,void 0,void 0,function*(){return df(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),i)})}function uv(n,e,t,i,r){return Ta(this,void 0,void 0,function*(){return df(n,"DELETE",e,i,r,t)})}var vi=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(f){try{u(i.next(f))}catch(m){s(m)}}function c(f){try{u(i.throw(f))}catch(m){s(m)}}function u(f){f.done?o(f.value):r(f.value).then(l,c)}u((i=i.apply(n,e||[])).next())})},t8={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Bk={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},fv=class{constructor(e,t={},i,r){this.url=e,this.headers=t,this.bucketId=i,this.fetch=dv(r)}uploadOrUpdate(e,t,i,r){return vi(this,void 0,void 0,function*(){try{let o,s=Object.assign(Object.assign({},Bk),r),l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(s.upsert)}),c=s.metadata;typeof Blob<"u"&&i instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),c&&o.append("metadata",this.encodeMetadata(c)),o.append("",i)):typeof FormData<"u"&&i instanceof FormData?(o=i,o.append("cacheControl",s.cacheControl),c&&o.append("metadata",this.encodeMetadata(c))):(o=i,l["cache-control"]=`max-age=${s.cacheControl}`,l["content-type"]=s.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),r?.headers&&(l=Object.assign(Object.assign({},l),r.headers));let u=this._removeEmptyFolders(t),f=this._getFinalPath(u),m=yield(e=="PUT"?uf:xr)(this.fetch,`${this.url}/object/${f}`,o,Object.assign({headers:l},s?.duplex?{duplex:s.duplex}:{}));return{data:{path:u,id:m.Id,fullPath:m.Key},error:null}}catch(o){if(an(o))return{data:null,error:o};throw o}})}upload(e,t,i){return vi(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,i)})}uploadToSignedUrl(e,t,i,r){return vi(this,void 0,void 0,function*(){let o=this._removeEmptyFolders(e),s=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${s}`);l.searchParams.set("token",t);try{let c,u=Object.assign({upsert:Bk.upsert},r),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&i instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",i)):typeof FormData<"u"&&i instanceof FormData?(c=i,c.append("cacheControl",u.cacheControl)):(c=i,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType);let m=yield uf(this.fetch,l.toString(),c,{headers:f});return{data:{path:o,fullPath:m.Key},error:null}}catch(c){if(an(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return vi(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),r=Object.assign({},this.headers);t?.upsert&&(r["x-upsert"]="true");let o=yield xr(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),s=new URL(this.url+o.url),l=s.searchParams.get("token");if(!l)throw new Tc("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:l},error:null}}catch(i){if(an(i))return{data:null,error:i};throw i}})}update(e,t,i){return vi(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,i)})}move(e,t,i){return vi(this,void 0,void 0,function*(){try{return{data:yield xr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i?.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(an(r))return{data:null,error:r};throw r}})}copy(e,t,i){return vi(this,void 0,void 0,function*(){try{return{data:{path:(yield xr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:i?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(an(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,i){return vi(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),o=yield xr(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},i?.transform?{transform:i.transform}:{}),{headers:this.headers}),s=i?.download?`&download=${i.download===!0?"":i.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(r){if(an(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,i){return vi(this,void 0,void 0,function*(){try{let r=yield xr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),o=i?.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${o}`):null})),error:null}}catch(r){if(an(r))return{data:null,error:r};throw r}})}download(e,t){return vi(this,void 0,void 0,function*(){let r=typeof t?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(t?.transform||{}),s=o?`?${o}`:"";try{let l=this._getFinalPath(e);return{data:yield(yield Pc(this.fetch,`${this.url}/${r}/${l}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(an(l))return{data:null,error:l};throw l}})}info(e){return vi(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let i=yield Pc(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:cv(i),error:null}}catch(i){if(an(i))return{data:null,error:i};throw i}})}exists(e){return vi(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield jk(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(an(i)&&i instanceof Ma){let r=i.originalError;if([400,404].includes(r?.status))return{data:!1,error:i}}throw i}})}getPublicUrl(e,t){let i=this._getFinalPath(e),r=[],o=t?.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&r.push(o);let l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&r.push(c);let u=r.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${i}${u}`)}}}remove(e){return vi(this,void 0,void 0,function*(){try{return{data:yield uv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(an(t))return{data:null,error:t};throw t}})}list(e,t,i){return vi(this,void 0,void 0,function*(){try{let r=Object.assign(Object.assign(Object.assign({},t8),t),{prefix:e||""});return{data:yield xr(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(an(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};var Uk="2.10.4";var Hk={"X-Client-Info":`storage-js/${Uk}`};var Ac=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(f){try{u(i.next(f))}catch(m){s(m)}}function c(f){try{u(i.throw(f))}catch(m){s(m)}}function u(f){f.done?o(f.value):r(f.value).then(l,c)}u((i=i.apply(n,e||[])).next())})},pv=class{constructor(e,t={},i,r){let o=new URL(e);r?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href,this.headers=Object.assign(Object.assign({},Hk),t),this.fetch=dv(i)}listBuckets(){return Ac(this,void 0,void 0,function*(){try{return{data:yield Pc(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(an(e))return{data:null,error:e};throw e}})}getBucket(e){return Ac(this,void 0,void 0,function*(){try{return{data:yield Pc(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(an(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ac(this,void 0,void 0,function*(){try{return{data:yield xr(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(an(i))return{data:null,error:i};throw i}})}updateBucket(e,t){return Ac(this,void 0,void 0,function*(){try{return{data:yield uf(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(an(i))return{data:null,error:i};throw i}})}emptyBucket(e){return Ac(this,void 0,void 0,function*(){try{return{data:yield xr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(an(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ac(this,void 0,void 0,function*(){try{return{data:yield uv(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(an(t))return{data:null,error:t};throw t}})}};var ff=class extends pv{constructor(e,t={},i,r){super(e,t,i,r)}from(e){return new fv(this.url,this.headers,e,this.fetch)}};var Wk="2.54.0";var pf="";typeof Deno<"u"?pf="deno":typeof document<"u"?pf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?pf="react-native":pf="node";var n8={"X-Client-Info":`supabase-js-${pf}/${Wk}`},$k={headers:n8},qk={schema:"public"},Gk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Zk={};hI();var i8=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(f){try{u(i.next(f))}catch(m){s(m)}}function c(f){try{u(i.throw(f))}catch(m){s(m)}}function u(f){f.done?o(f.value):r(f.value).then(l,c)}u((i=i.apply(n,e||[])).next())})},r8=n=>{let e;return n?e=n:typeof fetch>"u"?e=fI:e=fetch,(...t)=>e(...t)},o8=()=>typeof Headers>"u"?pI:Headers,Yk=(n,e,t)=>{let i=r8(t),r=o8();return(o,s)=>i8(void 0,void 0,void 0,function*(){var l;let c=(l=yield e())!==null&&l!==void 0?l:n,u=new r(s?.headers);return u.has("apikey")||u.set("apikey",n),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),i(o,Object.assign(Object.assign({},s),{headers:u}))})};var s8=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(f){try{u(i.next(f))}catch(m){s(m)}}function c(f){try{u(i.throw(f))}catch(m){s(m)}}function u(f){f.done?o(f.value):r(f.value).then(l,c)}u((i=i.apply(n,e||[])).next())})};function Qk(n){return n.endsWith("/")?n:n+"/"}function Kk(n,e){var t,i;let{db:r,auth:o,realtime:s,global:l}=n,{db:c,auth:u,realtime:f,global:m}=e,w={db:Object.assign(Object.assign({},c),r),auth:Object.assign(Object.assign({},u),o),realtime:Object.assign(Object.assign({},f),s),storage:{},global:Object.assign(Object.assign(Object.assign({},m),l),{headers:Object.assign(Object.assign({},(t=m?.headers)!==null&&t!==void 0?t:{}),(i=l?.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>s8(this,void 0,void 0,function*(){return""})};return n.accessToken?w.accessToken=n.accessToken:delete w.accessToken,w}var hv="2.71.1";var Pa=30*1e3,gv=3,mv=gv*Pa,Jk="http://localhost:9999",Xk="supabase.auth.token";var eO={"X-Client-Info":`gotrue-js/${hv}`};var hf="X-Supabase-Api-Version",rE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},tO=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,nO=10*60*1e3;var gf=class extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}};function Pe(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}var vv=class extends gf{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}};function iO(n){return Pe(n)&&n.name==="AuthApiError"}var Rc=class extends gf{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}},oo=class extends gf{constructor(e,t,i,r){super(e,i,r),this.name=t,this.status=i}},Yi=class extends oo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function rO(n){return Pe(n)&&n.name==="AuthSessionMissingError"}var Aa=class extends oo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},Ra=class extends oo{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}},ka=class extends oo{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function oO(n){return Pe(n)&&n.name==="AuthImplicitGrantRedirectError"}var mf=class extends oo{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},kc=class extends oo{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}};function _v(n){return Pe(n)&&n.name==="AuthRetryableFetchError"}var vf=class extends oo{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}};var Oa=class extends oo{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}};var yv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),sO=` 	
\r=`.split(""),a8=(()=>{let n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<sO.length;e+=1)n[sO[e].charCodeAt(0)]=-2;for(let e=0;e<yv.length;e+=1)n[yv[e].charCodeAt(0)]=e;return n})();function aO(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){let i=e.queue>>e.queuedBits-6&63;t(yv[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){let i=e.queue>>e.queuedBits-6&63;t(yv[i]),e.queuedBits-=6}}function lO(n,e,t){let i=a8[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function oE(n){let e=[],t=s=>{e.push(String.fromCodePoint(s))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},o=s=>{d8(s,i,t)};for(let s=0;s<n.length;s+=1)lO(n.charCodeAt(s),r,o);return e.join("")}function l8(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function c8(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){let r=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}l8(i,e)}}function d8(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function cO(n){let e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};for(let r=0;r<n.length;r+=1)lO(n.charCodeAt(r),t,i);return new Uint8Array(e)}function dO(n){let e=[];return c8(n,t=>e.push(t)),new Uint8Array(e)}function uO(n){let e=[],t={queue:0,queuedBits:0},i=r=>{e.push(r)};return n.forEach(r=>aO(r,t,i)),aO(null,t,i),e.join("")}function fO(n){return Math.round(Date.now()/1e3)+n}function pO(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){let e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}var Qi=()=>typeof window<"u"&&typeof document<"u",Na={tested:!1,writable:!1},bv=()=>{if(!Qi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Na.tested)return Na.writable;let n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Na.tested=!0,Na.writable=!0}catch{Na.tested=!0,Na.writable=!1}return Na.writable};function hO(n){let e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,o)=>{e[o]=r})}catch{}return t.searchParams.forEach((i,r)=>{e[r]=i}),e}var wv=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>import("./chunk-N2HYM3BR.js").then(({default:i})=>i(...t)):e=fetch,(...t)=>e(...t)},gO=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",La=(n,e,t)=>C(null,null,function*(){yield n.setItem(e,JSON.stringify(t))}),ws=(n,e)=>C(null,null,function*(){let t=yield n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}}),Vo=(n,e)=>C(null,null,function*(){yield n.removeItem(e)}),_f=class n{constructor(){this.promise=new n.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}};_f.promiseConstructor=Promise;function Sv(n){let e=n.split(".");if(e.length!==3)throw new Oa("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!tO.test(e[i]))throw new Oa("JWT not in base64url format");return{header:JSON.parse(oE(e[0])),payload:JSON.parse(oE(e[1])),signature:cO(e[2]),raw:{header:e[0],payload:e[1]}}}function mO(n){return C(this,null,function*(){return yield new Promise(e=>{setTimeout(()=>e(null),n)})})}function vO(n,e){return new Promise((i,r)=>{C(null,null,function*(){for(let o=0;o<1/0;o++)try{let s=yield n(o);if(!e(o,null,s)){i(s);return}}catch(s){if(!e(o,s)){r(s);return}}})})}function u8(n){return("0"+n.toString(16)).substr(-2)}function f8(){let e=new Uint32Array(56);if(typeof crypto>"u"){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length,r="";for(let o=0;o<56;o++)r+=t.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(e),Array.from(e,u8).join("")}function p8(n){return C(this,null,function*(){let t=new TextEncoder().encode(n),i=yield crypto.subtle.digest("SHA-256",t),r=new Uint8Array(i);return Array.from(r).map(o=>String.fromCharCode(o)).join("")})}function h8(n){return C(this,null,function*(){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;let t=yield p8(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}function Fa(n,e,t=!1){return C(this,null,function*(){let i=f8(),r=i;t&&(r+="/PASSWORD_RECOVERY"),yield La(n,`${e}-code-verifier`,r);let o=yield h8(i);return[o,i===o?"plain":"s256"]})}var g8=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _O(n){let e=n.headers.get(hf);if(!e||!e.match(g8))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function yO(n){if(!n)throw new Error("Missing exp claim");let e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function bO(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var m8=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function za(n){if(!m8.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Cv(){let n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){let i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function sE(n){return JSON.parse(JSON.stringify(n))}var v8=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t},Va=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),_8=[502,503,504];function wO(n){return C(this,null,function*(){var e;if(!gO(n))throw new kc(Va(n),0);if(_8.includes(n.status))throw new kc(Va(n),n.status);let t;try{t=yield n.json()}catch(o){throw new Rc(Va(o),o)}let i,r=_O(n);if(r&&r.getTime()>=rE["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new vf(Va(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new Yi}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((o,s)=>o&&typeof s=="string",!0))throw new vf(Va(t),n.status,t.weak_password.reasons);throw new vv(Va(t),n.status||500,i)})}var y8=(n,e,t,i)=>{let r={method:n,headers:e?.headers||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),t))};function $e(n,e,t,i){return C(this,null,function*(){var r;let o=Object.assign({},i?.headers);o[hf]||(o[hf]=rE["2024-01-01"].name),i?.jwt&&(o.Authorization=`Bearer ${i.jwt}`);let s=(r=i?.query)!==null&&r!==void 0?r:{};i?.redirectTo&&(s.redirect_to=i.redirectTo);let l=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=yield b8(n,e,t+l,{headers:o,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(c):{data:Object.assign({},c),error:null}})}function b8(n,e,t,i,r,o){return C(this,null,function*(){let s=y8(e,i,r,o),l;try{l=yield n(t,Object.assign({},s))}catch(c){throw console.error(c),new kc(Va(c),0)}if(l.ok||(yield wO(l)),i?.noResolveJson)return l;try{return yield l.json()}catch(c){yield wO(c)}})}function so(n){var e;let t=null;w8(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=fO(n.expires_in)));let i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function aE(n){let e=so(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function ao(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function SO(n){return{data:n,error:null}}function CO(n){let{action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:o}=n,s=v8(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:i,redirect_to:r,verification_type:o},c=Object.assign({},s);return{data:{properties:l,user:c},error:null}}function EO(n){return n}function w8(n){return n.access_token&&n.refresh_token&&n.expires_in}var Ev=["global","local","others"];var S8=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t},Oc=class{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=wv(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(i){return C(this,arguments,function*(e,t=Ev[0]){if(Ev.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ev.join(", ")}`);try{return yield $e(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}})}inviteUserByEmail(i){return C(this,arguments,function*(e,t={}){try{return yield $e(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ao})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}})}generateLink(e){return C(this,null,function*(){try{let{options:t}=e,i=S8(e,["options"]),r=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(r.new_email=i?.newEmail,delete r.newEmail),yield $e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:CO,redirectTo:t?.redirectTo})}catch(t){if(Pe(t))return{data:{properties:null,user:null},error:t};throw t}})}createUser(e){return C(this,null,function*(){try{return yield $e(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ao})}catch(t){if(Pe(t))return{data:{user:null},error:t};throw t}})}listUsers(e){return C(this,null,function*(){var t,i,r,o,s,l,c;try{let u={nextPage:null,lastPage:0,total:0},f=yield $e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(o=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""},xform:EO});if(f.error)throw f.error;let m=yield f.json(),w=(s=f.headers.get("x-total-count"))!==null&&s!==void 0?s:0,b=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return b.length>0&&(b.forEach(D=>{let T=parseInt(D.split(";")[0].split("=")[1].substring(0,1)),M=JSON.parse(D.split(";")[1].split("=")[1]);u[`${M}Page`]=T}),u.total=parseInt(w)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(Pe(u))return{data:{users:[]},error:u};throw u}})}getUserById(e){return C(this,null,function*(){za(e);try{return yield $e(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ao})}catch(t){if(Pe(t))return{data:{user:null},error:t};throw t}})}updateUserById(e,t){return C(this,null,function*(){za(e);try{return yield $e(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ao})}catch(i){if(Pe(i))return{data:{user:null},error:i};throw i}})}deleteUser(e,t=!1){return C(this,null,function*(){za(e);try{return yield $e(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ao})}catch(i){if(Pe(i))return{data:{user:null},error:i};throw i}})}_listFactors(e){return C(this,null,function*(){za(e.userId);try{let{data:t,error:i}=yield $e(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:i}}catch(t){if(Pe(t))return{data:null,error:t};throw t}})}_deleteFactor(e){return C(this,null,function*(){za(e.userId),za(e.id);try{return{data:yield $e(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Pe(t))return{data:null,error:t};throw t}})}};function lE(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function xO(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var ja={debug:!!(globalThis&&bv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")},yf=class extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}},xv=class extends yf{};function cE(n,e,t){return C(this,null,function*(){ja.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);let i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),ja.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},r=>C(null,null,function*(){if(r){ja.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return yield t()}finally{ja.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw ja.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new xv(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(ja.debug)try{let o=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield t()}})))})}xO();var C8={url:Jk,storageKey:Xk,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:eO,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};function DO(n,e,t){return C(this,null,function*(){return yield t()})}var Nc={},dE=(()=>{class n{constructor(t){var i,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=n.nextInstanceID,n.nextInstanceID+=1,this.instanceID>0&&Qi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let o=Object.assign(Object.assign({},C8),t);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Oc({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=wv(o.fetch),this.lock=o.lock||DO,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Qi()&&(!((i=globalThis?.navigator)===null||i===void 0)&&i.locks)?this.lock=cE:this.lock=DO,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:bv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=lE(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=lE(this.memoryStorage)),Qi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",s=>C(this,null,function*(){this._debug("received broadcast notification from other tab or client",s),yield this._notifyAllSubscribers(s.data.event,s.data.session,!1)}))}this.initialize()}get jwks(){var t,i;return(i=(t=Nc[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&i!==void 0?i:{keys:[]}}set jwks(t){Nc[this.storageKey]=Object.assign(Object.assign({},Nc[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,i;return(i=(t=Nc[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&i!==void 0?i:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Nc[this.storageKey]=Object.assign(Object.assign({},Nc[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${hv}) ${new Date().toISOString()}`,...t),this}initialize(){return C(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=C(this,null,function*(){return yield this._acquireLock(-1,()=>C(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return C(this,null,function*(){var t;try{let i=hO(window.location.href),r="none";if(this._isImplicitGrantCallback(i)?r="implicit":(yield this._isPKCECallback(i))&&(r="pkce"),Qi()&&this.detectSessionInUrl&&r!=="none"){let{data:o,error:s}=yield this._getSessionFromURL(i,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),oO(s)){let u=(t=s.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:s}}return yield this._removeSession(),{error:s}}let{session:l,redirectType:c}=o;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),yield this._saveSession(l),setTimeout(()=>C(this,null,function*(){c==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",l):yield this._notifyAllSubscribers("SIGNED_IN",l)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(i){return Pe(i)?{error:i}:{error:new Rc("Unexpected error during initialization",i)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(t){return C(this,null,function*(){var i,r,o;try{let s=yield $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(i=t?.options)===null||i===void 0?void 0:i.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=t?.options)===null||o===void 0?void 0:o.captchaToken}},xform:so}),{data:l,error:c}=s;if(c||!l)return{data:{user:null,session:null},error:c};let u=l.session,f=l.user;return l.session&&(yield this._saveSession(l.session),yield this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:f,session:u},error:null}}catch(s){if(Pe(s))return{data:{user:null,session:null},error:s};throw s}})}signUp(t){return C(this,null,function*(){var i,r,o;try{let s;if("email"in t){let{email:m,password:w,options:b}=t,D=null,T=null;this.flowType==="pkce"&&([D,T]=yield Fa(this.storage,this.storageKey)),s=yield $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b?.emailRedirectTo,body:{email:m,password:w,data:(i=b?.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:b?.captchaToken},code_challenge:D,code_challenge_method:T},xform:so})}else if("phone"in t){let{phone:m,password:w,options:b}=t;s=yield $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:w,data:(r=b?.data)!==null&&r!==void 0?r:{},channel:(o=b?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:b?.captchaToken}},xform:so})}else throw new Ra("You must provide either an email or phone number and a password");let{data:l,error:c}=s;if(c||!l)return{data:{user:null,session:null},error:c};let u=l.session,f=l.user;return l.session&&(yield this._saveSession(l.session),yield this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:f,session:u},error:null}}catch(s){if(Pe(s))return{data:{user:null,session:null},error:s};throw s}})}signInWithPassword(t){return C(this,null,function*(){try{let i;if("email"in t){let{email:s,password:l,options:c}=t;i=yield $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:aE})}else if("phone"in t){let{phone:s,password:l,options:c}=t;i=yield $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:aE})}else throw new Ra("You must provide either an email or phone number and a password");let{data:r,error:o}=i;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Aa}:(r.session&&(yield this._saveSession(r.session),yield this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(i){if(Pe(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithOAuth(t){return C(this,null,function*(){var i,r,o,s;return yield this._handleProviderSignIn(t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=t.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})})}exchangeCodeForSession(t){return C(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>C(this,null,function*(){return this._exchangeCodeForSession(t)}))})}signInWithWeb3(t){return C(this,null,function*(){let{chain:i}=t;if(i==="solana")return yield this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${i}"`)})}signInWithSolana(t){return C(this,null,function*(){var i,r,o,s,l,c,u,f,m,w,b,D;let T,M;if("message"in t)T=t.message,M=t.signature;else{let{chain:P,wallet:U,statement:K,options:W}=t,re;if(Qi())if(typeof U=="object")re=U;else{let ce=window;if("solana"in ce&&typeof ce.solana=="object"&&("signIn"in ce.solana&&typeof ce.solana.signIn=="function"||"signMessage"in ce.solana&&typeof ce.solana.signMessage=="function"))re=ce.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof U!="object"||!W?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");re=U}let fe=new URL((i=W?.url)!==null&&i!==void 0?i:window.location.href);if("signIn"in re&&re.signIn){let ce=yield re.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},W?.signInWithSolana),{version:"1",domain:fe.host,uri:fe.href}),K?{statement:K}:null)),le;if(Array.isArray(ce)&&ce[0]&&typeof ce[0]=="object")le=ce[0];else if(ce&&typeof ce=="object"&&"signedMessage"in ce&&"signature"in ce)le=ce;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in le&&"signature"in le&&(typeof le.signedMessage=="string"||le.signedMessage instanceof Uint8Array)&&le.signature instanceof Uint8Array)T=typeof le.signedMessage=="string"?le.signedMessage:new TextDecoder().decode(le.signedMessage),M=le.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in re)||typeof re.signMessage!="function"||!("publicKey"in re)||typeof re!="object"||!re.publicKey||!("toBase58"in re.publicKey)||typeof re.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");T=[`${fe.host} wants you to sign in with your Solana account:`,re.publicKey.toBase58(),...K?["",K,""]:[""],"Version: 1",`URI: ${fe.href}`,`Issued At: ${(o=(r=W?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((s=W?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${W.signInWithSolana.notBefore}`]:[],...!((l=W?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${W.signInWithSolana.expirationTime}`]:[],...!((c=W?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${W.signInWithSolana.chainId}`]:[],...!((u=W?.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${W.signInWithSolana.nonce}`]:[],...!((f=W?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${W.signInWithSolana.requestId}`]:[],...!((w=(m=W?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||w===void 0)&&w.length?["Resources",...W.signInWithSolana.resources.map(le=>`- ${le}`)]:[]].join(`
`);let ce=yield re.signMessage(new TextEncoder().encode(T),"utf8");if(!ce||!(ce instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");M=ce}}try{let{data:P,error:U}=yield $e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:T,signature:uO(M)},!((b=t.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(D=t.options)===null||D===void 0?void 0:D.captchaToken}}:null),xform:so});if(U)throw U;return!P||!P.session||!P.user?{data:{user:null,session:null},error:new Aa}:(P.session&&(yield this._saveSession(P.session),yield this._notifyAllSubscribers("SIGNED_IN",P.session)),{data:Object.assign({},P),error:U})}catch(P){if(Pe(P))return{data:{user:null,session:null},error:P};throw P}})}_exchangeCodeForSession(t){return C(this,null,function*(){let i=yield ws(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(i??"").split("/");try{let{data:s,error:l}=yield $e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:so});if(yield Vo(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Aa}:(s.session&&(yield this._saveSession(s.session),yield this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:o??null}),error:l})}catch(s){if(Pe(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}})}signInWithIdToken(t){return C(this,null,function*(){try{let{options:i,provider:r,token:o,access_token:s,nonce:l}=t,c=yield $e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:so}),{data:u,error:f}=c;return f?{data:{user:null,session:null},error:f}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Aa}:(u.session&&(yield this._saveSession(u.session),yield this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:f})}catch(i){if(Pe(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithOtp(t){return C(this,null,function*(){var i,r,o,s,l;try{if("email"in t){let{email:c,options:u}=t,f=null,m=null;this.flowType==="pkce"&&([f,m]=yield Fa(this.storage,this.storageKey));let{error:w}=yield $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(i=u?.data)!==null&&i!==void 0?i:{},create_user:(r=u?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},code_challenge:f,code_challenge_method:m},redirectTo:u?.emailRedirectTo});return{data:{user:null,session:null},error:w}}if("phone"in t){let{phone:c,options:u}=t,{data:f,error:m}=yield $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(o=u?.data)!==null&&o!==void 0?o:{},create_user:(s=u?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},channel:(l=u?.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:f?.message_id},error:m}}throw new Ra("You must provide either an email or phone number.")}catch(c){if(Pe(c))return{data:{user:null,session:null},error:c};throw c}})}verifyOtp(t){return C(this,null,function*(){var i,r;try{let o,s;"options"in t&&(o=(i=t.options)===null||i===void 0?void 0:i.redirectTo,s=(r=t.options)===null||r===void 0?void 0:r.captchaToken);let{data:l,error:c}=yield $e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:o,xform:so});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");let u=l.session,f=l.user;return u?.access_token&&(yield this._saveSession(u),yield this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:f,session:u},error:null}}catch(o){if(Pe(o))return{data:{user:null,session:null},error:o};throw o}})}signInWithSSO(t){return C(this,null,function*(){var i,r,o;try{let s=null,l=null;return this.flowType==="pkce"&&([s,l]=yield Fa(this.storage,this.storageKey)),yield $e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(i=t.options)===null||i===void 0?void 0:i.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=t?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:l}),headers:this.headers,xform:SO})}catch(s){if(Pe(s))return{data:null,error:s};throw s}})}reauthenticate(){return C(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>C(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return C(this,null,function*(){try{return yield this._useSession(t=>C(this,null,function*(){let{data:{session:i},error:r}=t;if(r)throw r;if(!i)throw new Yi;let{error:o}=yield $e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:i.access_token});return{data:{user:null,session:null},error:o}}))}catch(t){if(Pe(t))return{data:{user:null,session:null},error:t};throw t}})}resend(t){return C(this,null,function*(){try{let i=`${this.url}/resend`;if("email"in t){let{email:r,type:o,options:s}=t,{error:l}=yield $e(this.fetch,"POST",i,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){let{phone:r,type:o,options:s}=t,{data:l,error:c}=yield $e(this.fetch,"POST",i,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return{data:{user:null,session:null,messageId:l?.message_id},error:c}}throw new Ra("You must provide either an email or phone number and a type")}catch(i){if(Pe(i))return{data:{user:null,session:null},error:i};throw i}})}getSession(){return C(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>C(this,null,function*(){return this._useSession(i=>C(this,null,function*(){return i}))}))})}_acquireLock(t,i){return C(this,null,function*(){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){let r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=C(this,null,function*(){return yield r,yield i()});return this.pendingInLock.push(C(this,null,function*(){try{yield o}catch{}})),o}return yield this.lock(`lock:${this.storageKey}`,t,()=>C(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let r=i();for(this.pendingInLock.push(C(this,null,function*(){try{yield r}catch{}})),yield r;this.pendingInLock.length;){let o=[...this.pendingInLock];yield Promise.all(o),this.pendingInLock.splice(0,o.length)}return yield r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(t){return C(this,null,function*(){this._debug("#_useSession","begin");try{let i=yield this.__loadSession();return yield t(i)}finally{this._debug("#_useSession","end")}})}__loadSession(){return C(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null,i=yield ws(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",i),i!==null&&(this._isValidSession(i)?t=i:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!t)return{data:{session:null},error:null};let r=t.expires_at?t.expires_at*1e3-Date.now()<mv:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){let l=yield ws(this.userStorage,this.storageKey+"-user");l?.user?t.user=l.user:t.user=Cv()}if(this.storage.isServer&&t.user){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(u,f,m)=>(!l&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,f,m))})}return{data:{session:t},error:null}}let{session:o,error:s}=yield this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(t){return C(this,null,function*(){return t?yield this._getUser(t):(yield this.initializePromise,yield this._acquireLock(-1,()=>C(this,null,function*(){return yield this._getUser()})))})}_getUser(t){return C(this,null,function*(){try{return t?yield $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ao}):yield this._useSession(i=>C(this,null,function*(){var r,o,s;let{data:l,error:c}=i;if(c)throw c;return!(!((r=l.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Yi}:yield $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(o=l.session)===null||o===void 0?void 0:o.access_token)!==null&&s!==void 0?s:void 0,xform:ao})}))}catch(i){if(Pe(i))return rO(i)&&(yield this._removeSession(),yield Vo(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:i};throw i}})}updateUser(r){return C(this,arguments,function*(t,i={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>C(this,null,function*(){return yield this._updateUser(t,i)}))})}_updateUser(r){return C(this,arguments,function*(t,i={}){try{return yield this._useSession(o=>C(this,null,function*(){let{data:s,error:l}=o;if(l)throw l;if(!s.session)throw new Yi;let c=s.session,u=null,f=null;this.flowType==="pkce"&&t.email!=null&&([u,f]=yield Fa(this.storage,this.storageKey));let{data:m,error:w}=yield $e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:i?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:f}),jwt:c.access_token,xform:ao});if(w)throw w;return c.user=m.user,yield this._saveSession(c),yield this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}}))}catch(o){if(Pe(o))return{data:{user:null},error:o};throw o}})}setSession(t){return C(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>C(this,null,function*(){return yield this._setSession(t)}))})}_setSession(t){return C(this,null,function*(){try{if(!t.access_token||!t.refresh_token)throw new Yi;let i=Date.now()/1e3,r=i,o=!0,s=null,{payload:l}=Sv(t.access_token);if(l.exp&&(r=l.exp,o=r<=i),o){let{session:c,error:u}=yield this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!c)return{data:{user:null,session:null},error:null};s=c}else{let{data:c,error:u}=yield this._getUser(t.access_token);if(u)throw u;s={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:r-i,expires_at:r},yield this._saveSession(s),yield this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(i){if(Pe(i))return{data:{session:null,user:null},error:i};throw i}})}refreshSession(t){return C(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>C(this,null,function*(){return yield this._refreshSession(t)}))})}_refreshSession(t){return C(this,null,function*(){try{return yield this._useSession(i=>C(this,null,function*(){var r;if(!t){let{data:l,error:c}=i;if(c)throw c;t=(r=l.session)!==null&&r!==void 0?r:void 0}if(!t?.refresh_token)throw new Yi;let{session:o,error:s}=yield this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}}))}catch(i){if(Pe(i))return{data:{user:null,session:null},error:i};throw i}})}_getSessionFromURL(t,i){return C(this,null,function*(){try{if(!Qi())throw new ka("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ka(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(i){case"implicit":if(this.flowType==="pkce")throw new mf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ka("Not a valid implicit grant flow url.");break;default:}if(i==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new mf("No code detected.");let{data:K,error:W}=yield this._exchangeCodeForSession(t.code);if(W)throw W;let re=new URL(window.location.href);return re.searchParams.delete("code"),window.history.replaceState(window.history.state,"",re.toString()),{data:{session:K.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:o,access_token:s,refresh_token:l,expires_in:c,expires_at:u,token_type:f}=t;if(!s||!c||!l||!f)throw new ka("No session defined in URL");let m=Math.round(Date.now()/1e3),w=parseInt(c),b=m+w;u&&(b=parseInt(u));let D=b-m;D*1e3<=Pa&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${D}s, should have been closer to ${w}s`);let T=b-w;m-T>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",T,b,m):m-T<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",T,b,m);let{data:M,error:P}=yield this._getUser(s);if(P)throw P;let U={provider_token:r,provider_refresh_token:o,access_token:s,expires_in:w,expires_at:b,refresh_token:l,token_type:f,user:M.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:U,redirectType:t.type},error:null}}catch(r){if(Pe(r))return{data:{session:null,redirectType:null},error:r};throw r}})}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}_isPKCECallback(t){return C(this,null,function*(){let i=yield ws(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&i)})}signOut(){return C(this,arguments,function*(t={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>C(this,null,function*(){return yield this._signOut(t)}))})}_signOut(){return C(this,arguments,function*({scope:t}={scope:"global"}){return yield this._useSession(i=>C(this,null,function*(){var r;let{data:o,error:s}=i;if(s)return{error:s};let l=(r=o.session)===null||r===void 0?void 0:r.access_token;if(l){let{error:c}=yield this.admin.signOut(l,t);if(c&&!(iO(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return t!=="others"&&(yield this._removeSession(),yield Vo(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(t){let i=pO(),r={id:i,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",i),this.stateChangeEmitters.delete(i)}};return this._debug("#onAuthStateChange()","registered callback with id",i),this.stateChangeEmitters.set(i,r),C(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>C(this,null,function*(){this._emitInitialSession(i)}))}),{data:{subscription:r}}}_emitInitialSession(t){return C(this,null,function*(){return yield this._useSession(i=>C(this,null,function*(){var r,o;try{let{data:{session:s},error:l}=i;if(l)throw l;yield(r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){yield(o=this.stateChangeEmitters.get(t))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}}))})}resetPasswordForEmail(r){return C(this,arguments,function*(t,i={}){let o=null,s=null;this.flowType==="pkce"&&([o,s]=yield Fa(this.storage,this.storageKey,!0));try{return yield $e(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:o,code_challenge_method:s,gotrue_meta_security:{captcha_token:i.captchaToken}},headers:this.headers,redirectTo:i.redirectTo})}catch(l){if(Pe(l))return{data:null,error:l};throw l}})}getUserIdentities(){return C(this,null,function*(){var t;try{let{data:i,error:r}=yield this.getUser();if(r)throw r;return{data:{identities:(t=i.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(i){if(Pe(i))return{data:null,error:i};throw i}})}linkIdentity(t){return C(this,null,function*(){var i;try{let{data:r,error:o}=yield this._useSession(s=>C(this,null,function*(){var l,c,u,f,m;let{data:w,error:b}=s;if(b)throw b;let D=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return yield $e(this.fetch,"GET",D,{headers:this.headers,jwt:(m=(f=w.session)===null||f===void 0?void 0:f.access_token)!==null&&m!==void 0?m:void 0})}));if(o)throw o;return Qi()&&!(!((i=t.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:t.provider,url:r?.url},error:null}}catch(r){if(Pe(r))return{data:{provider:t.provider,url:null},error:r};throw r}})}unlinkIdentity(t){return C(this,null,function*(){try{return yield this._useSession(i=>C(this,null,function*(){var r,o;let{data:s,error:l}=i;if(l)throw l;return yield $e(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(o=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})}))}catch(i){if(Pe(i))return{data:null,error:i};throw i}})}_refreshAccessToken(t){return C(this,null,function*(){let i=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{let r=Date.now();return yield vO(o=>C(this,null,function*(){return o>0&&(yield mO(200*Math.pow(2,o-1))),this._debug(i,"refreshing attempt",o),yield $e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:so})}),(o,s)=>{let l=200*Math.pow(2,o);return s&&_v(s)&&Date.now()+l-r<Pa})}catch(r){if(this._debug(i,"error",r),Pe(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(i,"end")}})}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}_handleProviderSignIn(t,i){return C(this,null,function*(){let r=yield this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:i.redirectTo,scopes:i.scopes,queryParams:i.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",i,"url",r),Qi()&&!i.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}})}_recoverAndRefresh(){return C(this,null,function*(){var t,i;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let o=yield ws(this.storage,this.storageKey);if(o&&this.userStorage){let l=yield ws(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:o.user},yield La(this.userStorage,this.storageKey+"-user",l)),o.user=(t=l?.user)!==null&&t!==void 0?t:Cv()}else if(o&&!o.user&&!o.user){let l=yield ws(this.storage,this.storageKey+"-user");l&&l?.user?(o.user=l.user,yield Vo(this.storage,this.storageKey+"-user"),yield La(this.storage,this.storageKey,o)):o.user=Cv()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&(yield this._removeSession());return}let s=((i=o.expires_at)!==null&&i!==void 0?i:1/0)*1e3-Date.now()<mv;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${mv}s`),s){if(this.autoRefreshToken&&o.refresh_token){let{error:l}=yield this._callRefreshToken(o.refresh_token);l&&(console.error(l),_v(l)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",l),yield this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{let{data:l,error:c}=yield this._getUser(o.access_token);!c&&l?.user?(o.user=l.user,yield this._saveSession(o),yield this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(r,"error getting user data, skipping SIGNED_IN notification",l)}else yield this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}})}_callRefreshToken(t){return C(this,null,function*(){var i,r;if(!t)throw new Yi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let o=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new _f;let{data:s,error:l}=yield this._refreshAccessToken(t);if(l)throw l;if(!s.session)throw new Yi;yield this._saveSession(s.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);let c={session:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(o,"error",s),Pe(s)){let l={session:null,error:s};return _v(s)||(yield this._removeSession()),(i=this.refreshingDeferred)===null||i===void 0||i.resolve(l),l}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(o,"end")}})}_notifyAllSubscribers(t,i,r=!0){return C(this,null,function*(){let o=`#_notifyAllSubscribers(${t})`;this._debug(o,"begin",i,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:i});let s=[],l=Array.from(this.stateChangeEmitters.values()).map(c=>C(this,null,function*(){try{yield c.callback(t,i)}catch(u){s.push(u)}}));if(yield Promise.all(l),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(o,"end")}})}_saveSession(t){return C(this,null,function*(){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;let i=Object.assign({},t),r=i.user&&i.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&i.user&&(yield La(this.userStorage,this.storageKey+"-user",{user:i.user}));let o=Object.assign({},i);delete o.user;let s=sE(o);yield La(this.storage,this.storageKey,s)}else{let o=sE(i);yield La(this.storage,this.storageKey,o)}})}_removeSession(){return C(this,null,function*(){this._debug("#_removeSession()"),yield Vo(this.storage,this.storageKey),yield Vo(this.storage,this.storageKey+"-code-verifier"),yield Vo(this.storage,this.storageKey+"-user"),this.userStorage&&(yield Vo(this.userStorage,this.storageKey+"-user")),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Qi()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(i){console.error("removing visibilitychange callback failed",i)}}_startAutoRefresh(){return C(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let t=setInterval(()=>this._autoRefreshTokenTick(),Pa);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(()=>C(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return C(this,null,function*(){this._debug("#_stopAutoRefresh()");let t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)})}startAutoRefresh(){return C(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return C(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return C(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>C(this,null,function*(){try{let t=Date.now();try{return yield this._useSession(i=>C(this,null,function*(){let{data:{session:r}}=i;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let o=Math.floor((r.expires_at*1e3-t)/Pa);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${Pa}ms, refresh threshold is ${gv} ticks`),o<=gv&&(yield this._callRefreshToken(r.refresh_token))}))}catch(i){console.error("Auto refresh tick failed with error. This is likely a transient error.",i)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(t){if(t.isAcquireTimeout||t instanceof yf)this._debug("auto refresh token tick lock not available");else throw t}})}_handleVisibilityChange(){return C(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!Qi()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>C(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})}_onVisibilityChanged(t){return C(this,null,function*(){let i=`#_onVisibilityChanged(${t})`;this._debug(i,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(yield this.initializePromise,yield this._acquireLock(-1,()=>C(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(i,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(t,i,r){return C(this,null,function*(){let o=[`provider=${encodeURIComponent(i)}`];if(r?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){let[s,l]=yield Fa(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});o.push(c.toString())}if(r?.queryParams){let s=new URLSearchParams(r.queryParams);o.push(s.toString())}return r?.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${o.join("&")}`})}_unenroll(t){return C(this,null,function*(){try{return yield this._useSession(i=>C(this,null,function*(){var r;let{data:o,error:s}=i;return s?{data:null,error:s}:yield $e(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})}))}catch(i){if(Pe(i))return{data:null,error:i};throw i}})}_enroll(t){return C(this,null,function*(){try{return yield this._useSession(i=>C(this,null,function*(){var r,o;let{data:s,error:l}=i;if(l)return{data:null,error:l};let c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:u,error:f}=yield $e(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(t.factorType==="totp"&&(!((o=u?.totp)===null||o===void 0)&&o.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})}))}catch(i){if(Pe(i))return{data:null,error:i};throw i}})}_verify(t){return C(this,null,function*(){return this._acquireLock(-1,()=>C(this,null,function*(){try{return yield this._useSession(i=>C(this,null,function*(){var r;let{data:o,error:s}=i;if(s)return{data:null,error:s};let{data:l,error:c}=yield $e(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})}))}catch(i){if(Pe(i))return{data:null,error:i};throw i}}))})}_challenge(t){return C(this,null,function*(){return this._acquireLock(-1,()=>C(this,null,function*(){try{return yield this._useSession(i=>C(this,null,function*(){var r;let{data:o,error:s}=i;return s?{data:null,error:s}:yield $e(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})}))}catch(i){if(Pe(i))return{data:null,error:i};throw i}}))})}_challengeAndVerify(t){return C(this,null,function*(){let{data:i,error:r}=yield this._challenge({factorId:t.factorId});return r?{data:null,error:r}:yield this._verify({factorId:t.factorId,challengeId:i.id,code:t.code})})}_listFactors(){return C(this,null,function*(){let{data:{user:t},error:i}=yield this.getUser();if(i)return{data:null,error:i};let r=t?.factors||[],o=r.filter(l=>l.factor_type==="totp"&&l.status==="verified"),s=r.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:r,totp:o,phone:s},error:null}})}_getAuthenticatorAssuranceLevel(){return C(this,null,function*(){return this._acquireLock(-1,()=>C(this,null,function*(){return yield this._useSession(t=>C(this,null,function*(){var i,r;let{data:{session:o},error:s}=t;if(s)return{data:null,error:s};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:l}=Sv(o.access_token),c=null;l.aal&&(c=l.aal);let u=c;((r=(i=o.user.factors)===null||i===void 0?void 0:i.filter(w=>w.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");let m=l.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:m},error:null}}))}))})}fetchJwk(r){return C(this,arguments,function*(t,i={keys:[]}){let o=i.keys.find(u=>u.kid===t);if(o)return o;let s=Date.now();if(o=this.jwks.keys.find(u=>u.kid===t),o&&this.jwks_cached_at+nO>s)return o;let{data:l,error:c}=yield $e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,o=l.keys.find(u=>u.kid===t),!o)?null:o})}getClaims(r){return C(this,arguments,function*(t,i={}){try{let o=t;if(!o){let{data:T,error:M}=yield this.getSession();if(M||!T.session)return{data:null,error:M};o=T.session.access_token}let{header:s,payload:l,signature:c,raw:{header:u,payload:f}}=Sv(o);i?.allowExpired||yO(l.exp);let m=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:yield this.fetchJwk(s.kid,i?.keys?{keys:i.keys}:i?.jwks);if(!m){let{error:T}=yield this.getUser(o);if(T)throw T;return{data:{claims:l,header:s,signature:c},error:null}}let w=bO(s.alg),b=yield crypto.subtle.importKey("jwk",m,w,!0,["verify"]);if(!(yield crypto.subtle.verify(w,b,c,dO(`${u}.${f}`))))throw new Oa("Invalid JWT signature");return{data:{claims:l,header:s,signature:c},error:null}}catch(o){if(Pe(o))return{data:null,error:o};throw o}})}}return n.nextInstanceID=0,n})();var E8=dE,uE=E8;var Dv=class extends uE{constructor(e){super(e)}};var x8=function(n,e,t,i){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function l(f){try{u(i.next(f))}catch(m){s(m)}}function c(f){try{u(i.throw(f))}catch(m){s(m)}}function u(f){f.done?o(f.value):r(f.value).then(l,c)}u((i=i.apply(n,e||[])).next())})},Iv=class{constructor(e,t,i){var r,o,s;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");let l=Qk(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);let u=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:qk,realtime:Zk,auth:Object.assign(Object.assign({},Gk),{storageKey:u}),global:$k},m=Kk(i??{},f);this.storageKey=(r=m.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(o=m.global.headers)!==null&&o!==void 0?o:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(w,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=m.auth)!==null&&s!==void 0?s:{},this.headers,m.global.fetch),this.fetch=Yk(t,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.rest=new Pk(new URL("rest/v1",c).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new ff(this.storageUrl.href,this.headers,this.fetch,i?.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new Qu(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},i={}){return this.rest.rpc(e,t,i)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return x8(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();let{data:i}=yield this.auth.getSession();return(t=(e=i.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,storageKey:o,flowType:s,lock:l,debug:c},u,f){let m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Dv({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),u),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,flowType:s,lock:l,debug:c,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new cf(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,i)=>{this._handleTokenChanged(t,"CLIENT",i?.access_token)})}_handleTokenChanged(e,t,i){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};var lo=(n,e,t)=>new Iv(n,e,t);function D8(){if(typeof window<"u"||typeof process>"u")return!1;let n=process.version;if(n==null)return!1;let e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}D8()&&console.warn("\u26A0\uFE0F  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var Nn={production:!1,supabaseUrl:"https://yfzqrntrqgpnpsintpwf.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmenFybnRycWdwbnBzaW50cHdmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5MjIzMjcsImV4cCI6MjA3MDQ5ODMyN30.hpG92qBI9N4U0-5rzWcKA6vIO2KLn40Vd096K1fCu-8"};var ue=class n{supabase=lo(Nn.supabaseUrl,Nn.supabaseAnonKey);profileCache=null;getClient(){return this.supabase}mapProfileRecord(e,t){let i=e?.id??t?.id??"",r=t?.email??e?.email??null;return{id:i,email:r,role:e?.role??null,salon_id:e?.salon_id??null,avatar_path:e?.avatar_path??null,full_name:e?.full_name??null,first_name:e?.first_name??null,last_name:e?.last_name??null,telefono:e?.telefono??null,sesso:e?.sesso??null,piva:e?.piva??null,pec:e?.pec??null,data_nascita:e?.data_nascita??null,luogo_nascita:e?.luogo_nascita??null,ragione_sociale:e?.ragione_sociale??null,logo_url:e?.logo_url??null,sito_web:e?.sito_web??e?.["sito web"]??null,provincia:e?.provincia??null,regione:e?.regione??null,indirizzo:e?.indirizzo??null,is_admin:e?.role?String(e.role).toLowerCase()==="admin":!1,created_at:e?.created_at??null,updated_at:e?.updated_at??null,scorte_basse:e?.scorte_basse??null,scorte_critiche:e?.scorte_critiche??null,descrizione:e?.descrizione||"",socials:{facebook:e?.facebook||void 0,instagram:e?.instagram||void 0,linkedin:e?.linkedin||void 0,whatsapp:e?.whatsapp||void 0},latitude:e?.latitude??null,longitude:e?.longitude??null}}getSessionUser(){return C(this,null,function*(){try{let{data:e,error:t}=yield this.supabase.auth.getSession();return t?String(t?.message??t).includes("NavigatorLockAcquireTimeoutError")?(console.warn("getSessionUser: lock timeout (non blocking):",t),null):(console.warn("Errore recupero sessione",t),null):e?.session?.user??null}catch(e){return String(e).includes("NavigatorLockAcquireTimeoutError")?(console.warn("getSessionUser catch: lock timeout (non blocking)",e),null):(console.error("getSessionUser critical error",e),null)}})}getCurrentUserId(){return C(this,null,function*(){try{let{data:e,error:t}=yield this.supabase.auth.getSession();return t?(console.warn("Errore recupero sessione",t),null):e?.session?.user?.id??null}catch(e){return console.error("Errore critico recupero ID utente:",e),null}})}getMyProfile(e=!1){return C(this,null,function*(){try{if(!e&&this.profileCache)return this.profileCache;let{data:t,error:i}=yield this.supabase.auth.getSession();if(i||!t?.session?.user)return console.error("Errore sessione:",i),null;let r=t.session.user,{data:o,error:s}=yield this.supabase.from("profiles").select("*, scorte_basse, scorte_critiche, facebook, instagram, linkedin, whatsapp, descrizione").eq("id",r.id).single();if(s){console.error("Errore recupero profilo:",s);let c=this.mapProfileRecord(null,r);return this.profileCache=c,c}let l=this.mapProfileRecord(o,r);return this.profileCache=l,l}catch(t){return console.error("Errore recupero profilo:",t),null}})}updateProfileLogo(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.from("profiles").update({logo_url:t}).eq("id",e);if(i)throw i;this.profileCache?.id===e&&(this.profileCache.logo_url=t)})}updateProfilePhone(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.from("profiles").update({telefono:t,updated_at:new Date().toISOString()}).eq("id",e);if(i)throw i;this.profileCache?.id===e&&(this.profileCache.telefono=t)})}updateProfileAddress(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.from("profiles").update({indirizzo:t,updated_at:new Date().toISOString()}).eq("id",e);if(i)throw console.error("Errore aggiornamento indirizzo:",i),i;this.profileCache?.id===e&&(this.profileCache.indirizzo=t)})}updateProfileWebsite(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.from("profiles").update({sito_web:t,updated_at:new Date().toISOString()}).eq("id",e);if(i)throw i;this.profileCache?.id===e&&(this.profileCache.sito_web=t)})}updateProfileLocation(e,t,i){return C(this,null,function*(){let{error:r}=yield this.supabase.from("profiles").update({provincia:t,regione:i}).eq("id",e);if(r)throw r;this.profileCache?.id===e&&(this.profileCache.provincia=t,this.profileCache.regione=i)})}updateProfileSocials(e,t){return C(this,null,function*(){try{let{error:i}=yield this.supabase.from("profiles").update({facebook:t.facebook||null,instagram:t.instagram||null,linkedin:t.linkedin||null,whatsapp:t.whatsapp||null,updated_at:new Date().toISOString()}).eq("id",e);if(i)throw i;this.profileCache?.id===e&&(this.profileCache.socials=t)}catch(i){throw console.error("Errore aggiornamento socials:",i),new Error("Impossibile aggiornare i social media")}})}updateProfileDescription(e,t){return C(this,null,function*(){let{data:i,error:r}=yield this.supabase.from("profiles").update({descrizione:t}).eq("id",e);if(r)throw r})}getProfileSocials(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.from("profiles").select("facebook, instagram, linkedin, whatsapp").eq("id",e).single();return i?(console.error("Errore recupero socials:",i),{}):{facebook:t?.facebook||void 0,instagram:t?.instagram||void 0,linkedin:t?.linkedin||void 0,whatsapp:t?.whatsapp||void 0}}catch(t){return console.error("Errore critico recupero socials:",t),{}}})}getProfileById(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.from("profiles").select("*").eq("id",e).single();return i?(console.error("Errore recupero profilo:",i),null):this.mapProfileRecord(t)}catch(t){return console.error("Errore critico recupero profilo:",t),null}})}uploadLogo(e){return C(this,null,function*(){let t=yield this.getCurrentUserId();if(!t)throw new Error("Utente non autenticato");try{let i=e.name.split(".").pop(),r=`${Date.now()}.${i}`,o=`${t}/${r}`,{error:s}=yield this.supabase.storage.from("logos").upload(o,e,{cacheControl:"3600",upsert:!0});if(s)throw s;let{data:l}=this.supabase.storage.from("logos").getPublicUrl(o);return yield this.updateProfileLogo(t,l.publicUrl),l.publicUrl}catch(i){throw console.error("Errore upload logo:",i),new Error("Impossibile caricare il logo")}})}getPublicLogoUrl(e){return C(this,null,function*(){let{data:t}=this.supabase.storage.from("logos").getPublicUrl(e);return t.publicUrl})}updateProfileField(e,t,i){return C(this,null,function*(){let{error:r}=yield this.getClient().from("profiles").update({[t]:i}).eq("id",e);if(r)throw console.error("Error updating profile field:",r),r})}getProfilesByIds(e){return C(this,null,function*(){if(!e||e.length===0)return[];try{let{data:t,error:i}=yield this.supabase.from("profiles").select("id, first_name, last_name, full_name, telefono, email").in("id",e);return i?(console.error("Errore recupero profili:",i),[]):t||[]}catch(t){return console.error("Errore critico recupero profili:",t),[]}})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var ln=class n{constructor(e){this.supabaseService=e;this.loadInitialProfile()}profileSubject=new Zt(null);profile$=this.profileSubject.asObservable();loadInitialProfile(){return C(this,null,function*(){let e=yield this.supabaseService.getMyProfile();this.profileSubject.next(e)})}register(e,t,i,r){return C(this,null,function*(){let{data:o,error:s}=yield this.supabaseService.getClient().auth.signUp({email:e,password:t,options:{data:{first_name:i,last_name:r,full_name:`${i} ${r}`}}});if(s)throw s;return o})}login(e,t){return C(this,null,function*(){let{data:i,error:r}=yield this.supabaseService.getClient().auth.signInWithPassword({email:e,password:t});if(r)throw r;let o=yield this.supabaseService.getMyProfile(!0);return this.profileSubject.next(o),i})}signOut(){return C(this,null,function*(){let{error:e}=yield this.supabaseService.getClient().auth.signOut();if(e)throw console.warn("Sign out error",e),e;this.clearProfileCache()})}getSessionUser(){return C(this,null,function*(){return this.supabaseService.getSessionUser()})}getCurrentUserId(){return C(this,null,function*(){return this.supabaseService.getCurrentUserId()})}getMyProfile(e=!1){return C(this,null,function*(){let t=yield this.supabaseService.getMyProfile(e);return this.profileSubject.next(t),t})}clearProfileCache(){this.supabaseService.getMyProfile(!0),this.profileSubject.next(null)}getAuthStateChanges(){return this.supabaseService.getClient().auth.onAuthStateChange}updateProfileLogo(e,t){return C(this,null,function*(){yield this.supabaseService.updateProfileLogo(e,t);let i=yield this.supabaseService.getMyProfile(!0);this.profileSubject.next(i)})}updateProfilePhone(e,t){return C(this,null,function*(){yield this.supabaseService.updateProfilePhone(e,t);let i=yield this.supabaseService.getMyProfile(!0);this.profileSubject.next(i)})}static \u0275fac=function(t){return new(t||n)(te(ue))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var _i=class n{constructor(e,t){this.supabase=e;this.auth=t}getDipendentiBySalon(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.getClient().from("dipendenti").select("*").eq("salon_id",e).order("cognome").order("nome");if(i)throw i;return t||[]})}createDipendente(e,t){return C(this,null,function*(){let{data:i,error:r}=yield this.supabase.getClient().from("dipendenti").insert([{salon_id:e,nome:t.nome,cognome:t.cognome,telefono:t.telefono,email:t.email,ruolo:t.ruolo,note:t.note,servizi:t.servizi||[],orari_lavoro:t.orari_lavoro||{fulltime:!0},assente:t.assente||!1,assente_fino:t.assente_fino||null}]).select().single();if(r)throw r;return i})}updateDipendente(e,t){return C(this,null,function*(){let i={nome:t.nome,cognome:t.cognome,telefono:t.telefono,email:t.email,ruolo:t.ruolo,note:t.note,updated_at:new Date().toISOString()};t.orari_lavoro!==void 0&&(i.orari_lavoro=t.orari_lavoro),t.assente!==void 0&&(i.assente=t.assente),t.assente_fino!==void 0&&(i.assente_fino=t.assente_fino);let{data:r,error:o}=yield this.supabase.getClient().from("dipendenti").update(i).eq("id",e).select().single();if(o)throw o;return r})}deleteDipendente(e){return C(this,null,function*(){let{error:t}=yield this.supabase.getClient().from("dipendenti").delete().eq("id",e);if(t)throw t})}setDipendenteServizi(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.getClient().from("dipendenti").update({servizi:t,updated_at:new Date().toISOString()}).eq("id",e);if(i)throw i})}getDipendentiByServizio(e,t){return C(this,null,function*(){try{let{data:i,error:r}=yield this.supabase.getClient().from("dipendenti").select("*").eq("salon_id",e);if(r)throw r;return i?i.filter(o=>(o.servizi||[]).includes(t)):[]}catch(i){return console.error("Errore recupero dipendenti:",i),[]}})}getDipendentiBySalonId(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.getClient().from("dipendenti").select("*").eq("salon_id",e);if(i)throw i;return t||[]})}getDipendentiWithServizi(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("dipendenti").select("*").eq("salon_id",e);return i?(console.error("Errore recupero dipendenti:",i),[]):t||[]}catch(t){return console.error("Errore critico recupero dipendenti:",t),[]}})}updateDipendenteServizi(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.getClient().from("dipendenti").update({servizi:t,updated_at:new Date().toISOString()}).eq("id",e);if(i)throw i})}getDipendenteById(e){return C(this,null,function*(){try{let i=(yield this.auth.getMyProfile(!0))?.id;if(!i)throw new Error("Salone non trovato");let{data:r,error:o}=yield this.supabase.getClient().from("dipendenti").select("*").eq("id",e).eq("salon_id",i).single();if(o)throw console.error("Errore nel recupero del dipendente:",o),o;return r}catch(t){throw console.error("Errore nel recupero del dipendente:",t),t}})}setDipendenteOrari(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.getClient().from("dipendenti").update({orari_lavoro:t,updated_at:new Date().toISOString()}).eq("id",e);if(i)throw i})}getDipendenteOrari(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.getClient().from("dipendenti").select("orari_lavoro").eq("id",e).single();if(i)throw i;return t?.orari_lavoro})}getDipendentiDisponibiliPerServizio(e,t,i,r){return C(this,null,function*(){try{let o=yield this.getDipendentiByServizio(e,t),s=[];for(let l of o)(yield this.isDipendenteDisponibile(l.id,i,r))&&s.push(l);return s}catch(o){return console.error("Errore recupero dipendenti disponibili:",o),[]}})}isDipendenteDisponibile(e,t,i){return C(this,null,function*(){try{let{data:r,error:o}=yield this.supabase.getClient().from("dipendenti").select("orari_lavoro, assente, assente_fino").eq("id",e).single();if(o)throw o;let s=r?.orari_lavoro,l=!!r?.assente,c=r?.assente_fino?new Date(r.assente_fino):null,u=new Date,f=new Date(u.getFullYear(),u.getMonth(),u.getDate());if(l&&!c)return!1;if(l&&c){let M=new Date(c.getFullYear(),c.getMonth(),c.getDate()),P=new Date(t+"T00:00:00");if(new Date(P.getFullYear(),P.getMonth(),P.getDate())<=M)return!1}if((!s||s.fulltime===!0)&&!l)return!0;let w=new Date(t+"T00:00:00").getDay().toString();if(!s||!s[w]||s[w].length===0)return!1;let[b,D]=i.split(":").map(Number),T=b*60+D;for(let M of s[w]){let[P,U]=M.start.split(":").map(Number),[K,W]=M.end.split(":").map(Number),re=P*60+U,fe=K*60+W;if(T>=re&&T<=fe)return!0}return!1}catch(r){return console.error("Errore verifica disponibilit\xE0 dipendente:",r),!1}})}setDipendenteAssenza(e,t,i){return C(this,null,function*(){let{error:r}=yield this.supabase.getClient().from("dipendenti").update({assente:t,assente_fino:i,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r})}static \u0275fac=function(t){return new(t||n)(te(ue),te(ln))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ss=class n{constructor(e){this.supabase=e}createChangeRequest(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.getClient().from("appointment_change_requests").insert(e).select().single();if(i)throw i;return t})}getPendingRequestsByClient(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("appointment_change_requests").select(`
        *,
        appointment:appointment_id (
          *,
          salon:salon_id (
            ragione_sociale
          ),
          service:service_id (
            name
          )
        )
      `).eq("appointment.client_id",e).eq("status","pending");return i?(console.error("Errore nel recupero delle richieste di modifica:",i),[]):(t||[]).map(r=>{let o=Array.isArray(r.appointment)?r.appointment[0]:r.appointment;return o&&(o.salon=Array.isArray(o.salon)?o.salon[0]:o.salon,o.service=Array.isArray(o.service)?o.service[0]:o.service),ne(B({},r),{appointment:o})})}catch(t){return console.error("Errore critico nel recupero delle richieste:",t),[]}})}updateRequestStatus(e,t){return C(this,null,function*(){let{data:i,error:r}=yield this.supabase.getClient().from("appointment_change_requests").update({status:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(r)throw r;return i})}getRequestById(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.getClient().from("appointment_change_requests").select(`
      *,
      appointment:appointment_id (*)
    `).eq("id",e).single();if(i)throw i;return t})}notifyClientAboutChangeRequest(e){return C(this,null,function*(){try{let t=yield this.getRequestById(e);console.log("Inviando notifica al cliente per la richiesta di modifica",e)}catch(t){console.error("Errore nell'invio della notifica:",t)}})}static \u0275fac=function(t){return new(t||n)(te(ue))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var qn=class n{constructor(e,t,i){this.supabase=e;this.dipendentiService=t;this.changeRequestService=i}createAppointment(e){return C(this,null,function*(){try{if(new Date(e.start_time)<new Date)throw new Error("Non \xE8 possibile creare appuntamenti nel passato");let i=e.client_id,r=e.salon_id,{data:o}=yield this.supabase.getClient().from("profiles").select("id, first_name, last_name, email, telefono").eq("id",i).single();if(o){let{data:c}=yield this.supabase.getClient().from("clients").select("id").eq("profile_id",o.id).eq("salon_id",r).single();if(c)i=c.id;else{let{data:u,error:f}=yield this.supabase.getClient().from("clients").insert([{salon_id:r,profile_id:o.id,first_name:o.first_name,last_name:o.last_name,email:o.email,phone:o.telefono,full_name:`${o.first_name} ${o.last_name}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();if(f)throw f;i=u.id,yield this.supabase.getClient().from("client_salons").insert([{client_id:u.id,salon_id:r}])}}let{data:s,error:l}=yield this.supabase.getClient().from("appointments").insert([ne(B({},e),{client_id:i})]).select();if(l)throw l;return s}catch(t){throw console.error("Errore nella creazione dell'appuntamento:",t),t}})}getAppointmentsBySalon(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("appointments").select("*").eq("salon_id",e).neq("status","cancelled").order("start_time",{ascending:!0});if(i)return console.error("Errore recupero appuntamenti:",i),[];if(!t||t.length===0)return[];let r=[...new Set(t.map(D=>D.client_id).filter(D=>D))],[o,s,l]=yield Promise.all([this.supabase.getClient().from("clients").select("*").in("id",r),this.supabase.getClient().from("profiles").select("*").in("id",r),this.supabase.getClient().from("services").select("*").in("id",[...new Set(t.map(D=>D.service_id).filter(D=>D))])]),c=o.data||[],u=s.data||[],f=l.data||[],m=new Map(c.map(D=>[D.id,D])),w=new Map(u.map(D=>[D.id,D])),b=new Map(f.map(D=>[D.id,D]));return t.map(D=>{let T=m.get(D.client_id)||w.get(D.client_id),M=b.get(D.service_id),P=T?.full_name||`${T?.first_name||""} ${T?.last_name||""}`.trim()||"Cliente sconosciuto";return ne(B({},D),{client_name:P,client_phone:T?.telefono||T?.phone||"N/D",client_email:T?.email||"N/D",service_name:M?.name||"Servizio sconosciuto"})})}catch(t){return console.error("Errore critico recupero appuntamenti:",t),[]}})}updateAppointment(e,t){return C(this,null,function*(){try{if(e.start_time&&new Date(e.start_time)<new Date)throw new Error("Non \xE8 possibile spostare appuntamenti nel passato");if(!t){let i=e,{id:s}=i,l=Sl(i,["id"]),{data:c,error:u}=yield this.supabase.getClient().from("appointments").update(l).eq("id",s).select().single();if(u)throw u;return c}let o=yield this.getAppointmentById(e.id);if(o.source==="client"&&t!==o.client_id){let s={appointment_id:e.id,requested_by:t,requested_start_time:e.start_time,requested_end_time:e.end_time,requested_service_id:e.service_id,requested_notes:e.notes,status:"pending"};return yield this.changeRequestService.createChangeRequest(s)}else{let r=e,{id:s}=r,l=Sl(r,["id"]),{data:c,error:u}=yield this.supabase.getClient().from("appointments").update(l).eq("id",s).select().single();if(u)throw u;return c}}catch(o){throw console.error("Errore updateAppointment:",o),o}})}getAppointmentById(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.getClient().from("appointments").select("*").eq("id",e).single();if(i)throw i;return t})}getAppointmentsBySalonAndTimeRange(e,t,i){return C(this,null,function*(){try{console.log("Querying appointments for salon:",e,"from",t,"to",i);let{data:r,error:o}=yield this.supabase.getClient().from("appointments").select("*").eq("salon_id",e).lt("start_time",i).gt("end_time",t).neq("status","cancelled");return o?(console.error("Errore recupero appuntamenti per intervallo:",o),[]):(console.log("Appointments found:",r),r||[])}catch(r){return console.error("Errore critico recupero appuntamenti per intervallo:",r),[]}})}getAppointmentsByDipendenteAndTimeRange(e,t,i){return C(this,null,function*(){try{let{data:r,error:o}=yield this.supabase.getClient().from("appointments").select("*").eq("dipendente_id",e).lt("start_time",i).gt("end_time",t).neq("status","cancelled");return o?(console.error("Errore recupero appuntamenti per dipendente:",o),[]):r||[]}catch(r){return console.error("Errore critico recupero appuntamenti per dipendente:",r),[]}})}checkAvailability(e,t,i,r,o="simple",s=1){return C(this,null,function*(){try{if(console.log("Checking availability with params:",{salonId:e,startTime:t,endTime:i,serviceId:r,appointmentMode:o,maxConcurrentAppointments:s}),o==="simple"){let l=yield this.getAppointmentsBySalonAndTimeRange(e,t,i);console.log("Existing appointments:",l);let c=l.filter(u=>u.status!=="cancelled");return console.log("Active appointments:",c),c.length>=s?{available:!1,reason:`Numero massimo di appuntamenti contemporanei (${s}) raggiunto`}:{available:!0}}else if(o==="advanced"){if(!r)return{available:!1,reason:"Servizio non selezionato"};let l=yield this.dipendentiService.getDipendentiByServizio(e,r);if(console.log("Dipendenti abilitati per servizio",r,":",l),l.length===0)return{available:!1,reason:"Nessun dipendente disponibile per questo servizio"};let c=0;for(let u of l){if((yield this.getAppointmentsByDipendenteAndTimeRange(u.id,t,i)).filter(T=>T.status!=="cancelled").length>0){c++;continue}let w=t.split("T")[0],b=t.split("T")[1].slice(0,5);(yield this.dipendentiService.isDipendenteDisponibile(u.id,w,b))||c++}return console.log(`Dipendenti occupati: ${c}, Dipendenti totali: ${l.length}`),c>=l.length?{available:!1,reason:"Nessun dipendente disponibile in questo orario"}:{available:!0}}return{available:!0}}catch(l){return console.error("Errore completo nel controllo disponibilit\xE0:",l),{available:!1,reason:"Errore nel controllo disponibilit\xE0"}}})}getAppointmentsByServiceAndTimeRange(e,t,i,r){return C(this,null,function*(){try{console.log("Querying appointments for service:",t,"from",i,"to",r);let{data:o,error:s}=yield this.supabase.getClient().from("appointments").select("*").eq("salon_id",e).eq("service_id",t).lt("start_time",r).gt("end_time",i).neq("status","cancelled");return s?(console.error("Errore recupero appuntamenti per servizio:",s),[]):(console.log("Appointments found for service:",o),o||[])}catch(o){return console.error("Errore critico recupero appuntamenti per servizio:",o),[]}})}getAppointmentsByClient(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.getClient().from("clients").select("id").eq("profile_id",e);if(i)return console.error("Errore recupero clienti:",i),[];let r=t?.map(l=>l.id)||[e],{data:o,error:s}=yield this.supabase.getClient().from("appointments").select(`
      *,
      profiles:salon_id(
        ragione_sociale, comune, provincia, regione, indirizzo, logo_url,
        latitude, longitude
      ),
      services:service_id(name)
    `).in("client_id",r).order("start_time",{ascending:!1});return s?(console.error("Errore getAppointmentsByClient:",s),[]):o||[]})}cancelAppointment(e){return C(this,null,function*(){try{return yield this.updateAppointment({id:e,status:"cancelled",cancelled_at:new Date().toISOString()})}catch(t){throw console.error("Errore durante la cancellazione:",t),t}})}getCancelledAppointments(e,t=10){return C(this,null,function*(){try{let i=new Date;i.setDate(i.getDate()-t);let{data:r,error:o}=yield this.supabase.getClient().from("appointments").select("*").eq("salon_id",e).eq("status","cancelled").gte("cancelled_at",i.toISOString()).order("cancelled_at",{ascending:!1});if(o)return console.error("Errore recupero appuntamenti cancellati:",o),[];let s=r||[];if(s.length===0)return console.log("Nessun appuntamento cancellato trovato:",s),[];let l=Array.from(new Set(s.map(f=>f.service_id).filter(f=>f!=null))),c={};if(l.length>0){let{data:f,error:m}=yield this.supabase.getClient().from("services").select("*").in("id",l);m?console.error("Errore recupero servizi:",m):f&&(c=f.reduce((w,b)=>(w[String(b.id)]=b,w),{}))}let u=s.map(f=>{let m=f.service_id!==null&&f.service_id!==void 0?String(f.service_id):null;return ne(B({},f),{servizio:m?c[m]??null:null})});return console.log("Dati appuntamenti cancellati arricchiti:",u),u}catch(i){return console.error("Errore critico recupero appuntamenti cancellati:",i),[]}})}getRequestById(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.getClient().from("appointment_change_requests").select(`
      *,
      appointment:appointment_id (*)
    `).eq("id",e).single();if(i)throw i;return t})}static \u0275fac=function(t){return new(t||n)(te(ue),te(_i),te(Ss))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var Mv=class n{constructor(e,t,i){this.supabase=e;this.auth=t;this.appointmentService=i}getAppointmentsInDateRange(e,t){return C(this,null,function*(){let i=yield this.auth.getMyProfile();if(!i?.id)return[];let{data:r,error:o}=yield this.supabase.getClient().from("appointments").select("*").eq("salon_id",i.id).in("status",["confirmed","completed"]).gte("start_time",e.toISOString()).lte("start_time",t.toISOString());return o?(console.error("Error fetching appointments in date range:",o),[]):r||[]})}getRevenueInDateRange(e,t){return C(this,null,function*(){let i=yield this.auth.getMyProfile();if(!i?.id)return 0;let{data:r,error:o}=yield this.supabase.getClient().from("appointments").select("price").eq("salon_id",i.id).in("status",["confirmed","completed"]).gte("start_time",e.toISOString()).lte("start_time",t.toISOString());return o?(console.error("Error fetching revenue in date range:",o),0):r.reduce((s,l)=>s+(l.price||0),0)})}getUniqueClientsInDateRange(e,t){return C(this,null,function*(){let i=yield this.auth.getMyProfile();if(!i?.id)return 0;let{data:r,error:o}=yield this.supabase.getClient().from("appointments").select("client_id").eq("salon_id",i.id).in("status",["confirmed","completed"]).gte("start_time",e.toISOString()).lte("start_time",t.toISOString());return o?(console.error("Error fetching unique clients in date range:",o),0):new Set(r.map(l=>l.client_id).filter(l=>l)).size})}getAppointmentsCountInDateRange(e,t){return C(this,null,function*(){let i=yield this.auth.getMyProfile();if(!i?.id)return 0;let{count:r,error:o}=yield this.supabase.getClient().from("appointments").select("*",{count:"exact"}).eq("salon_id",i.id).in("status",["confirmed","completed"]).gte("start_time",e.toISOString()).lte("start_time",t.toISOString());return o?(console.error("Error fetching appointments count in date range:",o),0):r||0})}getAppointmentsLast30Days(){return C(this,null,function*(){let e=new Date,t=new Date;return t.setDate(t.getDate()-30),this.getAppointmentsCountInDateRange(t,e)})}getAppointmentsPrevious30Days(){return C(this,null,function*(){let e=new Date;e.setDate(e.getDate()-30);let t=new Date;return t.setDate(t.getDate()-60),this.getAppointmentsCountInDateRange(t,e)})}getRevenueLast30Days(){return C(this,null,function*(){let e=new Date,t=new Date;return t.setDate(t.getDate()-30),this.getRevenueInDateRange(t,e)})}getRevenuePrevious30Days(){return C(this,null,function*(){let e=new Date;e.setDate(e.getDate()-30);let t=new Date;return t.setDate(t.getDate()-60),this.getRevenueInDateRange(t,e)})}getRevenueLast365Days(){return C(this,null,function*(){let e=new Date,t=new Date;return t.setDate(t.getDate()-365),this.getRevenueInDateRange(t,e)})}getRevenuePrevious365Days(){return C(this,null,function*(){let e=new Date;e.setDate(e.getDate()-365);let t=new Date;return t.setDate(t.getDate()-730),this.getRevenueInDateRange(t,e)})}getUniqueClientsLast30Days(){return C(this,null,function*(){let e=new Date,t=new Date;return t.setDate(t.getDate()-30),this.getUniqueClientsInDateRange(t,e)})}getUniqueClientsPrevious30Days(){return C(this,null,function*(){let e=new Date;e.setDate(e.getDate()-30);let t=new Date;return t.setDate(t.getDate()-60),this.getUniqueClientsInDateRange(t,e)})}getAverageTicketLast30Days(){return C(this,null,function*(){let e=yield this.getRevenueLast30Days(),t=yield this.getUniqueClientsLast30Days();return t>0?e/t:0})}getAverageTicketPrevious30Days(){return C(this,null,function*(){let e=yield this.getRevenuePrevious30Days(),t=yield this.getUniqueClientsPrevious30Days();return t>0?e/t:0})}getUpcomingAppointments(e=5){return C(this,null,function*(){let t=yield this.auth.getMyProfile();if(!t?.id)return[];let i=yield this.appointmentService.getAppointmentsBySalon(t.id),r=new Date;return i.filter(s=>s.status==="confirmed"&&new Date(s.start_time)>=r).sort((s,l)=>new Date(s.start_time).getTime()-new Date(l.start_time).getTime()).slice(0,e).map(s=>({id:s.id,clientName:s.client_name||"Cliente",serviceName:s.service_name||"Servizio",time:this.formatTime(s.start_time),date:this.formatDate(s.start_time)}))})}formatTime(e){try{return new Date(e).toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit",hour12:!1})}catch(t){return console.error("Error formatting time:",t,e),"--:--"}}formatDate(e){try{let t=new Date(e),i=new Date,r=new Date(i);r.setDate(r.getDate()+1),i.setHours(0,0,0,0),r.setHours(0,0,0,0);let o=new Date(t);return o.setHours(0,0,0,0),o.getTime()===i.getTime()?"Oggi":o.getTime()===r.getTime()?"Domani":t.toLocaleDateString("it-IT",{weekday:"short",day:"numeric",month:"short"})}catch(t){return console.error("Error formatting date:",t,e),"Data sconosciuta"}}debugUpcomingAppointments(){return C(this,null,function*(){let e=yield this.auth.getMyProfile();if(!e?.id)return;let t=new Date;console.log("Current time:",t.toISOString());let{data:i,error:r}=yield this.supabase.getClient().from("appointments").select("*").eq("salon_id",e.id).eq("status","confirmed").gte("start_time",t.toISOString()).order("start_time",{ascending:!0});if(r){console.error("Debug - Error fetching appointments:",r);return}console.log("Debug - All upcoming appointments:",i),i.forEach(o=>{console.log(`Appointment ${o.id}: ${o.start_time}, parsed: ${new Date(o.start_time)}`)})})}static \u0275fac=function(t){return new(t||n)(te(ue),te(ln),te(qn))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};function M8(n,e){n&1&&(g(0,"div",12)(1,"div",13),ie(2,"div",14),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}function T8(n,e){if(n&1&&(g(0,"div",15)(1,"p"),v(2),p()()),n&2){let t=E();_(2),q(t.error)}}function P8(n,e){if(n&1&&(g(0,"div",16)(1,"div",17)(2,"h3",18),v(3,"Appuntamenti (30gg)"),p(),g(4,"p",19),v(5),p(),g(6,"div",20),v(7),p()(),g(8,"div",17)(9,"h3",18),v(10,"Fatturato (30gg)"),p(),g(11,"p",19),v(12),p(),g(13,"div",20),v(14),p()(),g(15,"div",17)(16,"h3",18),v(17,"Fatturato (anno)"),p(),g(18,"p",19),v(19),p(),g(20,"div",20),v(21),p()(),g(22,"div",17)(23,"h3",18),v(24,"Scontrino medio"),p(),g(25,"p",19),v(26),p(),g(27,"div",20),v(28),p()()()),n&2){let t=E();_(5),q(t.kpiData.appointmentsLast30Days),_(),hs(t.getTrendClass(t.kpiData.trends.appointments)),_(),J(" ",t.getTrendText(t.kpiData.trends.appointments)," "),_(5),q(t.formatCurrency(t.kpiData.revenueLast30Days)),_(),hs(t.getTrendClass(t.kpiData.trends.revenue30)),_(),J(" ",t.getTrendText(t.kpiData.trends.revenue30)," "),_(5),q(t.formatCurrency(t.kpiData.revenueLast365Days)),_(),hs(t.getTrendClass(t.kpiData.trends.revenue365)),_(),J(" ",t.getTrendText(t.kpiData.trends.revenue365,"anno")," "),_(5),q(t.formatCurrency(t.kpiData.averageTicketLast30Days)),_(),hs(t.getTrendClass(t.kpiData.trends.averageTicket)),_(),J(" ",t.getTrendText(t.kpiData.trends.averageTicket)," ")}}function A8(n,e){if(n&1&&(g(0,"div",24)(1,"div",25)(2,"div",26),v(3),p(),g(4,"div",27),v(5),p()(),g(6,"div",28)(7,"div"),v(8),p(),g(9,"div",29),v(10),p()()()),n&2){let t=e.$implicit;_(3),q(t.clientName),_(2),q(t.serviceName),_(3),q(t.time),_(2),q(t.date)}}function R8(n,e){n&1&&(g(0,"div",30)(1,"p"),v(2,"Nessun appuntamento in programma"),p()())}function k8(n,e){if(n&1&&(g(0,"div")(1,"div",21),N(2,A8,11,4,"div",22)(3,R8,3,0,"div",23),p()()),n&2){let t=E();_(2),x("ngForOf",t.recentAppointments),_(),x("ngIf",t.recentAppointments.length===0)}}var Tv=class n{constructor(e,t){this.kpiService=e;this.auth=t}kpiData={appointmentsLast30Days:0,appointmentsPrevious30Days:0,revenueLast30Days:0,revenuePrevious30Days:0,revenueLast365Days:0,revenuePrevious365Days:0,averageTicketLast30Days:0,averageTicketPrevious30Days:0,trends:{appointments:0,revenue30:0,revenue365:0,averageTicket:0}};recentAppointments=[];loading=!0;error=null;ngOnInit(){return C(this,null,function*(){try{yield this.loadKpiData(),yield this.loadRecentAppointments(),yield this.kpiService.debugUpcomingAppointments()}catch(e){console.error("Error loading data:",e),this.error="Errore nel caricamento dei dati"}finally{this.loading=!1}})}loadKpiData(){return C(this,null,function*(){try{let[e,t,i,r,o,s,l,c]=yield Promise.all([this.kpiService.getAppointmentsLast30Days(),this.kpiService.getAppointmentsPrevious30Days(),this.kpiService.getRevenueLast30Days(),this.kpiService.getRevenuePrevious30Days(),this.kpiService.getRevenueLast365Days(),this.kpiService.getRevenuePrevious365Days(),this.kpiService.getAverageTicketLast30Days(),this.kpiService.getAverageTicketPrevious30Days()]),u=this.calculateTrend(e,t),f=this.calculateTrend(i,r),m=this.calculateTrend(o,s),w=this.calculateTrend(l,c);this.kpiData={appointmentsLast30Days:e,appointmentsPrevious30Days:t,revenueLast30Days:i,revenuePrevious30Days:r,revenueLast365Days:o,revenuePrevious365Days:s,averageTicketLast30Days:l,averageTicketPrevious30Days:c,trends:{appointments:u,revenue30:f,revenue365:m,averageTicket:w}}}catch(e){throw console.error("Error loading KPI data:",e),e}})}loadRecentAppointments(){return C(this,null,function*(){try{this.recentAppointments=yield this.kpiService.getUpcomingAppointments(5),console.log("Recent appointments loaded:",this.recentAppointments)}catch(e){console.error("Error loading recent appointments:",e),this.recentAppointments=[]}})}calculateTrend(e,t){return t===0?e>0?100:0:(e-t)/t*100}abs(e){return Math.abs(e)}formatCurrency(e){return e.toLocaleString("it-IT",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2})}getTrendIcon(e){return e>=0?"\u2191":"\u2193"}getTrendClass(e){return e>=0?"trend-up":"trend-down"}getTrendText(e,t="mese"){let i=Math.abs(e);return`${this.getTrendIcon(e)} ${i.toFixed(1)}% vs ${t} scorso`}static \u0275fac=function(t){return new(t||n)(z(Mv),z(ln))};static \u0275cmp=he({type:n,selectors:[["app-home"]],decls:27,vars:4,consts:[[1,"container"],[1,"section-title"],["routerLink","/admin/home",1,"active"],["routerLink","/admin/calendario"],["routerLink","/admin/clienti"],["routerLink","/admin/servizi"],["routerLink","/admin/lista-prodotti"],["class","loading-overlay",4,"ngIf"],["class","error-message",4,"ngIf"],["class","kpi-cards",4,"ngIf"],[1,"section-subtitle"],[4,"ngIf"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"],[1,"error-message"],[1,"kpi-cards"],[1,"kpi-card"],[1,"kpi-title"],[1,"kpi-value"],[1,"kpi-trend"],[1,"appointment-list"],["class","appointment-item",4,"ngFor","ngForOf"],["class","no-appointments",4,"ngIf"],[1,"appointment-item"],[1,"client-info"],[1,"client-name"],[1,"service-name"],[1,"appointment-time"],[1,"appointment-date"],[1,"no-appointments"]],template:function(t,i){t&1&&(g(0,"div",0)(1,"h2",1),v(2,"Home"),p(),g(3,"header")(4,"nav")(5,"ul")(6,"li")(7,"a",2),v(8,"Home"),p()(),g(9,"li")(10,"a",3),v(11,"Calendario"),p()(),g(12,"li")(13,"a",4),v(14,"Clienti"),p()(),g(15,"li")(16,"a",5),v(17,"Servizi"),p()(),g(18,"li")(19,"a",6),v(20,"Prodotti"),p()()()()(),N(21,M8,5,0,"div",7)(22,T8,3,1,"div",8)(23,P8,29,16,"div",9),g(24,"h3",10),v(25,"Prossimi Appuntamenti"),p(),N(26,k8,4,2,"div",11),p()),t&2&&(_(21),x("ngIf",i.loading),_(),x("ngIf",i.error),_(),x("ngIf",!i.loading&&!i.error),_(3),x("ngIf",!i.loading&&!i.error))},dependencies:[bt,sn,Se,Ze,Ne],styles:["header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:var(--padding-v);border-bottom:1px solid var(--secondary);margin:0 0 var(--padding-h) 0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;list-style:none;gap:var(--padding-v);padding:var(--padding-v) 0;margin:0}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--text-light);text-decoration:none;transition:color .3s;padding:var(--padding-v);border-radius:var(--border-radius)}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:var(--primary);background:color-mix(in srgb,var(--primary) 20%,transparent)}.kpi-trend[_ngcontent-%COMP%]{font-size:.8rem;display:flex;align-items:center;justify-content:center;gap:5px;margin-top:5px}.trend-up[_ngcontent-%COMP%]{color:var(--success)}.trend-down[_ngcontent-%COMP%]{color:var(--danger)}.recent-appointments[_ngcontent-%COMP%]{background:var(--background2);border-radius:var(--border-radius);padding:20px;margin-top:20px}.appointment-list[_ngcontent-%COMP%]{display:grid;gap:var(--padding-v)}.appointment-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;padding:var(--padding-v);background:var(--background2);border-radius:var(--border-radius);align-items:center;border:1px solid color-mix(in srgb,var(--secondary) 70%,transparent)}.client-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--padding-v)}.client-name[_ngcontent-%COMP%]{font-weight:500;color:var(--primary);font-size:var(--font-size-lg)}.service-name[_ngcontent-%COMP%]{color:var(--text-muted);font-size:var(--font-size-base)}.appointment-time[_ngcontent-%COMP%], .appointment-date[_ngcontent-%COMP%]{color:var(--text-light)}@media (max-width: 768px){header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;text-align:center}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{justify-content:center;flex-wrap:wrap}.appointment-item[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:10px;text-align:center}.appointment-time[_ngcontent-%COMP%]{text-align:center}}"]})};var LO=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||n)(z(Wn),z(ft))};static \u0275dir=Ee({type:n})}return n})(),Df=(()=>{class n extends LO{static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,features:[Et]})}return n})(),Ha=new se(""),O8={provide:Ha,useExisting:Rt(()=>Dr),multi:!0},Dr=(()=>{class n extends Df{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){i&1&&F("change",function(s){return r.onChange(s.target.checked)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Tt([O8]),Et]})}return n})(),N8={provide:Ha,useExisting:Rt(()=>st),multi:!0};function L8(){let n=$i()?$i().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var F8=new se(""),st=(()=>{class n extends LO{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!L8())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||n)(z(Wn),z(ft),z(F8,8))};static \u0275dir=Ee({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&F("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Tt([N8]),Et]})}return n})();function mE(n){return n==null||vE(n)===0}function vE(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var ki=new se(""),Bc=new se(""),z8=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,co=class{static min(e){return FO(e)}static max(e){return zO(e)}static required(e){return VO(e)}static requiredTrue(e){return V8(e)}static email(e){return jO(e)}static minLength(e){return BO(e)}static maxLength(e){return UO(e)}static pattern(e){return HO(e)}static nullValidator(e){return Av()}static compose(e){return YO(e)}static composeAsync(e){return QO(e)}};function FO(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function zO(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function VO(n){return mE(n.value)?{required:!0}:null}function V8(n){return n.value===!0?null:{required:!0}}function jO(n){return mE(n.value)||z8.test(n.value)?null:{email:!0}}function BO(n){return e=>{let t=e.value?.length??vE(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function UO(n){return e=>{let t=e.value?.length??vE(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function HO(n){if(!n)return Av;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(mE(i.value))return null;let r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}function Av(n){return null}function WO(n){return n!=null}function $O(n){return ps(n)?_t(n):n}function qO(n){let e={};return n.forEach(t=>{e=t!=null?B(B({},e),t):e}),Object.keys(e).length===0?null:e}function GO(n,e){return e.map(t=>t(n))}function j8(n){return!n.validate}function ZO(n){return n.map(e=>j8(e)?e:t=>e.validate(t))}function YO(n){if(!n)return null;let e=n.filter(WO);return e.length==0?null:function(t){return qO(GO(t,e))}}function _E(n){return n!=null?YO(ZO(n)):null}function QO(n){if(!n)return null;let e=n.filter(WO);return e.length==0?null:function(t){let i=GO(t,e).map($O);return Oy(i).pipe(ke(qO))}}function yE(n){return n!=null?QO(ZO(n)):null}function IO(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function KO(n){return n._rawValidators}function JO(n){return n._rawAsyncValidators}function pE(n){return n?Array.isArray(n)?n:[n]:[]}function Rv(n,e){return Array.isArray(n)?n.includes(e):n===e}function MO(n,e){let t=pE(e);return pE(n).forEach(r=>{Rv(t,r)||t.push(r)}),t}function TO(n,e){return pE(e).filter(t=>!Rv(n,t))}var kv=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=_E(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=yE(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},oi=class extends kv{name;get formDirective(){return null}get path(){return null}},Ua=class extends kv{_parent=null;name=null;valueAccessor=null},Ov=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},B8={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},pye=ne(B({},B8),{"[class.ng-submitted]":"isSubmitted"}),at=(()=>{class n extends Ov{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(z(Ua,2))};static \u0275dir=Ee({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Oe("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[Et]})}return n})(),yi=(()=>{class n extends Ov{constructor(t){super(t)}static \u0275fac=function(i){return new(i||n)(z(oi,10))};static \u0275dir=Ee({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&Oe("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[Et]})}return n})();var bf="VALID",Pv="INVALID",Fc="PENDING",wf="DISABLED",Cs=class{},Nv=class extends Cs{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Cf=class extends Cs{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Ef=class extends Cs{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},zc=class extends Cs{status;source;constructor(e,t){super(),this.status=e,this.source=t}},Lv=class extends Cs{source;constructor(e){super(),this.source=e}},Fv=class extends Cs{source;constructor(e){super(),this.source=e}};function bE(n){return(Bv(n)?n.validators:n)||null}function U8(n){return Array.isArray(n)?_E(n):n||null}function wE(n,e){return(Bv(e)?e.asyncValidators:n)||null}function H8(n){return Array.isArray(n)?yE(n):n||null}function Bv(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function XO(n,e,t){let i=n.controls;if(!(e?Object.keys(i):i).length)throw new oe(1e3,"");if(!i[t])throw new oe(1001,"")}function eN(n,e,t){n._forEachChild((i,r)=>{if(t[r]===void 0)throw new oe(1002,"")})}var Vc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return gi(this.statusReactive)}set status(e){gi(()=>this.statusReactive.set(e))}_status=ma(()=>this.statusReactive());statusReactive=Un(void 0);get valid(){return this.status===bf}get invalid(){return this.status===Pv}get pending(){return this.status==Fc}get disabled(){return this.status===wf}get enabled(){return this.status!==wf}errors;get pristine(){return gi(this.pristineReactive)}set pristine(e){gi(()=>this.pristineReactive.set(e))}_pristine=ma(()=>this.pristineReactive());pristineReactive=Un(!0);get dirty(){return!this.pristine}get touched(){return gi(this.touchedReactive)}set touched(e){gi(()=>this.touchedReactive.set(e))}_touched=ma(()=>this.touchedReactive());touchedReactive=Un(!1);get untouched(){return!this.touched}_events=new _e;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(MO(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(MO(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(TO(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(TO(e,this._rawAsyncValidators))}hasValidator(e){return Rv(this._rawValidators,e)}hasAsyncValidator(e){return Rv(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(ne(B({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Ef(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new Ef(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(ne(B({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Cf(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new Cf(!0,i))}markAsPending(e={}){this.status=Fc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new zc(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(ne(B({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=wf,this.errors=null,this._forEachChild(r=>{r.disable(ne(B({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Nv(this.value,i)),this._events.next(new zc(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ne(B({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=bf,this._forEachChild(i=>{i.enable(ne(B({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ne(B({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===bf||this.status===Fc)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Nv(this.value,t)),this._events.next(new zc(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(ne(B({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?wf:bf}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Fc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=$O(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new zc(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new ye,this.statusChanges=new ye}_calculateStatus(){return this._allControlsDisabled()?wf:this.errors?Pv:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Fc)?Fc:this._anyControlsHaveStatus(Pv)?Pv:bf}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new Cf(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Ef(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Bv(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=U8(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=H8(this._rawAsyncValidators)}},jc=class extends Vc{constructor(e,t,i){super(bE(t),wE(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){eN(this,!0,e),Object.keys(e).forEach(i=>{XO(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(i=>{let r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e?e[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>i._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var hE=class extends jc{};var If=new se("",{providedIn:"root",factory:()=>Uv}),Uv="always";function Hv(n,e){return[...e.path,n]}function zv(n,e,t=Uv){SE(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),$8(n,e),G8(n,e),q8(n,e),W8(n,e)}function PO(n,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),jv(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Vv(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function W8(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function SE(n,e){let t=KO(n);e.validator!==null?n.setValidators(IO(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=JO(n);e.asyncValidator!==null?n.setAsyncValidators(IO(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();Vv(e._rawValidators,r),Vv(e._rawAsyncValidators,r)}function jv(n,e){let t=!1;if(n!==null){if(e.validator!==null){let r=KO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.validator);o.length!==r.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let r=JO(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==e.asyncValidator);o.length!==r.length&&(t=!0,n.setAsyncValidators(o))}}}let i=()=>{};return Vv(e._rawValidators,i),Vv(e._rawAsyncValidators,i),t}function $8(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&tN(n,e)})}function q8(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&tN(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function tN(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function G8(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function nN(n,e){n==null,SE(n,e)}function Z8(n,e){return jv(n,e)}function iN(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function Y8(n){return Object.getPrototypeOf(n.constructor)===Df}function rN(n,e){n._syncPendingControls(),e.forEach(t=>{let i=t.control;i.updateOn==="submit"&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function oN(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(o=>{o.constructor===st?t=o:Y8(o)?i=o:r=o}),r||i||t||null}function Q8(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var K8={provide:oi,useExisting:Rt(()=>Ir)},Sf=Promise.resolve(),Ir=(()=>{class n extends oi{callSetDisabledState;get submitted(){return gi(this.submittedReactive)}_submitted=ma(()=>this.submittedReactive());submittedReactive=Un(!1);_directives=new Set;form;ngSubmit=new ye;options;constructor(t,i,r){super(),this.callSetDisabledState=r,this.form=new jc({},_E(t),yE(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Sf.then(()=>{let i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),zv(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Sf.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Sf.then(()=>{let i=this._findContainer(t.path),r=new jc({});nN(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Sf.then(()=>{let i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){Sf.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),rN(this.form,this._directives),this.ngSubmit.emit(t),this.form._events.next(new Lv(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1),this.form._events.next(new Fv(this.form))}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(i){return new(i||n)(z(ki,10),z(Bc,10),z(If,8))};static \u0275dir=Ee({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){i&1&&F("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Tt([K8]),Et]})}return n})();function AO(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function RO(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var xf=class extends Vc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(bE(t),wE(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Bv(t)&&(t.nonNullable||t.initialValueIsDefault)&&(RO(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){AO(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){AO(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){RO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var J8=n=>n instanceof xf,X8=(()=>{class n extends oi{_parent;ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return Hv(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,standalone:!1,features:[Et]})}return n})();var eW={provide:Ua,useExisting:Rt(()=>pt)},kO=Promise.resolve(),pt=(()=>{class n extends Ua{_changeDetectorRef;callSetDisabledState;control=new xf;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new ye;constructor(t,i,r,o,s,l){super(),this._changeDetectorRef=s,this.callSetDisabledState=l,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=oN(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),iN(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){zv(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){kO.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,r=i!==0&&An(i);kO.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?Hv(t,this._parent):[t]}static \u0275fac=function(i){return new(i||n)(z(oi,9),z(ki,10),z(Bc,10),z(Ha,10),z(Pn,8),z(If,8))};static \u0275dir=Ee({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Tt([eW]),Et,Dn]})}return n})();var bi=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ee({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})(),tW={provide:Ha,useExisting:Rt(()=>Wa),multi:!0},Wa=(()=>{class n extends Df{writeValue(t){let i=t??"";this.setProperty("value",i)}registerOnChange(t){this.onChange=i=>{t(i==""?null:parseFloat(i))}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){i&1&&F("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Tt([tW]),Et]})}return n})();var sN=new se("");var nW={provide:oi,useExisting:Rt(()=>Uc)},Uc=(()=>{class n extends oi{callSetDisabledState;get submitted(){return gi(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=ma(()=>this._submittedReactive());_submittedReactive=Un(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new ye;constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(jv(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let i=this.form.get(t.path);return zv(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){PO(t.control||null,t,!1),Q8(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this._submittedReactive.set(!0),rN(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Lv(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0,i={}){this.form.reset(t,i),this._submittedReactive.set(!1),i?.emitEvent!==!1&&this.form._events.next(new Fv(this.form))}_updateDomValue(){this.directives.forEach(t=>{let i=t.control,r=this.form.get(t.path);i!==r&&(PO(i||null,t),J8(r)&&(zv(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let i=this.form.get(t.path);nN(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let i=this.form.get(t.path);i&&Z8(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){SE(this.form,this),this._oldForm&&jv(this._oldForm,this)}static \u0275fac=function(i){return new(i||n)(z(ki,10),z(Bc,10),z(If,8))};static \u0275dir=Ee({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&F("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Tt([nW]),Et,Dn]})}return n})(),iW={provide:oi,useExisting:Rt(()=>Wv)},Wv=(()=>{class n extends X8{name=null;constructor(t,i,r){super(),this._parent=t,this._setValidators(i),this._setAsyncValidators(r)}_checkParentType(){aN(this._parent)}static \u0275fac=function(i){return new(i||n)(z(oi,13),z(ki,10),z(Bc,10))};static \u0275dir=Ee({type:n,selectors:[["","formGroupName",""]],inputs:{name:[0,"formGroupName","name"]},standalone:!1,features:[Tt([iW]),Et]})}return n})(),rW={provide:oi,useExisting:Rt(()=>$v)},$v=(()=>{class n extends oi{_parent;name=null;constructor(t,i,r){super(),this._parent=t,this._setValidators(i),this._setAsyncValidators(r)}ngOnInit(){aN(this._parent),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective?.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return Hv(this.name==null?this.name:this.name.toString(),this._parent)}static \u0275fac=function(i){return new(i||n)(z(oi,13),z(ki,10),z(Bc,10))};static \u0275dir=Ee({type:n,selectors:[["","formArrayName",""]],inputs:{name:[0,"formArrayName","name"]},standalone:!1,features:[Tt([rW]),Et]})}return n})();function aN(n){return!(n instanceof Wv)&&!(n instanceof Uc)&&!(n instanceof $v)}var oW={provide:Ua,useExisting:Rt(()=>Mf)},Mf=(()=>{class n extends Ua{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new ye;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=oN(this,o)}ngOnChanges(t){this._added||this._setUpControl(),iN(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return Hv(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(z(oi,13),z(ki,10),z(Bc,10),z(Ha,10),z(sN,8))};static \u0275dir=Ee({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Tt([oW]),Et,Dn]})}return n})();var sW={provide:Ha,useExisting:Rt(()=>Dt),multi:!0};function lN(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function aW(n){return n.split(":")[0]}var Dt=(()=>{class n extends Df{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=V(Hi).injector;appRefDestroyRef=this.appRefInjector.get(Ii);destroyRef=V(Ii);cdr=V(Pn);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefDestroyRef.destroyed||(this._queuedWrite=!0,fs({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let i=this._getOptionId(t),r=lN(i,t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){let i=aW(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){i&1&&F("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Tt([sW]),Et]})}return n})(),Ot=(()=>{class n{_element;_renderer;_select;id;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(lN(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(i){return new(i||n)(z(ft),z(Wn),z(Dt,9))};static \u0275dir=Ee({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),lW={provide:Ha,useExisting:Rt(()=>cN),multi:!0};function OO(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function cW(n){return n.split(":")[0]}var cN=(()=>{class n extends Df{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let i;if(Array.isArray(t)){let r=t.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{let r=[],o=i.selectedOptions;if(o!==void 0){let s=o;for(let l=0;l<s.length;l++){let c=s[l],u=this._getOptionValue(c.value);r.push(u)}}else{let s=i.options;for(let l=0;l<s.length;l++){let c=s[l];if(c.selected){let u=this._getOptionValue(c.value);r.push(u)}}}this.value=r,t(r)}}_registerOption(t){let i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){let i=cW(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){i&1&&F("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Tt([lW]),Et]})}return n})(),Nt=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(OO(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(OO(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(z(ft),z(Wn),z(cN,9))};static \u0275dir=Ee({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function dN(n){return typeof n=="number"?n:parseInt(n,10)}function uN(n){return typeof n=="number"?n:parseFloat(n)}var $a=(()=>{class n{_validator=Av;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Av,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ee({type:n,features:[Dn]})}return n})(),dW={provide:ki,useExisting:Rt(()=>Tf),multi:!0},Tf=(()=>{class n extends $a{max;inputName="max";normalizeInput=t=>uN(t);createValidator=t=>zO(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&hn("max",r._enabled?r.max:null)},inputs:{max:"max"},standalone:!1,features:[Tt([dW]),Et]})}return n})(),uW={provide:ki,useExisting:Rt(()=>qa),multi:!0},qa=(()=>{class n extends $a{min;inputName="min";normalizeInput=t=>uN(t);createValidator=t=>FO(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&hn("min",r._enabled?r.min:null)},inputs:{min:"min"},standalone:!1,features:[Tt([uW]),Et]})}return n})(),fW={provide:ki,useExisting:Rt(()=>Ln),multi:!0};var Ln=(()=>{class n extends $a{required;inputName="required";normalizeInput=An;createValidator=t=>VO;enabled(t){return t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,r){i&2&&hn("required",r._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Tt([fW]),Et]})}return n})();var pW={provide:ki,useExisting:Rt(()=>CE),multi:!0},CE=(()=>{class n extends $a{email;inputName="email";normalizeInput=An;createValidator=t=>jO;enabled(t){return t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,selectors:[["","email","","formControlName",""],["","email","","formControl",""],["","email","","ngModel",""]],inputs:{email:"email"},standalone:!1,features:[Tt([pW]),Et]})}return n})(),hW={provide:ki,useExisting:Rt(()=>Pf),multi:!0},Pf=(()=>{class n extends $a{minlength;inputName="minlength";normalizeInput=t=>dN(t);createValidator=t=>BO(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&hn("minlength",r._enabled?r.minlength:null)},inputs:{minlength:"minlength"},standalone:!1,features:[Tt([hW]),Et]})}return n})(),gW={provide:ki,useExisting:Rt(()=>EE),multi:!0},EE=(()=>{class n extends $a{maxlength;inputName="maxlength";normalizeInput=t=>dN(t);createValidator=t=>UO(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&hn("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},standalone:!1,features:[Tt([gW]),Et]})}return n})(),mW={provide:ki,useExisting:Rt(()=>xE),multi:!0},xE=(()=>{class n extends $a{pattern;inputName="pattern";normalizeInput=t=>t;createValidator=t=>HO(t);static \u0275fac=(()=>{let t;return function(r){return(t||(t=In(n)))(r||n)}})();static \u0275dir=Ee({type:n,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&hn("pattern",r._enabled?r.pattern:null)},inputs:{pattern:"pattern"},standalone:!1,features:[Tt([mW]),Et]})}return n})();var fN=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=pn({type:n});static \u0275inj=nn({})}return n})(),gE=class extends Vc{constructor(e,t,i){super(bE(t),wE(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),t&&(this.controls.splice(r,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){eN(this,!1,e),e.forEach((i,r)=>{XO(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,i)=>i._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function NO(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var qv=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,i=null){let r=this._reduceControls(t),o={};return NO(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new jc(r,o)}record(t,i=null){let r=this._reduceControls(t);return new hE(r,i)}control(t,i,r){let o={};return this.useNonNullable?(NO(i)?o=i:(o.validators=i,o.asyncValidators=r),new xf(t,ne(B({},o),{nonNullable:!0}))):new xf(t,i,r)}array(t,i,r){let o=t.map(s=>this._createControl(s));return new gE(o,i,r)}_reduceControls(t){let i={};return Object.keys(t).forEach(r=>{i[r]=this._createControl(t[r])}),i}_createControl(t){if(t instanceof xf)return t;if(t instanceof Vc)return t;if(Array.isArray(t)){let i=t[0],r=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(i,r,o)}else return this.control(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var vt=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:If,useValue:t.callSetDisabledState??Uv}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=pn({type:n});static \u0275inj=nn({imports:[fN]})}return n})(),Gv=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:sN,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:If,useValue:t.callSetDisabledState??Uv}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=pn({type:n});static \u0275inj=nn({imports:[fN]})}return n})();var Es=class n{constructor(e){this.authService=e}supabase=lo(Nn.supabaseUrl,Nn.supabaseAnonKey);getUserId(){return C(this,null,function*(){let{data:e,error:t}=yield this.supabase.auth.getSession();return t?(console.warn("Errore nel recupero sessione supabase",t),null):e.session?.user?.id??null})}getOrCreateSalonId(e){return C(this,null,function*(){let t=yield this.getSalonIdFromProfiles(e);if(t)return t;let{data:i,error:r}=yield this.supabase.from("salons").insert([{owner_id:e,name:"Il mio Salone",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select("id").single();if(r)throw new Error("Errore creazione salone: "+r.message);let{error:o}=yield this.supabase.from("profiles").update({salon_id:i.id}).eq("id",e);if(o)throw new Error("Errore aggiornamento profilo: "+o.message);return i.id})}getSalonIdFromSession(){return C(this,null,function*(){let{data:e}=yield this.supabase.auth.getSession();return e?.session?.user?.user_metadata?.salon_id??null})}getSalonIdFromProfiles(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.from("profiles").select("salon_id").eq("id",e).maybeSingle();return i?(console.warn("Errore fetching profile",i),null):t&&"salon_id"in t?t.salon_id:null})}listFranchisingProducts(){return C(this,null,function*(){let{data:e,error:t}=yield this.supabase.from("franchising_products").select("*").eq("active",!0).order("name",{ascending:!0});if(t)throw t;return e??[]})}getFranchisingProductById(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.from("franchising_products").select("*").eq("id",e).maybeSingle();if(i)throw i;return t??null})}getMyProducts(){return C(this,null,function*(){let e=yield this.getUserId();console.log("User ID:",e);let{data:t,error:i}=yield this.supabase.from("products").select("*").eq("owner_id",e).order("created_at",{ascending:!1});if(i)throw console.error("Supabase error:",i),i;return console.log("Prodotti dal database:",t),t})}getProductById(e){return C(this,null,function*(){if(!(yield this.getUserId()))throw new Error("Utente non autenticato");let{data:i,error:r}=yield this.supabase.from("products").select("*").eq("id",e).maybeSingle();if(r)throw r;return i??null})}createProduct(e){return C(this,null,function*(){let t=yield this.getUserId();if(!t)throw new Error("Utente non autenticato");let i=yield this.getSalonIdFromSession();i||(i=yield this.getSalonIdFromProfiles(t));let u=e,{id:r}=u,o=Sl(u,["id"]),s=ne(B({},o),{owner_id:t,salon_id:i}),{data:l,error:c}=yield this.supabase.from("products").insert([s]).select().single();if(c)throw console.error("Errore creazione prodotto:",c),c;return l})}createProductWithSalon(e){return C(this,null,function*(){let t=yield this.getUserId();if(!t)throw new Error("Utente non autenticato");let i=yield this.getSalonIdFromSession();i||(i=yield this.getSalonIdFromProfiles(t));let r=ne(B({},e),{owner_id:t,salon_id:i}),{data:o,error:s}=yield this.supabase.from("products").insert([r]).select().single();if(s)throw s;return o})}updateProduct(e,t){return C(this,null,function*(){let{data:i,error:r}=yield this.supabase.from("products").update(t).eq("id",e).select().single();if(r)throw r;return i})}deleteProduct(e){return C(this,null,function*(){let{error:t}=yield this.supabase.from("products").delete().eq("id",e);if(t)throw t})}getPublicImageUrl(e,t="product-images"){return e?/^https?:\/\//.test(e)?e:`${Nn.supabaseUrl.replace(/^https?:\/\//,"https://")}/storage/v1/object/public/${t}/${e}`:null}saveProduct(e){return C(this,null,function*(){return e.id?this.updateProduct(e.id,e):this.createProduct(e)})}createOrder(e){return C(this,null,function*(){let t=yield this.getUserId();if(!t)throw new Error("Utente non autenticato");let i=yield this.getOrCreateSalonId(t);if(!i)throw new Error("Salon non trovato");let r=e.reduce((l,c)=>{let u=c.price||0;return l+u*c.qty},0),{data:o,error:s}=yield this.supabase.from("orders").insert({salon_id:i,total_price:r,status:"pending"}).select().single();if(s)throw s;return yield this.addOrderItems(o.id,e),o})}addOrderItems(e,t){return C(this,null,function*(){let i=t.map(o=>({order_id:e,product_id:o.productId,quantity:o.qty,unit_price:o.price||0})),{error:r}=yield this.supabase.from("order_items").insert(i);if(r)throw r})}static \u0275fac=function(t){return new(t||n)(te(ln))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var Hc=class n{constructor(e){this.supabase=e}updateStockSettings(e,t,i){return C(this,null,function*(){let{error:r}=yield this.supabase.getClient().from("profiles").update({scorte_basse:t,scorte_critiche:i,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r})}getStockSettings(e){return C(this,null,function*(){if(!e)return console.error("UserId non valido per recupero impostazioni scorte"),{scorte_basse:5,scorte_critiche:2};let{data:t,error:i}=yield this.supabase.getClient().from("profiles").select("scorte_basse, scorte_critiche, role").eq("id",e).single();return i?(console.error("Errore recupero impostazioni scorte:",i),{scorte_basse:5,scorte_critiche:2}):t.role==="admin"?{scorte_basse:t.scorte_basse||5,scorte_critiche:t.scorte_critiche||2}:{scorte_basse:t.scorte_basse||5,scorte_critiche:t.scorte_critiche||2}})}static \u0275fac=function(t){return new(t||n)(te(ue))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var vW=n=>["/admin/product-detail","franchising",n];function _W(n,e){if(n&1&&(g(0,"option",46),v(1),p()),n&2){let t=e.$implicit;x("value",t),_(),q(t)}}function yW(n,e){if(n&1){let t=ee();g(0,"div",53)(1,"div",54)(2,"span",55),v(3),p(),g(4,"span",56),v(5),p()(),g(6,"div",57)(7,"input",58),Z("ngModelChange",function(r){let o=A(t).$implicit;return Y(o.qty,r)||(o.qty=r),R(r)}),F("change",function(){let r=A(t).$implicit,o=E(2);return R(o.updateCartItem(r))}),p(),g(8,"button",59),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.rimuoviDalCarrello(r))}),v(9," \xD7 "),p()(),g(10,"div",60),v(11),Me(12,"currency"),p()()}if(n&2){let t=e.$implicit;_(3),q(t.name),_(2),q(t.brand||"N/D"),_(2),G("ngModel",t.qty),_(4),J(" ",Te(12,4,t.price*t.qty,"EUR")," ")}}function bW(n,e){n&1&&(g(0,"span"),v(1,"Invia Ordine"),p())}function wW(n,e){n&1&&(g(0,"span"),v(1,"Invio in corso..."),p())}function SW(n,e){if(n&1){let t=ee();g(0,"section",47)(1,"h3")(2,"i",35),v(3,"shopping_cart "),p(),v(4," Carrello Ordine"),p(),g(5,"div",48),N(6,yW,13,7,"div",49),p(),g(7,"div",50),v(8),Me(9,"currency"),p(),g(10,"div",51)(11,"button",28),F("click",function(){A(t);let r=E();return R(r.svuotaCarrello())}),v(12," Svuota "),p(),g(13,"button",52),F("click",function(){A(t);let r=E();return R(r.inviaOrdine())}),N(14,bW,2,0,"span",33)(15,wW,2,0,"span",33),p()()()}if(n&2){let t=E();_(6),x("ngForOf",t.cart),_(2),J(" Totale: ",Te(9,5,t.getCartTotal(),"EUR")," "),_(5),x("disabled",t.checkoutLoading),_(),x("ngIf",!t.checkoutLoading),_(),x("ngIf",t.checkoutLoading)}}function CW(n,e){if(n&1&&(g(0,"span"),v(1),p()),n&2){let t=E();_(),J("Salva modifiche (",t.productsModified.size,")")}}function EW(n,e){n&1&&(g(0,"span"),v(1,"Salvataggio in corso..."),p())}function xW(n,e){n&1&&(g(0,"div",61)(1,"div",62),ie(2,"div",63),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}function DW(n,e){if(n&1&&(g(0,"li"),v(1),p()),n&2){let t=e.$implicit,i=E(4);Oe("critical",t.quantity<=i.criticalStockThreshold)("low",t.quantity>i.criticalStockThreshold&&t.quantity<=i.lowStockThreshold),_(),yt(" ",t.name," (",t.quantity," pz) ")}}function IW(n,e){if(n&1&&(g(0,"li",80),v(1),p()),n&2){let t=E(2).$implicit;_(),J(" ... e altri ",t.riskStockCount-3," prodotti ")}}function MW(n,e){if(n&1&&(g(0,"div",77)(1,"h4"),v(2),p(),g(3,"ul"),N(4,DW,2,6,"li",78)(5,IW,2,1,"li",79),p()()),n&2){let t=E().$implicit;_(2),J("Prodotti a rischio (",t.riskStockCount,"):"),_(2),x("ngForOf",t.topProducts),_(),x("ngIf",t.riskStockCount>3)}}function TW(n,e){if(n&1){let t=ee();g(0,"div",67)(1,"div",68)(2,"h3",69),v(3),p(),g(4,"div",70)(5,"span",71),v(6),p()()(),g(7,"div",72)(8,"div",73)(9,"span"),v(10),p(),g(11,"span"),v(12),p(),g(13,"span"),v(14),p()(),N(15,MW,6,3,"div",74),p(),g(16,"div",75)(17,"button",34),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.viewCategory(r.name))}),v(18,"Vedi dettagli"),p(),g(19,"button",76),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.clearCategory(r.name))}),g(20,"i",35),v(21,"delete"),p()()()()}if(n&2){let t=e.$implicit;Oe("low-stock",t.lowStockCount>0&&t.criticalStockCount===0)("critical-stock",t.criticalStockCount>0),_(3),q(t.name),_(3),J("",t.productCount," prodotti"),_(4),J("Quantit\xE0 totale: ",t.totalQuantity," pz"),_(2),J("Scorte basse: ",t.lowStockCount," prodotti"),_(2),J("Scorte critiche: ",t.criticalStockCount," prodotti"),_(),x("ngIf",t.riskStockCount>0)}}function PW(n,e){n&1&&(tt(0),v(1," Nessun prodotto di questa tipologia. "),nt())}function AW(n,e){n&1&&v(0," Nessun prodotto presente. ")}function RW(n,e){if(n&1&&(g(0,"div",81),N(1,PW,2,0,"ng-container",82)(2,AW,1,0,"ng-template",null,0,$t),p()),n&2){let t=Ve(3),i=E(2);_(),x("ngIf",i.categoryFilter)("ngIfElse",t)}}function kW(n,e){if(n&1&&(g(0,"div",64),N(1,TW,22,10,"div",65)(2,RW,4,2,"div",66),p()),n&2){let t=E();_(),x("ngForOf",t.groupedCategories),_(),x("ngIf",t.groupedCategories.length===0)}}function OW(n,e){if(n&1&&(g(0,"option",46),v(1),p()),n&2){let t=e.$implicit;x("value",t),_(),q(t)}}function NW(n,e){if(n&1){let t=ee();g(0,"tr")(1,"td")(2,"select",85),Z("ngModelChange",function(r){let o=A(t).$implicit;return Y(o.category,r)||(o.category=r),R(r)}),F("change",function(){let r=A(t).index,o=E(2);return R(o.onProductChange(r))}),N(3,OW,2,2,"option",13),p()(),g(4,"td")(5,"input",86),Z("ngModelChange",function(r){let o=A(t).$implicit;return Y(o.name,r)||(o.name=r),R(r)}),F("input",function(){let r=A(t).index,o=E(2);return R(o.onProductChange(r))}),p()(),g(6,"td")(7,"input",87),Z("ngModelChange",function(r){let o=A(t).$implicit;return Y(o.brand,r)||(o.brand=r),R(r)}),F("input",function(){let r=A(t).index,o=E(2);return R(o.onProductChange(r))}),p()(),g(8,"td")(9,"input",88),Z("ngModelChange",function(r){let o=A(t).$implicit;return Y(o.format,r)||(o.format=r),R(r)}),F("input",function(){let r=A(t).index,o=E(2);return R(o.onProductChange(r))}),p()(),g(10,"td")(11,"div",89)(12,"button",90),F("click",function(){let r=A(t),o=r.$implicit,s=r.index,l=E(2);return R(l.decrementQuantity(o,s))}),v(13,"-"),p(),g(14,"input",91),Z("ngModelChange",function(r){let o=A(t).$implicit;return Y(o.quantity,r)||(o.quantity=r),R(r)}),F("input",function(){let r=A(t).index,o=E(2);return R(o.onProductChange(r))}),p(),g(15,"button",90),F("click",function(){let r=A(t),o=r.$implicit,s=r.index,l=E(2);return R(l.incrementQuantity(o,s))}),v(16,"+"),p()()(),g(17,"td")(18,"input",92),Z("ngModelChange",function(r){let o=A(t).$implicit;return Y(o.price,r)||(o.price=r),R(r)}),F("input",function(){let r=A(t).index,o=E(2);return R(o.onProductChange(r))}),p()(),g(19,"td")(20,"input",93),Z("ngModelChange",function(r){let o=A(t).$implicit;return Y(o.note,r)||(o.note=r),R(r)}),F("input",function(){let r=A(t).index,o=E(2);return R(o.onProductChange(r))}),p()(),g(21,"td",94)(22,"button",95),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.removeProdottoSalone(r))}),p()()()}if(n&2){let t=e.$implicit,i=e.index,r=E(2);Oe("modified",r.productsModified.has(i)),_(2),G("ngModel",t.category),_(),x("ngForOf",r.categorie),_(2),G("ngModel",t.name),_(2),G("ngModel",t.brand),_(2),G("ngModel",t.format),_(5),G("ngModel",t.quantity),_(4),G("ngModel",t.price),_(2),G("ngModel",t.note)}}function LW(n,e){if(n&1&&(g(0,"table",83)(1,"thead")(2,"tr")(3,"th"),v(4,"Categoria"),p(),g(5,"th"),v(6,"Nome"),p(),g(7,"th"),v(8,"Brand"),p(),g(9,"th"),v(10,"Formato"),p(),g(11,"th"),v(12,"Quantit\xE0"),p(),g(13,"th"),v(14,"Prezzo"),p(),g(15,"th"),v(16,"Note"),p(),g(17,"th"),v(18,"Azioni"),p()()(),g(19,"tbody"),N(20,NW,23,10,"tr",84),p()()),n&2){let t=E();_(20),x("ngForOf",t.pagedProducts)}}function FW(n,e){if(n&1){let t=ee();g(0,"div",96)(1,"button",97),F("click",function(){A(t);let r=E();return R(r.prevPage())}),v(2,"\u2039"),p(),g(3,"span"),v(4),p(),g(5,"button",97),F("click",function(){A(t);let r=E();return R(r.nextPage())}),v(6,"\u203A"),p()()}if(n&2){let t=E();_(),x("disabled",t.currentPage===0),_(3),yt("Pagina ",t.currentPage+1," di ",t.totalPages),_(),x("disabled",t.currentPage===t.totalPages-1)}}function zW(n,e){if(n&1&&(g(0,"option",46),v(1),p()),n&2){let t=e.$implicit;x("value",t),_(),q(t)}}function VW(n,e){if(n&1){let t=ee();g(0,"div",98)(1,"div",99)(2,"h2"),v(3),p(),g(4,"div",100)(5,"div",101)(6,"div",102)(7,"label",103),v(8,"Categoria"),g(9,"span",104),v(10,"*"),p()(),g(11,"select",105),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editingProduct.category,r)||(o.editingProduct.category=r),R(r)}),g(12,"option",12),v(13,"Seleziona categoria"),p(),N(14,zW,2,2,"option",13),p()(),g(15,"div",102)(16,"label",106),v(17,"Nome prodotto"),g(18,"span",104),v(19,"*"),p()(),g(20,"input",107),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editingProduct.name,r)||(o.editingProduct.name=r),R(r)}),p()()(),g(21,"div",101)(22,"div",102)(23,"label",108),v(24,"Brand"),p(),g(25,"input",109),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editingProduct.brand,r)||(o.editingProduct.brand=r),R(r)}),p()(),g(26,"div",102)(27,"label",110),v(28,"Formato"),p(),g(29,"input",111),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editingProduct.format,r)||(o.editingProduct.format=r),R(r)}),p()()(),g(30,"div",101)(31,"div",102)(32,"label",112),v(33,"Quantit\xE0"),g(34,"span",104),v(35,"*"),p()(),g(36,"input",113),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editingProduct.quantity,r)||(o.editingProduct.quantity=r),R(r)}),p()(),g(37,"div",102)(38,"label",114),v(39,"Prezzo (\u20AC)"),p(),g(40,"input",115),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editingProduct.price,r)||(o.editingProduct.price=r),R(r)}),p()()(),g(41,"div",102)(42,"label",116),v(43,"Note"),p(),g(44,"textarea",117),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editingProduct.note,r)||(o.editingProduct.note=r),R(r)}),p()()(),g(45,"div",118)(46,"button",119),F("click",function(){A(t);let r=E();return R(r.cancelEdit())}),v(47,"Annulla"),p(),g(48,"button",120),F("click",function(){A(t);let r=E();return R(r.saveEditedProduct())}),v(49,"Salva"),p()()()()}if(n&2){let t=E();_(3),q(t.editingProduct.id?"Modifica prodotto":"Nuovo prodotto"),_(8),G("ngModel",t.editingProduct.category),_(3),x("ngForOf",t.categorie),_(6),G("ngModel",t.editingProduct.name),_(5),G("ngModel",t.editingProduct.brand),_(4),G("ngModel",t.editingProduct.format),_(7),G("ngModel",t.editingProduct.quantity),_(4),G("ngModel",t.editingProduct.price),_(4),G("ngModel",t.editingProduct.note),_(4),x("disabled",!t.isFormValid())}}function jW(n,e){n&1&&(g(0,"div",121),v(1,"Caricamento prodotti franchising..."),p())}function BW(n,e){if(n&1&&(g(0,"div",122),v(1),p()),n&2){let t=E();_(),q(t.errorMsg)}}function UW(n,e){if(n&1){let t=ee();g(0,"tr",128),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.vaiAlDettaglio("franchising",r.id))}),g(1,"td",129),v(2),p(),g(3,"td",129)(4,"a",130),F("click",function(r){return A(t),R(r.stopPropagation())}),v(5),p()(),g(6,"td",129),v(7),p(),g(8,"td",129),v(9),p(),g(10,"td",129),v(11),Me(12,"number"),p(),g(13,"td",129)(14,"div",131),F("click",function(r){return A(t),R(r.stopPropagation())}),g(15,"input",132),Z("ngModelChange",function(r){let o=A(t).$implicit;return Y(o.quantitaDaOrdinare,r)||(o.quantitaDaOrdinare=r),R(r)}),p()()(),g(16,"td",133),F("click",function(r){return A(t),R(r.stopPropagation())}),g(17,"button",134),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.aggiungiAlCarrello(r))}),g(18,"i",35),v(19,"add_shopping_cart"),p(),v(20," Aggiungi "),p()()()}if(n&2){let t=e.$implicit;_(2),q(t.category||"\u2014"),_(2),x("title",ha("Vai al prodotto ",t.name))("routerLink",Wi(18,vW,t.id)),_(),q(t.name),_(2),q(t.brand||"\u2014"),_(2),q(t.format||"\u2014"),_(2),q(t.price!==void 0&&t.price!==null?Te(12,15,t.price,"1.2-2"):"\u2014"),_(4),Oe("low-stock",t.quantitaDaOrdinare&&t.quantitaDaOrdinare<=5)("critical-stock",t.quantitaDaOrdinare&&t.quantitaDaOrdinare<=2),G("ngModel",t.quantitaDaOrdinare),hn("aria-label","Quantit\xE0 da ordinare per "+t.name),_(2),hn("aria-label","Aggiungi "+t.name+" al carrello")}}function HW(n,e){if(n&1&&(g(0,"div",38)(1,"table",123)(2,"thead")(3,"tr",124)(4,"th",125),v(5,"Categoria"),p(),g(6,"th",125),v(7,"Nome"),p(),g(8,"th",125),v(9,"Marca"),p(),g(10,"th",125),v(11,"Formato"),p(),g(12,"th",125),v(13,"Prezzo"),p(),g(14,"th",125),v(15,"Quantit\xE0"),p(),g(16,"th",126),v(17,"Azioni"),p()()(),g(18,"tbody"),N(19,UW,21,20,"tr",127),p()()()),n&2){let t=E();_(19),x("ngForOf",t.prodottiFranchising)}}function WW(n,e){n&1&&(g(0,"div"),v(1," Nessun prodotto franchising disponibile. "),p())}var Zv=class n{constructor(e,t,i,r,o){this.router=e;this.productService=t;this.authService=i;this.stockService=r;this.cdRef=o;window.addEventListener("beforeunload",s=>{this.productsModified.size!==0&&(s.preventDefault(),s.returnValue="")})}prodottiSalone=[{category:"",name:"",brand:"",format:"",quantity:0,price:0,note:""}];formTouched=!1;prodottiFranchising=[];pagedProducts=[];categorie=["Shampoo","Balsamo","Colore","Cera","Gel","Lacca","Olio","Lozione","Trattamento","Altro"];loadingFranchising=!1;savingIndex=null;errorMsg="";loading=!1;lowStockThreshold=5;criticalStockThreshold=2;productsModified=new Set;savingAll=!1;cart=[];checkoutLoading=!1;orderSent=!1;MAX_VISIBLE_RISK_PRODUCTS=3;viewMode="cards";editingProduct=null;searchQuery="";categoryFilter="";stockFilter="all";filteredProducts=[];currentPage=0;pageSize=12;totalPages=1;isBlocked=!1;lowStockTotal=0;criticalStockTotal=0;routerSub;canDeactivate(){return this.productsModified.size!==0?confirm("Ci sono modifiche non salvate. Sei sicuro di voler uscire?"):!0}ngOnDestroy(){this.routerSub&&this.routerSub.unsubscribe()}ngOnInit(){return C(this,null,function*(){this.router.events.subscribe(e=>{e instanceof io&&(this.productsModified.size!==0&&(this.isBlocked=!0),this.loading=!0),(e instanceof mn||e instanceof Gi||e instanceof ys)&&(this.loading=!1)}),window.addEventListener("beforeunload",e=>{this.productsModified.size!==0&&(confirm("Sei sicuro di voler uscire? Ci sono delle modifiche non salvate")||e.preventDefault())}),yield this.loadStockSettings(),this.loadFranchising(),this.loadMyProducts()})}loadStockSettings(){return C(this,null,function*(){try{let e=yield this.authService.getCurrentUserId();if(e){let t=yield this.stockService.getStockSettings(e);this.lowStockThreshold=t.scorte_basse,this.criticalStockThreshold=t.scorte_critiche}else this.lowStockThreshold=5,this.criticalStockThreshold=2}catch(e){console.error("Errore caricamento impostazioni scorte:",e),this.lowStockThreshold=5,this.criticalStockThreshold=2}})}loadFranchising(){return C(this,null,function*(){this.loadingFranchising=!0,this.errorMsg="";try{let e=yield this.productService.listFranchisingProducts();this.prodottiFranchising=e.map(t=>ne(B({},t),{quantitaDaOrdinare:1}))}catch(e){console.error("Errore caricamento franchising",e),this.errorMsg=e?.message||"Errore caricamento prodotti franchising"}finally{this.loadingFranchising=!1}})}loadMyProducts(){return C(this,null,function*(){try{let e=yield this.productService.getMyProducts();this.prodottiSalone=e.map(t=>this.toProdottoSalone(t)),this.applyFilters(),this.updateStockCounts()}catch(e){console.error("Errore caricamento prodotti",e)}})}applyFilters(){let e=[...this.prodottiSalone];if(this.searchQuery){let t=this.searchQuery.toLowerCase();e=e.filter(i=>(i.name||"").toLowerCase().includes(t)||(i.brand||"").toLowerCase().includes(t)||(i.category||"").toLowerCase().includes(t))}this.categoryFilter&&(e=e.filter(t=>t.category===this.categoryFilter)),this.stockFilter==="low"?e=e.filter(t=>t.quantity<=this.lowStockThreshold&&t.quantity>this.criticalStockThreshold):this.stockFilter==="critical"?e=e.filter(t=>t.quantity<=this.criticalStockThreshold):this.stockFilter==="risk"&&(e=e.filter(t=>t.quantity<=this.lowStockThreshold)),e.sort((t,i)=>t.quantity-i.quantity),this.filteredProducts=e,this.totalPages=Math.ceil(this.filteredProducts.length/this.pageSize),this.currentPage=0,this.updatePagination()}updatePagination(){let e=this.currentPage*this.pageSize;this.pagedProducts=this.filteredProducts.slice(e,e+this.pageSize)}nextPage(){this.currentPage<this.totalPages-1&&(this.currentPage++,this.updatePagination())}prevPage(){this.currentPage>0&&(this.currentPage--,this.updatePagination())}editProduct(e){this.editingProduct=B({},e)}cancelEdit(){this.editingProduct=null}addProdottoSalone(){this.editingProduct={category:"",name:"",brand:"",format:"",quantity:0,price:0,note:""}}isFormValid(){return this.editingProduct?!!this.editingProduct.category&&!!this.editingProduct.name&&this.editingProduct.quantity>0:!1}removeProdottoSalone(e){if(!confirm("Sei sicuro di voler eliminare questo prodotto?"))return;let t=this.getProductIndex(e);if(t<0||t>=this.prodottiSalone.length)return;let i=this.prodottiSalone[t];i.id?this.productService.deleteProduct(i.id).then(()=>{this.prodottiSalone=this.prodottiSalone.filter((r,o)=>o!==t),this.applyFilters()}).catch(console.error):(this.prodottiSalone=this.prodottiSalone.filter((r,o)=>o!==t),this.applyFilters())}aggiungiAlCarrello(e){if(!e.quantitaDaOrdinare||e.quantitaDaOrdinare<1){alert("Inserisci una quantit\xE0 valida");return}let t=this.cart.find(i=>i.productId===e.id);t?t.qty+=e.quantitaDaOrdinare:this.cart.push({productId:e.id,name:e.name,brand:e.brand,format:e.format,price:e.price||0,qty:e.quantitaDaOrdinare}),e.quantitaDaOrdinare=1}vaiAlDettaglio(e,t){this.router.navigate(["/admin/product-detail",e,t])}toProduct(e){return ne(B({},e.id&&{id:e.id}),{name:e.name,brand:e.brand,category:e.category,format:e.format,quantity:e.quantity,price:e.price,note:e.note})}toProdottoSalone(e){return{id:e.id,owner_id:e.owner_id,salon_id:e.salon_id,category:e.category??"",name:e.name??"",brand:e.brand??"",format:e.format??"",quantity:e.quantity??0,price:e.price??0,note:e.note??""}}saveProdotto=(e,t)=>C(this,null,function*(){try{let i=this.toProduct(e),r=yield this.productService.saveProduct(i),o=[...this.prodottiSalone];o[t]=this.toProdottoSalone(r),this.prodottiSalone=o,this.productsModified.delete(t),this.cdRef.detectChanges(),this.updateStockCounts()}catch(i){throw console.error("Errore salvataggio prodotto",i),i}});saveEditedProduct(){return C(this,null,function*(){if(!(!this.editingProduct||!this.isFormValid()))try{let e=this.getProductIndex(this.editingProduct);if(e!==-1)yield this.saveProdotto(this.editingProduct,e);else{let t=yield this.saveNewProduct(this.editingProduct);this.prodottiSalone=[...this.prodottiSalone,t]}this.applyFilters(),this.editingProduct=null,this.viewMode==="table"&&setTimeout(()=>{let t=document.querySelector(".prodotti-table");t&&t.scrollIntoView({behavior:"smooth",block:"end"})},100)}catch(e){console.error("Errore salvataggio prodotto",e)}})}saveNewProduct(e){return C(this,null,function*(){let t=this.toProduct(e),i=yield this.productService.saveProduct(t);return this.toProdottoSalone(i)})}getProductIndex(e){return e?e.id?this.prodottiSalone.findIndex(t=>t.id===e.id):this.prodottiSalone.findIndex(t=>t.name===e.name&&t.brand===e.brand&&t.category===e.category&&t.format===e.format):-1}get groupedCategories(){let e={};for(let t of this.filteredProducts){let i=t.category||"Senza categoria";e[i]||(e[i]={name:i,products:[],totalQuantity:0,lowStockCount:0,criticalStockCount:0,riskStockCount:0,productCount:0}),e[i].products.push(t),e[i].totalQuantity+=t.quantity,e[i].productCount++,t.quantity<=this.criticalStockThreshold?(e[i].criticalStockCount++,e[i].riskStockCount++):t.quantity<=this.lowStockThreshold&&(e[i].lowStockCount++,e[i].riskStockCount++)}return Object.values(e).map(t=>{let r=[...t.products.filter(o=>o.quantity<=this.lowStockThreshold)].sort((o,s)=>o.quantity-s.quantity);return ne(B({},t),{topProducts:r.slice(0,3)})}).sort((t,i)=>t.totalQuantity-i.totalQuantity)}viewCategory(e){this.searchQuery="",this.stockFilter="all",this.categoryFilter=e,this.applyFilters(),this.viewMode="table"}rimuoviDalCarrello(e){this.cart=this.cart.filter(t=>t!==e)}svuotaCarrello(){this.cart=[]}updateCartItem(e){e.qty<1&&this.rimuoviDalCarrello(e)}getCartTotal(){return this.cart.reduce((e,t)=>e+t.price*t.qty,0)}inviaOrdine(){return C(this,null,function*(){if(this.cart.length!==0){this.checkoutLoading=!0;try{console.log("Invio ordine con items:",this.cart),yield this.productService.createOrder(this.cart),this.orderSent=!0,this.cart=[],alert("Ordine inviato con successo! Riceverai una conferma via email")}catch(e){console.error("Dettaglio errore ordine:",e),alert("Errore durante l'invio dell'ordine. Riprova pi\xF9 tardi.")}finally{this.checkoutLoading=!1}}})}onProductChange(e){this.productsModified.add(e),this.updateStockCounts()}saveAllChanges(){return C(this,null,function*(){if(this.productsModified.size===0){alert("Nessuna modifica da salvare");return}this.savingAll=!0;let e=Array.from(this.productsModified),t=0,i=0;for(let r of e)try{yield this.saveProdotto(this.prodottiSalone[r],r),t++}catch(o){console.error("Errore nel salvataggio del prodotto",o),i++}this.productsModified.clear(),this.savingAll=!1,alert(i===0?`Tutte le ${t} modifiche salvate con successo!`:`Salvate ${t} modifiche. ${i} errori.`)})}incrementQuantity(e,t){e.quantity=(e.quantity||0)+1,this.onProductChange(t),this.updateStockCounts()}decrementQuantity(e,t){e.quantity>0&&(e.quantity-=1,this.onProductChange(t),this.updateStockCounts())}isCriticalProduct(e){return e?.quantity!==void 0&&e.quantity<=this.criticalStockThreshold}isLowProduct(e){return e?.quantity!==void 0&&e.quantity>this.criticalStockThreshold&&e.quantity<=this.lowStockThreshold}updateStockCounts(){let e=this.prodottiSalone||[];this.criticalStockTotal=e.reduce((t,i)=>t+(this.isCriticalProduct(i)?1:0),0),this.lowStockTotal=e.reduce((t,i)=>t+(this.isLowProduct(i)?1:0),0)}clearCategory(e){return C(this,null,function*(){if(confirm(`Sei sicuro di voler eliminare tutti i prodotti della categoria "${e}"? Questa operazione non pu\xF2 essere annullata.`))try{let t=this.prodottiSalone.filter(i=>i.category===e);for(let i of t)i.id&&(yield this.productService.deleteProduct(i.id));this.prodottiSalone=this.prodottiSalone.filter(i=>i.category!==e),this.applyFilters(),this.updateStockCounts(),alert(`Categoria "${e}" eliminata con successo!`)}catch(t){console.error("Errore durante l'eliminazione della categoria:",t),alert("Si \xE8 verificato un errore durante l'eliminazione. Riprova pi\xF9 tardi.")}})}static \u0275fac=function(t){return new(t||n)(z(We),z(Es),z(ln),z(Hc),z(Pn))};static \u0275cmp=he({type:n,selectors:[["app-prodotti"]],decls:78,vars:23,consts:[["noProductsAtAll",""],[1,"container"],[1,"section-title"],[1,"filters-bar"],[1,"search-box"],["type","search","placeholder","Cerca prodotti...","placeholder","Cerca prodotti...","aria-label","Cerca prodotti...",3,"ngModelChange","input","ngModel"],[1,"search-icon"],[1,"filters-inline"],[1,"form-group","compact"],["for","categoryFilter",1,"vis-label"],[1,"select-wrapper"],["id","categoryFilter","aria-label","Seleziona categoria",1,"select-field",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["aria-hidden","true",1,"select-icon"],["width","14","height","9","viewBox","0 0 14 9","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M1 1L7 7L13 1","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["for","stockFilter",1,"vis-label"],["id","stockFilter","aria-label","Seleziona stato stock",1,"select-field",3,"ngModelChange","change","ngModel"],["value","all"],["value","low"],["value","critical"],["value","risk"],["aria-live","polite",1,"stock-summary"],[1,"stock-item"],[1,"stock-badge"],["class","cart-section",4,"ngIf"],[1,"view-toggle"],[1,"btn",3,"click"],[1,"section-container"],[1,"section-subtitle"],[1,"section-header"],["type","button",1,"btn",3,"click","disabled"],[4,"ngIf"],["type","button",1,"btn-primary",3,"click"],[1,"material-icons"],["class","loading-overlay",4,"ngIf"],["class","products-grid",4,"ngIf"],[1,"table-responsive"],["class","data-table",4,"ngIf"],["class","pagination",4,"ngIf"],["class","modal-backdrop",4,"ngIf"],[1,"franchising-section"],["class","muted",4,"ngIf"],["class","error-message",4,"ngIf"],["class","table-responsive",4,"ngIf"],[3,"value"],[1,"cart-section"],[1,"cart-items"],["class","cart-item",4,"ngFor","ngForOf"],[1,"cart-total"],[1,"cart-actions"],[1,"btn-primary",3,"click","disabled"],[1,"cart-item"],[1,"item-info"],[1,"item-name"],[1,"item-brand"],[1,"item-actions"],["type","number","min","1",1,"qty-input",3,"ngModelChange","change","ngModel"],[1,"btn-remove",3,"click"],[1,"item-price"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"],[1,"products-grid"],["class","category-card",3,"low-stock","critical-stock",4,"ngFor","ngForOf"],["class","no-products-message",4,"ngIf"],[1,"category-card"],[1,"card-header"],[1,"category-name"],[1,"category-header-actions"],[1,"product-count"],[1,"card-body"],[1,"stock-info"],["class","category-details",4,"ngIf"],[1,"card-actions"],["type","button","title","Elimina tutta la categoria",1,"btn-icon",3,"click"],[1,"category-details"],[3,"critical","low",4,"ngFor","ngForOf"],["class","more-items",4,"ngIf"],[1,"more-items"],[1,"no-products-message"],[4,"ngIf","ngIfElse"],[1,"data-table"],[3,"modified",4,"ngFor","ngForOf"],[3,"ngModelChange","change","ngModel"],["placeholder","Es. Shampoo Antiforfora",3,"ngModelChange","input","ngModel"],["placeholder","Es. Wella",3,"ngModelChange","input","ngModel"],["placeholder","Es. 500ml",3,"ngModelChange","input","ngModel"],[1,"quantity-controls"],["type","button",1,"btn-quantity",3,"click"],["type","number","min","0",1,"qty-input",3,"ngModelChange","input","ngModel"],["type","number","min","0","step","0.01",3,"ngModelChange","input","ngModel"],["placeholder","Note opzionali",3,"ngModelChange","input","ngModel"],[1,"actions"],["type","button",1,"btn-remove",3,"click"],[1,"pagination"],[3,"click","disabled"],[1,"modal-backdrop"],[1,"edit-modal"],[1,"modal-content"],[1,"form-row"],[1,"form-group"],["for","category"],[1,"required"],["id","category","required","",3,"ngModelChange","ngModel"],["for","name"],["id","name","required","",3,"ngModelChange","ngModel"],["for","brand"],["id","brand",3,"ngModelChange","ngModel"],["for","format"],["id","format",3,"ngModelChange","ngModel"],["for","quantity"],["type","number","id","quantity","min","0","required","",3,"ngModelChange","ngModel"],["for","price"],["type","number","id","price","min","0","step","0.01",3,"ngModelChange","ngModel"],["for","note"],["id","note","rows","3",3,"ngModelChange","ngModel"],[1,"modal-actions"],["type","button",1,"btn",3,"click"],["type","button",1,"btn-primary",3,"click","disabled"],[1,"muted"],[1,"error-message"],["role","table","aria-label","Tabella prodotti franchising",1,"data-table"],["role","row"],["role","columnheader"],["role","columnheader",1,"text-center"],["role","row","style","cursor: pointer;",3,"click",4,"ngFor","ngForOf"],["role","row",2,"cursor","pointer",3,"click"],["role","cell"],[1,"link-reset",3,"click","routerLink","title"],[1,"qty-cell",3,"click"],["type","number","min","1",1,"qty-input",3,"ngModelChange","ngModel"],["role","cell",1,"actions",3,"click"],["type","button","title","Aggiungi al carrello",1,"btn-primary",3,"click"]],template:function(t,i){t&1&&(g(0,"div",1)(1,"h2",2),v(2,"Lista Prodotti"),p(),g(3,"div",3)(4,"div",4)(5,"input",5),Z("ngModelChange",function(o){return Y(i.searchQuery,o)||(i.searchQuery=o),o}),F("input",function(){return i.applyFilters()}),p(),g(6,"span",6),v(7," \u{1F50D} "),p()(),g(8,"div",7)(9,"div",8)(10,"label",9),v(11,"Categoria"),p(),g(12,"div",10)(13,"select",11),Z("ngModelChange",function(o){return Y(i.categoryFilter,o)||(i.categoryFilter=o),o}),F("change",function(){return i.applyFilters()}),g(14,"option",12),v(15,"Tutte le categorie"),p(),N(16,_W,2,2,"option",13),p(),g(17,"span",14),xn(),g(18,"svg",15),ie(19,"path",16),p()()()(),Bn(),g(20,"div",8)(21,"label",17),v(22,"Stock"),p(),g(23,"div",10)(24,"select",18),Z("ngModelChange",function(o){return Y(i.stockFilter,o)||(i.stockFilter=o),o}),F("change",function(){return i.applyFilters()}),g(25,"option",19),v(26,"Tutto lo stock"),p(),g(27,"option",20),v(28,"Scorte basse"),p(),g(29,"option",21),v(30,"Scorte critiche"),p(),g(31,"option",22),v(32,"Scorte basse e critiche"),p()(),g(33,"span",14),xn(),g(34,"svg",15),ie(35,"path",16),p()()()()(),Bn(),g(36,"div",23)(37,"div",24)(38,"span"),v(39,"Scorte basse"),p(),g(40,"span",25),v(41),p()(),g(42,"div",24)(43,"span"),v(44,"Scorte critiche"),p(),g(45,"span",25),v(46),p()()()(),N(47,SW,16,8,"section",26),g(48,"div",27)(49,"button",28),F("click",function(){return i.viewMode="cards"}),v(50," Card "),p(),g(51,"button",28),F("click",function(){return i.viewMode="table"}),v(52," Tabella "),p()(),g(53,"section",29)(54,"h2",30),v(55,"Prodotti del Salone"),p(),g(56,"div",31)(57,"div")(58,"button",32),F("click",function(){return i.saveAllChanges()}),N(59,CW,2,1,"span",33)(60,EW,2,0,"span",33),p(),g(61,"button",34),F("click",function(){return i.addProdottoSalone()}),g(62,"i",35),v(63,"add"),p(),v(64,"Nuovo prodotto "),p()()(),N(65,xW,5,0,"div",36)(66,kW,3,2,"div",37),g(67,"div",38),N(68,LW,21,1,"table",39),p(),N(69,FW,7,4,"div",40),p(),N(70,VW,50,10,"div",41),g(71,"section",42)(72,"h2"),v(73,"Prodotti Franchising"),p(),N(74,jW,2,0,"div",43)(75,BW,2,1,"div",44)(76,HW,20,1,"div",45)(77,WW,2,0,"div",33),p()()),t&2&&(_(5),G("ngModel",i.searchQuery),_(8),G("ngModel",i.categoryFilter),_(3),x("ngForOf",i.categorie),_(8),G("ngModel",i.stockFilter),_(17),q(i.lowStockTotal),_(5),q(i.criticalStockTotal),_(),x("ngIf",i.cart.length>0),_(2),Oe("btn-primary",i.viewMode==="cards"),_(2),Oe("btn-primary",i.viewMode==="table"),_(7),x("disabled",i.savingAll||i.productsModified.size===0),_(),x("ngIf",!i.savingAll),_(),x("ngIf",i.savingAll),_(5),x("ngIf",i.loading),_(),x("ngIf",i.viewMode==="cards"),_(2),x("ngIf",i.viewMode==="table"),_(),x("ngIf",i.filteredProducts.length>i.pageSize),_(),x("ngIf",i.editingProduct),_(4),x("ngIf",i.loadingFranchising),_(),x("ngIf",i.errorMsg),_(),x("ngIf",!i.loadingFranchising&&(i.prodottiFranchising==null?null:i.prodottiFranchising.length)),_(),x("ngIf",!i.loadingFranchising&&(!i.prodottiFranchising||i.prodottiFranchising.length===0)))},dependencies:[vt,Ot,Nt,st,Wa,Dt,at,Ln,qa,pt,Se,Ze,Ne,bt,sn,_a,Sr],styles:['.actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--padding-v);justify-content:center;padding:var(--padding-v);margin:0}a[_ngcontent-%COMP%]{cursor:pointer;text-decoration:none;color:var(--text-light);font-weight:700;transition:color .2s ease}a[_ngcontent-%COMP%]:hover{color:var(--primary);text-decoration:underline}.loading-indicator[_ngcontent-%COMP%]{padding:10px;background:var(--background);text-align:center;font-style:italic}.filter-group[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem;opacity:.8}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.6rem;background:#ffffff1a;border:1px solid rgba(255,255,255,.2);border-radius:6px;color:var(--text-light);background:var(--background2)}.view-toggle[_ngcontent-%COMP%]{display:flex;gap:var(--padding-v);margin-bottom:var(--padding-v)}.view-toggle[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:var(--primary);color:var(--text-light)}.products-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(min(100%,250px),1fr));gap:clamp(.8rem,2vw,1.2rem);margin-bottom:clamp(1rem,3vw,2rem)}.product-card[_ngcontent-%COMP%]{background:#ffffff0d;border-radius:10px;overflow:hidden;transition:transform .3s ease,box-shadow .3s ease;border:1px solid rgba(255,255,255,.1)}.product-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 10px 20px #0003;border-color:#fff3}.product-card.low-stock[_ngcontent-%COMP%]{border-left:4px solid #ff9800}.product-card.critical-stock[_ngcontent-%COMP%]{border-left:4px solid #f44336;animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{box-shadow:0 0 #f4433666}70%{box-shadow:0 0 0 10px #f4433600}to{box-shadow:0 0 #f4433600}}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.8rem 1rem;background:#ffffff14}.product-category[_ngcontent-%COMP%]{font-weight:600;color:var(--primary)}.product-quantity[_ngcontent-%COMP%]{font-weight:700;background:#0000004d;padding:.2rem .6rem;border-radius:20px;font-size:.9rem}.card-body[_ngcontent-%COMP%]{padding:1.2rem}.product-name[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.2rem}.product-details[_ngcontent-%COMP%]{display:grid;gap:.7rem;grid-template-columns:max-content 1fr}.detail-item[_ngcontent-%COMP%]{display:contents}.detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:80px;opacity:.7;font-size:.9rem}.card-actions[_ngcontent-%COMP%]{display:flex;align-items:center;padding:clamp(.6rem,1.5vw,.8rem) clamp(.8rem,2vw,1rem);gap:clamp(.3rem,1vw,.5rem)}.card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex-grow:1;padding:.5rem;font-size:.9rem;color:var(--text-light)}.card-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{flex-grow:1;padding:clamp(.4rem,1vw,.6rem);font-size:clamp(.7rem,1.1vw,.85rem)}select[_ngcontent-%COMP%]{color:var(--text-light);background:var(--background)}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:1rem;margin-top:1.5rem}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:40px}.category-card[_ngcontent-%COMP%], .category-card[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{box-sizing:border-box;min-inline-size:0}.category-card[_ngcontent-%COMP%]{background:var(--background2);border-radius:10px;overflow:hidden;border-left:4px solid var(--primary);transition:transform .3s ease;display:flex;flex-direction:column;min-height:auto;width:100%;padding:0;-webkit-tap-highlight-color:transparent}.category-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{flex:1 1 auto;display:flex;flex-direction:column;gap:clamp(.35rem,1vw,.8rem);padding:clamp(.7rem,1.6vw,1rem);overflow:hidden;min-height:0;-webkit-overflow-scrolling:touch}.category-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:clamp(.5rem,1.2vw,.9rem);background:#ffffff14;z-index:1}.category-name[_ngcontent-%COMP%]{margin:0;font-size:var(--font-size-medium);font-weight:700;word-break:break-word;display:flex;align-items:center}.product-count[_ngcontent-%COMP%]{background:var(--background);padding:var(--padding-v);margin:0;border-radius:var(--border-radius);border:1px solid var(--primary);font-weight:600;font-size:var(--font-size-base);white-space:nowrap}.category-card[_ngcontent-%COMP%]   .risk-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:clamp(.35rem,.8vw,.6rem)}.risk-badge[_ngcontent-%COMP%]{background:var(--danger, #f44336);color:var(--text-light);padding:clamp(.08rem,.35vw,.18rem) clamp(.35rem,.9vw,.5rem);border-radius:999px;font-weight:700;font-size:clamp(.72rem,1vw,.85rem);line-height:1}.category-card[_ngcontent-%COMP%]   .risk-list[_ngcontent-%COMP%]{margin:clamp(.25rem,.6vw,.35rem) 0;padding-left:1.2rem;max-height:min(clamp(4rem,18vh,6.5rem),30vh);overflow:auto;-webkit-overflow-scrolling:touch}.category-card[_ngcontent-%COMP%]   .more-risk[_ngcontent-%COMP%]{font-size:clamp(.75rem,1vw,.85rem);color:var(--secondary);margin-top:.25rem}.category-card[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]{margin-top:auto;display:flex;justify-content:flex-end;padding:clamp(.5rem,1.2vw,.8rem) clamp(.8rem,1.8vw,1rem);gap:clamp(.35rem,.8vw,.6rem)}.category-card.low-stock[_ngcontent-%COMP%]{border-left-color:#ff9800}.category-card.critical-stock[_ngcontent-%COMP%]{border-left-color:#f44336}.category-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.card-body[_ngcontent-%COMP%]{padding:clamp(.6rem,1.4vw,.8rem)}.stock-info[_ngcontent-%COMP%]{display:grid;gap:var(--padding-v);margin-bottom:var(--padding-v);font-size:var(--font-size-base);color:var(--text-light)}.category-details[_ngcontent-%COMP%]{border-top:1px solid rgba(255,255,255,.1);padding-top:clamp(.6rem,1.2vw,1rem)}.category-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:0;margin-bottom:var(--padding-v);font-size:var(--font-size-lg);color:var(--secondary)}.category-details[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:var(--padding-h);margin:0;color:var(--text-light)}.category-details[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:clamp(.78rem,.95vw,.85rem);margin-bottom:.2rem}.category-card[_ngcontent-%COMP%]   .critical[_ngcontent-%COMP%]{color:#ff6b6b;font-weight:700}.category-card[_ngcontent-%COMP%]   .risk-list[_ngcontent-%COMP%], .category-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{-webkit-overflow-scrolling:touch}.lista-prodotti-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .lista-prodotti-container[_ngcontent-%COMP%]   .filters-bar[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .prodotti-table[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{background-color:var(--background)!important;color:var(--text-light)!important;border:1.5px solid var(--secondary);border-radius:6px;padding:.35rem .5rem;-webkit-appearance:none;appearance:none}.lista-prodotti-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background-color:var(--background2);color:var(--text-light)}.lista-prodotti-container[_ngcontent-%COMP%]   .select-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block}.lista-prodotti-container[_ngcontent-%COMP%]   .select-wrapper[_ngcontent-%COMP%]:after{content:"\\25be";position:absolute;right:.6rem;top:50%;transform:translateY(-50%);pointer-events:none;color:#ffffffb3}.lista-prodotti-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding-right:1.6rem}.error-message[_ngcontent-%COMP%]{color:var(--danger);font-size:.85rem;margin-top:.5rem;display:block;animation:_ngcontent-%COMP%_fadeIn .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.cart-section[_ngcontent-%COMP%]{margin:2rem 0;padding:1rem;background:#ffffff0d;border:1px solid rgba(255,255,255,.1);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a}.cart-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--primary);font-size:var(--font-size-lg);margin-bottom:1.2rem;padding-bottom:.5rem;border-bottom:1px solid rgba(255,255,255,.1)}.cart-items[_ngcontent-%COMP%]{display:grid;gap:.8rem}.cart-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr 1fr;align-items:center;padding:.8rem;background:#ffffff08;border-radius:8px;transition:background .3s ease}.cart-item[_ngcontent-%COMP%]:hover{background:#ffffff0f}.item-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.item-name[_ngcontent-%COMP%]{font-weight:600;color:var(--text-light)}.item-brand[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-light);margin-top:.2rem}.item-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.qty-input[_ngcontent-%COMP%]{padding:var(--padding-v);text-align:center;border-radius:var(--border-radius);color:var(--text-light);transition:all .2s ease}.qty-input[_ngcontent-%COMP%]:focus{border-color:var(--primary);box-shadow:0 0 0 2px #d4af374d}.section-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;align-items:end;margin-bottom:var(--padding-v);flex-wrap:wrap;gap:var(--padding-v)}.section-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;gap:var(--padding-v);align-items:center}.item-price[_ngcontent-%COMP%]{text-align:right;font-weight:600;color:var(--text-light)}.cart-total[_ngcontent-%COMP%]{text-align:right;font-size:1.1rem;font-weight:700;margin:1.5rem 0 1rem;padding-top:1rem;border-top:1px solid rgba(255,255,255,.1);color:var(--primary)}.cart-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.8rem}.more-items[_ngcontent-%COMP%]{color:var(--text-light);font-style:italic;list-style-type:none;margin-top:5px;font-size:.9em}.no-products-message[_ngcontent-%COMP%]{text-align:center;padding:2rem;font-size:1.2rem;color:var(--primary);background-color:var(--background2);border-radius:8px;margin:1rem 0;border:1px solid var(--primary)}.cards-container[_ngcontent-%COMP%]{min-height:200px}.modal-content[_ngcontent-%COMP%]{padding:20px;overflow-y:auto;flex:1}.modal-actions[_ngcontent-%COMP%]{padding:16px 20px;border-top:1px solid var(--primary);display:flex;justify-content:flex-end;gap:10px;background:transparent}textarea[_ngcontent-%COMP%]{resize:vertical;min-height:80px;max-height:200px;width:100%;padding:10px;border:1px solid var(--primary);border-radius:4px;font-family:inherit;box-sizing:border-box}textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#4a90e2;box-shadow:0 0 0 2px #4a90e233}.qty-input[_ngcontent-%COMP%]{width:50px;text-align:center;padding:.25rem}input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.stock-summary[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--padding-h);justify-content:center;align-items:center;border:1px solid var(--secondary);padding:var(--padding-v);border-radius:var(--border-radius);margin:var(--padding-v) 0}.stock-item[_ngcontent-%COMP%]{font-weight:600;display:flex;gap:var(--padding-v);align-items:center}.stock-badge[_ngcontent-%COMP%]{text-align:center;padding:var(--padding-v);background:transparent;font-weight:800;color:var(--secondary)}.stock-badge.low[_ngcontent-%COMP%], .stock-badge.critical[_ngcontent-%COMP%]{background:transparent}.category-header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.btn-icon[_ngcontent-%COMP%]:hover{background:var(--secondary);transform:translateY(-2px);box-shadow:0 4px 8px #0003;border:none}']})};var IE;function $W(){if(IE==null){let n=typeof document<"u"?document.head:null;IE=!!(n&&(n.createShadowRoot||n.attachShadow))}return IE}function Yv(n){if($W()){let e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function Af(n){return n.composedPath?n.composedPath()[0]:n.target}function hN(n){return n.buttons===0||n.detail===0}function gN(n){let e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}function Qv(n,e=0){return qW(n)?Number(n):arguments.length===2?e:0}function qW(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}function Mr(n){return n instanceof ft?n.nativeElement:n}var Kv=new WeakMap,mN=(()=>{class n{_appRef;_injector=V(un);_environmentInjector=V(zt);load(t){let i=this._appRef=this._appRef||this._injector.get(Hi),r=Kv.get(i);r||(r={loaders:new Set,refs:[]},Kv.set(i,r),i.onDestroy(()=>{Kv.get(i)?.refs.forEach(o=>o.destroy()),Kv.delete(i)})),r.loaders.has(t)||(r.loaders.add(t),r.refs.push(uA(t,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ME;try{ME=typeof Intl<"u"&&Intl.v8BreakIterator}catch{ME=!1}var TE=(()=>{class n{_platformId=V(us);isBrowser=this._platformId?$A(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||ME)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var GW=new se("cdk-dir-doc",{providedIn:"root",factory:ZW});function ZW(){return V(ot)}var YW=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function QW(n){let e=n?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?YW.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var PE=(()=>{class n{get value(){return this.valueSignal()}valueSignal=Un("ltr");change=new ye;constructor(){let t=V(GW,{optional:!0});if(t){let i=t.body?t.body.dir:null,r=t.documentElement?t.documentElement.dir:null;this.valueSignal.set(QW(i||r||"ltr"))}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var KW=20,vN=(()=>{class n{_ngZone=V(ut);_platform=V(TE);_renderer=V(Mi).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new _e;_scrolledCount=0;scrollContainers=new Map;register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){let i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=KW){return this._platform.isBrowser?new De(i=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let r=t>0?this._scrolled.pipe(zh(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):ge()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){let r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(wn(o=>!o||r.indexOf(o)>-1))}getAncestorScrollContainers(t){let i=[];return this.scrollContainers.forEach((r,o)=>{this._scrollableContainsElement(o,t)&&i.push(o)}),i}_scrollableContainsElement(t,i){let r=Mr(i),o=t.getElementRef().nativeElement;do if(r==o)return!0;while(r=r.parentElement);return!1}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var JW=20,_N=(()=>{class n{_platform=V(TE);_listeners;_viewportSize;_change=new _e;_document=V(ot);constructor(){let t=V(ut),i=V(Mi).createRenderer(null,null);t.runOutsideAngular(()=>{if(this._platform.isBrowser){let r=o=>this._change.next(o);this._listeners=[i.listen("window","resize",r),i.listen("window","orientationchange",r)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(t=>t()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){let t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let t=this._document,i=this._getWindow(),r=t.documentElement,o=r.getBoundingClientRect(),s=-o.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,l=-o.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0;return{top:s,left:l}}change(t=JW){return t>0?this._change.pipe(zh(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var yN=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=pn({type:n});static \u0275inj=nn({})}return n})();var AE={},bN=(()=>{class n{_appId=V(oc);getId(t){return this._appId!=="ng"&&(t+=this._appId),AE.hasOwnProperty(t)||(AE[t]=0),`${t}${AE[t]++}`}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function wN(n){return Array.isArray(n)?n:[n]}function OE(n){let e=n.cloneNode(!0),t=e.querySelectorAll("[id]"),i=n.nodeName.toLowerCase();e.removeAttribute("id");for(let r=0;r<t.length;r++)t[r].removeAttribute("id");return i==="canvas"?EN(n,e):(i==="input"||i==="select"||i==="textarea")&&CN(n,e),SN("canvas",n,e,EN),SN("input, textarea, select",n,e,CN),e}function SN(n,e,t,i){let r=e.querySelectorAll(n);if(r.length){let o=t.querySelectorAll(n);for(let s=0;s<r.length;s++)i(r[s],o[s])}}var XW=0;function CN(n,e){e.type!=="file"&&(e.value=n.value),e.type==="radio"&&e.name&&(e.name=`mat-clone-${e.name}-${XW++}`)}function EN(n,e){let t=e.getContext("2d");if(t)try{t.drawImage(n,0,0)}catch{}}function BE(n){let e=n.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height,x:e.x,y:e.y}}function NE(n,e,t){let{top:i,bottom:r,left:o,right:s}=n;return t>=i&&t<=r&&e>=o&&e<=s}function e$(n,e){let t=e.left<n.left,i=e.left+e.width>n.right,r=e.top<n.top,o=e.top+e.height>n.bottom;return t||i||r||o}function Of(n,e,t){n.top+=e,n.bottom=n.top+n.height,n.left+=t,n.right=n.left+n.width}function xN(n,e,t,i){let{top:r,right:o,bottom:s,left:l,width:c,height:u}=n,f=c*e,m=u*e;return i>r-m&&i<s+m&&t>l-f&&t<o+f}var Jv=class{_document;positions=new Map;constructor(e){this._document=e}clear(){this.positions.clear()}cache(e){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),e.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:BE(t)})})}handleScroll(e){let t=Af(e),i=this.positions.get(t);if(!i)return null;let r=i.scrollPosition,o,s;if(t===this._document){let u=this.getViewportScrollPosition();o=u.top,s=u.left}else o=t.scrollTop,s=t.scrollLeft;let l=r.top-o,c=r.left-s;return this.positions.forEach((u,f)=>{u.clientRect&&t!==f&&t.contains(f)&&Of(u.clientRect,l,c)}),r.top=o,r.left=s,{top:l,left:c}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function FN(n,e){let t=n.rootNodes;if(t.length===1&&t[0].nodeType===e.ELEMENT_NODE)return t[0];let i=e.createElement("div");return t.forEach(r=>i.appendChild(r)),i}function UE(n,e,t){for(let i in e)if(e.hasOwnProperty(i)){let r=e[i];r?n.setProperty(i,r,t?.has(i)?"important":""):n.removeProperty(i)}return n}function Wc(n,e){let t=e?"":"none";UE(n.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function DN(n,e,t){UE(n.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},t)}function Xv(n,e){return e&&e!="none"?n+" "+e:n}function IN(n,e){n.style.width=`${e.width}px`,n.style.height=`${e.height}px`,n.style.transform=Nf(e.left,e.top)}function Nf(n,e){return`translate3d(${Math.round(n)}px, ${Math.round(e)}px, 0)`}function MN(n){let e=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*e}function t$(n){let e=getComputedStyle(n),t=RE(e,"transition-property"),i=t.find(l=>l==="transform"||l==="all");if(!i)return 0;let r=t.indexOf(i),o=RE(e,"transition-duration"),s=RE(e,"transition-delay");return MN(o[r])+MN(s[r])}function RE(n,e){return n.getPropertyValue(e).split(",").map(i=>i.trim())}var n$=new Set(["position"]),LE=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(e,t,i,r,o,s,l,c,u,f){this._document=e,this._rootElement=t,this._direction=i,this._initialDomRect=r,this._previewTemplate=o,this._previewClass=s,this._pickupPositionOnPage=l,this._initialTransform=c,this._zIndex=u,this._renderer=f}attach(e){this._preview=this._createPreview(),e.appendChild(this._preview),TN(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(e){this._preview.style.transform=e}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(e){this._preview.classList.add(e)}getTransitionDuration(){return t$(this._preview)}addEventListener(e,t){return this._renderer.listen(this._preview,e,t)}_createPreview(){let e=this._previewTemplate,t=this._previewClass,i=e?e.template:null,r;if(i&&e){let o=e.matchSize?this._initialDomRect:null,s=e.viewContainer.createEmbeddedView(i,e.context);s.detectChanges(),r=FN(s,this._document),this._previewEmbeddedView=s,e.matchSize?IN(r,o):r.style.transform=Nf(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=OE(this._rootElement),IN(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return UE(r.style,{"pointer-events":"none",margin:TN(r)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},n$),Wc(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("popover","manual"),r.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(o=>r.classList.add(o)):r.classList.add(t)),r}};function TN(n){return"showPopover"in n}var i$={passive:!0},PN={passive:!1},r$={passive:!1,capture:!0},o$=800,AN="cdk-drag-placeholder",RN=new Set(["position"]),FE=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=Un(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new _e;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=et.EMPTY;_pointerUpSubscription=et.EMPTY;_scrollSubscription=et.EMPTY;_resizeSubscription=et.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(e){e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>Wc(t,e)))}_disabled=!1;beforeStarted=new _e;started=new _e;released=new _e;ended=new _e;entered=new _e;exited=new _e;dropped=new _e;moved=this._moveEvents;data;constrainPosition;constructor(e,t,i,r,o,s,l){this._config=t,this._document=i,this._ngZone=r,this._viewportRuler=o,this._dragDropRegistry=s,this._renderer=l,this.withRootElement(e).withParent(t.parentDragRef||null),this._parentPositions=new Jv(i),s.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(e){this._handles=e.map(i=>Mr(i)),this._handles.forEach(i=>Wc(i,this.disabled)),this._toggleNativeDragInteractions();let t=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&t.add(i)}),this._disabledHandles=t,this}withPreviewTemplate(e){return this._previewTemplate=e,this}withPlaceholderTemplate(e){return this._placeholderTemplate=e,this}withRootElement(e){let t=Mr(e);if(t!==this._rootElement){this._removeRootElementListeners();let i=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[i.listen(t,"mousedown",this._pointerDown,PN),i.listen(t,"touchstart",this._pointerDown,i$),i.listen(t,"dragstart",this._nativeDragStart,PN)]),this._initialTransform=void 0,this._rootElement=t}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(e){return this._boundaryElement=e?Mr(e):null,this._resizeSubscription.unsubscribe(),e&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(e){return this._parentDragRef=e,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&e$(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){let e=this._boundaryElement.getBoundingClientRect(),t=this._rootElement.getBoundingClientRect(),i=0,r=0;t.left<e.left?i=e.left-t.left:t.right>e.right&&(i=e.right-t.right),t.top<e.top?r=e.top-t.top:t.bottom>e.bottom&&(r=e.bottom-t.bottom);let o=this._activeTransform.x,s=this._activeTransform.y,l=o+i,c=s+r;this._rootElement.style.transform=Nf(l,c),this._activeTransform={x:l,y:c},this._passiveTransform={x:l,y:c}}}disableHandle(e){!this._disabledHandles.has(e)&&this._handles.indexOf(e)>-1&&(this._disabledHandles.add(e),Wc(e,!0))}enableHandle(e){this._disabledHandles.has(e)&&(this._disabledHandles.delete(e),Wc(e,this.disabled))}withDirection(e){return this._direction=e,this}_withDropContainer(e){this._dropContainer=e}getFreeDragPosition(){let e=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:e.x,y:e.y}}setFreeDragPosition(e){return this._activeTransform={x:0,y:0},this._passiveTransform.x=e.x,this._passiveTransform.y=e.y,this._dropContainer||this._applyRootElementTransform(e.x,e.y),this}withPreviewContainer(e){return this._previewContainer=e,this}_sortFromLastPointerPosition(){let e=this._lastKnownPointerPosition;e&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(e),e)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=e=>{if(this.beforeStarted.next(),this._handles.length){let t=this._getTargetHandle(e);t&&!this._disabledHandles.has(t)&&!this.disabled&&this._initializeDragSequence(t,e)}else this.disabled||this._initializeDragSequence(this._rootElement,e)};_pointerMove=e=>{let t=this._getPointerPositionOnPage(e);if(!this._hasStartedDragging()){let r=Math.abs(t.x-this._pickupPositionOnPage.x),o=Math.abs(t.y-this._pickupPositionOnPage.y);if(r+o>=this._config.dragStartThreshold){let l=Date.now()>=this._dragStartTime+this._getDragStartDelay(e),c=this._dropContainer;if(!l){this._endDragSequence(e);return}(!c||!c.isDragging()&&!c.isReceiving())&&(e.cancelable&&e.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(e)))}return}e.cancelable&&e.preventDefault();let i=this._getConstrainedPointerPosition(t);if(this._hasMoved=!0,this._lastKnownPointerPosition=t,this._updatePointerDirectionDelta(i),this._dropContainer)this._updateActiveDropContainer(i,t);else{let r=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,o=this._activeTransform;o.x=i.x-r.x+this._passiveTransform.x,o.y=i.y-r.y+this._passiveTransform.y,this._applyRootElementTransform(o.x,o.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:i,event:e,distance:this._getDragDistance(i),delta:this._pointerDirectionDelta})})};_pointerUp=e=>{this._endDragSequence(e)};_endDragSequence(e){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:e}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(e),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let t=this._getPointerPositionOnPage(e);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(e){Rf(e)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let t=this._getShadowRoot(),i=this._dropContainer;if(t&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(t,"selectstart",s$,r$)}),i){let r=this._rootElement,o=r.parentNode,s=this._placeholder=this._createPlaceholderElement(),l=this._marker=this._marker||this._document.createComment("");o.insertBefore(l,r),this._initialTransform=r.style.transform||"",this._preview=new LE(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(o,t)),DN(r,!1,RN),this._document.body.appendChild(o.replaceChild(s,r)),this.started.next({source:this,event:e}),i.start(),this._initialContainer=i,this._initialIndex=i.getItemIndex(this)}else this.started.next({source:this,event:e}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(i?i.getScrollableParents():[])}_initializeDragSequence(e,t){this._parentDragRef&&t.stopPropagation();let i=this.isDragging(),r=Rf(t),o=!r&&t.button!==0,s=this._rootElement,l=Af(t),c=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+o$>Date.now(),u=r?gN(t):hN(t);if(l&&l.draggable&&t.type==="mousedown"&&t.preventDefault(),i||o||c||u)return;if(this._handles.length){let w=s.style;this._rootElementTapHighlight=w.webkitTapHighlightColor||"",w.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(w=>this._updateOnScroll(w)),this._boundaryElement&&(this._boundaryRect=BE(this._boundaryElement));let f=this._previewTemplate;this._pickupPositionInElement=f&&f.template&&!f.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,e,t);let m=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:m.x,y:m.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(e){DN(this._rootElement,!0,RN),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let t=this._dropContainer,i=t.getItemIndex(this),r=this._getPointerPositionOnPage(e),o=this._getDragDistance(r),s=t._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:o,dropPoint:r,event:e}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:o,dropPoint:r,event:e}),t.drop(this,i,this._initialIndex,this._initialContainer,s,o,r,e),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:e,y:t},{x:i,y:r}){let o=this._initialContainer._getSiblingContainerFromPosition(this,e,t);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(e,t)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{let s=this._dropContainer.getItemIndex(this),l=this._dropContainer.getItemAtIndex(s+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(o,this._dropContainer,l),this._dropContainer=o,this._dropContainer.enter(this,e,t,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,r),this._dropContainer._sortItem(this,e,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(e,t):this._applyPreviewTransform(e-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let e=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(e.left,e.top);let t=this._preview.getTransitionDuration();return t===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{let r=l=>{(!l||this._preview&&Af(l)===this._preview.element&&l.propertyName==="transform")&&(s(),i(),clearTimeout(o))},o=setTimeout(r,t*1.5),s=this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){let e=this._placeholderTemplate,t=e?e.template:null,i;return t?(this._placeholderRef=e.viewContainer.createEmbeddedView(t,e.context),this._placeholderRef.detectChanges(),i=FN(this._placeholderRef,this._document)):i=OE(this._rootElement),i.style.pointerEvents="none",i.classList.add(AN),i}_getPointerPositionInElement(e,t,i){let r=t===this._rootElement?null:t,o=r?r.getBoundingClientRect():e,s=Rf(i)?i.targetTouches[0]:i,l=this._getViewportScrollPosition(),c=s.pageX-o.left-l.left,u=s.pageY-o.top-l.top;return{x:o.left-e.left+c,y:o.top-e.top+u}}_getPointerPositionOnPage(e){let t=this._getViewportScrollPosition(),i=Rf(e)?e.touches[0]||e.changedTouches[0]||{pageX:0,pageY:0}:e,r=i.pageX-t.left,o=i.pageY-t.top;if(this._ownerSVGElement){let s=this._ownerSVGElement.getScreenCTM();if(s){let l=this._ownerSVGElement.createSVGPoint();return l.x=r,l.y=o,l.matrixTransform(s.inverse())}}return{x:r,y:o}}_getConstrainedPointerPosition(e){let t=this._dropContainer?this._dropContainer.lockAxis:null,{x:i,y:r}=this.constrainPosition?this.constrainPosition(e,this,this._initialDomRect,this._pickupPositionInElement):e;if(this.lockAxis==="x"||t==="x"?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||t==="y")&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:o,y:s}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,l=this._boundaryRect,{width:c,height:u}=this._getPreviewRect(),f=l.top+s,m=l.bottom-(u-s),w=l.left+o,b=l.right-(c-o);i=kN(i,w,b),r=kN(r,f,m)}return{x:i,y:r}}_updatePointerDirectionDelta(e){let{x:t,y:i}=e,r=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,s=Math.abs(t-o.x),l=Math.abs(i-o.y);return s>this._config.pointerDirectionChangeThreshold&&(r.x=t>o.x?1:-1,o.x=t),l>this._config.pointerDirectionChangeThreshold&&(r.y=i>o.y?1:-1,o.y=i),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let e=this._handles.length>0||!this.isDragging();e!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=e,Wc(this._rootElement,e))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(e=>e()),this._rootElementCleanups=void 0}_applyRootElementTransform(e,t){let i=1/this.scale,r=Nf(e*i,t*i),o=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=o.transform&&o.transform!="none"?o.transform:""),o.transform=Xv(r,this._initialTransform)}_applyPreviewTransform(e,t){let i=this._previewTemplate?.template?void 0:this._initialTransform,r=Nf(e,t);this._preview.setTransform(Xv(r,i))}_getDragDistance(e){let t=this._pickupPositionOnPage;return t?{x:e.x-t.x,y:e.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:e,y:t}=this._passiveTransform;if(e===0&&t===0||this.isDragging()||!this._boundaryElement)return;let i=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(r.width===0&&r.height===0||i.width===0&&i.height===0)return;let o=r.left-i.left,s=i.right-r.right,l=r.top-i.top,c=i.bottom-r.bottom;r.width>i.width?(o>0&&(e+=o),s>0&&(e-=s)):e=0,r.height>i.height?(l>0&&(t+=l),c>0&&(t-=c)):t=0,(e!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:e})}_getDragStartDelay(e){let t=this.dragStartDelay;return typeof t=="number"?t:Rf(e)?t.touch:t?t.mouse:0}_updateOnScroll(e){let t=this._parentPositions.handleScroll(e);if(t){let i=Af(e);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&Of(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=Yv(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(e,t){let i=this._previewContainer||"global";if(i==="parent")return e;if(i==="global"){let r=this._document;return t||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return Mr(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=e=>{if(this._handles.length){let t=this._getTargetHandle(e);t&&!this._disabledHandles.has(t)&&!this.disabled&&e.preventDefault()}else this.disabled||e.preventDefault()};_getTargetHandle(e){return this._handles.find(t=>e.target&&(e.target===t||t.contains(e.target)))}_conditionallyInsertAnchor(e,t,i){if(e===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(t===this._initialContainer&&t.hasAnchor){let r=this._anchor??=OE(this._placeholder);r.classList.remove(AN),r.classList.add("cdk-drag-anchor"),r.style.transform="",i?i.before(r):Mr(t.element).appendChild(r)}}};function kN(n,e,t){return Math.max(e,Math.min(t,n))}function Rf(n){return n.type[0]==="t"}function s$(n){n.preventDefault()}function $c(n,e,t){let i=ON(e,n.length-1),r=ON(t,n.length-1);if(i===r)return;let o=n[i],s=r<i?-1:1;for(let l=i;l!==r;l+=s)n[l]=n[l+s];n[r]=o}function ON(n,e){return Math.max(0,Math.min(e,n))}var e_=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(e){this._dragDropRegistry=e}_previousSwap={drag:null,delta:0,overlaps:!1};start(e){this.withItems(e)}sort(e,t,i,r){let o=this._itemPositions,s=this._getItemIndexFromPointerPosition(e,t,i,r);if(s===-1&&o.length>0)return null;let l=this.orientation==="horizontal",c=o.findIndex(M=>M.drag===e),u=o[s],f=o[c].clientRect,m=u.clientRect,w=c>s?1:-1,b=this._getItemOffsetPx(f,m,w),D=this._getSiblingOffsetPx(c,o,w),T=o.slice();return $c(o,c,s),o.forEach((M,P)=>{if(T[P]===M)return;let U=M.drag===e,K=U?b:D,W=U?e.getPlaceholderElement():M.drag.getRootElement();M.offset+=K;let re=Math.round(M.offset*(1/M.drag.scale));l?(W.style.transform=Xv(`translate3d(${re}px, 0, 0)`,M.initialTransform),Of(M.clientRect,0,K)):(W.style.transform=Xv(`translate3d(0, ${re}px, 0)`,M.initialTransform),Of(M.clientRect,K,0))}),this._previousSwap.overlaps=NE(m,t,i),this._previousSwap.drag=u.drag,this._previousSwap.delta=l?r.x:r.y,{previousIndex:c,currentIndex:s}}enter(e,t,i,r){let o=r==null||r<0?this._getItemIndexFromPointerPosition(e,t,i):r,s=this._activeDraggables,l=s.indexOf(e),c=e.getPlaceholderElement(),u=s[o];if(u===e&&(u=s[o+1]),!u&&(o==null||o===-1||o<s.length-1)&&this._shouldEnterAsFirstChild(t,i)&&(u=s[0]),l>-1&&s.splice(l,1),u&&!this._dragDropRegistry.isDragging(u)){let f=u.getRootElement();f.parentElement.insertBefore(c,f),s.splice(o,0,e)}else this._element.appendChild(c),s.push(e);c.style.transform="",this._cacheItemPositions()}withItems(e){this._activeDraggables=e.slice(),this._cacheItemPositions()}withSortPredicate(e){this._sortPredicate=e}reset(){this._activeDraggables?.forEach(e=>{let t=e.getRootElement();if(t){let i=this._itemPositions.find(r=>r.drag===e)?.initialTransform;t.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(e){return this._getVisualItemPositions().findIndex(t=>t.drag===e)}getItemAtIndex(e){return this._getVisualItemPositions()[e]?.drag||null}updateOnScroll(e,t){this._itemPositions.forEach(({clientRect:i})=>{Of(i,e,t)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}withElementContainer(e){this._element=e}_cacheItemPositions(){let e=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(t=>{let i=t.getVisibleElement();return{drag:t,offset:0,initialTransform:i.style.transform||"",clientRect:BE(i)}}).sort((t,i)=>e?t.clientRect.left-i.clientRect.left:t.clientRect.top-i.clientRect.top)}_getVisualItemPositions(){return this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(e,t,i){let r=this.orientation==="horizontal",o=r?t.left-e.left:t.top-e.top;return i===-1&&(o+=r?t.width-e.width:t.height-e.height),o}_getSiblingOffsetPx(e,t,i){let r=this.orientation==="horizontal",o=t[e].clientRect,s=t[e+i*-1],l=o[r?"width":"height"]*i;if(s){let c=r?"left":"top",u=r?"right":"bottom";i===-1?l-=s.clientRect[c]-o[u]:l+=o[c]-s.clientRect[u]}return l}_shouldEnterAsFirstChild(e,t){if(!this._activeDraggables.length)return!1;let i=this._itemPositions,r=this.orientation==="horizontal";if(i[0].drag!==this._activeDraggables[0]){let s=i[i.length-1].clientRect;return r?e>=s.right:t>=s.bottom}else{let s=i[0].clientRect;return r?e<=s.left:t<=s.top}}_getItemIndexFromPointerPosition(e,t,i,r){let o=this.orientation==="horizontal",s=this._itemPositions.findIndex(({drag:l,clientRect:c})=>{if(l===e)return!1;if(r){let u=o?r.x:r.y;if(l===this._previousSwap.drag&&this._previousSwap.overlaps&&u===this._previousSwap.delta)return!1}return o?t>=Math.floor(c.left)&&t<Math.floor(c.right):i>=Math.floor(c.top)&&i<Math.floor(c.bottom)});return s===-1||!this._sortPredicate(s,e)?-1:s}},zE=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(e,t){this._document=e,this._dragDropRegistry=t}start(e){let t=this._element.childNodes;this._relatedNodes=[];for(let i=0;i<t.length;i++){let r=t[i];this._relatedNodes.push([r,r.nextSibling])}this.withItems(e)}sort(e,t,i,r){let o=this._getItemIndexFromPointerPosition(e,t,i),s=this._previousSwap;if(o===-1||this._activeItems[o]===e)return null;let l=this._activeItems[o];if(s.drag===l&&s.overlaps&&s.deltaX===r.x&&s.deltaY===r.y)return null;let c=this.getItemIndex(e),u=e.getPlaceholderElement(),f=l.getRootElement();o>c?f.after(u):f.before(u),$c(this._activeItems,c,o);let m=this._getRootNode().elementFromPoint(t,i);return s.deltaX=r.x,s.deltaY=r.y,s.drag=l,s.overlaps=f===m||f.contains(m),{previousIndex:c,currentIndex:o}}enter(e,t,i,r){let o=this._activeItems.indexOf(e);o>-1&&this._activeItems.splice(o,1);let s=r==null||r<0?this._getItemIndexFromPointerPosition(e,t,i):r;s===-1&&(s=this._getClosestItemIndexToPointer(e,t,i));let l=this._activeItems[s];l&&!this._dragDropRegistry.isDragging(l)?(this._activeItems.splice(s,0,e),l.getRootElement().before(e.getPlaceholderElement())):(this._activeItems.push(e),this._element.appendChild(e.getPlaceholderElement()))}withItems(e){this._activeItems=e.slice()}withSortPredicate(e){this._sortPredicate=e}reset(){let e=this._element,t=this._previousSwap;for(let i=this._relatedNodes.length-1;i>-1;i--){let[r,o]=this._relatedNodes[i];r.parentNode===e&&r.nextSibling!==o&&(o===null?e.appendChild(r):o.parentNode===e&&e.insertBefore(r,o))}this._relatedNodes=[],this._activeItems=[],t.drag=null,t.deltaX=t.deltaY=0,t.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(e){return this._activeItems.indexOf(e)}getItemAtIndex(e){return this._activeItems[e]||null}updateOnScroll(){this._activeItems.forEach(e=>{this._dragDropRegistry.isDragging(e)&&e._sortFromLastPointerPosition()})}withElementContainer(e){e!==this._element&&(this._element=e,this._rootNode=void 0)}_getItemIndexFromPointerPosition(e,t,i){let r=this._getRootNode().elementFromPoint(Math.floor(t),Math.floor(i)),o=r?this._activeItems.findIndex(s=>{let l=s.getRootElement();return r===l||l.contains(r)}):-1;return o===-1||!this._sortPredicate(o,e)?-1:o}_getRootNode(){return this._rootNode||(this._rootNode=Yv(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(e,t,i){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let r=1/0,o=-1;for(let s=0;s<this._activeItems.length;s++){let l=this._activeItems[s];if(l!==e){let{x:c,y:u}=l.getRootElement().getBoundingClientRect(),f=Math.hypot(t-c,i-u);f<r&&(r=f,o=s)}}return o}},NN=.05,zN=.05,Ki=function(n){return n[n.NONE=0]="NONE",n[n.UP=1]="UP",n[n.DOWN=2]="DOWN",n}(Ki||{}),ai=function(n){return n[n.NONE=0]="NONE",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n}(ai||{}),VE=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new _e;entered=new _e;exited=new _e;dropped=new _e;sorted=new _e;receivingStarted=new _e;receivingStopped=new _e;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=et.EMPTY;_verticalScrollDirection=Ki.NONE;_horizontalScrollDirection=ai.NONE;_scrollNode;_stopScrollTimers=new _e;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(e,t,i,r,o){this._dragDropRegistry=t,this._ngZone=r,this._viewportRuler=o;let s=this.element=Mr(e);this._document=i,this.withOrientation("vertical").withElementContainer(s),t.registerDropContainer(this),this._parentPositions=new Jv(i)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(e,t,i,r){this._draggingStarted(),r==null&&this.sortingDisabled&&(r=this._draggables.indexOf(e)),this._sortStrategy.enter(e,t,i,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:e,container:this,currentIndex:this.getItemIndex(e)})}exit(e){this._reset(),this.exited.next({item:e,container:this})}drop(e,t,i,r,o,s,l,c={}){this._reset(),this.dropped.next({item:e,currentIndex:t,previousIndex:i,container:this,previousContainer:r,isPointerOverContainer:o,distance:s,dropPoint:l,event:c})}withItems(e){let t=this._draggables;return this._draggables=e,e.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(t.filter(r=>r.isDragging()).every(r=>e.indexOf(r)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(e){return this._direction=e,this._sortStrategy instanceof e_&&(this._sortStrategy.direction=e),this}connectedTo(e){return this._siblings=e.slice(),this}withOrientation(e){if(e==="mixed")this._sortStrategy=new zE(this._document,this._dragDropRegistry);else{let t=new e_(this._dragDropRegistry);t.direction=this._direction,t.orientation=e,this._sortStrategy=t}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((t,i)=>this.sortPredicate(t,i,this)),this}withScrollableParents(e){let t=this._container;return this._scrollableElements=e.indexOf(t)===-1?[t,...e]:e.slice(),this}withElementContainer(e){if(e===this._container)return this;let t=Mr(this.element),i=this._scrollableElements.indexOf(this._container),r=this._scrollableElements.indexOf(e);return i>-1&&this._scrollableElements.splice(i,1),r>-1&&this._scrollableElements.splice(r,1),this._sortStrategy&&this._sortStrategy.withElementContainer(e),this._cachedShadowRoot=null,this._scrollableElements.unshift(e),this._container=e,this}getScrollableParents(){return this._scrollableElements}getItemIndex(e){return this._isDragging?this._sortStrategy.getItemIndex(e):this._draggables.indexOf(e)}getItemAtIndex(e){return this._isDragging?this._sortStrategy.getItemAtIndex(e):this._draggables[e]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(e,t,i,r){if(this.sortingDisabled||!this._domRect||!xN(this._domRect,NN,t,i))return;let o=this._sortStrategy.sort(e,t,i,r);o&&this.sorted.next({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:e})}_startScrollingIfNecessary(e,t){if(this.autoScrollDisabled)return;let i,r=Ki.NONE,o=ai.NONE;if(this._parentPositions.positions.forEach((s,l)=>{l===this._document||!s.clientRect||i||xN(s.clientRect,NN,e,t)&&([r,o]=a$(l,s.clientRect,this._direction,e,t),(r||o)&&(i=l))}),!r&&!o){let{width:s,height:l}=this._viewportRuler.getViewportSize(),c={width:s,height:l,top:0,right:s,bottom:l,left:0};r=VN(c,t),o=jN(c,e),i=window}i&&(r!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=o,this._scrollNode=i,(r||o)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let e=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let e=this._container.style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),Ny(0,_h).pipe(Kn(this._stopScrollTimers)).subscribe(()=>{let e=this._scrollNode,t=this.autoScrollStep;this._verticalScrollDirection===Ki.UP?e.scrollBy(0,-t):this._verticalScrollDirection===Ki.DOWN&&e.scrollBy(0,t),this._horizontalScrollDirection===ai.LEFT?e.scrollBy(-t,0):this._horizontalScrollDirection===ai.RIGHT&&e.scrollBy(t,0)})};_isOverContainer(e,t){return this._domRect!=null&&NE(this._domRect,e,t)}_getSiblingContainerFromPosition(e,t,i){return this._siblings.find(r=>r._canReceive(e,t,i))}_canReceive(e,t,i){if(!this._domRect||!NE(this._domRect,t,i)||!this.enterPredicate(e,this))return!1;let r=this._getShadowRoot().elementFromPoint(t,i);return r?r===this._container||this._container.contains(r):!1}_startReceiving(e,t){let i=this._activeSiblings;!i.has(e)&&t.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(i.add(e),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:e,receiver:this,items:t}))}_stopReceiving(e){this._activeSiblings.delete(e),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:e,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(e=>{if(this.isDragging()){let t=this._parentPositions.handleScroll(e);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let e=Yv(this._container);this._cachedShadowRoot=e||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let e=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,e))}};function VN(n,e){let{top:t,bottom:i,height:r}=n,o=r*zN;return e>=t-o&&e<=t+o?Ki.UP:e>=i-o&&e<=i+o?Ki.DOWN:Ki.NONE}function jN(n,e){let{left:t,right:i,width:r}=n,o=r*zN;return e>=t-o&&e<=t+o?ai.LEFT:e>=i-o&&e<=i+o?ai.RIGHT:ai.NONE}function a$(n,e,t,i,r){let o=VN(e,r),s=jN(e,i),l=Ki.NONE,c=ai.NONE;if(o){let u=n.scrollTop;o===Ki.UP?u>0&&(l=Ki.UP):n.scrollHeight-u>n.clientHeight&&(l=Ki.DOWN)}if(s){let u=n.scrollLeft;t==="rtl"?s===ai.RIGHT?u<0&&(c=ai.RIGHT):n.scrollWidth+u>n.clientWidth&&(c=ai.LEFT):s===ai.LEFT?u>0&&(c=ai.LEFT):n.scrollWidth-u>n.clientWidth&&(c=ai.RIGHT)}return[l,c]}var kf={capture:!0},kE={passive:!1,capture:!0},l$=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=he({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(i,r){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return n})(),HE=(()=>{class n{_ngZone=V(ut);_document=V(ot);_styleLoader=V(mN);_renderer=V(Mi).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new _e;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=Un([]);_globalListeners;_draggingPredicate=t=>t.isDragging();_domNodesToDirectives=null;pointerMove=new _e;pointerUp=new _e;constructor(){}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,kE)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(t,i){if(!(this._activeDragInstances().indexOf(t)>-1)&&(this._styleLoader.load(l$),this._activeDragInstances.update(r=>[...r,t]),this._activeDragInstances().length===1)){let r=i.type.startsWith("touch"),o=l=>this.pointerUp.next(l),s=[["scroll",l=>this._scroll.next(l),kf],["selectstart",this._preventDefaultWhileDragging,kE]];r?s.push(["touchend",o,kf],["touchcancel",o,kf]):s.push(["mouseup",o,kf]),r||s.push(["mousemove",l=>this.pointerMove.next(l),kE]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=s.map(([l,c,u])=>this._renderer.listen(this._document,l,c,u))})}}stopDragging(t){this._activeDragInstances.update(i=>{let r=i.indexOf(t);return r>-1?(i.splice(r,1),[...i]):i}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(t){return this._activeDragInstances().indexOf(t)>-1}scrolled(t){let i=[this._scroll];return t&&t!==this._document&&i.push(new De(r=>this._ngZone.runOutsideAngular(()=>{let o=this._renderer.listen(t,"scroll",s=>{this._activeDragInstances().length&&r.next(s)},kf);return()=>{o()}}))),Od(...i)}registerDirectiveNode(t,i){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(t,i)}removeDirectiveNode(t){this._domNodesToDirectives?.delete(t)}getDragDirectiveForNode(t){return this._domNodesToDirectives?.get(t)||null}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=t=>{this._activeDragInstances().length>0&&t.preventDefault()};_persistentTouchmoveListener=t=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&t.preventDefault(),this.pointerMove.next(t))};_clearGlobalListeners(){this._globalListeners?.forEach(t=>t()),this._globalListeners=void 0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),c$={dragStartThreshold:5,pointerDirectionChangeThreshold:5},WE=(()=>{class n{_document=V(ot);_ngZone=V(ut);_viewportRuler=V(_N);_dragDropRegistry=V(HE);_renderer=V(Mi).createRenderer(null,null);constructor(){}createDrag(t,i=c$){return new FE(t,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(t){return new VE(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),jE=new se("CDK_DRAG_PARENT");var BN=new se("CdkDragHandle"),UN=(()=>{class n{element=V(ft);_parentDrag=V(jE,{optional:!0,skipSelf:!0});_dragDropRegistry=V(HE);_stateChanges=new _e;get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._stateChanges.next(this)}_disabled=!1;constructor(){this._parentDrag?._addHandle(this)}ngAfterViewInit(){if(!this._parentDrag){let t=this.element.nativeElement.parentElement;for(;t;){let i=this._dragDropRegistry.getDragDirectiveForNode(t);if(i){this._parentDrag=i,i._addHandle(this);break}t=t.parentElement}}}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ee({type:n,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[2,"cdkDragHandleDisabled","disabled",An]},features:[Tt([{provide:BN,useExisting:n}])]})}return n})(),HN=new se("CDK_DRAG_CONFIG"),WN=new se("CdkDropList"),$N=(()=>{class n{element=V(ft);dropContainer=V(WN,{optional:!0,skipSelf:!0});_ngZone=V(ut);_viewContainerRef=V(Ti);_dir=V(PE,{optional:!0});_changeDetectorRef=V(Pn);_selfHandle=V(BN,{optional:!0,self:!0});_parentDrag=V(jE,{optional:!0,skipSelf:!0});_dragDropRegistry=V(HE);_destroyed=new _e;_handles=new Zt([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(t){this._disabled=t,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new ye;released=new ye;ended=new ye;entered=new ye;exited=new ye;dropped=new ye;moved=new De(t=>{let i=this._dragRef.moved.pipe(ke(r=>({source:this,pointerPosition:r.pointerPosition,event:r.event,delta:r.delta,distance:r.distance}))).subscribe(t);return()=>{i.unsubscribe()}});_injector=V(un);constructor(){let t=this.dropContainer,i=V(HN,{optional:!0}),r=V(WE);this._dragRef=r.createDrag(this.element,{dragStartThreshold:i&&i.dragStartThreshold!=null?i.dragStartThreshold:5,pointerDirectionChangeThreshold:i&&i.pointerDirectionChangeThreshold!=null?i.pointerDirectionChangeThreshold:5,zIndex:i?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),i&&this._assignDefaults(i),t&&(t.addItem(this),t._dropListRef.beforeStarted.pipe(Kn(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(t){this._dragRef.setFreeDragPosition(t)}ngAfterViewInit(){fs(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(t){let i=t.rootElementSelector,r=t.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(t){let i=this._handles.getValue();i.push(t),this._handles.next(i)}_removeHandle(t){let i=this._handles.getValue(),r=i.indexOf(t);r>-1&&(i.splice(r,1),this._handles.next(i))}_setPreviewTemplate(t){this._previewTemplate=t}_resetPreviewTemplate(t){t===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(t){this._placeholderTemplate=t}_resetPlaceholderTemplate(t){t===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let t=this.element.nativeElement,i=t;this.rootElementSelector&&(i=t.closest!==void 0?t.closest(this.rootElementSelector):t.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||t)}_getBoundaryElement(){let t=this.boundaryElement;return t?typeof t=="string"?this.element.nativeElement.closest(t):Mr(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){let i=this._dir,r=this.dragStartDelay,o=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,s=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.scale=this.scale,t.dragStartDelay=typeof r=="object"&&r?r:Qv(r),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(o).withPreviewTemplate(s).withPreviewContainer(this.previewContainer||"global"),i&&t.withDirection(i.value)}}),t.beforeStarted.pipe(cr(1)).subscribe(()=>{if(this._parentDrag){t.withParent(this._parentDrag._dragRef);return}let i=this.element.nativeElement.parentElement;for(;i;){let r=this._dragDropRegistry.getDragDirectiveForNode(i);if(r){t.withParent(r._dragRef);break}i=i.parentElement}})}_handleEvents(t){t.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),t.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(t){let{lockAxis:i,dragStartDelay:r,constrainPosition:o,previewClass:s,boundaryElement:l,draggingDisabled:c,rootElementSelector:u,previewContainer:f}=t;this.disabled=c??!1,this.dragStartDelay=r||0,i&&(this.lockAxis=i),o&&(this.constrainPosition=o),s&&(this.previewClass=s),l&&(this.boundaryElement=l),u&&(this.rootElementSelector=u),f&&(this.previewContainer=f)}_setupHandlesListener(){this._handles.pipe(tn(t=>{let i=t.map(r=>r.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),Sn(t=>Od(...t.map(i=>i._stateChanges.pipe(dr(i))))),Kn(this._destroyed)).subscribe(t=>{let i=this._dragRef,r=t.element.nativeElement;t.disabled?i.disableHandle(r):i.enableHandle(r)})}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ee({type:n,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,r){i&2&&Oe("cdk-drag-disabled",r.disabled)("cdk-drag-dragging",r._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",An],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",kS]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Tt([{provide:jE,useExisting:n}]),Dn]})}return n})(),LN=new se("CdkDropListGroup");var qN=(()=>{class n{element=V(ft);_changeDetectorRef=V(Pn);_scrollDispatcher=V(vN);_dir=V(PE,{optional:!0});_group=V(LN,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new _e;_scrollableParentsResolved;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation;id=V(bN).getId("cdk-drop-list-");lockAxis;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(t){this._dropListRef.disabled=this._disabled=t}_disabled;sortingDisabled;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled;autoScrollStep;elementContainerSelector;hasAnchor;dropped=new ye;entered=new ye;exited=new ye;sorted=new ye;_unsortedItems=new Set;constructor(){let t=V(WE),i=V(HN,{optional:!0});this._dropListRef=t.createDropList(this.element),this._dropListRef.data=this,i&&this._assignDefaults(i),this._dropListRef.enterPredicate=(r,o)=>this.enterPredicate(r.data,o.data),this._dropListRef.sortPredicate=(r,o,s)=>this.sortPredicate(r,o.data,s.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),n._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(t){this._unsortedItems.add(t),t._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(i=>i._dragRef))}removeItem(t){if(this._unsortedItems.delete(t),this._latestSortedRefs){let i=this._latestSortedRefs.indexOf(t._dragRef);i>-1&&(this._latestSortedRefs.splice(i,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((t,i)=>t._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let t=n._dropLists.indexOf(this);t>-1&&n._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(t){this._dir&&this._dir.change.pipe(dr(this._dir.value),Kn(this._destroyed)).subscribe(i=>t.withDirection(i)),t.beforeStarted.subscribe(()=>{let i=wN(this.connectedTo).map(r=>{if(typeof r=="string"){let o=n._dropLists.find(s=>s.id===r);return o}return r});if(this._group&&this._group._items.forEach(r=>{i.indexOf(r)===-1&&i.push(r)}),!this._scrollableParentsResolved){let r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(o=>o.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let r=this.element.nativeElement.querySelector(this.elementContainerSelector);t.withElementContainer(r)}t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.sortingDisabled=this.sortingDisabled,t.autoScrollDisabled=this.autoScrollDisabled,t.autoScrollStep=Qv(this.autoScrollStep,2),t.hasAnchor=this.hasAnchor,t.connectedTo(i.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(t){t.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(i=>i._dragRef)),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),t.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),Od(t.receivingStarted,t.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(t){let{lockAxis:i,draggingDisabled:r,sortingDisabled:o,listAutoScrollDisabled:s,listOrientation:l}=t;this.disabled=r??!1,this.sortingDisabled=o??!1,this.autoScrollDisabled=s??!1,this.orientation=l||"vertical",i&&(this.lockAxis=i)}_syncItemsWithRef(t){this._latestSortedRefs=t,this._dropListRef.withItems(t)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ee({type:n,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(i,r){i&2&&(hn("id",r.id),Oe("cdk-drop-list-disabled",r.disabled)("cdk-drop-list-dragging",r._dropListRef.isDragging())("cdk-drop-list-receiving",r._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",An],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",An],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",An],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",An]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Tt([{provide:LN,useValue:void 0},{provide:WN,useExisting:n}])]})}return n})();var GN=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=pn({type:n});static \u0275inj=nn({providers:[WE],imports:[yN]})}return n})();var Ji=class n{constructor(e){this.supabase=e}getMyServices(){return C(this,null,function*(){let e=yield this.supabase.getCurrentUserId();if(!e)throw new Error("Utente non autenticato");let{data:t,error:i}=yield this.supabase.getClient().from("services").select("*").eq("owner_id",e).order("order_index",{ascending:!0}).order("created_at",{ascending:!0});if(i)throw i;return t??[]})}createServices(e){return C(this,null,function*(){let t=yield this.supabase.getCurrentUserId();if(!t)throw new Error("Utente non autenticato");for(let o of e)o.is_group&&o.price&&Number(o.price)!==0&&console.warn("I gruppi non dovrebbero avere un prezzo diverso da zero",o);let i=yield this.getSalonIdFromSession(),r=e.map(o=>({name:o.name,description:o.description??null,price:o.is_group?0:o.price?Number(o.price):0,timing:o.timing?Number(o.timing):null,active:typeof o.active=="boolean"?o.active:!0,owner_id:t,salon_id:i??o.salon_id??null,is_group:o.is_group??!1,parent_id:o.parent_id??null,order_index:typeof o.order_index=="number"?o.order_index:0,sesso:o.sesso??null}));try{let{data:o,error:s}=yield this.supabase.getClient().from("services").insert(r).select("*");if(s)throw console.error("[SalonServiceService.createServices] supabase error",s,{payload:r}),s;return o??[]}catch(o){throw console.error("[SalonServiceService.createServices] caught error",o),o}})}createService(e){return C(this,null,function*(){return(yield this.createServices([e]))[0]})}updateService(e,t){return C(this,null,function*(){let{data:i,error:r}=yield this.supabase.getClient().from("services").update(t).eq("id",e).select("*").single();if(r)throw console.error("[SalonServiceService.updateService] supabase error",r,{id:e,changes:t}),r;return i})}deleteService(e){return C(this,null,function*(){let{error:t}=yield this.supabase.getClient().from("services").delete().eq("id",e);if(t)throw t})}getServicesHierarchy(){return C(this,null,function*(){let e=yield this.supabase.getCurrentUserId();if(!e)throw new Error("Utente non autenticato");let{data:t,error:i}=yield this.supabase.getClient().from("services").select("*").eq("owner_id",e).order("order_index",{ascending:!0}).order("created_at",{ascending:!0});if(i)throw i;let r=t||[],o=[],s=new Map;return r.forEach(l=>{s.set(l.id,ne(B({},l),{children:[]}))}),r.forEach(l=>{if(l.parent_id){let c=s.get(l.parent_id);c&&c.children.push(s.get(l.id))}else o.push(s.get(l.id))}),o})}moveServiceToGroup(e,t){return C(this,null,function*(){try{let{data:i,error:r}=yield this.supabase.getClient().from("services").update({parent_id:t}).eq("id",e).select().single();return r&&this.handleSupabaseError(r,"moveServiceToGroup"),i}catch(i){throw console.error("[SalonServiceService.moveServiceToGroup] error:",i),i}})}getServiceById(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("services").select("*").eq("id",e).single();return i?(console.error("Errore recupero servizio:",i),null):t}catch(t){return console.error("Errore critico recupero servizio:",t),null}})}getSalonIdFromSession(){return C(this,null,function*(){return(yield this.supabase.getSessionUser())?.user_metadata?.salon_id??null})}handleSupabaseError(e,t){throw console.error(`[SalonServiceService.${t}] Supabase error:`,e),e.code==="42501"?new Error("Permessi insufficienti sul database"):e.code==="23505"?new Error("Elemento duplicato"):e}getServicesOnly(e=!1){return C(this,null,function*(){let t=yield this.supabase.getCurrentUserId();if(!t)throw new Error("Utente non autenticato");let{data:i,error:r}=yield this.supabase.getClient().from("services").select("*").eq("owner_id",t).order("order_index",{ascending:!0}).order("created_at",{ascending:!0});if(r)throw r;let o=i||[];return e?o.map(s=>ne(B({},s),{isSelectable:!s.is_group,isGroupHeader:s.is_group})):o.filter(s=>!s.is_group)})}static \u0275fac=function(t){return new(t||n)(te(ue))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var wi=class n{constructor(e){this.supabase=e}getMyProfile(e=!1){return C(this,null,function*(){return this.supabase.getMyProfile(e)})}updateProfileLogo(e,t){return C(this,null,function*(){return this.supabase.updateProfileLogo(e,t)})}updateProfilePhone(e,t){return C(this,null,function*(){return this.supabase.updateProfilePhone(e,t)})}updateProfileAddress(e,t){return C(this,null,function*(){return this.supabase.updateProfileAddress(e,t)})}updateProfileWebsite(e,t){return C(this,null,function*(){return this.supabase.updateProfileWebsite(e,t)})}updateProfileLocation(e,t,i){return C(this,null,function*(){return this.supabase.updateProfileLocation(e,t,i)})}updateProfileSocials(e,t){return C(this,null,function*(){return this.supabase.updateProfileSocials(e,t)})}updateProfileDescription(e,t){return C(this,null,function*(){return this.supabase.updateProfileDescription(e,t)})}getProfileSocials(e){return C(this,null,function*(){return this.supabase.getProfileSocials(e)})}getProfileById(e){return C(this,null,function*(){return this.supabase.getProfileById(e)})}updateProfileField(e,t,i){return C(this,null,function*(){return this.supabase.updateProfileField(e,t,i)})}updateAppointmentMode(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.getClient().from("profiles").update({appointment_mode:t}).eq("id",e);if(i)throw i})}updateMaxConcurrentAppointments(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.getClient().from("profiles").update({max_concurrent_appointments:t}).eq("id",e);if(i)throw i})}getMaxConcurrentAppointments(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.getClient().from("profiles").select("max_concurrent_appointments").eq("id",e).single();if(i)throw i;return t?.max_concurrent_appointments||1})}getAppointmentMode(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.getClient().from("profiles").select("appointment_mode").eq("id",e).single();return i?(console.error("Errore nel recupero della modalit\xE0 appuntamenti:",i),"simple"):t?.appointment_mode||"simple"})}getSalonSettings(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("profiles").select("appointment_mode, max_concurrent_appointments").eq("id",e).single();if(i)throw i;return t}catch(t){return console.error("Errore recupero impostazioni salone:",t),null}})}updateProfileRagioneSociale(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.getClient().from("profiles").update({ragione_sociale:t}).eq("id",e);if(i)throw i})}static \u0275fac=function(t){return new(t||n)(te(ue))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var Tr={user_id:"",primary_color:"#ef0095",secondary_color:"#9f1893",text_color:"#0f0f0f",background_color:"#fffaf7",background2_color:"rgba(61, 61, 61, 1)",updated_at:void 0,created_at:void 0};var Gc=class n{constructor(e){this.supabase=e}getBrandSettings(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("brand_settings").select("*").eq("user_id",e).single();return i?(console.error("Errore getBrandSettings:",i),null):t||null}catch(t){return console.error("Errore critico getBrandSettings:",t),null}})}saveBrandSettings(e,t){return C(this,null,function*(){let i={user_id:e,primary_color:t.primary_color??Tr.primary_color,secondary_color:t.secondary_color??Tr.secondary_color,text_color:t.text_color??Tr.text_color,background_color:t.background_color??Tr.background_color,background2_color:t.background2_color??Tr.background2_color,updated_at:new Date().toISOString()},{data:r,error:o}=yield this.supabase.getClient().from("brand_settings").upsert(i,{onConflict:"user_id"}).select().single();if(o)throw o;return r})}mergeWithDefaults(e){return B(B({},Tr),e||{})}applyBrandColors(e,t=!0){if(!t)return;let i=this.mergeWithDefaults(e);requestAnimationFrame(()=>{document.documentElement.style.setProperty("--primary",String(i.primary_color)),document.documentElement.style.setProperty("--secondary",String(i.secondary_color)),document.documentElement.style.setProperty("--text-light",String(i.text_color)),document.documentElement.style.setProperty("--background",String(i.background_color)),document.documentElement.style.setProperty("--background2",String(i.background2_color));let r=this.fadeColor(String(i.text_color),.7);document.documentElement.style.setProperty("--text-muted",r)})}resetToDefaults(e){return ne(B({},Tr),{user_id:e??Tr.user_id})}fadeColor(e,t=.7){let i=e.replace("#",""),r=parseInt(i.substring(0,2),16),o=parseInt(i.substring(2,4),16),s=parseInt(i.substring(4,6),16);return`rgba(${r}, ${o}, ${s}, ${t})`}static \u0275fac=function(t){return new(t||n)(te(ue))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};function u$(n,e){n&1&&(g(0,"span"),v(1,"Salva listino"),p())}function f$(n,e){n&1&&(g(0,"span"),v(1,"Salvataggio..."),p())}function p$(n,e){if(n&1){let t=ee();g(0,"div",17)(1,"h3",18),v(2,"Scegli layout di stampa"),p(),g(3,"div",19)(4,"label")(5,"input",20),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.includeGroupsInPrint,r)||(o.includeGroupsInPrint=r),R(r)}),p(),v(6," Includi gruppi nella stampa "),p()(),g(7,"div",21)(8,"div",22),F("click",function(){A(t);let r=E();return R(r.generatePDF(1))}),ie(9,"div",23),g(10,"span"),v(11,"Classico"),p()(),g(12,"div",22),F("click",function(){A(t);let r=E();return R(r.generatePDF(2))}),ie(13,"div",24),g(14,"span"),v(15,"Moderno"),p()(),g(16,"div",22),F("click",function(){A(t);let r=E();return R(r.generatePDF(3))}),ie(17,"div",25),g(18,"span"),v(19,"Minimal"),p()()(),g(20,"button",26),F("click",function(){A(t);let r=E();return R(r.showPrintOptions=!1)}),v(21,"Annulla"),p()()}if(n&2){let t=E();_(5),G("ngModel",t.includeGroupsInPrint),hn("aria-checked",t.includeGroupsInPrint)}}function h$(n,e){n&1&&(g(0,"span"),v(1,"\u25BC"),p())}function g$(n,e){n&1&&(g(0,"span"),v(1,"\u25B6"),p())}function m$(n,e){if(n&1){let t=ee();tt(0),g(1,"td",29)(2,"div",30)(3,"button",31),F("click",function(){let r;A(t);let o=E().$implicit,s=E();return R(s.toggleGroup((r=o.get("id"))==null?null:r.value))}),N(4,h$,2,0,"span",6)(5,g$,2,0,"span",6),p(),ie(6,"input",32),p()(),g(7,"td")(8,"small",33),v(9,"Gruppo"),p()(),g(10,"td")(11,"div",34)(12,"button",35),F("click",function(){let r;A(t);let o=E(),s=o.$implicit,l=o.index,c=E();return R(c.addServiceAt(l,{name:"Nuovo servizio",parent_id:((r=s.get("id"))==null?null:r.value)??null}))}),v(13,"\uFF0B"),p()()(),g(14,"td")(15,"div",34)(16,"button",36),F("click",function(){A(t);let r=E().index,o=E();return R(o.removeService(r))}),v(17,"\u{1F5D1}"),p()()(),nt()}if(n&2){let t,i,r,o=E().$implicit,s=E();_(3),hn("aria-expanded",!s.isGroupCollapsed((t=o.get("id"))==null?null:t.value)),_(),x("ngIf",!s.isGroupCollapsed((i=o.get("id"))==null?null:i.value)),_(),x("ngIf",s.isGroupCollapsed((r=o.get("id"))==null?null:r.value))}}function v$(n,e){if(n&1){let t=ee();g(0,"td")(1,"div",37),ie(2,"input",38),g(3,"select",39)(4,"option",40),v(5,"M"),p(),g(6,"option",41),v(7,"F"),p(),g(8,"option",42),v(9,"X"),p()()(),g(10,"div",43),v(11,"Obbligatorio "),p()(),g(12,"td"),ie(13,"input",44),p(),g(14,"td")(15,"div",45),ie(16,"input",46),p(),g(17,"div",43),v(18,"Formato errato"),p()(),g(19,"td"),ie(20,"input",47),p(),g(21,"td",48)(22,"span",49),v(23,"\u2630"),p(),g(24,"button",50),F("click",function(){A(t);let r=E().index,o=E();return R(o.removeService(r))}),p()()}if(n&2){let t,i,r=E().$implicit;_(10),Oe("visible",((t=r.get("nome"))==null?null:t.touched)&&((t=r.get("nome"))==null?null:t.invalid)),_(7),Oe("visible",((i=r.get("prezzo"))==null?null:i.touched)&&((i=r.get("prezzo"))==null?null:i.invalid))}}function _$(n,e){if(n&1&&(g(0,"tr",27),N(1,m$,18,3,"ng-container",28)(2,v$,25,4,"ng-template",null,0,$t),p()),n&2){let t,i,r,o,s=e.$implicit,l=e.index,c=Ve(3),u=E();Oo("display",!((t=s.get("is_group"))!=null&&t.value)&&u.isGroupCollapsed((t=s.get("parent_id"))==null?null:t.value)?"none":null),Oe("group-row",(i=s.get("is_group"))==null?null:i.value)("service-row",!((r=s.get("is_group"))!=null&&r.value)),x("formGroupName",l),_(),x("ngIf",(o=s.get("is_group"))==null?null:o.value)("ngIfElse",c)}}var t_=class n{constructor(e,t,i,r){this.fb=e;this.salonServiceService=t;this.profileService=i;this.brandSettingsService=r}serviziForm;savingAll=!1;loading=!1;showPrintOptions=!1;collapsedGroups={};includeGroupsInPrint=!0;ngOnInit(){this.serviziForm=this.fb.group({servizi:this.fb.array([])}),this.loadMyServices()}get servizi(){return this.serviziForm.get("servizi")}createServiceGroup(e){return this.fb.group({id:[e?.id??null],nome:[e?.name??"",co.required],descrizione:[e?.description??""],prezzo:[e?.price??"",[co.pattern(/^\d+(\.\d{1,2})?$/)]],timing:[e?.timing??"",[co.pattern(/^\d+$/)]],active:[typeof e?.active=="boolean"?e.active:!0],is_group:[e?.is_group??!1],parent_id:[e?.parent_id??null],order_index:[e?.order_index??0],sesso:[e?.sesso??""]})}addService(e){this.servizi.push(this.createServiceGroup(e))}removeService(e){return C(this,null,function*(){let t=this.servizi.at(e);if(!t)return;let i=!!t.get("is_group")?.value,r=t.get("id")?.value??null,o=(t.get("nome")?.value??"").toString().trim(),s=(t.get("descrizione")?.value??"").toString().trim(),l=t.get("prezzo")?.value,c=t.get("timing")?.value,u=l==null||l==="",f=c==null||c==="";if(!o&&!s&&u&&f&&!r){this.servizi.removeAt(e),this.updateOrderIndexes(),this.servizi.length===0&&this.addService();return}let w=o||(i?"gruppo":"servizio");if(window.confirm(`Sei sicuro di voler eliminare questo ${i?"gruppo":"servizio"}: "${w}"?`)){if(i){let D=this.getGroupChildren(r);D.length>0&&(window.confirm(`Il gruppo contiene ${D.length} servizi.
OK: elimina anche i servizi.
Annulla: mantieni i servizi e rimuovi solo il raggruppamento (verranno slegati).`)?yield this.deleteGroupChildren(D):yield this.unlinkGroupChildren(D))}if(r)try{yield this.salonServiceService.deleteService(r)}catch(D){console.error("Errore eliminazione servizio/gruppo",D),window.alert("Errore durante l'eliminazione del gruppo/servizio. Controlla la console.");return}this.servizi.removeAt(e),this.updateOrderIndexes(),this.servizi.length===0&&this.addService()}})}getGroupChildren(e){return e?this.servizi.controls.map((t,i)=>({ctrl:t,idx:i})).filter(({ctrl:t})=>!t.get("is_group")?.value&&t.get("parent_id")?.value===e):[]}deleteGroupChildren(e){return C(this,null,function*(){let t=[...e].sort((i,r)=>r.idx-i.idx);for(let{ctrl:i,idx:r}of t){let o=i.get("id")?.value;try{o&&(yield this.salonServiceService.deleteService(o))}catch(s){console.error("Errore eliminazione servizio figlio",s)}this.servizi.removeAt(r)}})}unlinkGroupChildren(e){return C(this,null,function*(){let t=[];for(let{ctrl:i}of e){i.get("parent_id")?.setValue(null);let r=i.get("id")?.value;if(r)try{let o=i.value,s={name:o.nome,description:o.descrizione,price:o.prezzo,timing:o.timing,active:o.active,is_group:o.is_group,parent_id:null,order_index:o.order_index};yield this.salonServiceService.updateService(r,s)}catch(o){console.error("Errore slegamento servizio (update parent_id)",o),t.push({id:r,err:o})}}t.length>0&&window.alert("Alcuni servizi non sono stati correttamente slegati dal gruppo (vedi console).")})}loadMyServices(){return C(this,null,function*(){this.loading=!0;try{let e=yield this.salonServiceService.getMyServices();for(;this.servizi.length;)this.servizi.removeAt(0);e.forEach(t=>{let i=ne(B({},t),{nome:t.name,descrizione:t.description,prezzo:t.price,sesso:t.sesso});this.addService(i)}),e.length===0&&this.addService()}catch(e){console.error("Errore caricamento servizi",e),this.servizi.length===0&&this.addService()}finally{this.loading=!1}})}saveAll(){return C(this,null,function*(){if(this.updateOrderIndexes(),this.serviziForm.invalid){this.servizi.markAllAsTouched(),window.alert("Controlla i campi evidenziati: il form non \xE8 valido.");return}this.savingAll=!0;let e=!1;try{let t=this.servizi.controls,i=[],r=[],o=[];t.forEach((u,f)=>{let m=!!u.get("is_group")?.value,w=u.get("id")?.value,b=u.get("prezzo")?.value,D=u.get("timing")?.value,T=b===""||b==null?null:Number(b),M=D===""||D==null?null:Number(D),P={name:u.get("nome")?.value??"",description:u.get("descrizione")?.value??null,price:m||isNaN(Number(T))?0:T,timing:m||isNaN(Number(M))?null:M,active:!!u.get("active")?.value,is_group:!!m,parent_id:u.get("parent_id")?.value??null,order_index:typeof u.get("order_index")?.value=="number"?u.get("order_index")?.value:f,sesso:u.get("sesso")?.value??null};w?i.push(this.salonServiceService.updateService(w,P)):m&&(r.push(P),o.push(f))}),r.length>0&&(yield this.salonServiceService.createServices(r)).forEach((f,m)=>{let w=o[m],b=this.servizi.at(w);b&&b.patchValue({id:f.id??null,nome:f.name??"",descrizione:f.description??"",is_group:f.is_group??!0,parent_id:f.parent_id??null})}),this.normalizeParentIdsByAdjacency();let s=[],l=[];this.servizi.controls.forEach((u,f)=>{let m=!!u.get("is_group")?.value,w=u.get("id")?.value,b=u.get("prezzo")?.value,D=u.get("timing")?.value,T=b===""||b==null?null:Number(b),M=D===""||D==null?null:Number(D),P={name:u.get("nome")?.value??"",description:u.get("descrizione")?.value??null,price:m||isNaN(Number(T))?null:T,timing:m||isNaN(Number(M))?null:M,active:!!u.get("active")?.value,is_group:!!m,parent_id:u.get("parent_id")?.value??null,order_index:typeof u.get("order_index")?.value=="number"?u.get("order_index")?.value:f,sesso:u.get("sesso")?.value??null};!w&&!m?(s.push(P),l.push(f)):w&&!m&&i.push(this.salonServiceService.updateService(w,P))});let c=yield Promise.allSettled(i);e=c.some(u=>u.status==="rejected"),c.forEach(u=>{u.status==="rejected"&&console.error("Update failed",u.reason)}),s.length>0&&(yield this.salonServiceService.createServices(s)).forEach((f,m)=>{let w=l[m],b=this.servizi.at(w);b&&b.patchValue({id:f.id??null,nome:f.name??"",descrizione:f.description??"",prezzo:f.price??null,timing:f.timing??null,active:typeof f.active=="boolean"?f.active:!0,is_group:f.is_group??!1,parent_id:f.parent_id??null})}),console.log("Salvataggio completato"),e?window.alert("Salvataggio completato con alcuni errori sugli aggiornamenti. Controlla la console."):window.alert("Listino prezzi salvato con successo!")}catch(t){console.error("Errore durante salvataggio totale",t),window.alert(`Errore durante il salvataggio: ${t?.message||t}`)}finally{this.savingAll=!1}})}normalizeParentIdsByAdjacency(){let e=null;this.servizi.controls.forEach(t=>{t.get("is_group")?.value?e=t.get("id")?.value??null:!t.get("parent_id")?.value&&e&&t.get("parent_id")?.setValue(e)})}printList(){return C(this,null,function*(){this.showPrintOptions=!0})}urlToDataUrl(e){return C(this,null,function*(){if(!e)return null;try{let t=yield fetch(e,{mode:"cors"});if(!t.ok)return null;let i=yield t.blob();return yield new Promise((r,o)=>{let s=new FileReader;s.onload=()=>r(s.result),s.onerror=l=>o(l),s.readAsDataURL(i)})}catch(t){return console.warn("urlToDataUrl failed",t),null}})}exportCsv(){let e=["SERVIZIO","DESCRIZIONE","SESSO","PREZZO (\u20AC)"],t=(this.serviziForm.value.servizi||[]).map(l=>{let c=l.nome??l.name??"",u=l.descrizione??l.description??"",f=l.sesso??"",m="";if(l.prezzo!==void 0&&l.prezzo!==""){let w=Number(l.prezzo);m=isNaN(w)?"":w.toFixed(2)}return[c,u,m,f]}),i=[e.join(","),...t.map(l=>l.map(c=>c.includes(",")||c.includes('"')||c.includes(`
`)?`"${c.replace(/"/g,'""')}"`:c).join(","))].join(`
`),r=new Blob(["\uFEFF"+i],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),s=URL.createObjectURL(r);o.setAttribute("href",s),o.setAttribute("download",`listino-servizi-${new Date().toISOString().slice(0,10)}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)}getGroups(){return this.servizi.controls.filter(e=>!!e.get("is_group")?.value)}getGroupServices(e){return this.servizi.controls.filter(t=>!t.get("is_group")?.value&&t.get("parent_id")?.value===e)}getUngroupedServices(){return this.servizi.controls.filter(e=>!e.get("is_group")?.value&&!e.get("parent_id")?.value)}getServiceIndex(e){return this.servizi.controls.findIndex(t=>t===e)}addGroup(){let e=this.createServiceGroup({is_group:!0,name:"Nuovo gruppo",price:null,timing:null});this.servizi.push(e)}dropGroup(e,t=null){let i=this.servizi;$c(i.controls,e.previousIndex,e.currentIndex);let r=i.at(e.currentIndex);if(r.get("is_group")?.value){r.get("parent_id")?.setValue(null);let o=r.get("id")?.value;i.controls.forEach(s=>{!s.get("is_group")?.value&&s.get("parent_id")?.value===o&&s.get("parent_id")?.setValue(o)})}else r.get("parent_id")?.setValue(t);this.updateOrderIndexes()}getGroupId(e){return this.servizi.at(e).get("group_id")?.value??""}dropService(e){let t=this.servizi;if(e.previousContainer===e.container)$c(e.container.data,e.previousIndex,e.currentIndex);else{let i=e.previousContainer.data[e.previousIndex],r=null;if(e.container.data.length>0){let o=e.container.data[0];r=o.get("is_group")?.value?o.get("id")?.value??null:o.get("parent_id")?.value??null}i.get("parent_id")?.setValue(r),e.previousContainer.data.splice(e.previousIndex,1),e.container.data.splice(e.currentIndex,0,i)}this.updateOrderIndexes()}updateOrderIndexes(){this.servizi.controls.forEach((e,t)=>{e.get("order_index")?.setValue(t)})}onDrop(e){return C(this,null,function*(){let t=this.servizi;$c(t.controls,e.previousIndex,e.currentIndex);let i=t.at(e.currentIndex);if(!i)return;if(i.get("is_group")?.value){i.get("parent_id")?.setValue(null),this.updateOrderIndexes();return}let r=null;for(let s=e.currentIndex-1;s>=0;s--){let l=t.at(s);if(l?.get("is_group")?.value){r=l.get("id")?.value??null;break}}i.get("parent_id")?.setValue(r),this.updateOrderIndexes();let o=i.get("id")?.value;try{o&&(yield this.salonServiceService.moveServiceToGroup(o,r))}catch(s){console.error("Errore aggiornamento parent_id su backend",s),window.alert("Errore sincronizzazione cambio gruppo. Ripristina o salva il listino per correggere.")}})}groupNameById(e){return e?this.getGroups().find(r=>(r.get("id")?.value??null)===e)?.get("nome")?.value??"":""}onGroupSelect(e,t){let i=t.target,r=i&&i.value||null,o=this.servizi.at(e);o&&(o.get("parent_id")?.setValue(r),this.moveServiceIntoGroup(e,r),this.updateOrderIndexes())}moveServiceIntoGroup(e,t){if(e<0||e>=this.servizi.length)return;let i=this.servizi.at(e);if(i&&(i.get("parent_id")?.setValue(t),t)){let r=this.servizi.controls.findIndex(c=>(c.get("id")?.value??null)===t);if(r===-1)return;let o=e,s=r+1;o<s&&s--;let l=this.servizi.at(o);if(!l)return;this.servizi.removeAt(o),this.servizi.insert(s,l)}}toggleGroup(e){if(!e){alert("Salva il gruppo per poterlo comprimere/espandere.");return}this.collapsedGroups[e]=!this.collapsedGroups[e]}isGroupCollapsed(e){return!!(e&&this.collapsedGroups[e])}onServiceMoved(e,t){let i=this.servizi.at(e);i&&i.get("parent_id")?.setValue(t)}addServiceAt(e,t){let i=this.servizi;if(e<0||e>i.length){this.addService(t);return}let r=i.at(e);if(!r){this.addService(t);return}let o=r.get("id")?.value??t?.parent_id??null,s=e+1;for(;s<i.length;){let c=i.at(s);if(!c||c.get("is_group")?.value||(c.get("parent_id")?.value??null)!==o)break;s++}let l=this.createServiceGroup({is_group:!1,parent_id:o,name:t?.name??"",description:t?.description??"",price:t?.price??null,timing:t?.timing??null,active:typeof t?.active=="boolean"?t.active:!0});i.insert(s,l),o&&(this.collapsedGroups[o]=!1),this.updateOrderIndexes()}normalizeColor(e,t="#cc9c00"){if(!e)return t;let i=String(e).trim();if(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(i)){if(i.length===4){let o=i[1],s=i[2],l=i[3];return`#${o}${o}${s}${s}${l}${l}`}return i}if(/^#([0-9a-f]{8})$/i.test(i))return`#${i.slice(1,7)}`;let r=i.match(/rgba?\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})/i);if(r){let o=Math.min(255,Number(r[1])),s=Math.min(255,Number(r[2])),l=Math.min(255,Number(r[3])),c=u=>u.toString(16).padStart(2,"0");return`#${c(o)}${c(s)}${c(l)}`}return/^[0-9a-f]{6}$/i.test(i)?`#${i}`:t}generatePDF(e){return C(this,null,function*(){this.showPrintOptions=!1,console.log("[generatePDF] layout requested =",e);let t=null,i=null;try{t=yield this.profileService.getMyProfile(),t?.id&&(i=yield this.brandSettingsService.getBrandSettings(t.id))}catch(c){console.warn("Errore recupero profilo/brand",c)}let r=t?.ragione_sociale??"Il tuo salone",o=t?.logo_url??null,s=i?{primary:i.primary_color,secondary:i.secondary_color,text:i.text_color,background:i.background_color,background2:i.background2_color}:{primary:"#cc9c00",secondary:"#8f6d00",text:"#eeeeee",background:"#000000",background2:"#1b1b1b"},l=this.getTableDataForPdf(e);console.log("[generatePDF] tableData sample:",l&&l.slice?l.slice(0,4):l);try{let c=yield import("./chunk-DJ22ZWFX.js"),u=yield import("./chunk-GCQFHPBS.js"),f=c.default??c;f.vfs=u.pdfMake?.vfs??u.pdfMake?.vfs??u.pdfMake?.vfs??u.vfs;let m=null;if(o)try{m=yield this.urlToDataUrl(o)}catch(T){console.warn("Errore caricamento logo",T)}let w={telefono:t?.telefono??"",email:t?.email??"",sito_web:t?.sito_web??""},b;e===1?b=this.layoutClassic(r,m,s,l,w,this.includeGroupsInPrint):e===2?b=this.layoutElegant(r,m,s,l,w,this.includeGroupsInPrint):e===3?b=this.layoutMinimal(r,m,s,l,w,this.includeGroupsInPrint):b=this.layoutClassic(r,m,s,l,w,this.includeGroupsInPrint);let D=`listino-${(r||"salone").replace(/\s+/g,"-").toLowerCase()}-${new Date().toISOString().slice(0,10)}.pdf`;f.createPdf(b).download(D)}catch(c){console.error("Errore generazione PDF",c),alert("Si \xE8 verificato un errore durante la generazione del PDF. Controlla la console per i dettagli.")}})}getTableDataForPdf(e){let t=(this.serviziForm.value.servizi||[]).filter(i=>i?.active!==!1).map(i=>({name:i?.nome?.trim()||"Servizio",description:i?.descrizione?.trim()||"",price:i?.prezzo!==void 0&&i?.prezzo!==""&&!isNaN(Number(i.prezzo))?Number(i.prezzo).toFixed(2):"",is_group:i?.is_group||!1,id:i?.id||""}));if(this.includeGroupsInPrint||(t=t.filter(i=>!i.is_group)),e===1){let i=this.includeGroupsInPrint?[{text:"",style:"borderIndicatorHeader",width:1},{text:"SERVIZIO",style:"tableHeader"},{text:"DESCRIZIONE",style:"tableHeader"},{text:"PREZZO",style:"tableHeader"}]:[{text:"SERVIZIO",style:"tableHeader"},{text:"DESCRIZIONE",style:"tableHeader"},{text:"PREZZO",style:"tableHeader"}],r=t.map(o=>this.includeGroupsInPrint?[{text:"",style:o.is_group?"groupBorderIndicator":"serviceBorderIndicator"},{text:o.name,style:o.is_group?"groupServiceName":"serviceName"},{text:o.description,style:o.is_group?"groupServiceDesc":"serviceDesc",margin:o.description?[0,4,0,4]:[0,0,0,0]},{text:o.is_group?"":o.price?`${o.price} \u20AC`:"",style:o.is_group?"groupServicePrice":"servicePrice"}]:[{text:o.name,style:"serviceName"},{text:o.description,style:"serviceDesc",margin:o.description?[0,4,0,4]:[0,0,0,0]},{text:o.price?`${o.price} \u20AC`:"",style:"servicePrice"}]);return[i,...r]}if(e===2){let i=this.includeGroupsInPrint?[{text:"",style:"borderIndicatorHeader",width:3},{text:"SERVIZIO",style:"tableHeader",alignment:"left"},{text:"PREZZO",style:"tableHeader",alignment:"right"}]:[{text:"SERVIZIO",style:"tableHeader",alignment:"left"},{text:"PREZZO",style:"tableHeader",alignment:"right"}],r=t.map(o=>this.includeGroupsInPrint?[{text:"",style:o.is_group?"groupBorderIndicator":"serviceBorderIndicator"},{text:o.name,style:o.is_group?"groupServiceName":"serviceName",alignment:"left"},{text:o.is_group?"":o.price?`${o.price} \u20AC`:"",alignment:"right",style:o.is_group?"groupServicePrice":"servicePrice"}]:[{text:o.name,style:"serviceName",alignment:"left"},{text:o.price?`${o.price} \u20AC`:"",alignment:"right",style:"servicePrice"}]);return[i,...r]}if(e===3){let i=this.includeGroupsInPrint?[{text:"",style:"borderIndicatorHeader",width:1},{text:"SERVIZIO",style:"tableHeader",alignment:"left"},{text:"PREZZO",style:"tableHeader",alignment:"right"}]:[{text:"SERVIZIO",style:"tableHeader",alignment:"left"},{text:"PREZZO",style:"tableHeader",alignment:"right"}],r=t.map(o=>this.includeGroupsInPrint?[{text:"",style:o.is_group?"groupBorderIndicator":"serviceBorderIndicator"},{text:o.name,style:o.is_group?"groupServiceName":"serviceName",alignment:"left"},{text:o.is_group?"":o.price?`${o.price} \u20AC`:"",alignment:"right",style:o.is_group?"groupServicePrice":"servicePrice"}]:[{text:o.name,style:"serviceName",alignment:"left"},{text:o.price?`${o.price} \u20AC`:"",alignment:"right",style:"servicePrice"}]);return[i,...r]}return this.getTableDataForPdf(1)}layoutClassic(e,t,i,r,o,s=!0){let u=this.normalizeColor(i.primary,"#cc9c00"),f=this.normalizeColor(i.secondary,"#8f6d00"),m=this.normalizeColor(i.text,"#eeeeee"),w=this.normalizeColor(i.background,"#000000"),b=this.normalizeColor(i.background2,"#0a0a0a"),D=[];o.telefono&&D.push({text:`Tel: ${o.telefono}`,style:"footerItem"}),o.email&&D.push({text:`Email: ${o.email}`,style:"footerItem"}),o.sito_web&&D.push({text:`Web: ${o.sito_web}`,style:"footerItem"});let T=s?[3,"40%","45%","12%"]:["40%","45%","15%"];return{pageSize:"A4",pageMargins:[36,36,36,36],background:[{canvas:[{type:"rect",x:0,y:0,w:595.28,h:841.89,color:w}]}],content:[...t?[{image:t,width:90,alignment:"center",margin:[0,0,0,8]}]:[],{text:e,style:"title",alignment:"center",margin:[0,4,0,2],color:m},{text:"Listino Prezzi",style:"subtitle",alignment:"center",margin:[0,0,0,12],color:f},{table:{headerRows:1,widths:T,body:r},layout:{fillColor:(M,P)=>M===0?u:M%2===0?b:w,hLineWidth:M=>M===1?.9:.4,vLineWidth:()=>0,hLineColor:()=>f,paddingLeft:(M,P)=>8,paddingRight:()=>8,paddingTop:M=>M===0?8:6,paddingBottom:M=>M===0?8:6},margin:[0,6,0,0]},...D.length>0?[{stack:D,style:"footer",margin:[0,20,0,0],alignment:"center"}]:[]],styles:{title:{fontSize:20,bold:!0},subtitle:{fontSize:12,bold:!0},tableHeader:{bold:!0,color:m,fontSize:11,alignment:"left"},borderIndicatorHeader:{},serviceName:{fontSize:11,bold:!0,color:m,alignment:"left"},serviceDesc:{fontSize:9,color:m,alignment:"left"},servicePrice:{fontSize:11,bold:!0,color:m,alignment:"right"},footer:{fontSize:10,color:"#cfcfcf",lineHeight:1.5},footerItem:{fontSize:10,color:"#cfcfcf",margin:[0,3]},groupBorderIndicator:{fillColor:f},serviceBorderIndicator:{fillColor:w},groupServiceName:{fontSize:11,bold:!0,color:m,alignment:"left",margin:[2,0,0,0]},groupServiceDesc:{fontSize:9,color:"#cfcfcf",alignment:"left",margin:[2,0,0,0]},groupServicePrice:{fontSize:11,bold:!0,color:m,alignment:"right",margin:[2,0,0,0]}},defaultStyle:{fontSize:10,color:m,lineHeight:1.2}}}layoutElegant(e,t,i,r,o,s=!0){let u=this.normalizeColor(i.primary,"#cc9c00"),f=this.normalizeColor(i.secondary,"#8f6d00"),m=this.normalizeColor(i.text,"#222222"),w=this.normalizeColor(i.background,"#ffffff"),b=[];o.telefono&&b.push({text:`Tel: ${o.telefono}`,style:"footerItem"}),o.email&&b.push({text:`Email: ${o.email}`,style:"footerItem"}),o.sito_web&&b.push({text:`Web: ${o.sito_web}`,style:"footerItem"});let D=s?[3,"*","auto"]:["*","auto"];return{pageSize:"A4",pageMargins:[50,60,50,50],background:[{canvas:[{type:"rect",x:0,y:0,w:595.28,h:841.89,color:w}]}],content:[{stack:[...t?[{image:t,width:80,alignment:"center",margin:[0,0,0,10]}]:[],{text:e.toUpperCase(),style:"headerTitle",margin:[0,0,0,5]},{text:"LISTINO PREZZI",style:"headerSubtitle",margin:[0,0,0,30]}],alignment:"center",margin:[0,0,0,20]},{table:{headerRows:1,widths:D,body:r},layout:{fillColor:()=>null,hLineWidth:T=>T>0?.5:0,vLineWidth:()=>0,hLineColor:()=>"#e0e0e0",paddingTop:T=>T===0?0:8,paddingBottom:T=>8},margin:[0,20,0,0]},...b.length>0?[{stack:b,style:"footer",margin:[0,20,0,0],alignment:"center"}]:[]],styles:{headerTitle:{fontSize:18,bold:!0,color:m,letterSpacing:1.2},headerSubtitle:{fontSize:12,color:u,fontStyle:"italic"},serviceName:{fontSize:12,color:m,lineHeight:1.4},servicePrice:{fontSize:12,color:m,bold:!0},tableHeader:{bold:!0,fontSize:11,color:u,alignment:"center"},borderIndicatorHeader:{},footer:{fontSize:10,color:"#666666",lineHeight:1.5},footerItem:{fontSize:10,color:"#666666",margin:[0,2]},groupBorderIndicator:{fillColor:f},serviceBorderIndicator:{fillColor:w},groupServiceName:{fontSize:12,bold:!0,color:m,alignment:"left",margin:[2,0,0,0]},groupServicePrice:{fontSize:12,bold:!0,color:m,alignment:"right",margin:[2,0,0,0]}},defaultStyle:{fontSize:11,color:m,lineHeight:1.3}}}layoutMinimal(e,t,i,r,o,s=!0){let u=this.normalizeColor(i.primary,"#cc9c00"),f=this.normalizeColor(i.secondary,"#8f6d00"),m=this.normalizeColor(i.text,"#222222"),w=this.normalizeColor(i.background,"#ffffff"),b=[];o.telefono&&b.push({text:`Tel: ${o.telefono}`,style:"footerItem"}),o.email&&b.push({text:`Email: ${o.email}`,style:"footerItem"}),o.sito_web&&b.push({text:`Web: ${o.sito_web}`,style:"footerItem"});let D=s?[3,"*",80]:["*",80];return{pageSize:"A4",pageMargins:[40,40,40,40],background:[{canvas:[{type:"rect",x:0,y:0,w:595.28,h:841.89,color:w}]}],content:[{stack:[...t?[{image:t,width:60,alignment:"center"}]:[],{text:e,style:"minimalHeaderTitle",margin:[0,t?8:0,0,0]},{text:"LISTINO PREZZI",style:"minimalHeaderSubtitle",margin:[0,4,0,20]}],alignment:"center"},{table:{headerRows:1,widths:D,body:r},layout:{fillColor:()=>null,hLineWidth:()=>0,vLineWidth:()=>0,paddingTop:()=>6,paddingBottom:()=>6},margin:[0,0,0,0]},...b.length>0?[{stack:b,style:"footer",margin:[0,15,0,0],alignment:"center"}]:[]],styles:{minimalHeaderTitle:{fontSize:18,bold:!0,color:m,alignment:"center"},minimalHeaderSubtitle:{fontSize:12,color:u,alignment:"center",margin:[0,4,0,0]},tableHeader:{bold:!0,fontSize:11,color:u,alignment:"center"},borderIndicatorHeader:{},serviceName:{fontSize:12,color:m},servicePrice:{fontSize:12,color:m},footer:{fontSize:10,color:"#888888",lineHeight:1.5},footerItem:{fontSize:10,color:"#888888",margin:[0,3]},groupBorderIndicator:{fillColor:f},serviceBorderIndicator:{fillColor:w},groupServiceName:{fontSize:12,bold:!0,color:m,alignment:"left",margin:[2,0,0,0]},groupServicePrice:{fontSize:12,bold:!0,color:m,alignment:"right",margin:[2,0,0,0]}},defaultStyle:{fontSize:10,color:m,lineHeight:1.2}}}static \u0275fac=function(t){return new(t||n)(z(qv),z(Ji),z(wi),z(Gc))};static \u0275cmp=he({type:n,selectors:[["app-lista-servizi"]],decls:37,vars:7,consts:[["serviceRow",""],[1,"container","lista-servizi-container"],[1,"section-title"],[1,"toolbar"],[1,"left"],["type","button",1,"btn-primary",3,"click","disabled"],[4,"ngIf"],["type","button",1,"btn",3,"click"],[1,"icon"],[1,"right"],["type","button","aria-label","Stampa listino",1,"btn",3,"click"],["class","print-options","role","dialog","aria-modal","true",4,"ngIf"],["id","printArea","aria-live","polite",1,"table-responsive"],[3,"ngSubmit","formGroup"],["aria-label","Tabella servizi",1,"data-table"],["formArrayName","servizi","cdkDropList","","cdkDropListOrientation","vertical",3,"cdkDropListDropped","cdkDropListData"],[3,"formGroupName","group-row","service-row","display",4,"ngFor","ngForOf"],["role","dialog","aria-modal","true",1,"print-options"],[1,"section-subtitle"],[1,"option-group"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"layout-options"],["role","button","tabindex","0",1,"layout-option",3,"click"],["aria-hidden","true",1,"layout-preview","classic"],["aria-hidden","true",1,"layout-preview","modern"],["aria-hidden","true",1,"layout-preview","minimal"],[1,"btn",3,"click"],[3,"formGroupName"],[4,"ngIf","ngIfElse"],["colspan","2",1,"group-cell"],[1,"group-inline"],["type","button","aria-label","Apri/chiudi gruppo","tabindex","0",1,"arrow-btn",3,"click"],["formControlName","nome","placeholder","Nome gruppo","aria-label","Nome gruppo",1,"input-field"],[1,"text-muted"],[1,"group-actions"],["type","button","title","Aggiungi servizio al gruppo",1,"btn",3,"click"],["type","button","title","Elimina gruppo","aria-label","Elimina gruppo",1,"btn-icon",3,"click"],[1,"name-with-gender"],["formControlName","nome","placeholder","Nome servizio","aria-label","Nome servizio",1,"input-field"],["formControlName","sesso","aria-label","Sesso servizio","title","Sesso servizio",1,"tiny-select"],["value","maschio"],["value","femmina"],["value","unisex"],[1,"error"],["formControlName","descrizione","placeholder","Descrizione servizio","aria-label","Descrizione servizio",1,"input-field"],[1,"price-wrapper"],["formControlName","prezzo","placeholder","Prezzo","aria-label","Prezzo",1,"input-field"],["formControlName","timing","placeholder","Durata","aria-label","Durata in minuti",1,"input-field"],[1,"actions"],["cdkDrag","","cdkDragHandle","","aria-hidden","true",1,"drag-handle"],["type","button","title","Elimina riga","aria-label","Elimina riga",1,"btn-remove",3,"click"]],template:function(t,i){t&1&&(g(0,"div",1)(1,"h2",2),v(2,"Lista Servizi"),p(),g(3,"div",3)(4,"div",4)(5,"button",5),F("click",function(){return i.saveAll()}),N(6,u$,2,0,"span",6)(7,f$,2,0,"span",6),p(),g(8,"button",7),F("click",function(){return i.addService()}),g(9,"span",8),v(10,"\uFF0B"),p(),v(11," Aggiungi servizio "),p(),g(12,"button",7),F("click",function(){return i.addGroup()}),v(13," Aggiungi gruppo "),p()(),g(14,"div",9)(15,"button",7),F("click",function(){return i.exportCsv()}),v(16,"Esporta CSV"),p(),g(17,"button",10),F("click",function(){return i.printList()}),v(18,"Stampa / PDF"),p()()(),N(19,p$,22,2,"div",11),g(20,"div",12)(21,"form",13),F("ngSubmit",function(){return i.saveAll()}),g(22,"table",14)(23,"thead")(24,"tr")(25,"th"),v(26,"Nome servizio / Gruppo"),p(),g(27,"th"),v(28,"Descrizione"),p(),g(29,"th"),v(30,"Prezzo (\u20AC)"),p(),g(31,"th"),v(32,"Durata (min)"),p(),g(33,"th"),v(34,"Azioni"),p()()(),g(35,"tbody",15),F("cdkDropListDropped",function(o){return i.onDrop(o)}),N(36,_$,4,9,"tr",16),p()()()()()),t&2&&(_(5),x("disabled",i.savingAll),_(),x("ngIf",!i.savingAll),_(),x("ngIf",i.savingAll),_(12),x("ngIf",i.showPrintOptions),_(2),x("formGroup",i.serviziForm),_(14),x("cdkDropListData",i.servizi.controls),_(),x("ngForOf",i.servizi.controls))},dependencies:[Se,Ze,Ne,Gv,bi,Ot,Nt,st,Dr,Dt,at,yi,Uc,Mf,Wv,$v,vt,pt,GN,qN,$N,UN],styles:[".toolbar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--padding-v);align-items:center;justify-content:space-between;margin-bottom:var(--padding-h)}.toolbar[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%], .toolbar[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--padding-v);align-items:center;min-width:0}.print-options[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--background);padding:var(--padding-v);border-radius:var(--border-radius);z-index:1000;box-shadow:0 10px 20px color-mix(in srgb,var(--background) 20%,transparent);width:92%;max-width:600px;border:1px solid color-mix(in srgb,var(--primary) 20%,transparent)}.layout-options[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin:0;flex-wrap:wrap;gap:var(--padding-v)}.layout-option[_ngcontent-%COMP%]{cursor:pointer;text-align:center;transition:transform .2s ease;-webkit-user-select:none;user-select:none;padding:var(--padding-v);border-radius:var(--border-radius)}.layout-option[_ngcontent-%COMP%]:hover{transform:scale(1.03);background:var(--background2)}.layout-preview[_ngcontent-%COMP%]{width:110px;height:140px;border:2px solid var(--primary);border-radius:var(--border-radius);margin-bottom:var(--padding-v)}.classic[_ngcontent-%COMP%]{background:linear-gradient(to bottom,var(--primary) 0% 10%,var(--background2) 10% 20%,var(--background) 20% 100%)}.modern[_ngcontent-%COMP%]{background:linear-gradient(to right,var(--primary) 0% 15%,var(--background) 15% 100%),linear-gradient(to bottom,var(--background2) 20% 25%,var(--background) 25% 100%)}.minimal[_ngcontent-%COMP%]{background:var(--background);border:2px solid var(--secondary)}@media (max-width: 480px){.toolbar[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%], .toolbar[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:100%;justify-content:center}.btn[_ngcontent-%COMP%]{flex:1 1 auto;justify-content:center}.data-table[_ngcontent-%COMP%]{min-width:520px}}.group-row[_ngcontent-%COMP%]{background:var(--background2);border-left:4px solid var(--secondary)}.group-actions[_ngcontent-%COMP%]{display:flex;gap:var(--padding-v);align-items:center;justify-content:flex-start}.drag-handle[_ngcontent-%COMP%]{cursor:grab;display:inline-block;padding:var(--padding-v);font-size:var(--font-size-lg);opacity:.85}.group-inline[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--padding-v)}.arrow-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;line-height:1;color:var(--secondary);padding:var(--padding-v);display:inline-flex;align-items:center;justify-content:center}.group-inline[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]{flex:1 1 auto;min-width:0}.option-group[_ngcontent-%COMP%]{margin-bottom:var(--padding-v)}.option-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.option-group[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-right:8px}.name-with-gender[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.45rem;width:100%}.name-with-gender[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]{flex:1 1 auto;min-width:0;padding-right:.4rem}.tiny-select[_ngcontent-%COMP%]{flex:0 0 44px;height:100%;padding:var(--padding-v);border-radius:var(--border-radius);border:1px solid color-mix(in srgb,var(--text-light) 20%,transparent);background:var(--background2);color:var(--text-light);-webkit-appearance:none;appearance:none;text-align-last:center;cursor:pointer}"]})};var s_,me,XN,qE,Zc,Ga,YN,e2,t2,i_={},n2=[],y$=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function xs(n,e){for(var t in e)n[t]=e[t];return n}function i2(n){var e=n.parentNode;e&&e.removeChild(n)}function k(n,e,t){var i,r,o,s={};for(o in e)o=="key"?i=e[o]:o=="ref"?r=e[o]:s[o]=e[o];if(arguments.length>2&&(s.children=arguments.length>3?s_.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(o in n.defaultProps)s[o]===void 0&&(s[o]=n.defaultProps[o]);return n_(n,s,i,r,null)}function n_(n,e,t,i,r){var o={type:n,props:e,key:t,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:r??++XN};return r==null&&me.vnode!=null&&me.vnode(o),o}function cn(){return{current:null}}function Xe(n){return n.children}function b$(n,e,t,i,r){var o;for(o in t)o==="children"||o==="key"||o in e||r_(n,o,null,t[o],i);for(o in e)r&&typeof e[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||t[o]===e[o]||r_(n,o,e[o],t[o],i)}function QN(n,e,t){e[0]==="-"?n.setProperty(e,t??""):n[e]=t==null?"":typeof t!="number"||y$.test(e)?t:t+"px"}function r_(n,e,t,i,r){var o;e:if(e==="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof i=="string"&&(n.style.cssText=i=""),i)for(e in i)t&&e in t||QN(n.style,e,"");if(t)for(e in t)i&&t[e]===i[e]||QN(n.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in n?e.toLowerCase().slice(2):e.slice(2),n.l||(n.l={}),n.l[e+o]=t,t?i||n.addEventListener(e,o?JN:KN,o):n.removeEventListener(e,o?JN:KN,o);else if(e!=="dangerouslySetInnerHTML"){if(r)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="width"&&e!=="height"&&e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in n)try{n[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e.indexOf("-")==-1?n.removeAttribute(e):n.setAttribute(e,t))}}function KN(n){Zc=!0;try{return this.l[n.type+!1](me.event?me.event(n):n)}finally{Zc=!1}}function JN(n){Zc=!0;try{return this.l[n.type+!0](me.event?me.event(n):n)}finally{Zc=!1}}function Fn(n,e){this.props=n,this.context=e}function Ff(n,e){if(e==null)return n.__?Ff(n.__,n.__.__k.indexOf(n)+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?Ff(n):null}function r2(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return r2(n)}}function w$(n){Zc?setTimeout(n):e2(n)}function $E(n){(!n.__d&&(n.__d=!0)&&Ga.push(n)&&!o_.__r++||YN!==me.debounceRendering)&&((YN=me.debounceRendering)||w$)(o_)}function o_(){var n,e,t,i,r,o,s,l;for(Ga.sort(function(c,u){return c.__v.__b-u.__v.__b});n=Ga.shift();)n.__d&&(e=Ga.length,i=void 0,r=void 0,s=(o=(t=n).__v).__e,(l=t.__P)&&(i=[],(r=xs({},o)).__v=o.__v+1,GE(l,o,r,t.__n,l.ownerSVGElement!==void 0,o.__h!=null?[s]:null,i,s??Ff(o),o.__h),c2(i,o),o.__e!=s&&r2(o)),Ga.length>e&&Ga.sort(function(c,u){return c.__v.__b-u.__v.__b}));o_.__r=0}function o2(n,e,t,i,r,o,s,l,c,u){var f,m,w,b,D,T,M,P=i&&i.__k||n2,U=P.length;for(t.__k=[],f=0;f<e.length;f++)if((b=t.__k[f]=(b=e[f])==null||typeof b=="boolean"?null:typeof b=="string"||typeof b=="number"||typeof b=="bigint"?n_(null,b,null,null,b):Array.isArray(b)?n_(Xe,{children:b},null,null,null):b.__b>0?n_(b.type,b.props,b.key,b.ref?b.ref:null,b.__v):b)!=null){if(b.__=t,b.__b=t.__b+1,(w=P[f])===null||w&&b.key==w.key&&b.type===w.type)P[f]=void 0;else for(m=0;m<U;m++){if((w=P[m])&&b.key==w.key&&b.type===w.type){P[m]=void 0;break}w=null}GE(n,b,w=w||i_,r,o,s,l,c,u),D=b.__e,(m=b.ref)&&w.ref!=m&&(M||(M=[]),w.ref&&M.push(w.ref,null,b),M.push(m,b.__c||D,b)),D!=null?(T==null&&(T=D),typeof b.type=="function"&&b.__k===w.__k?b.__d=c=s2(b,c,n):c=a2(n,b,w,P,D,c),typeof t.type=="function"&&(t.__d=c)):c&&w.__e==c&&c.parentNode!=n&&(c=Ff(w))}for(t.__e=T,f=U;f--;)P[f]!=null&&(typeof t.type=="function"&&P[f].__e!=null&&P[f].__e==t.__d&&(t.__d=l2(i).nextSibling),u2(P[f],P[f]));if(M)for(f=0;f<M.length;f++)d2(M[f],M[++f],M[++f])}function s2(n,e,t){for(var i,r=n.__k,o=0;r&&o<r.length;o++)(i=r[o])&&(i.__=n,e=typeof i.type=="function"?s2(i,e,t):a2(t,i,i,r,i.__e,e));return e}function zf(n,e){return e=e||[],n==null||typeof n=="boolean"||(Array.isArray(n)?n.some(function(t){zf(t,e)}):e.push(n)),e}function a2(n,e,t,i,r,o){var s,l,c;if(e.__d!==void 0)s=e.__d,e.__d=void 0;else if(t==null||r!=o||r.parentNode==null)e:if(o==null||o.parentNode!==n)n.appendChild(r),s=null;else{for(l=o,c=0;(l=l.nextSibling)&&c<i.length;c+=1)if(l==r)break e;n.insertBefore(r,o),s=o}return s!==void 0?s:r.nextSibling}function l2(n){var e,t,i;if(n.type==null||typeof n.type=="string")return n.__e;if(n.__k){for(e=n.__k.length-1;e>=0;e--)if((t=n.__k[e])&&(i=l2(t)))return i}return null}function GE(n,e,t,i,r,o,s,l,c){var u,f,m,w,b,D,T,M,P,U,K,W,re,fe,ce,le=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(c=t.__h,l=e.__e=t.__e,e.__h=null,o=[l]),(u=me.__b)&&u(e);try{e:if(typeof le=="function"){if(M=e.props,P=(u=le.contextType)&&i[u.__c],U=u?P?P.props.value:u.__:i,t.__c?T=(f=e.__c=t.__c).__=f.__E:("prototype"in le&&le.prototype.render?e.__c=f=new le(M,U):(e.__c=f=new Fn(M,U),f.constructor=le,f.render=C$),P&&P.sub(f),f.props=M,f.state||(f.state={}),f.context=U,f.__n=i,m=f.__d=!0,f.__h=[],f._sb=[]),f.__s==null&&(f.__s=f.state),le.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=xs({},f.__s)),xs(f.__s,le.getDerivedStateFromProps(M,f.__s))),w=f.props,b=f.state,f.__v=e,m)le.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(le.getDerivedStateFromProps==null&&M!==w&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(M,U),!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(M,f.__s,U)===!1||e.__v===t.__v){for(e.__v!==t.__v&&(f.props=M,f.state=f.__s,f.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(ct){ct&&(ct.__=e)}),K=0;K<f._sb.length;K++)f.__h.push(f._sb[K]);f._sb=[],f.__h.length&&s.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(M,f.__s,U),f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(w,b,D)})}if(f.context=U,f.props=M,f.__P=n,W=me.__r,re=0,"prototype"in le&&le.prototype.render){for(f.state=f.__s,f.__d=!1,W&&W(e),u=f.render(f.props,f.state,f.context),fe=0;fe<f._sb.length;fe++)f.__h.push(f._sb[fe]);f._sb=[]}else do f.__d=!1,W&&W(e),u=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++re<25);f.state=f.__s,f.getChildContext!=null&&(i=xs(xs({},i),f.getChildContext())),m||f.getSnapshotBeforeUpdate==null||(D=f.getSnapshotBeforeUpdate(w,b)),ce=u!=null&&u.type===Xe&&u.key==null?u.props.children:u,o2(n,Array.isArray(ce)?ce:[ce],e,t,i,r,o,s,l,c),f.base=e.__e,e.__h=null,f.__h.length&&s.push(f),T&&(f.__E=f.__=null),f.__e=!1}else o==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=S$(t.__e,e,t,i,r,o,s,c);(u=me.diffed)&&u(e)}catch(ct){e.__v=null,(c||o!=null)&&(e.__e=l,e.__h=!!c,o[o.indexOf(l)]=null),me.__e(ct,e,t)}}function c2(n,e){me.__c&&me.__c(e,n),n.some(function(t){try{n=t.__h,t.__h=[],n.some(function(i){i.call(t)})}catch(i){me.__e(i,t.__v)}})}function S$(n,e,t,i,r,o,s,l){var c,u,f,m=t.props,w=e.props,b=e.type,D=0;if(b==="svg"&&(r=!0),o!=null){for(;D<o.length;D++)if((c=o[D])&&"setAttribute"in c==!!b&&(b?c.localName===b:c.nodeType===3)){n=c,o[D]=null;break}}if(n==null){if(b===null)return document.createTextNode(w);n=r?document.createElementNS("http://www.w3.org/2000/svg",b):document.createElement(b,w.is&&w),o=null,l=!1}if(b===null)m===w||l&&n.data===w||(n.data=w);else{if(o=o&&s_.call(n.childNodes),u=(m=t.props||i_).dangerouslySetInnerHTML,f=w.dangerouslySetInnerHTML,!l){if(o!=null)for(m={},D=0;D<n.attributes.length;D++)m[n.attributes[D].name]=n.attributes[D].value;(f||u)&&(f&&(u&&f.__html==u.__html||f.__html===n.innerHTML)||(n.innerHTML=f&&f.__html||""))}if(b$(n,w,m,r,l),f)e.__k=[];else if(D=e.props.children,o2(n,Array.isArray(D)?D:[D],e,t,i,r&&b!=="foreignObject",o,s,o?o[0]:t.__k&&Ff(t,0),l),o!=null)for(D=o.length;D--;)o[D]!=null&&i2(o[D]);l||("value"in w&&(D=w.value)!==void 0&&(D!==n.value||b==="progress"&&!D||b==="option"&&D!==m.value)&&r_(n,"value",D,m.value,!1),"checked"in w&&(D=w.checked)!==void 0&&D!==n.checked&&r_(n,"checked",D,m.checked,!1))}return n}function d2(n,e,t){try{typeof n=="function"?n(e):n.current=e}catch(i){me.__e(i,t)}}function u2(n,e,t){var i,r;if(me.unmount&&me.unmount(n),(i=n.ref)&&(i.current&&i.current!==n.__e||d2(i,null,e)),(i=n.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(o){me.__e(o,e)}i.base=i.__P=null,n.__c=void 0}if(i=n.__k)for(r=0;r<i.length;r++)i[r]&&u2(i[r],e,t||typeof n.type!="function");t||n.__e==null||i2(n.__e),n.__=n.__e=n.__d=void 0}function C$(n,e,t){return this.constructor(n,t)}function Ds(n,e,t){var i,r,o;me.__&&me.__(n,e),r=(i=typeof t=="function")?null:t&&t.__k||e.__k,o=[],GE(e,n=(!i&&t||e).__k=k(Xe,null,[n]),r||i_,i_,e.ownerSVGElement!==void 0,!i&&t?[t]:r?null:e.firstChild?s_.call(e.childNodes):null,o,!i&&t?t:r?r.__e:e.firstChild,i),c2(o,n)}function a_(n,e){var t={__c:e="__cC"+t2++,__:n,Consumer:function(i,r){return i.children(r)},Provider:function(i){var r,o;return this.getChildContext||(r=[],(o={})[e]=this,this.getChildContext=function(){return o},this.shouldComponentUpdate=function(s){this.props.value!==s.value&&r.some(function(l){l.__e=!0,$E(l)})},this.sub=function(s){r.push(s);var l=s.componentWillUnmount;s.componentWillUnmount=function(){r.splice(r.indexOf(s),1),l&&l.call(s)}}),i.children}};return t.Provider.__=t.Consumer.contextType=t}s_=n2.slice,me={__e:function(n,e,t,i){for(var r,o,s;e=e.__;)if((r=e.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(n)),s=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(n,i||{}),s=r.__d),s)return r.__E=r}catch(l){n=l}throw n}},XN=0,qE=function(n){return n!=null&&n.constructor===void 0},Zc=!1,Fn.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=xs({},this.state),typeof n=="function"&&(n=n(xs({},t),this.props)),n&&xs(t,n),n!=null&&this.__v&&(e&&this._sb.push(e),$E(this))},Fn.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),$E(this))},Fn.prototype.render=Xe,Ga=[],e2=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,o_.__r=0,t2=0;var x$,uo,ZE,f2;var y2=[],YE=[],p2=me.__b,h2=me.__r,g2=me.diffed,m2=me.__c,v2=me.unmount;function D$(){for(var n;n=y2.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(l_),n.__H.__h.forEach(QE),n.__H.__h=[]}catch(e){n.__H.__h=[],me.__e(e,n.__v)}}me.__b=function(n){uo=null,p2&&p2(n)},me.__r=function(n){h2&&h2(n),x$=0;var e=(uo=n.__c).__H;e&&(ZE===uo?(e.__h=[],uo.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=YE,t.__N=t.i=void 0})):(e.__h.forEach(l_),e.__h.forEach(QE),e.__h=[])),ZE=uo},me.diffed=function(n){g2&&g2(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(y2.push(e)!==1&&f2===me.requestAnimationFrame||((f2=me.requestAnimationFrame)||I$)(D$)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==YE&&(t.__=t.__V),t.i=void 0,t.__V=YE})),ZE=uo=null},me.__c=function(n,e){e.some(function(t){try{t.__h.forEach(l_),t.__h=t.__h.filter(function(i){return!i.__||QE(i)})}catch(i){e.some(function(r){r.__h&&(r.__h=[])}),e=[],me.__e(i,t.__v)}}),m2&&m2(n,e)},me.unmount=function(n){v2&&v2(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.forEach(function(i){try{l_(i)}catch(r){e=r}}),t.__H=void 0,e&&me.__e(e,t.__v))};var _2=typeof requestAnimationFrame=="function";function I$(n){var e,t=function(){clearTimeout(i),_2&&cancelAnimationFrame(e),setTimeout(n)},i=setTimeout(t,100);_2&&(e=requestAnimationFrame(t))}function l_(n){var e=uo,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),uo=e}function QE(n){var e=uo;n.__c=n.__(),uo=e}function M$(n,e){for(var t in e)n[t]=e[t];return n}function b2(n,e){for(var t in n)if(t!=="__source"&&!(t in e))return!0;for(var i in e)if(i!=="__source"&&n[i]!==e[i])return!0;return!1}function w2(n){this.props=n}(w2.prototype=new Fn).isPureReactComponent=!0,w2.prototype.shouldComponentUpdate=function(n,e){return b2(this.props,n)||b2(this.state,e)};var S2=me.__b;me.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),S2&&S2(n)};var awe=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;var T$=me.__e;me.__e=function(n,e,t,i){if(n.then){for(var r,o=e;o=o.__;)if((r=o.__c)&&r.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),r.__c(n,e)}T$(n,e,t,i)};var C2=me.unmount;function T2(n,e,t){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(i){typeof i.__c=="function"&&i.__c()}),n.__c.__H=null),(n=M$({},n)).__c!=null&&(n.__c.__P===t&&(n.__c.__P=e),n.__c=null),n.__k=n.__k&&n.__k.map(function(i){return T2(i,e,t)})),n}function P2(n,e,t){return n&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(i){return P2(i,e,t)}),n.__c&&n.__c.__P===e&&(n.__e&&t.insertBefore(n.__e,n.__d),n.__c.__e=!0,n.__c.__P=t)),n}function KE(){this.__u=0,this.t=null,this.__b=null}function A2(n){var e=n.__.__c;return e&&e.__a&&e.__a(n)}function c_(){this.u=null,this.o=null}me.unmount=function(n){var e=n.__c;e&&e.__R&&e.__R(),e&&n.__h===!0&&(n.type=null),C2&&C2(n)},(KE.prototype=new Fn).__c=function(n,e){var t=e.__c,i=this;i.t==null&&(i.t=[]),i.t.push(t);var r=A2(i.__v),o=!1,s=function(){o||(o=!0,t.__R=null,r?r(l):l())};t.__R=s;var l=function(){if(!--i.__u){if(i.state.__a){var u=i.state.__a;i.__v.__k[0]=P2(u,u.__c.__P,u.__c.__O)}var f;for(i.setState({__a:i.__b=null});f=i.t.pop();)f.forceUpdate()}},c=e.__h===!0;i.__u++||c||i.setState({__a:i.__b=i.__v.__k[0]}),n.then(s,s)},KE.prototype.componentWillUnmount=function(){this.t=[]},KE.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=T2(this.__b,t,i.__O=i.__P)}this.__b=null}var r=e.__a&&k(Xe,null,n.fallback);return r&&(r.__h=null),[k(Xe,null,e.__a?null:n.children),r]};var E2=function(n,e,t){if(++t[1]===t[0]&&n.o.delete(e),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.o.size))for(t=n.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;n.u=t=t[2]}};function P$(n){return this.getChildContext=function(){return n.context},n.children}function A$(n){var e=this,t=n.i;e.componentWillUnmount=function(){Ds(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),n.__v?(e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(i){this.childNodes.push(i),e.i.appendChild(i)},insertBefore:function(i,r){this.childNodes.push(i),e.i.appendChild(i)},removeChild:function(i){this.childNodes.splice(this.childNodes.indexOf(i)>>>1,1),e.i.removeChild(i)}}),Ds(k(P$,{context:e.context},n.__v),e.l)):e.l&&e.componentWillUnmount()}function R2(n,e){var t=k(A$,{__v:n,i:e});return t.containerInfo=e,t}(c_.prototype=new Fn).__a=function(n){var e=this,t=A2(e.__v),i=e.o.get(n);return i[0]++,function(r){var o=function(){e.props.revealOrder?(i.push(r),E2(e,n,i)):r()};t?t(o):o()}},c_.prototype.render=function(n){this.u=null,this.o=new Map;var e=zf(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return n.children},c_.prototype.componentDidUpdate=c_.prototype.componentDidMount=function(){var n=this;this.o.forEach(function(e,t){E2(n,t,e)})};var R$=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,k$=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,O$=typeof document<"u",N$=function(n){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(n)};Fn.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(Fn.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(e){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:e})}})});var x2=me.event;function L$(){}function F$(){return this.cancelBubble}function z$(){return this.defaultPrevented}me.event=function(n){return x2&&(n=x2(n)),n.persist=L$,n.isPropagationStopped=F$,n.isDefaultPrevented=z$,n.nativeEvent=n};var V$,D2={configurable:!0,get:function(){return this.class}},I2=me.vnode;me.vnode=function(n){var e=n.type,t=n.props,i=t;if(typeof e=="string"){var r=e.indexOf("-")===-1;for(var o in i={},t){var s=t[o];O$&&o==="children"&&e==="noscript"||o==="value"&&"defaultValue"in t&&s==null||(o==="defaultValue"&&"value"in t&&t.value==null?o="value":o==="download"&&s===!0?s="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+e)&&!N$(t.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(o)?o=o.toLowerCase():r&&k$.test(o)?o=o.replace(/[A-Z0-9]/g,"-$&").toLowerCase():s===null&&(s=void 0),/^oninput$/i.test(o)&&(o=o.toLowerCase(),i[o]&&(o="oninputCapture")),i[o]=s)}e=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=zf(t.children).forEach(function(l){l.props.selected=i.value.indexOf(l.props.value)!=-1})),e=="select"&&i.defaultValue!=null&&(i.value=zf(t.children).forEach(function(l){l.props.selected=i.multiple?i.defaultValue.indexOf(l.props.value)!=-1:i.defaultValue==l.props.value})),n.props=i,t.class!=t.className&&(D2.enumerable="className"in t,t.className!=null&&(i.class=t.className),Object.defineProperty(i,"className",D2))}n.$$typeof=R$,I2&&I2(n)};var M2=me.__r;me.__r=function(n){M2&&M2(n),V$=n.__c};var q2=[],lx=new Map;function Kc(n){q2.push(n),lx.forEach(e=>{Y2(e,n)})}function G2(n){n.isConnected&&n.getRootNode&&Z2(n.getRootNode())}function Z2(n){let e=lx.get(n);if(!e||!e.isConnected){if(e=n.querySelector("style[data-fullcalendar]"),!e){e=document.createElement("style"),e.setAttribute("data-fullcalendar","");let t=B$();t&&(e.nonce=t);let i=n===document?document.head:n,r=n===document?i.querySelector("script,link[rel=stylesheet],link[as=style],style"):i.firstChild;i.insertBefore(e,r)}lx.set(n,e),j$(e)}}function j$(n){for(let e of q2)Y2(n,e)}function Y2(n,e){let{sheet:t}=n,i=t.cssRules.length;e.split("}").forEach((r,o)=>{r=r.trim(),r&&t.insertRule(r+"}",i+o)})}var JE;function B$(){return JE===void 0&&(JE=U$()),JE}function U$(){let n=document.querySelector('meta[name="csp-nonce"]');if(n&&n.hasAttribute("content"))return n.getAttribute("content");let e=document.querySelector("script[nonce]");return e&&e.nonce||""}typeof document<"u"&&Z2(document);var H$=':root{--fc-small-font-size:.85em;--fc-page-bg-color:#fff;--fc-neutral-bg-color:hsla(0,0%,82%,.3);--fc-neutral-text-color:grey;--fc-border-color:#ddd;--fc-button-text-color:#fff;--fc-button-bg-color:#2c3e50;--fc-button-border-color:#2c3e50;--fc-button-hover-bg-color:#1e2b37;--fc-button-hover-border-color:#1a252f;--fc-button-active-bg-color:#1a252f;--fc-button-active-border-color:#151e27;--fc-event-bg-color:#3788d8;--fc-event-border-color:#3788d8;--fc-event-text-color:#fff;--fc-event-selected-overlay-color:rgba(0,0,0,.25);--fc-more-link-bg-color:#d0d0d0;--fc-more-link-text-color:inherit;--fc-event-resizer-thickness:8px;--fc-event-resizer-dot-total-width:8px;--fc-event-resizer-dot-border-width:1px;--fc-non-business-color:hsla(0,0%,84%,.3);--fc-bg-event-color:#8fdf82;--fc-bg-event-opacity:0.3;--fc-highlight-color:rgba(188,232,241,.3);--fc-today-bg-color:rgba(255,220,40,.15);--fc-now-indicator-color:red}.fc-not-allowed,.fc-not-allowed .fc-event{cursor:not-allowed}.fc{display:flex;flex-direction:column;font-size:1em}.fc,.fc *,.fc :after,.fc :before{box-sizing:border-box}.fc table{border-collapse:collapse;border-spacing:0;font-size:1em}.fc th{text-align:center}.fc td,.fc th{padding:0;vertical-align:top}.fc a[data-navlink]{cursor:pointer}.fc a[data-navlink]:hover{text-decoration:underline}.fc-direction-ltr{direction:ltr;text-align:left}.fc-direction-rtl{direction:rtl;text-align:right}.fc-theme-standard td,.fc-theme-standard th{border:1px solid var(--fc-border-color)}.fc-liquid-hack td,.fc-liquid-hack th{position:relative}@font-face{font-family:fcicons;font-style:normal;font-weight:400;src:url("data:application/x-font-ttf;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg8SBfAAAAC8AAAAYGNtYXAXVtKNAAABHAAAAFRnYXNwAAAAEAAAAXAAAAAIZ2x5ZgYydxIAAAF4AAAFNGhlYWQUJ7cIAAAGrAAAADZoaGVhB20DzAAABuQAAAAkaG10eCIABhQAAAcIAAAALGxvY2ED4AU6AAAHNAAAABhtYXhwAA8AjAAAB0wAAAAgbmFtZXsr690AAAdsAAABhnBvc3QAAwAAAAAI9AAAACAAAwPAAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADpBgPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAOAAAAAoACAACAAIAAQAg6Qb//f//AAAAAAAg6QD//f//AAH/4xcEAAMAAQAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAABAWIAjQKeAskAEwAAJSc3NjQnJiIHAQYUFwEWMjc2NCcCnuLiDQ0MJAz/AA0NAQAMJAwNDcni4gwjDQwM/wANIwz/AA0NDCMNAAAAAQFiAI0CngLJABMAACUBNjQnASYiBwYUHwEHBhQXFjI3AZ4BAA0N/wAMJAwNDeLiDQ0MJAyNAQAMIw0BAAwMDSMM4uINIwwNDQAAAAIA4gC3Ax4CngATACcAACUnNzY0JyYiDwEGFB8BFjI3NjQnISc3NjQnJiIPAQYUHwEWMjc2NCcB87e3DQ0MIw3VDQ3VDSMMDQ0BK7e3DQ0MJAzVDQ3VDCQMDQ3zuLcMJAwNDdUNIwzWDAwNIwy4twwkDA0N1Q0jDNYMDA0jDAAAAgDiALcDHgKeABMAJwAAJTc2NC8BJiIHBhQfAQcGFBcWMjchNzY0LwEmIgcGFB8BBwYUFxYyNwJJ1Q0N1Q0jDA0Nt7cNDQwjDf7V1Q0N1QwkDA0Nt7cNDQwkDLfWDCMN1Q0NDCQMt7gMIw0MDNYMIw3VDQ0MJAy3uAwjDQwMAAADAFUAAAOrA1UAMwBoAHcAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMhMjY1NCYjISIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAAVYRGRkR/qoRGRkRA1UFBAUOCQkVDAsZDf2rDRkLDBUJCA4FBQUFBQUOCQgVDAsZDQJVDRkLDBUJCQ4FBAVVAgECBQMCBwQECAX9qwQJAwQHAwMFAQICAgIBBQMDBwQDCQQCVQUIBAQHAgMFAgEC/oAZEhEZGRESGQAAAAADAFUAAAOrA1UAMwBoAIkAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMzFRQWMzI2PQEzMjY1NCYrATU0JiMiBh0BIyIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAgBkSEhmAERkZEYAZEhIZgBEZGREDVQUEBQ4JCRUMCxkN/asNGQsMFQkIDgUFBQUFBQ4JCBUMCxkNAlUNGQsMFQkJDgUEBVUCAQIFAwIHBAQIBf2rBAkDBAcDAwUBAgICAgEFAwMHBAMJBAJVBQgEBAcCAwUCAQL+gIASGRkSgBkSERmAEhkZEoAZERIZAAABAOIAjQMeAskAIAAAExcHBhQXFjI/ARcWMjc2NC8BNzY0JyYiDwEnJiIHBhQX4uLiDQ0MJAzi4gwkDA0N4uINDQwkDOLiDCQMDQ0CjeLiDSMMDQ3h4Q0NDCMN4uIMIw0MDOLiDAwNIwwAAAABAAAAAQAAa5n0y18PPPUACwQAAAAAANivOVsAAAAA2K85WwAAAAADqwNVAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAOrAAEAAAAAAAAAAAAAAAAAAAALBAAAAAAAAAAAAAAAAgAAAAQAAWIEAAFiBAAA4gQAAOIEAABVBAAAVQQAAOIAAAAAAAoAFAAeAEQAagCqAOoBngJkApoAAQAAAAsAigADAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApGZjaWNvbnMAZgBjAGkAYwBvAG4Ac1ZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMGZjaWNvbnMAZgBjAGkAYwBvAG4Ac2ZjaWNvbnMAZgBjAGkAYwBvAG4Ac1JlZ3VsYXIAUgBlAGcAdQBsAGEAcmZjaWNvbnMAZgBjAGkAYwBvAG4Ac0ZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=") format("truetype")}.fc-icon{speak:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:inline-block;font-family:fcicons!important;font-style:normal;font-variant:normal;font-weight:400;height:1em;line-height:1;text-align:center;text-transform:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1em}.fc-icon-chevron-left:before{content:"\\e900"}.fc-icon-chevron-right:before{content:"\\e901"}.fc-icon-chevrons-left:before{content:"\\e902"}.fc-icon-chevrons-right:before{content:"\\e903"}.fc-icon-minus-square:before{content:"\\e904"}.fc-icon-plus-square:before{content:"\\e905"}.fc-icon-x:before{content:"\\e906"}.fc .fc-button{border-radius:0;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;overflow:visible;text-transform:none}.fc .fc-button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}.fc .fc-button{-webkit-appearance:button}.fc .fc-button:not(:disabled){cursor:pointer}.fc .fc-button{background-color:transparent;border:1px solid transparent;border-radius:.25em;display:inline-block;font-size:1em;font-weight:400;line-height:1.5;padding:.4em .65em;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle}.fc .fc-button:hover{text-decoration:none}.fc .fc-button:focus{box-shadow:0 0 0 .2rem rgba(44,62,80,.25);outline:0}.fc .fc-button:disabled{opacity:.65}.fc .fc-button-primary{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:hover{background-color:var(--fc-button-hover-bg-color);border-color:var(--fc-button-hover-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:disabled{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button-primary:not(:disabled).fc-button-active,.fc .fc-button-primary:not(:disabled):active{background-color:var(--fc-button-active-bg-color);border-color:var(--fc-button-active-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:not(:disabled).fc-button-active:focus,.fc .fc-button-primary:not(:disabled):active:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button .fc-icon{font-size:1.5em;vertical-align:middle}.fc .fc-button-group{display:inline-flex;position:relative;vertical-align:middle}.fc .fc-button-group>.fc-button{flex:1 1 auto;position:relative}.fc .fc-button-group>.fc-button.fc-button-active,.fc .fc-button-group>.fc-button:active,.fc .fc-button-group>.fc-button:focus,.fc .fc-button-group>.fc-button:hover{z-index:1}.fc-direction-ltr .fc-button-group>.fc-button:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0;margin-left:-1px}.fc-direction-ltr .fc-button-group>.fc-button:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0}.fc-direction-rtl .fc-button-group>.fc-button:not(:first-child){border-bottom-right-radius:0;border-top-right-radius:0;margin-right:-1px}.fc-direction-rtl .fc-button-group>.fc-button:not(:last-child){border-bottom-left-radius:0;border-top-left-radius:0}.fc .fc-toolbar{align-items:center;display:flex;justify-content:space-between}.fc .fc-toolbar.fc-header-toolbar{margin-bottom:1.5em}.fc .fc-toolbar.fc-footer-toolbar{margin-top:1.5em}.fc .fc-toolbar-title{font-size:1.75em;margin:0}.fc-direction-ltr .fc-toolbar>*>:not(:first-child){margin-left:.75em}.fc-direction-rtl .fc-toolbar>*>:not(:first-child){margin-right:.75em}.fc-direction-rtl .fc-toolbar-ltr{flex-direction:row-reverse}.fc .fc-scroller{-webkit-overflow-scrolling:touch;position:relative}.fc .fc-scroller-liquid{height:100%}.fc .fc-scroller-liquid-absolute{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-scroller-harness{direction:ltr;overflow:hidden;position:relative}.fc .fc-scroller-harness-liquid{height:100%}.fc-direction-rtl .fc-scroller-harness>.fc-scroller{direction:rtl}.fc-theme-standard .fc-scrollgrid{border:1px solid var(--fc-border-color)}.fc .fc-scrollgrid,.fc .fc-scrollgrid table{table-layout:fixed;width:100%}.fc .fc-scrollgrid table{border-left-style:hidden;border-right-style:hidden;border-top-style:hidden}.fc .fc-scrollgrid{border-bottom-width:0;border-collapse:separate;border-right-width:0}.fc .fc-scrollgrid-liquid{height:100%}.fc .fc-scrollgrid-section,.fc .fc-scrollgrid-section table,.fc .fc-scrollgrid-section>td{height:1px}.fc .fc-scrollgrid-section-liquid>td{height:100%}.fc .fc-scrollgrid-section>*{border-left-width:0;border-top-width:0}.fc .fc-scrollgrid-section-footer>*,.fc .fc-scrollgrid-section-header>*{border-bottom-width:0}.fc .fc-scrollgrid-section-body table,.fc .fc-scrollgrid-section-footer table{border-bottom-style:hidden}.fc .fc-scrollgrid-section-sticky>*{background:var(--fc-page-bg-color);position:sticky;z-index:3}.fc .fc-scrollgrid-section-header.fc-scrollgrid-section-sticky>*{top:0}.fc .fc-scrollgrid-section-footer.fc-scrollgrid-section-sticky>*{bottom:0}.fc .fc-scrollgrid-sticky-shim{height:1px;margin-bottom:-1px}.fc-sticky{position:sticky}.fc .fc-view-harness{flex-grow:1;position:relative}.fc .fc-view-harness-active>.fc-view{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-col-header-cell-cushion{display:inline-block;padding:2px 4px}.fc .fc-bg-event,.fc .fc-highlight,.fc .fc-non-business{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-non-business{background:var(--fc-non-business-color)}.fc .fc-bg-event{background:var(--fc-bg-event-color);opacity:var(--fc-bg-event-opacity)}.fc .fc-bg-event .fc-event-title{font-size:var(--fc-small-font-size);font-style:italic;margin:.5em}.fc .fc-highlight{background:var(--fc-highlight-color)}.fc .fc-cell-shaded,.fc .fc-day-disabled{background:var(--fc-neutral-bg-color)}a.fc-event,a.fc-event:hover{text-decoration:none}.fc-event.fc-event-draggable,.fc-event[href]{cursor:pointer}.fc-event .fc-event-main{position:relative;z-index:2}.fc-event-dragging:not(.fc-event-selected){opacity:.75}.fc-event-dragging.fc-event-selected{box-shadow:0 2px 7px rgba(0,0,0,.3)}.fc-event .fc-event-resizer{display:none;position:absolute;z-index:4}.fc-event-selected .fc-event-resizer,.fc-event:hover .fc-event-resizer{display:block}.fc-event-selected .fc-event-resizer{background:var(--fc-page-bg-color);border-color:inherit;border-radius:calc(var(--fc-event-resizer-dot-total-width)/2);border-style:solid;border-width:var(--fc-event-resizer-dot-border-width);height:var(--fc-event-resizer-dot-total-width);width:var(--fc-event-resizer-dot-total-width)}.fc-event-selected .fc-event-resizer:before{bottom:-20px;content:"";left:-20px;position:absolute;right:-20px;top:-20px}.fc-event-selected,.fc-event:focus{box-shadow:0 2px 5px rgba(0,0,0,.2)}.fc-event-selected:before,.fc-event:focus:before{bottom:0;content:"";left:0;position:absolute;right:0;top:0;z-index:3}.fc-event-selected:after,.fc-event:focus:after{background:var(--fc-event-selected-overlay-color);bottom:-1px;content:"";left:-1px;position:absolute;right:-1px;top:-1px;z-index:1}.fc-h-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-h-event .fc-event-main{color:var(--fc-event-text-color)}.fc-h-event .fc-event-main-frame{display:flex}.fc-h-event .fc-event-time{max-width:100%;overflow:hidden}.fc-h-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-width:0}.fc-h-event .fc-event-title{display:inline-block;left:0;max-width:100%;overflow:hidden;right:0;vertical-align:top}.fc-h-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-start),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-end){border-bottom-left-radius:0;border-left-width:0;border-top-left-radius:0}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-end),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-start){border-bottom-right-radius:0;border-right-width:0;border-top-right-radius:0}.fc-h-event:not(.fc-event-selected) .fc-event-resizer{bottom:0;top:0;width:var(--fc-event-resizer-thickness)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end{cursor:w-resize;left:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start{cursor:e-resize;right:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-h-event.fc-event-selected .fc-event-resizer{margin-top:calc(var(--fc-event-resizer-dot-total-width)*-.5);top:50%}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-start,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-end{left:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-end,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-start{right:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc .fc-popover{box-shadow:0 2px 6px rgba(0,0,0,.15);position:absolute;z-index:9999}.fc .fc-popover-header{align-items:center;display:flex;flex-direction:row;justify-content:space-between;padding:3px 4px}.fc .fc-popover-title{margin:0 2px}.fc .fc-popover-close{cursor:pointer;font-size:1.1em;opacity:.65}.fc-theme-standard .fc-popover{background:var(--fc-page-bg-color);border:1px solid var(--fc-border-color)}.fc-theme-standard .fc-popover-header{background:var(--fc-neutral-bg-color)}';Kc(H$);var Qa=class{constructor(e){this.drainedOption=e,this.isRunning=!1,this.isDirty=!1,this.pauseDepths={},this.timeoutId=0}request(e){this.isDirty=!0,this.isPaused()||(this.clearTimeout(),e==null?this.tryDrain():this.timeoutId=setTimeout(this.tryDrain.bind(this),e))}pause(e=""){let{pauseDepths:t}=this;t[e]=(t[e]||0)+1,this.clearTimeout()}resume(e="",t){let{pauseDepths:i}=this;e in i&&(t?delete i[e]:(i[e]-=1,i[e]<=0&&delete i[e]),this.tryDrain())}isPaused(){return Object.keys(this.pauseDepths).length}tryDrain(){if(!this.isRunning&&!this.isPaused()){for(this.isRunning=!0;this.isDirty;)this.isDirty=!1,this.drained();this.isRunning=!1}}clear(){this.clearTimeout(),this.isDirty=!1,this.pauseDepths={}}clearTimeout(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)}drained(){this.drainedOption&&this.drainedOption()}};function np(n){n.parentNode&&n.parentNode.removeChild(n)}function yn(n,e){if(n.closest)return n.closest(e);if(!document.documentElement.contains(n))return null;do{if(yx(n,e))return n;n=n.parentElement||n.parentNode}while(n!==null&&n.nodeType===1);return null}function yx(n,e){return(n.matches||n.matchesSelector||n.msMatchesSelector).call(n,e)}function Q2(n,e){let t=n instanceof HTMLElement?[n]:n,i=[];for(let r=0;r<t.length;r+=1){let o=t[r].querySelectorAll(e);for(let s=0;s<o.length;s+=1)i.push(o[s])}return i}var W$=/(top|left|right|bottom|width|height)$/i;function ll(n,e){for(let t in e)bx(n,t,e[t])}function bx(n,e,t){t==null?n.style[e]="":typeof t=="number"&&W$.test(e)?n.style[e]=`${t}px`:n.style[e]=t}function T_(n){var e,t;return(t=(e=n.composedPath)===null||e===void 0?void 0:e.call(n)[0])!==null&&t!==void 0?t:n.target}var k2=0;function cl(){return k2+=1,"fc-dom-"+k2}function ip(n){n.preventDefault()}function $$(n,e){return t=>{let i=yn(t.target,n);i&&e.call(i,t,i)}}function wx(n,e,t,i){let r=$$(t,i);return n.addEventListener(e,r),()=>{n.removeEventListener(e,r)}}function K2(n,e,t,i){let r;return wx(n,"mouseover",e,(o,s)=>{if(s!==r){r=s,t(o,s);let l=c=>{r=null,i(c,s),s.removeEventListener("mouseleave",l)};s.addEventListener("mouseleave",l)}})}var O2=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"];function Sx(n,e){let t=i=>{e(i),O2.forEach(r=>{n.removeEventListener(r,t)})};O2.forEach(i=>{n.addEventListener(i,t)})}function J2(n){return Object.assign({onClick:n},X2(n))}function X2(n){return{tabIndex:0,onKeyDown(e){(e.key==="Enter"||e.key===" ")&&(n(e),e.preventDefault())}}}var N2=0;function $o(){return N2+=1,String(N2)}function rp(){document.body.classList.add("fc-not-allowed")}function op(){document.body.classList.remove("fc-not-allowed")}function Cx(n){n.style.userSelect="none",n.style.webkitUserSelect="none",n.addEventListener("selectstart",ip)}function Ex(n){n.style.userSelect="",n.style.webkitUserSelect="",n.removeEventListener("selectstart",ip)}function xx(n){n.addEventListener("contextmenu",ip)}function Dx(n){n.removeEventListener("contextmenu",ip)}function eL(n){let e=[],t=[],i,r;for(typeof n=="string"?t=n.split(/\s*,\s*/):typeof n=="function"?t=[n]:Array.isArray(n)&&(t=n),i=0;i<t.length;i+=1)r=t[i],typeof r=="string"?e.push(r.charAt(0)==="-"?{field:r.substring(1),order:-1}:{field:r,order:1}):typeof r=="function"&&e.push({func:r});return e}function tL(n,e,t){let i,r;for(i=0;i<t.length;i+=1)if(r=q$(n,e,t[i]),r)return r;return 0}function q$(n,e,t){return t.func?t.func(n,e):nL(n[t.field],e[t.field])*(t.order||1)}function nL(n,e){return!n&&!e?0:e==null?-1:n==null?1:typeof n=="string"||typeof e=="string"?String(n).localeCompare(String(e)):n-e}function Ya(n,e){let t=String(n);return"000".substr(0,e-t.length)+t}function Jc(n,e,t){return typeof n=="function"?n(...e):typeof n=="string"?e.reduce((i,r,o)=>i.replace("$"+o,r||""),n):t}function Ix(n,e){return n-e}function Vf(n){return n%1===0}function G$(n){let e=n.querySelector(".fc-scrollgrid-shrink-frame"),t=n.querySelector(".fc-scrollgrid-shrink-cushion");if(!e)throw new Error("needs fc-scrollgrid-shrink-frame className");if(!t)throw new Error("needs fc-scrollgrid-shrink-cushion className");return n.getBoundingClientRect().width-e.getBoundingClientRect().width+t.getBoundingClientRect().width}var L2=["years","months","days","milliseconds"],Z$=/^(-?)(?:(\d+)\.)?(\d+):(\d\d)(?::(\d\d)(?:\.(\d\d\d))?)?/;function qe(n,e){return typeof n=="string"?Y$(n):typeof n=="object"&&n?F2(n):typeof n=="number"?F2({[e||"milliseconds"]:n}):null}function Y$(n){let e=Z$.exec(n);if(e){let t=e[1]?-1:1;return{years:0,months:0,days:t*(e[2]?parseInt(e[2],10):0),milliseconds:t*((e[3]?parseInt(e[3],10):0)*60*60*1e3+(e[4]?parseInt(e[4],10):0)*60*1e3+(e[5]?parseInt(e[5],10):0)*1e3+(e[6]?parseInt(e[6],10):0))}}return null}function F2(n){let e={years:n.years||n.year||0,months:n.months||n.month||0,days:n.days||n.day||0,milliseconds:(n.hours||n.hour||0)*60*60*1e3+(n.minutes||n.minute||0)*60*1e3+(n.seconds||n.second||0)*1e3+(n.milliseconds||n.millisecond||n.ms||0)},t=n.weeks||n.week;return t&&(e.days+=t*7,e.specifiedWeeks=!0),e}function Q$(n,e){return n.years===e.years&&n.months===e.months&&n.days===e.days&&n.milliseconds===e.milliseconds}function sp(n,e){return{years:n.years+e.years,months:n.months+e.months,days:n.days+e.days,milliseconds:n.milliseconds+e.milliseconds}}function iL(n,e){return{years:n.years-e.years,months:n.months-e.months,days:n.days-e.days,milliseconds:n.milliseconds-e.milliseconds}}function Mx(n,e){return{years:n.years*e,months:n.months*e,days:n.days*e,milliseconds:n.milliseconds*e}}function K$(n){return Yc(n)/365}function J$(n){return Yc(n)/30}function Yc(n){return Oi(n)/864e5}function Oi(n){return n.years*(365*864e5)+n.months*(30*864e5)+n.days*864e5+n.milliseconds}function ap(n,e){let t=null;for(let i=0;i<L2.length;i+=1){let r=L2[i];if(e[r]){let o=n[r]/e[r];if(!Vf(o)||t!==null&&t!==o)return null;t=o}else if(n[r])return null}return t}function jf(n){let e=n.milliseconds;if(e){if(e%1e3!==0)return{unit:"millisecond",value:e};if(e%(1e3*60)!==0)return{unit:"second",value:e/1e3};if(e%(1e3*60*60)!==0)return{unit:"minute",value:e/(1e3*60)};if(e)return{unit:"hour",value:e/(1e3*60*60)}}return n.days?n.specifiedWeeks&&n.days%7===0?{unit:"week",value:n.days/7}:{unit:"day",value:n.days}:n.months?{unit:"month",value:n.months}:n.years?{unit:"year",value:n.years}:{unit:"millisecond",value:0}}function ho(n,e,t){if(n===e)return!0;let i=n.length,r;if(i!==e.length)return!1;for(r=0;r<i;r+=1)if(!(t?t(n[r],e[r]):n[r]===e[r]))return!1;return!0}var X$=["sun","mon","tue","wed","thu","fri","sat"];function P_(n,e){let t=Ms(n);return t[2]+=e*7,Si(t)}function Kt(n,e){let t=Ms(n);return t[2]+=e,Si(t)}function fo(n,e){let t=Ms(n);return t[6]+=e,Si(t)}function Tx(n,e){return qo(n,e)/7}function qo(n,e){return(e.valueOf()-n.valueOf())/(1e3*60*60*24)}function e9(n,e){return(e.valueOf()-n.valueOf())/(1e3*60*60)}function t9(n,e){return(e.valueOf()-n.valueOf())/(1e3*60)}function n9(n,e){return(e.valueOf()-n.valueOf())/1e3}function rL(n,e){let t=lt(n),i=lt(e);return{years:0,months:0,days:Math.round(qo(t,i)),milliseconds:e.valueOf()-i.valueOf()-(n.valueOf()-t.valueOf())}}function oL(n,e){let t=Qc(n,e);return t!==null&&t%7===0?t/7:null}function Qc(n,e){return Ts(n)===Ts(e)?Math.round(qo(n,e)):null}function lt(n){return Si([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()])}function i9(n){return Si([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours()])}function r9(n){return Si([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes()])}function o9(n){return Si([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds()])}function s9(n,e,t){let i=n.getUTCFullYear(),r=XE(n,i,e,t);if(r<1)return XE(n,i-1,e,t);let o=XE(n,i+1,e,t);return o>=1?Math.min(r,o):r}function XE(n,e,t,i){let r=Si([e,0,1+a9(e,t,i)]),o=lt(n),s=Math.round(qo(r,o));return Math.floor(s/7)+1}function a9(n,e,t){let i=7+e-t;return-((7+Si([n,0,i]).getUTCDay()-e)%7)+i-1}function z2(n){return[n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()]}function V2(n){return new Date(n[0],n[1]||0,n[2]==null?1:n[2],n[3]||0,n[4]||0,n[5]||0)}function Ms(n){return[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds()]}function Si(n){return n.length===1&&(n=n.concat([0])),new Date(Date.UTC(...n))}function Px(n){return!isNaN(n.valueOf())}function Ts(n){return n.getUTCHours()*1e3*60*60+n.getUTCMinutes()*1e3*60+n.getUTCSeconds()*1e3+n.getUTCMilliseconds()}function A_(n,e,t=!1){let i=n.toISOString();return i=i.replace(".000",""),t&&(i=i.replace("T00:00:00Z","")),i.length>10&&(e==null?i=i.replace("Z",""):e!==0&&(i=i.replace("Z",kx(e,!0)))),i}function lp(n){return n.toISOString().replace(/T.*$/,"")}function Ax(n){return n.toISOString().match(/^\d{4}-\d{2}/)[0]}function Rx(n){return Ya(n.getUTCHours(),2)+":"+Ya(n.getUTCMinutes(),2)+":"+Ya(n.getUTCSeconds(),2)}function kx(n,e=!1){let t=n<0?"-":"+",i=Math.abs(n),r=Math.floor(i/60),o=Math.round(i%60);return e?`${t+Ya(r,2)}:${Ya(o,2)}`:`GMT${t}${r}${o?`:${Ya(o,2)}`:""}`}function ve(n,e,t){let i,r;return function(...o){if(!i)r=n.apply(this,o);else if(!ho(i,o)){t&&t(r);let s=n.apply(this,o);(!e||!e(s,r))&&(r=s)}return i=o,r}}function Xc(n,e,t){let i,r;return o=>{if(!i)r=n.call(this,o);else if(!Ci(i,o)){t&&t(r);let s=n.call(this,o);(!e||!e(s,r))&&(r=s)}return i=o,r}}var ex={week:3,separator:9,omitZeroMinute:9,meridiem:9,omitCommas:9},v_={timeZoneName:7,era:6,year:5,month:4,day:2,weekday:2,hour:1,minute:1,second:1},d_=/\s*([ap])\.?m\.?/i,l9=/,/g,c9=/\s+/g,d9=/\u200e/g,u9=/UTC|GMT/,cx=class{constructor(e){let t={},i={},r=9;for(let o in e)o in ex?(i[o]=e[o],ex[o]<9&&(r=Math.min(ex[o],r))):(t[o]=e[o],o in v_&&(r=Math.min(v_[o],r)));this.standardDateProps=t,this.extendedSettings=i,this.smallestUnitNum=r,this.buildFormattingFunc=ve(j2)}format(e,t){return this.buildFormattingFunc(this.standardDateProps,this.extendedSettings,t)(e)}formatRange(e,t,i,r){let{standardDateProps:o,extendedSettings:s}=this,l=v9(e.marker,t.marker,i.calendarSystem);if(!l)return this.format(e,i);let c=l;c>1&&(o.year==="numeric"||o.year==="2-digit")&&(o.month==="numeric"||o.month==="2-digit")&&(o.day==="numeric"||o.day==="2-digit")&&(c=1);let u=this.format(e,i),f=this.format(t,i);if(u===f)return u;let m=_9(o,c),w=j2(m,s,i),b=w(e),D=w(t),T=y9(u,b,f,D),M=s.separator||r||i.defaultSeparator||"";return T?T.before+b+M+D+T.after:u+M+f}getSmallestUnit(){switch(this.smallestUnitNum){case 7:case 6:case 5:return"year";case 4:return"month";case 3:return"week";case 2:return"day";default:return"time"}}};function j2(n,e,t){let i=Object.keys(n).length;return i===1&&n.timeZoneName==="short"?r=>kx(r.timeZoneOffset):i===0&&e.week?r=>m9(t.computeWeekNumber(r.marker),t.weekText,t.weekTextLong,t.locale,e.week):f9(n,e,t)}function f9(n,e,t){n=Object.assign({},n),e=Object.assign({},e),p9(n,e),n.timeZone="UTC";let i=new Intl.DateTimeFormat(t.locale.codes,n),r;if(e.omitZeroMinute){let o=Object.assign({},n);delete o.minute,r=new Intl.DateTimeFormat(t.locale.codes,o)}return o=>{let{marker:s}=o,l;r&&!s.getUTCMinutes()?l=r:l=i;let c=l.format(s);return h9(c,o,n,e,t)}}function p9(n,e){n.timeZoneName&&(n.hour||(n.hour="2-digit"),n.minute||(n.minute="2-digit")),n.timeZoneName==="long"&&(n.timeZoneName="short"),e.omitZeroMinute&&(n.second||n.millisecond)&&delete e.omitZeroMinute}function h9(n,e,t,i,r){return n=n.replace(d9,""),t.timeZoneName==="short"&&(n=g9(n,r.timeZone==="UTC"||e.timeZoneOffset==null?"UTC":kx(e.timeZoneOffset))),i.omitCommas&&(n=n.replace(l9,"").trim()),i.omitZeroMinute&&(n=n.replace(":00","")),i.meridiem===!1?n=n.replace(d_,"").trim():i.meridiem==="narrow"?n=n.replace(d_,(o,s)=>s.toLocaleLowerCase()):i.meridiem==="short"?n=n.replace(d_,(o,s)=>`${s.toLocaleLowerCase()}m`):i.meridiem==="lowercase"&&(n=n.replace(d_,o=>o.toLocaleLowerCase())),n=n.replace(c9," "),n=n.trim(),n}function g9(n,e){let t=!1;return n=n.replace(u9,()=>(t=!0,e)),t||(n+=` ${e}`),n}function m9(n,e,t,i,r){let o=[];return r==="long"?o.push(t):(r==="short"||r==="narrow")&&o.push(e),(r==="long"||r==="short")&&o.push(" "),o.push(i.simpleNumberFormat.format(n)),i.options.direction==="rtl"&&o.reverse(),o.join("")}function v9(n,e,t){return t.getMarkerYear(n)!==t.getMarkerYear(e)?5:t.getMarkerMonth(n)!==t.getMarkerMonth(e)?4:t.getMarkerDay(n)!==t.getMarkerDay(e)?2:Ts(n)!==Ts(e)?1:0}function _9(n,e){let t={};for(let i in n)(!(i in v_)||v_[i]<=e)&&(t[i]=n[i]);return t}function y9(n,e,t,i){let r=0;for(;r<n.length;){let o=n.indexOf(e,r);if(o===-1)break;let s=n.substr(0,o);r=o+e.length;let l=n.substr(r),c=0;for(;c<t.length;){let u=t.indexOf(i,c);if(u===-1)break;let f=t.substr(0,u);c=u+i.length;let m=t.substr(c);if(s===f&&l===m)return{before:s,after:l}}}return null}function B2(n,e){let t=e.markerToArray(n.marker);return{marker:n.marker,timeZoneOffset:n.timeZoneOffset,array:t,year:t[0],month:t[1],day:t[2],hour:t[3],minute:t[4],second:t[5],millisecond:t[6]}}function __(n,e,t,i){let r=B2(n,t.calendarSystem),o=e?B2(e,t.calendarSystem):null;return{date:r,start:r,end:o,timeZone:t.timeZone,localeCodes:t.locale.codes,defaultSeparator:i||t.defaultSeparator}}var dx=class{constructor(e){this.cmdStr=e}format(e,t,i){return t.cmdFormatter(this.cmdStr,__(e,null,t,i))}formatRange(e,t,i,r){return i.cmdFormatter(this.cmdStr,__(e,t,i,r))}},ux=class{constructor(e){this.func=e}format(e,t,i){return this.func(__(e,null,t,i))}formatRange(e,t,i,r){return this.func(__(e,t,i,r))}};function wt(n){return typeof n=="object"&&n?new cx(n):typeof n=="string"?new dx(n):typeof n=="function"?new ux(n):null}var Ox={navLinkDayClick:H,navLinkWeekClick:H,duration:qe,bootstrapFontAwesome:H,buttonIcons:H,customButtons:H,defaultAllDayEventDuration:qe,defaultTimedEventDuration:qe,nextDayThreshold:qe,scrollTime:qe,scrollTimeReset:Boolean,slotMinTime:qe,slotMaxTime:qe,dayPopoverFormat:wt,slotDuration:qe,snapDuration:qe,headerToolbar:H,footerToolbar:H,defaultRangeSeparator:String,titleRangeSeparator:String,forceEventDuration:Boolean,dayHeaders:Boolean,dayHeaderFormat:wt,dayHeaderClassNames:H,dayHeaderContent:H,dayHeaderDidMount:H,dayHeaderWillUnmount:H,dayCellClassNames:H,dayCellContent:H,dayCellDidMount:H,dayCellWillUnmount:H,initialView:String,aspectRatio:Number,weekends:Boolean,weekNumberCalculation:H,weekNumbers:Boolean,weekNumberClassNames:H,weekNumberContent:H,weekNumberDidMount:H,weekNumberWillUnmount:H,editable:Boolean,viewClassNames:H,viewDidMount:H,viewWillUnmount:H,nowIndicator:Boolean,nowIndicatorSnap:H,nowIndicatorClassNames:H,nowIndicatorContent:H,nowIndicatorDidMount:H,nowIndicatorWillUnmount:H,showNonCurrentDates:Boolean,lazyFetching:Boolean,startParam:String,endParam:String,timeZoneParam:String,timeZone:String,locales:H,locale:H,themeSystem:String,dragRevertDuration:Number,dragScroll:Boolean,allDayMaintainDuration:Boolean,unselectAuto:Boolean,dropAccept:H,eventOrder:eL,eventOrderStrict:Boolean,handleWindowResize:Boolean,windowResizeDelay:Number,longPressDelay:Number,eventDragMinDistance:Number,expandRows:Boolean,height:H,contentHeight:H,direction:String,weekNumberFormat:wt,eventResizableFromStart:Boolean,displayEventTime:Boolean,displayEventEnd:Boolean,weekText:String,weekTextLong:String,progressiveEventRendering:Boolean,businessHours:H,initialDate:H,now:H,eventDataTransform:H,stickyHeaderDates:H,stickyFooterScrollbar:H,viewHeight:H,defaultAllDay:Boolean,eventSourceFailure:H,eventSourceSuccess:H,eventDisplay:String,eventStartEditable:Boolean,eventDurationEditable:Boolean,eventOverlap:H,eventConstraint:H,eventAllow:H,eventBackgroundColor:String,eventBorderColor:String,eventTextColor:String,eventColor:String,eventClassNames:H,eventContent:H,eventDidMount:H,eventWillUnmount:H,selectConstraint:H,selectOverlap:H,selectAllow:H,droppable:Boolean,unselectCancel:String,slotLabelFormat:H,slotLaneClassNames:H,slotLaneContent:H,slotLaneDidMount:H,slotLaneWillUnmount:H,slotLabelClassNames:H,slotLabelContent:H,slotLabelDidMount:H,slotLabelWillUnmount:H,dayMaxEvents:H,dayMaxEventRows:H,dayMinWidth:Number,slotLabelInterval:qe,allDayText:String,allDayClassNames:H,allDayContent:H,allDayDidMount:H,allDayWillUnmount:H,slotMinWidth:Number,navLinks:Boolean,eventTimeFormat:wt,rerenderDelay:Number,moreLinkText:H,moreLinkHint:H,selectMinDistance:Number,selectable:Boolean,selectLongPressDelay:Number,eventLongPressDelay:Number,selectMirror:Boolean,eventMaxStack:Number,eventMinHeight:Number,eventMinWidth:Number,eventShortHeight:Number,slotEventOverlap:Boolean,plugins:H,firstDay:Number,dayCount:Number,dateAlignment:String,dateIncrement:qe,hiddenDays:H,fixedWeekCount:Boolean,validRange:H,visibleRange:H,titleFormat:H,eventInteractive:Boolean,noEventsText:String,viewHint:H,navLinkHint:H,closeHint:String,timeHint:String,eventHint:String,moreLinkClick:H,moreLinkClassNames:H,moreLinkContent:H,moreLinkDidMount:H,moreLinkWillUnmount:H,monthStartFormat:wt,handleCustomRendering:H,customRenderingMetaMap:H,customRenderingReplaces:Boolean},Os={eventDisplay:"auto",defaultRangeSeparator:" - ",titleRangeSeparator:" \u2013 ",defaultTimedEventDuration:"01:00:00",defaultAllDayEventDuration:{day:1},forceEventDuration:!1,nextDayThreshold:"00:00:00",dayHeaders:!0,initialView:"",aspectRatio:1.35,headerToolbar:{start:"title",center:"",end:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"local",editable:!1,nowIndicator:!1,scrollTime:"06:00:00",scrollTimeReset:!0,slotMinTime:"00:00:00",slotMaxTime:"24:00:00",showNonCurrentDates:!0,lazyFetching:!0,startParam:"start",endParam:"end",timeZoneParam:"timeZone",timeZone:"local",locales:[],locale:"",themeSystem:"standard",dragRevertDuration:500,dragScroll:!0,allDayMaintainDuration:!1,unselectAuto:!0,dropAccept:"*",eventOrder:"start,-duration,allDay,title",dayPopoverFormat:{month:"long",day:"numeric",year:"numeric"},handleWindowResize:!0,windowResizeDelay:100,longPressDelay:1e3,eventDragMinDistance:5,expandRows:!1,navLinks:!1,selectable:!1,eventMinHeight:15,eventMinWidth:30,eventShortHeight:30,monthStartFormat:{month:"long",day:"numeric"},nowIndicatorSnap:"auto"},Nx={datesSet:H,eventsSet:H,eventAdd:H,eventChange:H,eventRemove:H,windowResize:H,eventClick:H,eventMouseEnter:H,eventMouseLeave:H,select:H,unselect:H,loading:H,_unmount:H,_beforeprint:H,_afterprint:H,_noEventDrop:H,_noEventResize:H,_resize:H,_scrollRequest:H},Lx={buttonText:H,buttonHints:H,views:H,plugins:H,initialEvents:H,events:H,eventSources:H},Ns={headerToolbar:Za,footerToolbar:Za,buttonText:Za,buttonHints:Za,buttonIcons:Za,dateIncrement:Za,plugins:u_,events:u_,eventSources:u_,resources:u_};function Za(n,e){return typeof n=="object"&&typeof e=="object"&&n&&e?Ci(n,e):n===e}function u_(n,e){return Array.isArray(n)&&Array.isArray(e)?ho(n,e):n===e}var sL={type:String,component:H,buttonText:String,buttonTextKey:String,dateProfileGeneratorClass:H,usesMinMaxTime:Boolean,classNames:H,content:H,didMount:H,willUnmount:H};function R_(n){return O_(n,Ns)}function k_(n,e){let t={},i={};for(let r in e)r in n&&(t[r]=e[r](n[r]));for(let r in n)r in e||(i[r]=n[r]);return{refined:t,extra:i}}function H(n){return n}var{hasOwnProperty:y_}=Object.prototype;function O_(n,e){let t={};if(e){for(let i in e)if(e[i]===Za){let r=[];for(let o=n.length-1;o>=0;o-=1){let s=n[o][i];if(typeof s=="object"&&s)r.unshift(s);else if(s!==void 0){t[i]=s;break}}r.length&&(t[i]=O_(r))}}for(let i=n.length-1;i>=0;i-=1){let r=n[i];for(let o in r)o in t||(t[o]=r[o])}return t}function Bo(n,e){let t={};for(let i in n)e(n[i],i)&&(t[i]=n[i]);return t}function er(n,e){let t={};for(let i in n)t[i]=e(n[i],i);return t}function Fx(n){let e={};for(let t of n)e[t]=!0;return e}function N_(n){let e=[];for(let t in n)e.push(n[t]);return e}function Ci(n,e){if(n===e)return!0;for(let t in n)if(y_.call(n,t)&&!(t in e))return!1;for(let t in e)if(y_.call(e,t)&&n[t]!==e[t])return!1;return!0}var b9=/^on[A-Z]/;function w9(n,e){let t=S9(n,e);for(let i of t)if(!b9.test(i))return!1;return!0}function S9(n,e){let t=[];for(let i in n)y_.call(n,i)&&(i in e||t.push(i));for(let i in e)y_.call(e,i)&&n[i]!==e[i]&&t.push(i);return t}function g_(n,e,t={}){if(n===e)return!0;for(let i in e)if(!(i in n&&C9(n[i],e[i],t[i])))return!1;for(let i in n)if(!(i in e))return!1;return!0}function C9(n,e,t){return n===e||t===!0?!0:t?t(n,e):!1}function aL(n,e=0,t,i=1){let r=[];t==null&&(t=Object.keys(n).length);for(let o=e;o<t;o+=i){let s=n[o];s!==void 0&&r.push(s)}return r}var lL={};function E9(n,e){lL[n]=e}function x9(n){return new lL[n]}var fx=class{getMarkerYear(e){return e.getUTCFullYear()}getMarkerMonth(e){return e.getUTCMonth()}getMarkerDay(e){return e.getUTCDate()}arrayToMarker(e){return Si(e)}markerToArray(e){return Ms(e)}};E9("gregory",fx);var D9=/^\s*(\d{4})(-?(\d{2})(-?(\d{2})([T ](\d{2}):?(\d{2})(:?(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/;function cL(n){let e=D9.exec(n);if(e){let t=new Date(Date.UTC(Number(e[1]),e[3]?Number(e[3])-1:0,Number(e[5]||1),Number(e[7]||0),Number(e[8]||0),Number(e[10]||0),e[12]?+`0.${e[12]}`*1e3:0));if(Px(t)){let i=null;return e[13]&&(i=(e[15]==="-"?-1:1)*(Number(e[16]||0)*60+Number(e[18]||0))),{marker:t,isTimeUnspecified:!e[6],timeZoneOffset:i}}}return null}var Bf=class{constructor(e){let t=this.timeZone=e.timeZone,i=t!=="local"&&t!=="UTC";e.namedTimeZoneImpl&&i&&(this.namedTimeZoneImpl=new e.namedTimeZoneImpl(t)),this.canComputeOffset=!!(!i||this.namedTimeZoneImpl),this.calendarSystem=x9(e.calendarSystem),this.locale=e.locale,this.weekDow=e.locale.week.dow,this.weekDoy=e.locale.week.doy,e.weekNumberCalculation==="ISO"&&(this.weekDow=1,this.weekDoy=4),typeof e.firstDay=="number"&&(this.weekDow=e.firstDay),typeof e.weekNumberCalculation=="function"&&(this.weekNumberFunc=e.weekNumberCalculation),this.weekText=e.weekText!=null?e.weekText:e.locale.options.weekText,this.weekTextLong=(e.weekTextLong!=null?e.weekTextLong:e.locale.options.weekTextLong)||this.weekText,this.cmdFormatter=e.cmdFormatter,this.defaultSeparator=e.defaultSeparator}createMarker(e){let t=this.createMarkerMeta(e);return t===null?null:t.marker}createNowMarker(){return this.canComputeOffset?this.timestampToMarker(new Date().valueOf()):Si(z2(new Date))}createMarkerMeta(e){if(typeof e=="string")return this.parse(e);let t=null;return typeof e=="number"?t=this.timestampToMarker(e):e instanceof Date?(e=e.valueOf(),isNaN(e)||(t=this.timestampToMarker(e))):Array.isArray(e)&&(t=Si(e)),t===null||!Px(t)?null:{marker:t,isTimeUnspecified:!1,forcedTzo:null}}parse(e){let t=cL(e);if(t===null)return null;let{marker:i}=t,r=null;return t.timeZoneOffset!==null&&(this.canComputeOffset?i=this.timestampToMarker(i.valueOf()-t.timeZoneOffset*60*1e3):r=t.timeZoneOffset),{marker:i,isTimeUnspecified:t.isTimeUnspecified,forcedTzo:r}}getYear(e){return this.calendarSystem.getMarkerYear(e)}getMonth(e){return this.calendarSystem.getMarkerMonth(e)}getDay(e){return this.calendarSystem.getMarkerDay(e)}add(e,t){let i=this.calendarSystem.markerToArray(e);return i[0]+=t.years,i[1]+=t.months,i[2]+=t.days,i[6]+=t.milliseconds,this.calendarSystem.arrayToMarker(i)}subtract(e,t){let i=this.calendarSystem.markerToArray(e);return i[0]-=t.years,i[1]-=t.months,i[2]-=t.days,i[6]-=t.milliseconds,this.calendarSystem.arrayToMarker(i)}addYears(e,t){let i=this.calendarSystem.markerToArray(e);return i[0]+=t,this.calendarSystem.arrayToMarker(i)}addMonths(e,t){let i=this.calendarSystem.markerToArray(e);return i[1]+=t,this.calendarSystem.arrayToMarker(i)}diffWholeYears(e,t){let{calendarSystem:i}=this;return Ts(e)===Ts(t)&&i.getMarkerDay(e)===i.getMarkerDay(t)&&i.getMarkerMonth(e)===i.getMarkerMonth(t)?i.getMarkerYear(t)-i.getMarkerYear(e):null}diffWholeMonths(e,t){let{calendarSystem:i}=this;return Ts(e)===Ts(t)&&i.getMarkerDay(e)===i.getMarkerDay(t)?i.getMarkerMonth(t)-i.getMarkerMonth(e)+(i.getMarkerYear(t)-i.getMarkerYear(e))*12:null}greatestWholeUnit(e,t){let i=this.diffWholeYears(e,t);return i!==null?{unit:"year",value:i}:(i=this.diffWholeMonths(e,t),i!==null?{unit:"month",value:i}:(i=oL(e,t),i!==null?{unit:"week",value:i}:(i=Qc(e,t),i!==null?{unit:"day",value:i}:(i=e9(e,t),Vf(i)?{unit:"hour",value:i}:(i=t9(e,t),Vf(i)?{unit:"minute",value:i}:(i=n9(e,t),Vf(i)?{unit:"second",value:i}:{unit:"millisecond",value:t.valueOf()-e.valueOf()}))))))}countDurationsBetween(e,t,i){let r;return i.years&&(r=this.diffWholeYears(e,t),r!==null)?r/K$(i):i.months&&(r=this.diffWholeMonths(e,t),r!==null)?r/J$(i):i.days&&(r=Qc(e,t),r!==null)?r/Yc(i):(t.valueOf()-e.valueOf())/Oi(i)}startOf(e,t){return t==="year"?this.startOfYear(e):t==="month"?this.startOfMonth(e):t==="week"?this.startOfWeek(e):t==="day"?lt(e):t==="hour"?i9(e):t==="minute"?r9(e):t==="second"?o9(e):null}startOfYear(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e)])}startOfMonth(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e)])}startOfWeek(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e),e.getUTCDate()-(e.getUTCDay()-this.weekDow+7)%7])}computeWeekNumber(e){return this.weekNumberFunc?this.weekNumberFunc(this.toDate(e)):s9(e,this.weekDow,this.weekDoy)}format(e,t,i={}){return t.format({marker:e,timeZoneOffset:i.forcedTzo!=null?i.forcedTzo:this.offsetForMarker(e)},this)}formatRange(e,t,i,r={}){return r.isEndExclusive&&(t=fo(t,-1)),i.formatRange({marker:e,timeZoneOffset:r.forcedStartTzo!=null?r.forcedStartTzo:this.offsetForMarker(e)},{marker:t,timeZoneOffset:r.forcedEndTzo!=null?r.forcedEndTzo:this.offsetForMarker(t)},this,r.defaultSeparator)}formatIso(e,t={}){let i=null;return t.omitTimeZoneOffset||(t.forcedTzo!=null?i=t.forcedTzo:i=this.offsetForMarker(e)),A_(e,i,t.omitTime)}timestampToMarker(e){return this.timeZone==="local"?Si(z2(new Date(e))):this.timeZone==="UTC"||!this.namedTimeZoneImpl?new Date(e):Si(this.namedTimeZoneImpl.timestampToArray(e))}offsetForMarker(e){return this.timeZone==="local"?-V2(Ms(e)).getTimezoneOffset():this.timeZone==="UTC"?0:this.namedTimeZoneImpl?this.namedTimeZoneImpl.offsetForArray(Ms(e)):null}toDate(e,t){return this.timeZone==="local"?V2(Ms(e)):this.timeZone==="UTC"?new Date(e.valueOf()):this.namedTimeZoneImpl?new Date(e.valueOf()-this.namedTimeZoneImpl.offsetForArray(Ms(e))*1e3*60):new Date(e.valueOf()-(t||0))}},Uo=class{constructor(e){this.iconOverrideOption&&this.setIconOverride(e[this.iconOverrideOption])}setIconOverride(e){let t,i;if(typeof e=="object"&&e){t=Object.assign({},this.iconClasses);for(i in e)t[i]=this.applyIconOverridePrefix(e[i]);this.iconClasses=t}else e===!1&&(this.iconClasses={})}applyIconOverridePrefix(e){let t=this.iconOverridePrefix;return t&&e.indexOf(t)!==0&&(e=t+e),e}getClass(e){return this.classes[e]||""}getIconClass(e,t){let i;return t&&this.rtlIconClasses?i=this.rtlIconClasses[e]||this.iconClasses[e]:i=this.iconClasses[e],i?`${this.baseIconClass} ${i}`:""}getCustomButtonIconClass(e){let t;return this.iconOverrideCustomButtonOption&&(t=e[this.iconOverrideCustomButtonOption],t)?`${this.baseIconClass} ${this.applyIconOverridePrefix(t)}`:""}};Uo.prototype.classes={};Uo.prototype.iconClasses={};Uo.prototype.baseIconClass="";Uo.prototype.iconOverridePrefix="";function Uf(n){n();let e=me.debounceRendering,t=[];function i(r){t.push(r)}for(me.debounceRendering=i,Ds(k(px,{}),document.createElement("div"));t.length;)t.shift()();me.debounceRendering=e}var px=class extends Fn{render(){return k("div",{})}componentDidMount(){this.setState({})}};function dL(n){let e=a_(n),t=e.Provider;return e.Provider=function(){let i=!this.getChildContext,r=t.apply(this,arguments);if(i){let o=[];this.shouldComponentUpdate=s=>{this.props.value!==s.value&&o.forEach(l=>{l.context=s.value,l.forceUpdate()})},this.sub=s=>{o.push(s);let l=s.componentWillUnmount;s.componentWillUnmount=()=>{o.splice(o.indexOf(s),1),l&&l.call(s)}}}return r},e}var b_=class{constructor(e,t,i,r){this.execFunc=e,this.emitter=t,this.scrollTime=i,this.scrollTimeReset=r,this.handleScrollRequest=o=>{this.queuedRequest=Object.assign({},this.queuedRequest||{},o),this.drain()},t.on("_scrollRequest",this.handleScrollRequest),this.fireInitialScroll()}detach(){this.emitter.off("_scrollRequest",this.handleScrollRequest)}update(e){e&&this.scrollTimeReset?this.fireInitialScroll():this.drain()}fireInitialScroll(){this.handleScrollRequest({time:this.scrollTime})}drain(){this.queuedRequest&&this.execFunc(this.queuedRequest)&&(this.queuedRequest=null)}},tr=dL({});function uL(n,e,t,i,r,o,s,l,c,u,f,m,w,b){return{dateEnv:r,nowManager:o,options:t,pluginHooks:l,emitter:f,dispatch:c,getCurrentData:u,calendarApi:m,viewSpec:n,viewApi:e,dateProfileGenerator:i,theme:s,isRtl:t.direction==="rtl",addResizeHandler(D){f.on("_resize",D)},removeResizeHandler(D){f.off("_resize",D)},createScrollResponder(D){return new b_(D,f,qe(t.scrollTime),t.scrollTimeReset)},registerInteractiveComponent:w,unregisterInteractiveComponent:b}}var cp=(()=>{class n extends Fn{shouldComponentUpdate(t,i){return!g_(this.props,t,this.propEquality)||!g_(this.state,i,this.stateEquality)}safeSetState(t){g_(this.state,Object.assign(Object.assign({},this.state),t),this.stateEquality)||this.setState(t)}}return n.addPropsEquality=I9,n.addStateEquality=M9,n.contextType=tr,n})();cp.prototype.propEquality={};cp.prototype.stateEquality={};var Ke=(()=>{class n extends cp{}return n.contextType=tr,n})();function I9(n){let e=Object.create(this.prototype.propEquality);Object.assign(e,n),this.prototype.propEquality=e}function M9(n){let e=Object.create(this.prototype.stateEquality);Object.assign(e,n),this.prototype.stateEquality=e}function Ni(n,e){typeof n=="function"?n(e):n&&(n.current=e)}var Hf=class extends Ke{constructor(){super(...arguments),this.id=$o(),this.queuedDomNodes=[],this.currentDomNodes=[],this.handleEl=e=>{let{options:t}=this.context,{generatorName:i}=this.props;(!t.customRenderingReplaces||!hx(i,t))&&this.updateElRef(e)},this.updateElRef=e=>{this.props.elRef&&Ni(this.props.elRef,e)}}render(){let{props:e,context:t}=this,{options:i}=t,{customGenerator:r,defaultGenerator:o,renderProps:s}=e,l=zx(e,[],this.handleEl),c=!1,u,f=[],m;if(r!=null){let w=typeof r=="function"?r(s,k):r;if(w===!0)c=!0;else{let b=w&&typeof w=="object";b&&"html"in w?l.dangerouslySetInnerHTML={__html:w.html}:b&&"domNodes"in w?f=Array.prototype.slice.call(w.domNodes):(b?qE(w):typeof w!="function")?u=w:m=w}}else c=!hx(e.generatorName,i);return c&&o&&(u=o(s)),this.queuedDomNodes=f,this.currentGeneratorMeta=m,k(e.elTag,l,u)}componentDidMount(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentDidUpdate(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentWillUnmount(){this.triggerCustomRendering(!1)}triggerCustomRendering(e){var t;let{props:i,context:r}=this,{handleCustomRendering:o,customRenderingMetaMap:s}=r.options;if(o){let l=(t=this.currentGeneratorMeta)!==null&&t!==void 0?t:s?.[i.generatorName];l&&o(Object.assign(Object.assign({id:this.id,isActive:e,containerEl:this.base,reportNewContainerEl:this.updateElRef,generatorMeta:l},i),{elClasses:(i.elClasses||[]).filter(T9)}))}}applyQueueudDomNodes(){let{queuedDomNodes:e,currentDomNodes:t}=this,i=this.base;if(!ho(e,t)){t.forEach(np);for(let r of e)i.appendChild(r);this.currentDomNodes=e}}};Hf.addPropsEquality({elClasses:ho,elStyle:Ci,elAttrs:w9,renderProps:Ci});function hx(n,e){var t;return!!(e.handleCustomRendering&&n&&(!((t=e.customRenderingMetaMap)===null||t===void 0)&&t[n]))}function zx(n,e,t){let i=Object.assign(Object.assign({},n.elAttrs),{ref:t});return(n.elClasses||e)&&(i.className=(n.elClasses||[]).concat(e||[]).concat(i.className||[]).filter(Boolean).join(" ")),n.elStyle&&(i.style=n.elStyle),i}function T9(n){return!!n}var Vx=dL(0),ci=(()=>{class n extends Fn{constructor(){super(...arguments),this.InnerContent=P9.bind(void 0,this),this.handleEl=t=>{this.el=t,this.props.elRef&&(Ni(this.props.elRef,t),t&&this.didMountMisfire&&this.componentDidMount())}}render(){let{props:t}=this,i=A9(t.classNameGenerator,t.renderProps);if(t.children){let r=zx(t,i,this.handleEl),o=t.children(this.InnerContent,t.renderProps,r);return t.elTag?k(t.elTag,r,o):o}else return k(Hf,Object.assign(Object.assign({},t),{elRef:this.handleEl,elTag:t.elTag||"div",elClasses:(t.elClasses||[]).concat(i),renderId:this.context}))}componentDidMount(){var t,i;this.el?(i=(t=this.props).didMount)===null||i===void 0||i.call(t,Object.assign(Object.assign({},this.props.renderProps),{el:this.el})):this.didMountMisfire=!0}componentWillUnmount(){var t,i;(i=(t=this.props).willUnmount)===null||i===void 0||i.call(t,Object.assign(Object.assign({},this.props.renderProps),{el:this.el}))}}return n.contextType=Vx,n})();function P9(n,e){let t=n.props;return k(Hf,Object.assign({renderProps:t.renderProps,generatorName:t.generatorName,customGenerator:t.customGenerator,defaultGenerator:t.defaultGenerator,renderId:n.context},e))}function A9(n,e){let t=typeof n=="function"?n(e):n||[];return typeof t=="string"?[t]:t}var Ho=class extends Ke{render(){let{props:e,context:t}=this,{options:i}=t,r={view:t.viewApi};return k(ci,{elRef:e.elRef,elTag:e.elTag||"div",elAttrs:e.elAttrs,elClasses:[...jx(e.viewSpec),...e.elClasses||[]],elStyle:e.elStyle,renderProps:r,classNameGenerator:i.viewClassNames,generatorName:void 0,didMount:i.viewDidMount,willUnmount:i.viewWillUnmount},()=>e.children)}};function jx(n){return[`fc-${n.type}-view`,"fc-view"]}function R9(n,e){let t=null,i=null;return n.start&&(t=e.createMarker(n.start)),n.end&&(i=e.createMarker(n.end)),!t&&!i||t&&i&&i<t?null:{start:t,end:i}}function U2(n,e){let t=[],{start:i}=e,r,o;for(n.sort(k9),r=0;r<n.length;r+=1)o=n[r],o.start>i&&t.push({start:i,end:o.start}),o.end>i&&(i=o.end);return i<e.end&&t.push({start:i,end:e.end}),t}function k9(n,e){return n.start.valueOf()-e.start.valueOf()}function Pr(n,e){let{start:t,end:i}=n,r=null;return e.start!==null&&(t===null?t=e.start:t=new Date(Math.max(t.valueOf(),e.start.valueOf()))),e.end!=null&&(i===null?i=e.end:i=new Date(Math.min(i.valueOf(),e.end.valueOf()))),(t===null||i===null||t<i)&&(r={start:t,end:i}),r}function fL(n,e){return(n.start===null?null:n.start.valueOf())===(e.start===null?null:e.start.valueOf())&&(n.end===null?null:n.end.valueOf())===(e.end===null?null:e.end.valueOf())}function L_(n,e){return(n.end===null||e.start===null||n.end>e.start)&&(n.start===null||e.end===null||n.start<e.end)}function ed(n,e){return(n.start===null||e.start!==null&&e.start>=n.start)&&(n.end===null||e.end!==null&&e.end<=n.end)}function Xi(n,e){return(n.start===null||e>=n.start)&&(n.end===null||e<n.end)}function O9(n,e){return e.start!=null&&n<e.start?e.start:e.end!=null&&n>=e.end?new Date(e.end.valueOf()-1):n}function pL(n){let e=Math.floor(qo(n.start,n.end))||1,t=lt(n.start),i=Kt(t,e);return{start:t,end:i}}function Bx(n,e=qe(0)){let t=null,i=null;if(n.end){i=lt(n.end);let r=n.end.valueOf()-i.valueOf();r&&r>=Oi(e)&&(i=Kt(i,1))}return n.start&&(t=lt(n.start),i&&i<=t&&(i=Kt(t,1))),{start:t,end:i}}function Ps(n,e,t,i){return i==="year"?qe(t.diffWholeYears(n,e),"year"):i==="month"?qe(t.diffWholeMonths(n,e),"month"):rL(n,e)}var Ka=class{constructor(e){this.props=e,this.initHiddenDays()}buildPrev(e,t,i){let{dateEnv:r}=this.props,o=r.subtract(r.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(o,-1,i)}buildNext(e,t,i){let{dateEnv:r}=this.props,o=r.add(r.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(o,1,i)}build(e,t,i=!0){let{props:r}=this,o,s,l,c,u,f;return o=this.buildValidRange(),o=this.trimHiddenDays(o),i&&(e=O9(e,o)),s=this.buildCurrentRangeInfo(e,t),l=/^(year|month|week|day)$/.test(s.unit),c=this.buildRenderRange(this.trimHiddenDays(s.range),s.unit,l),c=this.trimHiddenDays(c),u=c,r.showNonCurrentDates||(u=Pr(u,s.range)),u=this.adjustActiveRange(u),u=Pr(u,o),f=L_(s.range,o),Xi(c,e)||(e=c.start),{currentDate:e,validRange:o,currentRange:s.range,currentRangeUnit:s.unit,isRangeAllDay:l,activeRange:u,renderRange:c,slotMinTime:r.slotMinTime,slotMaxTime:r.slotMaxTime,isValid:f,dateIncrement:this.buildDateIncrement(s.duration)}}buildValidRange(){let e=this.props.validRangeInput,t=typeof e=="function"?e.call(this.props.calendarApi,this.props.dateEnv.toDate(this.props.nowManager.getDateMarker())):e;return this.refineRange(t)||{start:null,end:null}}buildCurrentRangeInfo(e,t){let{props:i}=this,r=null,o=null,s=null,l;return i.duration?(r=i.duration,o=i.durationUnit,s=this.buildRangeFromDuration(e,t,r,o)):(l=this.props.dayCount)?(o="day",s=this.buildRangeFromDayCount(e,t,l)):(s=this.buildCustomVisibleRange(e))?o=i.dateEnv.greatestWholeUnit(s.start,s.end).unit:(r=this.getFallbackDuration(),o=jf(r).unit,s=this.buildRangeFromDuration(e,t,r,o)),{duration:r,unit:o,range:s}}getFallbackDuration(){return qe({day:1})}adjustActiveRange(e){let{dateEnv:t,usesMinMaxTime:i,slotMinTime:r,slotMaxTime:o}=this.props,{start:s,end:l}=e;return i&&(Yc(r)<0&&(s=lt(s),s=t.add(s,r)),Yc(o)>1&&(l=lt(l),l=Kt(l,-1),l=t.add(l,o))),{start:s,end:l}}buildRangeFromDuration(e,t,i,r){let{dateEnv:o,dateAlignment:s}=this.props,l,c,u;if(!s){let{dateIncrement:m}=this.props;m&&Oi(m)<Oi(i)?s=jf(m).unit:s=r}Yc(i)<=1&&this.isHiddenDay(l)&&(l=this.skipHiddenDays(l,t),l=lt(l));function f(){l=o.startOf(e,s),c=o.add(l,i),u={start:l,end:c}}return f(),this.trimHiddenDays(u)||(e=this.skipHiddenDays(e,t),f()),u}buildRangeFromDayCount(e,t,i){let{dateEnv:r,dateAlignment:o}=this.props,s=0,l=e,c;o&&(l=r.startOf(l,o)),l=lt(l),l=this.skipHiddenDays(l,t),c=l;do c=Kt(c,1),this.isHiddenDay(c)||(s+=1);while(s<i);return{start:l,end:c}}buildCustomVisibleRange(e){let{props:t}=this,i=t.visibleRangeInput,r=typeof i=="function"?i.call(t.calendarApi,t.dateEnv.toDate(e)):i,o=this.refineRange(r);return o&&(o.start==null||o.end==null)?null:o}buildRenderRange(e,t,i){return e}buildDateIncrement(e){let{dateIncrement:t}=this.props,i;return t||((i=this.props.dateAlignment)?qe(1,i):e||qe({days:1}))}refineRange(e){if(e){let t=R9(e,this.props.dateEnv);return t&&(t=Bx(t)),t}return null}initHiddenDays(){let e=this.props.hiddenDays||[],t=[],i=0,r;for(this.props.weekends===!1&&e.push(0,6),r=0;r<7;r+=1)(t[r]=e.indexOf(r)!==-1)||(i+=1);if(!i)throw new Error("invalid hiddenDays");this.isHiddenDayHash=t}trimHiddenDays(e){let{start:t,end:i}=e;return t&&(t=this.skipHiddenDays(t)),i&&(i=this.skipHiddenDays(i,-1,!0)),t==null||i==null||t<i?{start:t,end:i}:null}isHiddenDay(e){return e instanceof Date&&(e=e.getUTCDay()),this.isHiddenDayHash[e]}skipHiddenDays(e,t=1,i=!1){for(;this.isHiddenDayHash[(e.getUTCDay()+(i?t:0)+7)%7];)e=Kt(e,t);return e}};function dp(n,e,t,i){return{instanceId:$o(),defId:n,range:e,forcedStartTzo:t??null,forcedEndTzo:i??null}}function N9(n,e,t,i){for(let r=0;r<i.length;r+=1){let o=i[r].parse(n,t);if(o){let{allDay:s}=n;return s==null&&(s=e,s==null&&(s=o.allDayGuess,s==null&&(s=!1))),{allDay:s,duration:o.duration,typeData:o.typeData,typeId:r}}}return null}function Ja(n,e,t){let{dateEnv:i,pluginHooks:r,options:o}=t,{defs:s,instances:l}=n;l=Bo(l,c=>!s[c.defId].recurringDef);for(let c in s){let u=s[c];if(u.recurringDef){let{duration:f}=u.recurringDef;f||(f=u.allDay?o.defaultAllDayEventDuration:o.defaultTimedEventDuration);let m=L9(u,f,e,i,r.recurringTypes);for(let w of m){let b=dp(c,{start:w,end:i.add(w,f)});l[b.instanceId]=b}}}return{defs:s,instances:l}}function L9(n,e,t,i,r){let s=r[n.recurringDef.typeId].expand(n.recurringDef.typeData,{start:i.subtract(t.start,e),end:t.end},i);return n.allDay&&(s=s.map(lt)),s}var m_={id:String,groupId:String,title:String,url:String,interactive:Boolean},hL={start:H,end:H,date:H,allDay:Boolean},F9=Object.assign(Object.assign(Object.assign({},m_),hL),{extendedProps:H});function gL(n,e,t,i,r=Ux(t),o,s){let{refined:l,extra:c}=F_(n,t,r),u=V9(e,t),f=N9(l,u,t.dateEnv,t.pluginHooks.recurringTypes);if(f){let w=Wf(l,c,e?e.sourceId:"",f.allDay,!!f.duration,t,o);return w.recurringDef={typeId:f.typeId,typeData:f.typeData,duration:f.duration},{def:w,instance:null}}let m=z9(l,u,t,i);if(m){let w=Wf(l,c,e?e.sourceId:"",m.allDay,m.hasEnd,t,o),b=dp(w.defId,m.range,m.forcedStartTzo,m.forcedEndTzo);return s&&w.publicId&&s[w.publicId]&&(b.instanceId=s[w.publicId]),{def:w,instance:b}}return null}function F_(n,e,t=Ux(e)){return k_(n,t)}function Ux(n){return Object.assign(Object.assign(Object.assign({},w_),F9),n.pluginHooks.eventRefiners)}function Wf(n,e,t,i,r,o,s){let l={title:n.title||"",groupId:n.groupId||"",publicId:n.id||"",url:n.url||"",recurringDef:null,defId:(s&&n.id?s[n.id]:"")||$o(),sourceId:t,allDay:i,hasEnd:r,interactive:n.interactive,ui:td(n,o),extendedProps:Object.assign(Object.assign({},n.extendedProps||{}),e)};for(let c of o.pluginHooks.eventDefMemberAdders)Object.assign(l,c(n));return Object.freeze(l.ui.classNames),Object.freeze(l.extendedProps),l}function z9(n,e,t,i){let{allDay:r}=n,o,s=null,l=!1,c,u=null,f=n.start!=null?n.start:n.date;if(o=t.dateEnv.createMarkerMeta(f),o)s=o.marker;else if(!i)return null;return n.end!=null&&(c=t.dateEnv.createMarkerMeta(n.end)),r==null&&(e!=null?r=e:r=(!o||o.isTimeUnspecified)&&(!c||c.isTimeUnspecified)),r&&s&&(s=lt(s)),c&&(u=c.marker,r&&(u=lt(u)),s&&u<=s&&(u=null)),u?l=!0:i||(l=t.options.forceEventDuration||!1,u=t.dateEnv.add(s,r?t.options.defaultAllDayEventDuration:t.options.defaultTimedEventDuration)),{allDay:r,hasEnd:l,range:{start:s,end:u},forcedStartTzo:o?o.forcedTzo:null,forcedEndTzo:c?c.forcedTzo:null}}function V9(n,e){let t=null;return n&&(t=n.defaultAllDay),t==null&&(t=e.options.defaultAllDay),t}function $f(n,e,t,i,r,o){let s=Gn(),l=Ux(t);for(let c of n){let u=gL(c,e,t,i,l,r,o);u&&qf(u,s)}return s}function qf(n,e=Gn()){return e.defs[n.def.defId]=n.def,n.instance&&(e.instances[n.instance.instanceId]=n.instance),e}function up(n,e){let t=n.instances[e];if(t){let i=n.defs[t.defId],r=V_(n,o=>j9(i,o));return r.defs[i.defId]=i,r.instances[t.instanceId]=t,r}return Gn()}function j9(n,e){return!!(n.groupId&&n.groupId===e.groupId)}function Gn(){return{defs:{},instances:{}}}function z_(n,e){return{defs:Object.assign(Object.assign({},n.defs),e.defs),instances:Object.assign(Object.assign({},n.instances),e.instances)}}function V_(n,e){let t=Bo(n.defs,e),i=Bo(n.instances,r=>t[r.defId]);return{defs:t,instances:i}}function B9(n,e){let{defs:t,instances:i}=n,r={},o={};for(let s in t)e.defs[s]||(r[s]=t[s]);for(let s in i)!e.instances[s]&&r[i[s].defId]&&(o[s]=i[s]);return{defs:r,instances:o}}function U9(n,e){return Array.isArray(n)?$f(n,null,e,!0):typeof n=="object"&&n?$f([n],null,e,!0):n!=null?String(n):null}function gx(n){return Array.isArray(n)?n:typeof n=="string"?n.split(/\s+/):[]}var w_={display:String,editable:Boolean,startEditable:Boolean,durationEditable:Boolean,constraint:H,overlap:H,allow:H,className:gx,classNames:gx,color:String,backgroundColor:String,borderColor:String,textColor:String},H9={display:null,startEditable:null,durationEditable:null,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]};function td(n,e){let t=U9(n.constraint,e);return{display:n.display||null,startEditable:n.startEditable!=null?n.startEditable:n.editable,durationEditable:n.durationEditable!=null?n.durationEditable:n.editable,constraints:t!=null?[t]:[],overlap:n.overlap!=null?n.overlap:null,allows:n.allow!=null?[n.allow]:[],backgroundColor:n.backgroundColor||n.color||"",borderColor:n.borderColor||n.color||"",textColor:n.textColor||"",classNames:(n.className||[]).concat(n.classNames||[])}}function Hx(n){return n.reduce(W9,H9)}function W9(n,e){return{display:e.display!=null?e.display:n.display,startEditable:e.startEditable!=null?e.startEditable:n.startEditable,durationEditable:e.durationEditable!=null?e.durationEditable:n.durationEditable,constraints:n.constraints.concat(e.constraints),overlap:typeof e.overlap=="boolean"?e.overlap:n.overlap,allows:n.allows.concat(e.allows),backgroundColor:e.backgroundColor||n.backgroundColor,borderColor:e.borderColor||n.borderColor,textColor:e.textColor||n.textColor,classNames:n.classNames.concat(e.classNames)}}var $9={id:String,defaultAllDay:Boolean,url:String,format:String,events:H,eventDataTransform:H,success:H,failure:H};function Wx(n,e,t=$x(e)){let i;if(typeof n=="string"?i={url:n}:typeof n=="function"||Array.isArray(n)?i={events:n}:typeof n=="object"&&n&&(i=n),i){let{refined:r,extra:o}=k_(i,t),s=q9(r,e);if(s)return{_raw:n,isFetching:!1,latestFetchId:"",fetchRange:null,defaultAllDay:r.defaultAllDay,eventDataTransform:r.eventDataTransform,success:r.success,failure:r.failure,publicId:r.id||"",sourceId:$o(),sourceDefId:s.sourceDefId,meta:s.meta,ui:td(r,e),extendedProps:o}}return null}function $x(n){return Object.assign(Object.assign(Object.assign({},w_),$9),n.pluginHooks.eventSourceRefiners)}function q9(n,e){let t=e.pluginHooks.eventSourceDefs;for(let i=t.length-1;i>=0;i-=1){let o=t[i].parseMeta(n);if(o)return{sourceDefId:i,meta:o}}return null}function mL(n,e,t,i,r){switch(e.type){case"RECEIVE_EVENTS":return G9(n,t[e.sourceId],e.fetchId,e.fetchRange,e.rawEvents,r);case"RESET_RAW_EVENTS":return Z9(n,t[e.sourceId],e.rawEvents,i.activeRange,r);case"ADD_EVENTS":return Y9(n,e.eventStore,i?i.activeRange:null,r);case"RESET_EVENTS":return e.eventStore;case"MERGE_EVENTS":return z_(n,e.eventStore);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return i?Ja(n,i.activeRange,r):n;case"REMOVE_EVENTS":return B9(n,e.eventStore);case"REMOVE_EVENT_SOURCE":return _L(n,e.sourceId);case"REMOVE_ALL_EVENT_SOURCES":return V_(n,o=>!o.sourceId);case"REMOVE_ALL_EVENTS":return Gn();default:return n}}function G9(n,e,t,i,r,o){if(e&&t===e.latestFetchId){let s=$f(vL(r,e,o),e,o);return i&&(s=Ja(s,i,o)),z_(_L(n,e.sourceId),s)}return n}function Z9(n,e,t,i,r){let{defIdMap:o,instanceIdMap:s}=K9(n),l=$f(vL(t,e,r),e,r,!1,o,s);return Ja(l,i,r)}function vL(n,e,t){let i=t.options.eventDataTransform,r=e?e.eventDataTransform:null;return r&&(n=H2(n,r)),i&&(n=H2(n,i)),n}function H2(n,e){let t;if(!e)t=n;else{t=[];for(let i of n){let r=e(i);r?t.push(r):r==null&&t.push(i)}}return t}function Y9(n,e,t,i){return t&&(e=Ja(e,t,i)),z_(n,e)}function qx(n,e,t){let{defs:i}=n,r=er(n.instances,o=>i[o.defId].allDay?o:Object.assign(Object.assign({},o),{range:{start:t.createMarker(e.toDate(o.range.start,o.forcedStartTzo)),end:t.createMarker(e.toDate(o.range.end,o.forcedEndTzo))},forcedStartTzo:t.canComputeOffset?null:o.forcedStartTzo,forcedEndTzo:t.canComputeOffset?null:o.forcedEndTzo}));return{defs:i,instances:r}}function _L(n,e){return V_(n,t=>t.sourceId!==e)}function Q9(n,e){return{defs:n.defs,instances:Bo(n.instances,t=>!e[t.instanceId])}}function K9(n){let{defs:e,instances:t}=n,i={},r={};for(let o in e){let s=e[o],{publicId:l}=s;l&&(i[l]=o)}for(let o in t){let s=t[o],l=e[s.defId],{publicId:c}=l;c&&(r[c]=o)}return{defIdMap:i,instanceIdMap:r}}var Wo=class{constructor(){this.handlers={},this.thisContext=null}setThisContext(e){this.thisContext=e}setOptions(e){this.options=e}on(e,t){J9(this.handlers,e,t)}off(e,t){X9(this.handlers,e,t)}trigger(e,...t){let i=this.handlers[e]||[],r=this.options&&this.options[e],o=[].concat(r||[],i);for(let s of o)s.apply(this.thisContext,t)}hasHandlers(e){return!!(this.handlers[e]&&this.handlers[e].length||this.options&&this.options[e])}};function J9(n,e,t){(n[e]||(n[e]=[])).push(t)}function X9(n,e,t){t?n[e]&&(n[e]=n[e].filter(i=>i!==t)):delete n[e]}var eq={startTime:"09:00",endTime:"17:00",daysOfWeek:[1,2,3,4,5],display:"inverse-background",classNames:"fc-non-business",groupId:"_businessHours"};function Gx(n,e){return $f(tq(n),null,e)}function tq(n){let e;return n===!0?e=[{}]:Array.isArray(n)?e=n.filter(t=>t.daysOfWeek):typeof n=="object"&&n?e=[n]:e=[],e=e.map(t=>Object.assign(Object.assign({},eq),t)),e}function j_(n,e,t){t.emitter.trigger("select",Object.assign(Object.assign({},Zx(n,t)),{jsEvent:e?e.origEvent:null,view:t.viewApi||t.calendarApi.view}))}function nq(n,e){e.emitter.trigger("unselect",{jsEvent:n?n.origEvent:null,view:e.viewApi||e.calendarApi.view})}function Zx(n,e){let t={};for(let i of e.pluginHooks.dateSpanTransforms)Object.assign(t,i(n,e));return Object.assign(t,hq(n,e.dateEnv)),t}function S_(n,e,t){let{dateEnv:i,options:r}=t,o=e;return n?(o=lt(o),o=i.add(o,r.defaultAllDayEventDuration)):o=i.add(o,r.defaultTimedEventDuration),o}function fp(n,e,t,i){let r=E_(n.defs,e),o=Gn();for(let s in n.defs){let l=n.defs[s];o.defs[s]=iq(l,r[s],t,i)}for(let s in n.instances){let l=n.instances[s],c=o.defs[l.defId];o.instances[s]=rq(l,c,r[l.defId],t,i)}return o}function iq(n,e,t,i){let r=t.standardProps||{};r.hasEnd==null&&e.durationEditable&&(t.startDelta||t.endDelta)&&(r.hasEnd=!0);let o=Object.assign(Object.assign(Object.assign({},n),r),{ui:Object.assign(Object.assign({},n.ui),r.ui)});t.extendedProps&&(o.extendedProps=Object.assign(Object.assign({},o.extendedProps),t.extendedProps));for(let s of i.pluginHooks.eventDefMutationAppliers)s(o,t,i);return!o.hasEnd&&i.options.forceEventDuration&&(o.hasEnd=!0),o}function rq(n,e,t,i,r){let{dateEnv:o}=r,s=i.standardProps&&i.standardProps.allDay===!0,l=i.standardProps&&i.standardProps.hasEnd===!1,c=Object.assign({},n);return s&&(c.range=pL(c.range)),i.datesDelta&&t.startEditable&&(c.range={start:o.add(c.range.start,i.datesDelta),end:o.add(c.range.end,i.datesDelta)}),i.startDelta&&t.durationEditable&&(c.range={start:o.add(c.range.start,i.startDelta),end:c.range.end}),i.endDelta&&t.durationEditable&&(c.range={start:c.range.start,end:o.add(c.range.end,i.endDelta)}),l&&(c.range={start:c.range.start,end:S_(e.allDay,c.range.start,r)}),e.allDay&&(c.range={start:lt(c.range.start),end:lt(c.range.end)}),c.range.end<c.range.start&&(c.range.end=S_(e.allDay,c.range.start,r)),c}var Is=class{constructor(e,t){this.context=e,this.internalEventSource=t}remove(){this.context.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:this.internalEventSource.sourceId})}refetch(){this.context.dispatch({type:"FETCH_EVENT_SOURCES",sourceIds:[this.internalEventSource.sourceId],isRefetch:!0})}get id(){return this.internalEventSource.publicId}get url(){return this.internalEventSource.meta.url}get format(){return this.internalEventSource.meta.format}},St=class n{constructor(e,t,i){this._context=e,this._def=t,this._instance=i||null}setProp(e,t){if(e in hL)console.warn("Could not set date-related prop 'name'. Use one of the date-related methods instead.");else if(e==="id")t=m_[e](t),this.mutate({standardProps:{publicId:t}});else if(e in m_)t=m_[e](t),this.mutate({standardProps:{[e]:t}});else if(e in w_){let i=w_[e](t);e==="color"?i={backgroundColor:t,borderColor:t}:e==="editable"?i={startEditable:t,durationEditable:t}:i={[e]:t},this.mutate({standardProps:{ui:i}})}else console.warn(`Could not set prop '${e}'. Use setExtendedProp instead.`)}setExtendedProp(e,t){this.mutate({extendedProps:{[e]:t}})}setStart(e,t={}){let{dateEnv:i}=this._context,r=i.createMarker(e);if(r&&this._instance){let o=this._instance.range,s=Ps(o.start,r,i,t.granularity);t.maintainDuration?this.mutate({datesDelta:s}):this.mutate({startDelta:s})}}setEnd(e,t={}){let{dateEnv:i}=this._context,r;if(!(e!=null&&(r=i.createMarker(e),!r))&&this._instance)if(r){let o=Ps(this._instance.range.end,r,i,t.granularity);this.mutate({endDelta:o})}else this.mutate({standardProps:{hasEnd:!1}})}setDates(e,t,i={}){let{dateEnv:r}=this._context,o={allDay:i.allDay},s=r.createMarker(e),l;if(s&&!(t!=null&&(l=r.createMarker(t),!l))&&this._instance){let c=this._instance.range;i.allDay===!0&&(c=pL(c));let u=Ps(c.start,s,r,i.granularity);if(l){let f=Ps(c.end,l,r,i.granularity);Q$(u,f)?this.mutate({datesDelta:u,standardProps:o}):this.mutate({startDelta:u,endDelta:f,standardProps:o})}else o.hasEnd=!1,this.mutate({datesDelta:u,standardProps:o})}}moveStart(e){let t=qe(e);t&&this.mutate({startDelta:t})}moveEnd(e){let t=qe(e);t&&this.mutate({endDelta:t})}moveDates(e){let t=qe(e);t&&this.mutate({datesDelta:t})}setAllDay(e,t={}){let i={allDay:e},{maintainDuration:r}=t;r==null&&(r=this._context.options.allDayMaintainDuration),this._def.allDay!==e&&(i.hasEnd=r),this.mutate({standardProps:i})}formatRange(e){let{dateEnv:t}=this._context,i=this._instance,r=wt(e);return this._def.hasEnd?t.formatRange(i.range.start,i.range.end,r,{forcedStartTzo:i.forcedStartTzo,forcedEndTzo:i.forcedEndTzo}):t.format(i.range.start,r,{forcedTzo:i.forcedStartTzo})}mutate(e){let t=this._instance;if(t){let i=this._def,r=this._context,{eventStore:o}=r.getCurrentData(),s=up(o,t.instanceId);s=fp(s,{"":{display:"",startEditable:!0,durationEditable:!0,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]}},e,r);let c=new n(r,i,t);this._def=s.defs[i.defId],this._instance=s.instances[t.instanceId],r.dispatch({type:"MERGE_EVENTS",eventStore:s}),r.emitter.trigger("eventChange",{oldEvent:c,event:this,relatedEvents:go(s,r,t),revert(){r.dispatch({type:"RESET_EVENTS",eventStore:o})}})}}remove(){let e=this._context,t=yL(this);e.dispatch({type:"REMOVE_EVENTS",eventStore:t}),e.emitter.trigger("eventRemove",{event:this,relatedEvents:[],revert(){e.dispatch({type:"MERGE_EVENTS",eventStore:t})}})}get source(){let{sourceId:e}=this._def;return e?new Is(this._context,this._context.getCurrentData().eventSources[e]):null}get start(){return this._instance?this._context.dateEnv.toDate(this._instance.range.start):null}get end(){return this._instance&&this._def.hasEnd?this._context.dateEnv.toDate(this._instance.range.end):null}get startStr(){let e=this._instance;return e?this._context.dateEnv.formatIso(e.range.start,{omitTime:this._def.allDay,forcedTzo:e.forcedStartTzo}):""}get endStr(){let e=this._instance;return e&&this._def.hasEnd?this._context.dateEnv.formatIso(e.range.end,{omitTime:this._def.allDay,forcedTzo:e.forcedEndTzo}):""}get id(){return this._def.publicId}get groupId(){return this._def.groupId}get allDay(){return this._def.allDay}get title(){return this._def.title}get url(){return this._def.url}get display(){return this._def.ui.display||"auto"}get startEditable(){return this._def.ui.startEditable}get durationEditable(){return this._def.ui.durationEditable}get constraint(){return this._def.ui.constraints[0]||null}get overlap(){return this._def.ui.overlap}get allow(){return this._def.ui.allows[0]||null}get backgroundColor(){return this._def.ui.backgroundColor}get borderColor(){return this._def.ui.borderColor}get textColor(){return this._def.ui.textColor}get classNames(){return this._def.ui.classNames}get extendedProps(){return this._def.extendedProps}toPlainObject(e={}){let t=this._def,{ui:i}=t,{startStr:r,endStr:o}=this,s={allDay:t.allDay};return t.title&&(s.title=t.title),r&&(s.start=r),o&&(s.end=o),t.publicId&&(s.id=t.publicId),t.groupId&&(s.groupId=t.groupId),t.url&&(s.url=t.url),i.display&&i.display!=="auto"&&(s.display=i.display),e.collapseColor&&i.backgroundColor&&i.backgroundColor===i.borderColor?s.color=i.backgroundColor:(i.backgroundColor&&(s.backgroundColor=i.backgroundColor),i.borderColor&&(s.borderColor=i.borderColor)),i.textColor&&(s.textColor=i.textColor),i.classNames.length&&(s.classNames=i.classNames),Object.keys(t.extendedProps).length&&(e.collapseExtendedProps?Object.assign(s,t.extendedProps):s.extendedProps=t.extendedProps),s}toJSON(){return this.toPlainObject()}};function yL(n){let e=n._def,t=n._instance;return{defs:{[e.defId]:e},instances:t?{[t.instanceId]:t}:{}}}function go(n,e,t){let{defs:i,instances:r}=n,o=[],s=t?t.instanceId:"";for(let l in r){let c=r[l],u=i[c.defId];c.instanceId!==s&&o.push(new St(e,u,c))}return o}function C_(n,e,t,i){let r={},o={},s={},l=[],c=[],u=E_(n.defs,e);for(let f in n.defs){let m=n.defs[f];u[m.defId].display==="inverse-background"&&(m.groupId?(r[m.groupId]=[],s[m.groupId]||(s[m.groupId]=m)):o[f]=[])}for(let f in n.instances){let m=n.instances[f],w=n.defs[m.defId],b=u[w.defId],D=m.range,T=!w.allDay&&i?Bx(D,i):D,M=Pr(T,t);M&&(b.display==="inverse-background"?w.groupId?r[w.groupId].push(M):o[m.defId].push(M):b.display!=="none"&&(b.display==="background"?l:c).push({def:w,ui:b,instance:m,range:M,isStart:T.start&&T.start.valueOf()===M.start.valueOf(),isEnd:T.end&&T.end.valueOf()===M.end.valueOf()}))}for(let f in r){let m=r[f],w=U2(m,t);for(let b of w){let D=s[f],T=u[D.defId];l.push({def:D,ui:T,instance:null,range:b,isStart:!1,isEnd:!1})}}for(let f in o){let m=o[f],w=U2(m,t);for(let b of w)l.push({def:n.defs[f],ui:u[f],instance:null,range:b,isStart:!1,isEnd:!1})}return{bg:l,fg:c}}function Yx(n){return n.ui.display==="background"||n.ui.display==="inverse-background"}function W2(n,e){n.fcSeg=e}function Go(n){return n.fcSeg||n.parentNode.fcSeg||null}function E_(n,e){return er(n,t=>bL(t,e))}function bL(n,e){let t=[];return e[""]&&t.push(e[""]),e[n.defId]&&t.push(e[n.defId]),t.push(n.ui),Hx(t)}function pp(n,e){let t=n.map(oq);return t.sort((i,r)=>tL(i,r,e)),t.map(i=>i._seg)}function oq(n){let{eventRange:e}=n,t=e.def,i=e.instance?e.instance.range:e.range,r=i.start?i.start.valueOf():0,o=i.end?i.end.valueOf():0;return Object.assign(Object.assign(Object.assign({},t.extendedProps),t),{id:t.publicId,start:r,end:o,duration:o-r,allDay:Number(t.allDay),_seg:n})}function sq(n,e){let{pluginHooks:t}=e,i=t.isDraggableTransformers,{def:r,ui:o}=n.eventRange,s=o.startEditable;for(let l of i)s=l(s,r,o,e);return s}function aq(n,e){return n.isStart&&n.eventRange.ui.durationEditable&&e.options.eventResizableFromStart}function lq(n,e){return n.isEnd&&n.eventRange.ui.durationEditable}function B_(n,e,t,i,r,o,s){let{dateEnv:l,options:c}=t,{displayEventTime:u,displayEventEnd:f}=c,m=n.eventRange.def,w=n.eventRange.instance;u==null&&(u=i!==!1),f==null&&(f=r!==!1);let b=w.range.start,D=w.range.end,T=o||n.start||n.eventRange.range.start,M=s||n.end||n.eventRange.range.end,P=lt(b).valueOf()===lt(T).valueOf(),U=lt(fo(D,-1)).valueOf()===lt(fo(M,-1)).valueOf();return u&&!m.allDay&&(P||U)?(T=P?b:T,M=U?D:M,f&&m.hasEnd?l.formatRange(T,M,e,{forcedStartTzo:o?null:w.forcedStartTzo,forcedEndTzo:s?null:w.forcedEndTzo}):l.format(T,e,{forcedTzo:o?null:w.forcedStartTzo})):""}function kr(n,e,t){let i=n.eventRange.range;return{isPast:i.end<=(t||e.start),isFuture:i.start>=(t||e.end),isToday:e&&Xi(e,i.start)}}function cq(n){let e=["fc-event"];return n.isMirror&&e.push("fc-event-mirror"),n.isDraggable&&e.push("fc-event-draggable"),(n.isStartResizable||n.isEndResizable)&&e.push("fc-event-resizable"),n.isDragging&&e.push("fc-event-dragging"),n.isResizing&&e.push("fc-event-resizing"),n.isSelected&&e.push("fc-event-selected"),n.isStart&&e.push("fc-event-start"),n.isEnd&&e.push("fc-event-end"),n.isPast&&e.push("fc-event-past"),n.isToday&&e.push("fc-event-today"),n.isFuture&&e.push("fc-event-future"),e}function hp(n){return n.instance?n.instance.instanceId:`${n.def.defId}:${n.range.start.toISOString()}`}function U_(n,e){let{def:t,instance:i}=n.eventRange,{url:r}=t;if(r)return{href:r};let{emitter:o,options:s}=e,{eventInteractive:l}=s;return l==null&&(l=t.interactive,l==null&&(l=!!o.hasHandlers("eventClick"))),l?X2(c=>{o.trigger("eventClick",{el:c.target,event:new St(e,t,i),jsEvent:c,view:e.viewApi})}):{}}var dq={start:H,end:H,allDay:Boolean};function uq(n,e,t){let i=fq(n,e),{range:r}=i;if(!r.start)return null;if(!r.end){if(t==null)return null;r.end=e.add(r.start,t)}return i}function fq(n,e){let{refined:t,extra:i}=k_(n,dq),r=t.start?e.createMarkerMeta(t.start):null,o=t.end?e.createMarkerMeta(t.end):null,{allDay:s}=t;return s==null&&(s=r&&r.isTimeUnspecified&&(!o||o.isTimeUnspecified)),Object.assign({range:{start:r?r.marker:null,end:o?o.marker:null},allDay:s},i)}function Qx(n,e){return fL(n.range,e.range)&&n.allDay===e.allDay&&pq(n,e)}function pq(n,e){for(let t in e)if(t!=="range"&&t!=="allDay"&&n[t]!==e[t])return!1;for(let t in n)if(!(t in e))return!1;return!0}function hq(n,e){return Object.assign(Object.assign({},wL(n.range,e,n.allDay)),{allDay:n.allDay})}function Kx(n,e,t){return Object.assign(Object.assign({},wL(n,e,t)),{timeZone:e.timeZone})}function wL(n,e,t){return{start:e.toDate(n.start),end:e.toDate(n.end),startStr:e.formatIso(n.start,{omitTime:t}),endStr:e.formatIso(n.end,{omitTime:t})}}function gq(n,e,t){let i=F_({editable:!1},t),r=Wf(i.refined,i.extra,"",n.allDay,!0,t);return{def:r,ui:bL(r,e),instance:dp(r.defId,n.range),range:n.range,isStart:!0,isEnd:!0}}function Jx(n,e,t){let i=!1,r=function(l){i||(i=!0,e(l))},o=function(l){i||(i=!0,t(l))},s=n(r,o);s&&typeof s.then=="function"&&s.then(r,o)}var x_=class extends Error{constructor(e,t){super(e),this.response=t}};function Xx(n,e,t){n=n.toUpperCase();let i={method:n};return n==="GET"?e+=(e.indexOf("?")===-1?"?":"&")+new URLSearchParams(t):(i.body=new URLSearchParams(t),i.headers={"Content-Type":"application/x-www-form-urlencoded"}),fetch(e,i).then(r=>{if(r.ok)return r.json().then(o=>[o,r],()=>{throw new x_("Failure parsing JSON",r)});throw new x_("Request failed",r)})}var tx;function eD(){return tx==null&&(tx=mq()),tx}function mq(){if(typeof document>"u")return!0;let n=document.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.innerHTML="<table><tr><td><div></div></td></tr></table>",n.querySelector("table").style.height="100px",n.querySelector("div").style.height="100%",document.body.appendChild(n);let t=n.querySelector("div").offsetHeight>0;return document.body.removeChild(n),t}var Gf=class extends Ke{constructor(){super(...arguments),this.state={forPrint:!1},this.handleBeforePrint=()=>{Uf(()=>{this.setState({forPrint:!0})})},this.handleAfterPrint=()=>{Uf(()=>{this.setState({forPrint:!1})})}}render(){let{props:e}=this,{options:t}=e,{forPrint:i}=this.state,r=i||t.height==="auto"||t.contentHeight==="auto",o=!r&&t.height!=null?t.height:"",s=["fc",i?"fc-media-print":"fc-media-screen",`fc-direction-${t.direction}`,e.theme.getClass("root")];return eD()||s.push("fc-liquid-hack"),e.children(s,o,r,i)}componentDidMount(){let{emitter:e}=this.props;e.on("_beforeprint",this.handleBeforePrint),e.on("_afterprint",this.handleAfterPrint)}componentWillUnmount(){let{emitter:e}=this.props;e.off("_beforeprint",this.handleBeforePrint),e.off("_afterprint",this.handleAfterPrint)}},Ar=class{constructor(e){this.component=e.component,this.isHitComboAllowed=e.isHitComboAllowed||null}destroy(){}};function SL(n,e){return{component:n,el:e.el,useEventCenter:e.useEventCenter!=null?e.useEventCenter:!0,isHitComboAllowed:e.isHitComboAllowed||null}}function gp(n){return{[n.component.uid]:n}}var nd={},Zo=(()=>{class n extends Fn{constructor(t,i){super(t,i),this.handleRefresh=()=>{let r=this.computeTiming();r.state.nowDate.valueOf()!==this.state.nowDate.valueOf()&&this.setState(r.state),this.clearTimeout(),this.setTimeout(r.waitMs)},this.handleVisibilityChange=()=>{document.hidden||this.handleRefresh()},this.state=this.computeTiming().state}render(){let{props:t,state:i}=this;return t.children(i.nowDate,i.todayRange)}componentDidMount(){this.setTimeout(),this.context.nowManager.addResetListener(this.handleRefresh),document.addEventListener("visibilitychange",this.handleVisibilityChange)}componentDidUpdate(t){t.unit!==this.props.unit&&(this.clearTimeout(),this.setTimeout())}componentWillUnmount(){this.clearTimeout(),this.context.nowManager.removeResetListener(this.handleRefresh),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}computeTiming(){let{props:t,context:i}=this,r=i.nowManager.getDateMarker(),{nowIndicatorSnap:o}=i.options;o==="auto"&&(o=/year|month|week|day/.test(t.unit)||(t.unitValue||1)===1);let s,l;return o?(s=i.dateEnv.startOf(r,t.unit),l=i.dateEnv.add(s,qe(1,t.unit)).valueOf()-r.valueOf()):(s=r,l=1e3*60),l=Math.min(1e3*60*60*24,l),{state:{nowDate:s,todayRange:vq(s)},waitMs:l}}setTimeout(t=this.computeTiming().waitMs){this.timeoutId=setTimeout(()=>{let i=this.computeTiming();this.setState(i.state,()=>{this.setTimeout(i.waitMs)})},t)}clearTimeout(){this.timeoutId&&clearTimeout(this.timeoutId)}}return n.contextType=tr,n})();function vq(n){let e=lt(n),t=Kt(e,1);return{start:e,end:t}}var Zf=class{getCurrentData(){return this.currentDataManager.getCurrentData()}dispatch(e){this.currentDataManager.dispatch(e)}get view(){return this.getCurrentData().viewApi}batchRendering(e){e()}updateSize(){this.trigger("_resize",!0)}setOption(e,t){this.dispatch({type:"SET_OPTION",optionName:e,rawOptionValue:t})}getOption(e){return this.currentDataManager.currentCalendarOptionsInput[e]}getAvailableLocaleCodes(){return Object.keys(this.getCurrentData().availableRawLocales)}on(e,t){let{currentDataManager:i}=this;i.currentCalendarOptionsRefiners[e]?i.emitter.on(e,t):console.warn(`Unknown listener name '${e}'`)}off(e,t){this.currentDataManager.emitter.off(e,t)}trigger(e,...t){this.currentDataManager.emitter.trigger(e,...t)}changeView(e,t){this.batchRendering(()=>{if(this.unselect(),t)if(t.start&&t.end)this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e}),this.dispatch({type:"SET_OPTION",optionName:"visibleRange",rawOptionValue:t});else{let{dateEnv:i}=this.getCurrentData();this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e,dateMarker:i.createMarker(t)})}else this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e})})}zoomTo(e,t){let i=this.getCurrentData(),r;t=t||"day",r=i.viewSpecs[t]||this.getUnitViewSpec(t),this.unselect(),r?this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:r.type,dateMarker:e}):this.dispatch({type:"CHANGE_DATE",dateMarker:e})}getUnitViewSpec(e){let{viewSpecs:t,toolbarConfig:i}=this.getCurrentData(),r=[].concat(i.header?i.header.viewsWithButtons:[],i.footer?i.footer.viewsWithButtons:[]),o,s;for(let l in t)r.push(l);for(o=0;o<r.length;o+=1)if(s=t[r[o]],s&&s.singleUnit===e)return s;return null}prev(){this.unselect(),this.dispatch({type:"PREV"})}next(){this.unselect(),this.dispatch({type:"NEXT"})}prevYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,-1)})}nextYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,1)})}today(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.nowManager.getDateMarker()})}gotoDate(e){let t=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.createMarker(e)})}incrementDate(e){let t=this.getCurrentData(),i=qe(e);i&&(this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.add(t.currentDate,i)}))}getDate(){let e=this.getCurrentData();return e.dateEnv.toDate(e.currentDate)}formatDate(e,t){let{dateEnv:i}=this.getCurrentData();return i.format(i.createMarker(e),wt(t))}formatRange(e,t,i){let{dateEnv:r}=this.getCurrentData();return r.formatRange(r.createMarker(e),r.createMarker(t),wt(i),i)}formatIso(e,t){let{dateEnv:i}=this.getCurrentData();return i.formatIso(i.createMarker(e),{omitTime:t})}select(e,t){let i;t==null?e.start!=null?i=e:i={start:e,end:null}:i={start:e,end:t};let r=this.getCurrentData(),o=uq(i,r.dateEnv,qe({days:1}));o&&(this.dispatch({type:"SELECT_DATES",selection:o}),j_(o,null,r))}unselect(e){let t=this.getCurrentData();t.dateSelection&&(this.dispatch({type:"UNSELECT_DATES"}),nq(e,t))}addEvent(e,t){if(e instanceof St){let s=e._def,l=e._instance;return this.getCurrentData().eventStore.defs[s.defId]||(this.dispatch({type:"ADD_EVENTS",eventStore:qf({def:s,instance:l})}),this.triggerEventAdd(e)),e}let i=this.getCurrentData(),r;if(t instanceof Is)r=t.internalEventSource;else if(typeof t=="boolean")t&&([r]=N_(i.eventSources));else if(t!=null){let s=this.getEventSourceById(t);if(!s)return console.warn(`Could not find an event source with ID "${t}"`),null;r=s.internalEventSource}let o=gL(e,r,i,!1);if(o){let s=new St(i,o.def,o.def.recurringDef?null:o.instance);return this.dispatch({type:"ADD_EVENTS",eventStore:qf(o)}),this.triggerEventAdd(s),s}return null}triggerEventAdd(e){let{emitter:t}=this.getCurrentData();t.trigger("eventAdd",{event:e,relatedEvents:[],revert:()=>{this.dispatch({type:"REMOVE_EVENTS",eventStore:yL(e)})}})}getEventById(e){let t=this.getCurrentData(),{defs:i,instances:r}=t.eventStore;e=String(e);for(let o in i){let s=i[o];if(s.publicId===e){if(s.recurringDef)return new St(t,s,null);for(let l in r){let c=r[l];if(c.defId===s.defId)return new St(t,s,c)}}}return null}getEvents(){let e=this.getCurrentData();return go(e.eventStore,e)}removeAllEvents(){this.dispatch({type:"REMOVE_ALL_EVENTS"})}getEventSources(){let e=this.getCurrentData(),t=e.eventSources,i=[];for(let r in t)i.push(new Is(e,t[r]));return i}getEventSourceById(e){let t=this.getCurrentData(),i=t.eventSources;e=String(e);for(let r in i)if(i[r].publicId===e)return new Is(t,i[r]);return null}addEventSource(e){let t=this.getCurrentData();if(e instanceof Is)return t.eventSources[e.internalEventSource.sourceId]||this.dispatch({type:"ADD_EVENT_SOURCES",sources:[e.internalEventSource]}),e;let i=Wx(e,t);return i?(this.dispatch({type:"ADD_EVENT_SOURCES",sources:[i]}),new Is(t,i)):null}removeAllEventSources(){this.dispatch({type:"REMOVE_ALL_EVENT_SOURCES"})}refetchEvents(){this.dispatch({type:"FETCH_EVENT_SOURCES",isRefetch:!0})}scrollToTime(e){let t=qe(e);t&&this.trigger("_scrollRequest",{time:t})}};function tD(n,e){return n.left>=e.left&&n.left<e.right&&n.top>=e.top&&n.top<e.bottom}function H_(n,e){let t={left:Math.max(n.left,e.left),right:Math.min(n.right,e.right),top:Math.max(n.top,e.top),bottom:Math.min(n.bottom,e.bottom)};return t.left<t.right&&t.top<t.bottom?t:!1}function nD(n,e){return{left:Math.min(Math.max(n.left,e.left),e.right),top:Math.min(Math.max(n.top,e.top),e.bottom)}}function iD(n){return{left:(n.left+n.right)/2,top:(n.top+n.bottom)/2}}function rD(n,e){return{left:n.left-e.left,top:n.top-e.top}}var nx=Gn(),Yf=class{constructor(){this.getKeysForEventDefs=ve(this._getKeysForEventDefs),this.splitDateSelection=ve(this._splitDateSpan),this.splitEventStore=ve(this._splitEventStore),this.splitIndividualUi=ve(this._splitIndividualUi),this.splitEventDrag=ve(this._splitInteraction),this.splitEventResize=ve(this._splitInteraction),this.eventUiBuilders={}}splitProps(e){let t=this.getKeyInfo(e),i=this.getKeysForEventDefs(e.eventStore),r=this.splitDateSelection(e.dateSelection),o=this.splitIndividualUi(e.eventUiBases,i),s=this.splitEventStore(e.eventStore,i),l=this.splitEventDrag(e.eventDrag),c=this.splitEventResize(e.eventResize),u={};this.eventUiBuilders=er(t,(f,m)=>this.eventUiBuilders[m]||ve(_q));for(let f in t){let m=t[f],w=s[f]||nx,b=this.eventUiBuilders[f];u[f]={businessHours:m.businessHours||e.businessHours,dateSelection:r[f]||null,eventStore:w,eventUiBases:b(e.eventUiBases[""],m.ui,o[f]),eventSelection:w.instances[e.eventSelection]?e.eventSelection:"",eventDrag:l[f]||null,eventResize:c[f]||null}}return u}_splitDateSpan(e){let t={};if(e){let i=this.getKeysForDateSpan(e);for(let r of i)t[r]=e}return t}_getKeysForEventDefs(e){return er(e.defs,t=>this.getKeysForEventDef(t))}_splitEventStore(e,t){let{defs:i,instances:r}=e,o={};for(let s in i)for(let l of t[s])o[l]||(o[l]=Gn()),o[l].defs[s]=i[s];for(let s in r){let l=r[s];for(let c of t[l.defId])o[c]&&(o[c].instances[s]=l)}return o}_splitIndividualUi(e,t){let i={};for(let r in e)if(r)for(let o of t[r])i[o]||(i[o]={}),i[o][r]=e[r];return i}_splitInteraction(e){let t={};if(e){let i=this._splitEventStore(e.affectedEvents,this._getKeysForEventDefs(e.affectedEvents)),r=this._getKeysForEventDefs(e.mutatedEvents),o=this._splitEventStore(e.mutatedEvents,r),s=l=>{t[l]||(t[l]={affectedEvents:i[l]||nx,mutatedEvents:o[l]||nx,isEvent:e.isEvent})};for(let l in i)s(l);for(let l in o)s(l)}return t}};function _q(n,e,t){let i=[];n&&i.push(n),e&&i.push(e);let r={"":Hx(i)};return t&&Object.assign(r,t),r}function oD(n,e,t,i){return{dow:n.getUTCDay(),isDisabled:!!(i&&(!i.activeRange||!Xi(i.activeRange,n))),isOther:!!(i&&!Xi(i.currentRange,n)),isToday:!!(e&&Xi(e,n)),isPast:!!(t?n<t:e&&n<e.start),isFuture:!!(t?n>t:e&&n>=e.end)}}function W_(n,e){let t=["fc-day",`fc-day-${X$[n.dow]}`];return n.isDisabled?t.push("fc-day-disabled"):(n.isToday&&(t.push("fc-day-today"),t.push(e.getClass("today"))),n.isPast&&t.push("fc-day-past"),n.isFuture&&t.push("fc-day-future"),n.isOther&&t.push("fc-day-other")),t}var yq=wt({year:"numeric",month:"long",day:"numeric"}),bq=wt({week:"long"});function dl(n,e,t="day",i=!0){let{dateEnv:r,options:o,calendarApi:s}=n,l=r.format(e,t==="week"?bq:yq);if(o.navLinks){let c=r.toDate(e),u=f=>{let m=t==="day"?o.navLinkDayClick:t==="week"?o.navLinkWeekClick:null;typeof m=="function"?m.call(s,r.toDate(e),f):(typeof m=="string"&&(t=m),s.zoomTo(e,t))};return Object.assign({title:Jc(o.navLinkHint,[l,c],l),"data-navlink":""},i?J2(u):{onClick:u})}return{"aria-label":l}}var ix=null;function CL(){return ix===null&&(ix=wq()),ix}function wq(){let n=document.createElement("div");ll(n,{position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}),n.innerHTML="<div></div>",document.body.appendChild(n);let t=n.firstChild.getBoundingClientRect().left>n.getBoundingClientRect().left;return np(n),t}var rx;function EL(){return rx||(rx=Sq()),rx}function Sq(){let n=document.createElement("div");n.style.overflow="scroll",n.style.position="absolute",n.style.top="-9999px",n.style.left="-9999px",document.body.appendChild(n);let e=xL(n);return document.body.removeChild(n),e}function xL(n){return{x:n.offsetHeight-n.clientHeight,y:n.offsetWidth-n.clientWidth}}function DL(n,e=!1){let t=window.getComputedStyle(n),i=parseInt(t.borderLeftWidth,10)||0,r=parseInt(t.borderRightWidth,10)||0,o=parseInt(t.borderTopWidth,10)||0,s=parseInt(t.borderBottomWidth,10)||0,l=xL(n),c=l.y-i-r,u=l.x-o-s,f={borderLeft:i,borderRight:r,borderTop:o,borderBottom:s,scrollbarBottom:u,scrollbarLeft:0,scrollbarRight:0};return CL()&&t.direction==="rtl"?f.scrollbarLeft=c:f.scrollbarRight=c,e&&(f.paddingLeft=parseInt(t.paddingLeft,10)||0,f.paddingRight=parseInt(t.paddingRight,10)||0,f.paddingTop=parseInt(t.paddingTop,10)||0,f.paddingBottom=parseInt(t.paddingBottom,10)||0),f}function sD(n,e=!1,t){let i=t?n.getBoundingClientRect():mp(n),r=DL(n,e),o={left:i.left+r.borderLeft+r.scrollbarLeft,right:i.right-r.borderRight-r.scrollbarRight,top:i.top+r.borderTop,bottom:i.bottom-r.borderBottom-r.scrollbarBottom};return e&&(o.left+=r.paddingLeft,o.right-=r.paddingRight,o.top+=r.paddingTop,o.bottom-=r.paddingBottom),o}function mp(n){let e=n.getBoundingClientRect();return{left:e.left+window.scrollX,top:e.top+window.scrollY,right:e.right+window.scrollX,bottom:e.bottom+window.scrollY}}function Cq(n){let e=$_(n),t=n.getBoundingClientRect();for(let i of e){let r=H_(t,i.getBoundingClientRect());if(r)t=r;else return null}return t}function $_(n){let e=[];for(;n instanceof HTMLElement;){let t=window.getComputedStyle(n);if(t.position==="fixed")break;/(auto|scroll)/.test(t.overflow+t.overflowY+t.overflowX)&&e.push(n),n=n.parentNode}return e}var Rr=class{constructor(e,t,i,r){this.els=t;let o=this.originClientRect=e.getBoundingClientRect();i&&this.buildElHorizontals(o.left),r&&this.buildElVerticals(o.top)}buildElHorizontals(e){let t=[],i=[];for(let r of this.els){let o=r.getBoundingClientRect();t.push(o.left-e),i.push(o.right-e)}this.lefts=t,this.rights=i}buildElVerticals(e){let t=[],i=[];for(let r of this.els){let o=r.getBoundingClientRect();t.push(o.top-e),i.push(o.bottom-e)}this.tops=t,this.bottoms=i}leftToIndex(e){let{lefts:t,rights:i}=this,r=t.length,o;for(o=0;o<r;o+=1)if(e>=t[o]&&e<i[o])return o}topToIndex(e){let{tops:t,bottoms:i}=this,r=t.length,o;for(o=0;o<r;o+=1)if(e>=t[o]&&e<i[o])return o}getWidth(e){return this.rights[e]-this.lefts[e]}getHeight(e){return this.bottoms[e]-this.tops[e]}similarTo(e){return f_(this.tops||[],e.tops||[])&&f_(this.bottoms||[],e.bottoms||[])&&f_(this.lefts||[],e.lefts||[])&&f_(this.rights||[],e.rights||[])}};function f_(n,e){let t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(Math.round(n[i])!==Math.round(e[i]))return!1;return!0}var Xa=class{getMaxScrollTop(){return this.getScrollHeight()-this.getClientHeight()}getMaxScrollLeft(){return this.getScrollWidth()-this.getClientWidth()}canScrollVertically(){return this.getMaxScrollTop()>0}canScrollHorizontally(){return this.getMaxScrollLeft()>0}canScrollUp(){return this.getScrollTop()>0}canScrollDown(){return this.getScrollTop()<this.getMaxScrollTop()}canScrollLeft(){return this.getScrollLeft()>0}canScrollRight(){return this.getScrollLeft()<this.getMaxScrollLeft()}},Qf=class extends Xa{constructor(e){super(),this.el=e}getScrollTop(){return this.el.scrollTop}getScrollLeft(){return this.el.scrollLeft}setScrollTop(e){this.el.scrollTop=e}setScrollLeft(e){this.el.scrollLeft=e}getScrollWidth(){return this.el.scrollWidth}getScrollHeight(){return this.el.scrollHeight}getClientHeight(){return this.el.clientHeight}getClientWidth(){return this.el.clientWidth}},Kf=class extends Xa{getScrollTop(){return window.scrollY}getScrollLeft(){return window.scrollX}setScrollTop(e){window.scroll(window.scrollX,e)}setScrollLeft(e){window.scroll(e,window.scrollY)}getScrollWidth(){return document.documentElement.scrollWidth}getScrollHeight(){return document.documentElement.scrollHeight}getClientHeight(){return document.documentElement.clientHeight}getClientWidth(){return document.documentElement.clientWidth}},li=class extends Ke{constructor(){super(...arguments),this.uid=$o()}prepareHits(){}queryHit(e,t,i,r){return null}isValidSegDownEl(e){return!this.props.eventDrag&&!this.props.eventResize&&!yn(e,".fc-event-mirror")}isValidDateDownEl(e){return!yn(e,".fc-event:not(.fc-bg-event)")&&!yn(e,".fc-more-link")&&!yn(e,"a[data-navlink]")&&!yn(e,".fc-popover")}};var el=class{constructor(e=t=>t.thickness||1){this.getEntryThickness=e,this.strictOrder=!1,this.allowReslicing=!1,this.maxCoord=-1,this.maxStackCnt=-1,this.levelCoords=[],this.entriesByLevel=[],this.stackCnts={}}addSegs(e){let t=[];for(let i of e)this.insertEntry(i,t);return t}insertEntry(e,t){let i=this.findInsertion(e);this.isInsertionValid(i,e)?this.insertEntryAt(e,i):this.handleInvalidInsertion(i,e,t)}isInsertionValid(e,t){return(this.maxCoord===-1||e.levelCoord+this.getEntryThickness(t)<=this.maxCoord)&&(this.maxStackCnt===-1||e.stackCnt<this.maxStackCnt)}handleInvalidInsertion(e,t,i){if(this.allowReslicing&&e.touchingEntry){let r=Object.assign(Object.assign({},t),{span:vp(t.span,e.touchingEntry.span)});i.push(r),this.splitEntry(t,e.touchingEntry,i)}else i.push(t)}splitEntry(e,t,i){let r=e.span,o=t.span;r.start<o.start&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:r.start,end:o.start}},i),r.end>o.end&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:o.end,end:r.end}},i)}insertEntryAt(e,t){let{entriesByLevel:i,levelCoords:r}=this;t.lateral===-1?(ox(r,t.level,t.levelCoord),ox(i,t.level,[e])):ox(i[t.level],t.lateral,e),this.stackCnts[po(e)]=t.stackCnt}findInsertion(e){let{levelCoords:t,entriesByLevel:i,strictOrder:r,stackCnts:o}=this,s=t.length,l=0,c=-1,u=-1,f=null,m=0;for(let D=0;D<s;D+=1){let T=t[D];if(!r&&T>=l+this.getEntryThickness(e))break;let M=i[D],P,U=Xf(M,e.span.start,Jf),K=U[0]+U[1];for(;(P=M[K])&&P.span.start<e.span.end;){let W=T+this.getEntryThickness(P);W>l&&(l=W,f=P,c=D,u=K),W===l&&(m=Math.max(m,o[po(P)]+1)),K+=1}}let w=0;if(f)for(w=c+1;w<s&&t[w]<l;)w+=1;let b=-1;return w<s&&t[w]===l&&(b=Xf(i[w],e.span.end,Jf)[0]),{touchingLevel:c,touchingLateral:u,touchingEntry:f,stackCnt:m,levelCoord:l,level:w,lateral:b}}toRects(){let{entriesByLevel:e,levelCoords:t}=this,i=e.length,r=[];for(let o=0;o<i;o+=1){let s=e[o],l=t[o];for(let c of s)r.push(Object.assign(Object.assign({},c),{thickness:this.getEntryThickness(c),levelCoord:l}))}return r}};function Jf(n){return n.span.end}function po(n){return n.index+":"+n.span.start}function aD(n){let e=[];for(let t of n){let i=[],r={span:t.span,entries:[t]};for(let o of e)vp(o.span,r.span)?r={entries:o.entries.concat(r.entries),span:Eq(o.span,r.span)}:i.push(o);i.push(r),e=i}return e}function Eq(n,e){return{start:Math.min(n.start,e.start),end:Math.max(n.end,e.end)}}function vp(n,e){let t=Math.max(n.start,e.start),i=Math.min(n.end,e.end);return t<i?{start:t,end:i}:null}function ox(n,e,t){n.splice(e,0,t)}function Xf(n,e,t){let i=0,r=n.length;if(!r||e<t(n[i]))return[0,0];if(e>t(n[r-1]))return[r,0];for(;i<r;){let o=Math.floor(i+(r-i)/2),s=t(n[o]);if(e<s)r=o;else if(e>s)i=o+1;else return[o,1]}return[i,0]}var ep=class{constructor(e,t){this.emitter=new Wo}destroy(){}setMirrorIsVisible(e){}setMirrorNeedsRevert(e){}setAutoScrollEnabled(e){}},_p={};function IL(n,e){return!n||e>10?wt({weekday:"short"}):e>1?wt({weekday:"short",month:"numeric",day:"numeric",omitCommas:!0}):wt({weekday:"long"})}var ML="fc-col-header-cell";function TL(n){return n.text}var D_=class extends Ke{render(){let{dateEnv:e,options:t,theme:i,viewApi:r}=this.context,{props:o}=this,{date:s,dateProfile:l}=o,c=oD(s,o.todayRange,null,l),u=[ML].concat(W_(c,i)),f=e.format(s,o.dayHeaderFormat),m=!c.isDisabled&&o.colCnt>1?dl(this.context,s):{},w=e.toDate(s);e.namedTimeZoneImpl&&(w=fo(w,36e5));let b=Object.assign(Object.assign(Object.assign({date:w,view:r},o.extraRenderProps),{text:f}),c);return k(ci,{elTag:"th",elClasses:u,elAttrs:Object.assign({role:"columnheader",colSpan:o.colSpan,"data-date":c.isDisabled?void 0:lp(s)},o.extraDataAttrs),renderProps:b,generatorName:"dayHeaderContent",customGenerator:t.dayHeaderContent,defaultGenerator:TL,classNameGenerator:t.dayHeaderClassNames,didMount:t.dayHeaderDidMount,willUnmount:t.dayHeaderWillUnmount},D=>k("div",{className:"fc-scrollgrid-sync-inner"},!c.isDisabled&&k(D,{elTag:"a",elAttrs:m,elClasses:["fc-col-header-cell-cushion",o.isSticky&&"fc-sticky"]})))}},xq=wt({weekday:"long"}),I_=class extends Ke{render(){let{props:e}=this,{dateEnv:t,theme:i,viewApi:r,options:o}=this.context,s=Kt(new Date(2592e5),e.dow),l={dow:e.dow,isDisabled:!1,isFuture:!1,isPast:!1,isToday:!1,isOther:!1},c=t.format(s,e.dayHeaderFormat),u=Object.assign(Object.assign(Object.assign(Object.assign({date:s},l),{view:r}),e.extraRenderProps),{text:c});return k(ci,{elTag:"th",elClasses:[ML,...W_(l,i),...e.extraClassNames||[]],elAttrs:Object.assign({role:"columnheader",colSpan:e.colSpan},e.extraDataAttrs),renderProps:u,generatorName:"dayHeaderContent",customGenerator:o.dayHeaderContent,defaultGenerator:TL,classNameGenerator:o.dayHeaderClassNames,didMount:o.dayHeaderDidMount,willUnmount:o.dayHeaderWillUnmount},f=>k("div",{className:"fc-scrollgrid-sync-inner"},k(f,{elTag:"a",elClasses:["fc-col-header-cell-cushion",e.isSticky&&"fc-sticky"],elAttrs:{"aria-label":t.format(s,xq)}})))}},tl=class extends Ke{constructor(){super(...arguments),this.createDayHeaderFormatter=ve(Dq)}render(){let{context:e}=this,{dates:t,dateProfile:i,datesRepDistinctDays:r,renderIntro:o}=this.props,s=this.createDayHeaderFormatter(e.options.dayHeaderFormat,r,t.length);return k(Zo,{unit:"day"},(l,c)=>k("tr",{role:"row"},o&&o("day"),t.map(u=>r?k(D_,{key:u.toISOString(),date:u,dateProfile:i,todayRange:c,colCnt:t.length,dayHeaderFormat:s}):k(I_,{key:u.getUTCDay(),dow:u.getUTCDay(),dayHeaderFormat:s}))))}};function Dq(n,e,t){return n||IL(e,t)}var nl=class{constructor(e,t){let i=e.start,{end:r}=e,o=[],s=[],l=-1;for(;i<r;)t.isHiddenDay(i)?o.push(l+.5):(l+=1,o.push(l),s.push(i)),i=Kt(i,1);this.dates=s,this.indices=o,this.cnt=s.length}sliceRange(e){let t=this.getDateDayIndex(e.start),i=this.getDateDayIndex(Kt(e.end,-1)),r=Math.max(0,t),o=Math.min(this.cnt-1,i);return r=Math.ceil(r),o=Math.floor(o),r<=o?{firstIndex:r,lastIndex:o,isStart:t===r,isEnd:i===o}:null}getDateDayIndex(e){let{indices:t}=this,i=Math.floor(qo(this.dates[0],e));return i<0?t[0]-1:i>=t.length?t[t.length-1]+1:t[i]}},il=class{constructor(e,t){let{dates:i}=e,r,o,s;if(t){for(o=i[0].getUTCDay(),r=1;r<i.length&&i[r].getUTCDay()!==o;r+=1);s=Math.ceil(i.length/r)}else s=1,r=i.length;this.rowCnt=s,this.colCnt=r,this.daySeries=e,this.cells=this.buildCells(),this.headerDates=this.buildHeaderDates()}buildCells(){let e=[];for(let t=0;t<this.rowCnt;t+=1){let i=[];for(let r=0;r<this.colCnt;r+=1)i.push(this.buildCell(t,r));e.push(i)}return e}buildCell(e,t){let i=this.daySeries.dates[e*this.colCnt+t];return{key:i.toISOString(),date:i}}buildHeaderDates(){let e=[];for(let t=0;t<this.colCnt;t+=1)e.push(this.cells[0][t].date);return e}sliceRange(e){let{colCnt:t}=this,i=this.daySeries.sliceRange(e),r=[];if(i){let{firstIndex:o,lastIndex:s}=i,l=o;for(;l<=s;){let c=Math.floor(l/t),u=Math.min((c+1)*t,s+1);r.push({row:c,firstCol:l%t,lastCol:(u-1)%t,isStart:i.isStart&&l===o,isEnd:i.isEnd&&u-1===s}),l=u}}return r}},rl=class{constructor(){this.sliceBusinessHours=ve(this._sliceBusinessHours),this.sliceDateSelection=ve(this._sliceDateSpan),this.sliceEventStore=ve(this._sliceEventStore),this.sliceEventDrag=ve(this._sliceInteraction),this.sliceEventResize=ve(this._sliceInteraction),this.forceDayIfListItem=!1}sliceProps(e,t,i,r,...o){let{eventUiBases:s}=e,l=this.sliceEventStore(e.eventStore,s,t,i,...o);return{dateSelectionSegs:this.sliceDateSelection(e.dateSelection,t,i,s,r,...o),businessHourSegs:this.sliceBusinessHours(e.businessHours,t,i,r,...o),fgEventSegs:l.fg,bgEventSegs:l.bg,eventDrag:this.sliceEventDrag(e.eventDrag,s,t,i,...o),eventResize:this.sliceEventResize(e.eventResize,s,t,i,...o),eventSelection:e.eventSelection}}sliceNowDate(e,t,i,r,...o){return this._sliceDateSpan({range:{start:e,end:fo(e,1)},allDay:!1},t,i,{},r,...o)}_sliceBusinessHours(e,t,i,r,...o){return e?this._sliceEventStore(Ja(e,p_(t,!!i),r),{},t,i,...o).bg:[]}_sliceEventStore(e,t,i,r,...o){if(e){let s=C_(e,t,p_(i,!!r),r);return{bg:this.sliceEventRanges(s.bg,o),fg:this.sliceEventRanges(s.fg,o)}}return{bg:[],fg:[]}}_sliceInteraction(e,t,i,r,...o){if(!e)return null;let s=C_(e.mutatedEvents,t,p_(i,!!r),r);return{segs:this.sliceEventRanges(s.fg,o),affectedInstances:e.affectedEvents.instances,isEvent:e.isEvent}}_sliceDateSpan(e,t,i,r,o,...s){if(!e)return[];let l=p_(t,!!i),c=Pr(e.range,l);if(c){e=Object.assign(Object.assign({},e),{range:c});let u=gq(e,r,o),f=this.sliceRange(e.range,...s);for(let m of f)m.eventRange=u;return f}return[]}sliceEventRanges(e,t){let i=[];for(let r of e)i.push(...this.sliceEventRange(r,t));return i}sliceEventRange(e,t){let i=e.range;this.forceDayIfListItem&&e.ui.display==="list-item"&&(i={start:i.start,end:Kt(i.start,1)});let r=this.sliceRange(i,...t);for(let o of r)o.eventRange=e,o.isStart=e.isStart&&o.isStart,o.isEnd=e.isEnd&&o.isEnd;return r}};function p_(n,e){let t=n.activeRange;return e?t:{start:fo(t.start,n.slotMinTime.milliseconds),end:fo(t.end,n.slotMaxTime.milliseconds-864e5)}}function q_(n,e,t){let{instances:i}=n.mutatedEvents;for(let r in i)if(!ed(e.validRange,i[r].range))return!1;return PL({eventDrag:n},t)}function lD(n,e,t){return ed(e.validRange,n.range)?PL({dateSelection:n},t):!1}function PL(n,e){let t=e.getCurrentData(),i=Object.assign({businessHours:t.businessHours,dateSelection:"",eventStore:t.eventStore,eventUiBases:t.eventUiBases,eventSelection:"",eventDrag:null,eventResize:null},n);return(e.pluginHooks.isPropsValid||AL)(i,e)}function AL(n,e,t={},i){return!(n.eventDrag&&!Iq(n,e,t,i)||n.dateSelection&&!Mq(n,e,t,i))}function Iq(n,e,t,i){let r=e.getCurrentData(),o=n.eventDrag,s=o.mutatedEvents,l=s.defs,c=s.instances,u=E_(l,o.isEvent?n.eventUiBases:{"":r.selectionConfig});i&&(u=er(u,i));let f=Q9(n.eventStore,o.affectedEvents.instances),m=f.defs,w=f.instances,b=E_(m,n.eventUiBases);for(let D in c){let T=c[D],M=T.range,P=u[T.defId],U=l[T.defId];if(!RL(P.constraints,M,f,n.businessHours,e))return!1;let{eventOverlap:K}=e.options,W=typeof K=="function"?K:null;for(let fe in w){let ce=w[fe];if(L_(M,ce.range)&&(b[ce.defId].overlap===!1&&o.isEvent||P.overlap===!1||W&&!W(new St(e,m[ce.defId],ce),new St(e,U,T))))return!1}let re=r.eventStore;for(let fe of P.allows){let ce=Object.assign(Object.assign({},t),{range:T.range,allDay:U.allDay}),le=re.defs[U.defId],ct=re.instances[D],Wt;if(le?Wt=new St(e,le,ct):Wt=new St(e,U),!fe(Zx(ce,e),Wt))return!1}}return!0}function Mq(n,e,t,i){let r=n.eventStore,o=r.defs,s=r.instances,l=n.dateSelection,c=l.range,{selectionConfig:u}=e.getCurrentData();if(i&&(u=i(u)),!RL(u.constraints,c,r,n.businessHours,e))return!1;let{selectOverlap:f}=e.options,m=typeof f=="function"?f:null;for(let w in s){let b=s[w];if(L_(c,b.range)&&(u.overlap===!1||m&&!m(new St(e,o[b.defId],b),null)))return!1}for(let w of u.allows){let b=Object.assign(Object.assign({},t),l);if(!w(Zx(b,e),null))return!1}return!0}function RL(n,e,t,i,r){for(let o of n)if(!Pq(Tq(o,e,t,i,r),e))return!1;return!0}function Tq(n,e,t,i,r){return n==="businessHours"?sx(Ja(i,e,r)):typeof n=="string"?sx(V_(t,o=>o.groupId===n)):typeof n=="object"&&n?sx(Ja(n,e,r)):[]}function sx(n){let{instances:e}=n,t=[];for(let i in e)t.push(e[i].range);return t}function Pq(n,e){for(let t of n)if(ed(t,e))return!0;return!1}var h_=/^(visible|hidden)$/,M_=class extends Ke{constructor(){super(...arguments),this.handleEl=e=>{this.el=e,Ni(this.props.elRef,e)}}render(){let{props:e}=this,{liquid:t,liquidIsAbsolute:i}=e,r=t&&i,o=["fc-scroller"];return t&&(i?o.push("fc-scroller-liquid-absolute"):o.push("fc-scroller-liquid")),k("div",{ref:this.handleEl,className:o.join(" "),style:{overflowX:e.overflowX,overflowY:e.overflowY,left:r&&-(e.overcomeLeft||0)||"",right:r&&-(e.overcomeRight||0)||"",bottom:r&&-(e.overcomeBottom||0)||"",marginLeft:!r&&-(e.overcomeLeft||0)||"",marginRight:!r&&-(e.overcomeRight||0)||"",marginBottom:!r&&-(e.overcomeBottom||0)||"",maxHeight:e.maxHeight||""}},e.children)}needsXScrolling(){if(h_.test(this.props.overflowX))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().width-this.getYScrollbarWidth(),{children:i}=e;for(let r=0;r<i.length;r+=1)if(i[r].getBoundingClientRect().width>t)return!0;return!1}needsYScrolling(){if(h_.test(this.props.overflowY))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().height-this.getXScrollbarWidth(),{children:i}=e;for(let r=0;r<i.length;r+=1)if(i[r].getBoundingClientRect().height>t)return!0;return!1}getXScrollbarWidth(){return h_.test(this.props.overflowX)?0:this.el.offsetHeight-this.el.clientHeight}getYScrollbarWidth(){return h_.test(this.props.overflowY)?0:this.el.offsetWidth-this.el.clientWidth}},Ei=class{constructor(e){this.masterCallback=e,this.currentMap={},this.depths={},this.callbackMap={},this.handleValue=(t,i)=>{let{depths:r,currentMap:o}=this,s=!1,l=!1;t!==null?(s=i in o,o[i]=t,r[i]=(r[i]||0)+1,l=!0):(r[i]-=1,r[i]||(delete o[i],delete this.callbackMap[i],s=!0)),this.masterCallback&&(s&&this.masterCallback(null,String(i)),l&&this.masterCallback(t,String(i)))}}createRef(e){let t=this.callbackMap[e];return t||(t=this.callbackMap[e]=i=>{this.handleValue(i,String(e))}),t}collect(e,t,i){return aL(this.currentMap,e,t,i)}getAll(){return N_(this.currentMap)}};function kL(n){let e=Q2(n,".fc-scrollgrid-shrink"),t=0;for(let i of e)t=Math.max(t,G$(i));return Math.ceil(t)}function cD(n,e){return n.liquid&&e.liquid}function OL(n,e){return e.maxHeight!=null||cD(n,e)}function NL(n,e,t,i){let{expandRows:r}=t;return typeof e.content=="function"?e.content(t):k("table",{role:"presentation",className:[e.tableClassName,n.syncRowHeights?"fc-scrollgrid-sync-table":""].join(" "),style:{minWidth:t.tableMinWidth,width:t.clientWidth,height:r?t.clientHeight:""}},t.tableColGroupNode,k(i?"thead":"tbody",{role:"presentation"},typeof e.rowContent=="function"?e.rowContent(t):e.rowContent))}function LL(n,e){return ho(n,e,Ci)}function FL(n,e){let t=[];for(let i of n){let r=i.span||1;for(let o=0;o<r;o+=1)t.push(k("col",{style:{width:i.width==="shrink"?zL(e):i.width||"",minWidth:i.minWidth||""}}))}return k("colgroup",{},...t)}function zL(n){return n??4}function VL(n){for(let e of n)if(e.width==="shrink")return!0;return!1}function jL(n,e){let t=["fc-scrollgrid",e.theme.getClass("table")];return n&&t.push("fc-scrollgrid-liquid"),t}function BL(n,e){let t=["fc-scrollgrid-section",`fc-scrollgrid-section-${n.type}`,n.className];return e&&n.liquid&&n.maxHeight==null&&t.push("fc-scrollgrid-section-liquid"),n.isSticky&&t.push("fc-scrollgrid-section-sticky"),t}function id(n){return k("div",{className:"fc-scrollgrid-sticky-shim",style:{width:n.clientWidth,minWidth:n.tableMinWidth}})}function ul(n){let{stickyHeaderDates:e}=n;return(e==null||e==="auto")&&(e=n.height==="auto"||n.viewHeight==="auto"),e}function yp(n){let{stickyFooterScrollbar:e}=n;return(e==null||e==="auto")&&(e=n.height==="auto"||n.viewHeight==="auto"),e}var As=class extends Ke{constructor(){super(...arguments),this.processCols=ve(e=>e,LL),this.renderMicroColGroup=ve(FL),this.scrollerRefs=new Ei,this.scrollerElRefs=new Ei(this._handleScrollerEl.bind(this)),this.state={shrinkWidth:null,forceYScrollbars:!1,scrollerClientWidths:{},scrollerClientHeights:{}},this.handleSizing=()=>{this.safeSetState(Object.assign({shrinkWidth:this.computeShrinkWidth()},this.computeScrollerDims()))}}render(){let{props:e,state:t,context:i}=this,r=e.sections||[],o=this.processCols(e.cols),s=this.renderMicroColGroup(o,t.shrinkWidth),l=jL(e.liquid,i);e.collapsibleWidth&&l.push("fc-scrollgrid-collapsible");let c=r.length,u=0,f,m=[],w=[],b=[];for(;u<c&&(f=r[u]).type==="header";)m.push(this.renderSection(f,s,!0)),u+=1;for(;u<c&&(f=r[u]).type==="body";)w.push(this.renderSection(f,s,!1)),u+=1;for(;u<c&&(f=r[u]).type==="footer";)b.push(this.renderSection(f,s,!0)),u+=1;let D=!eD(),T={role:"rowgroup"};return k("table",{role:"grid",className:l.join(" "),style:{height:e.height}},!!(!D&&m.length)&&k("thead",T,...m),!!(!D&&w.length)&&k("tbody",T,...w),!!(!D&&b.length)&&k("tfoot",T,...b),D&&k("tbody",T,...m,...w,...b))}renderSection(e,t,i){return"outerContent"in e?k(Xe,{key:e.key},e.outerContent):k("tr",{key:e.key,role:"presentation",className:BL(e,this.props.liquid).join(" ")},this.renderChunkTd(e,t,e.chunk,i))}renderChunkTd(e,t,i,r){if("outerContent"in i)return i.outerContent;let{props:o}=this,{forceYScrollbars:s,scrollerClientWidths:l,scrollerClientHeights:c}=this.state,u=OL(o,e),f=cD(o,e),m=o.liquid?s?"scroll":u?"auto":"hidden":"visible",w=e.key,b=NL(e,i,{tableColGroupNode:t,tableMinWidth:"",clientWidth:!o.collapsibleWidth&&l[w]!==void 0?l[w]:null,clientHeight:c[w]!==void 0?c[w]:null,expandRows:e.expandRows,syncRowHeights:!1,rowSyncHeights:[],reportRowHeightChange:()=>{}},r);return k(r?"th":"td",{ref:i.elRef,role:"presentation"},k("div",{className:`fc-scroller-harness${f?" fc-scroller-harness-liquid":""}`},k(M_,{ref:this.scrollerRefs.createRef(w),elRef:this.scrollerElRefs.createRef(w),overflowY:m,overflowX:o.liquid?"hidden":"visible",maxHeight:e.maxHeight,liquid:f,liquidIsAbsolute:!0},b)))}_handleScrollerEl(e,t){let i=Aq(this.props.sections,t);i&&Ni(i.chunk.scrollerElRef,e)}componentDidMount(){this.handleSizing(),this.context.addResizeHandler(this.handleSizing)}componentDidUpdate(){this.handleSizing()}componentWillUnmount(){this.context.removeResizeHandler(this.handleSizing)}computeShrinkWidth(){return VL(this.props.cols)?kL(this.scrollerElRefs.getAll()):0}computeScrollerDims(){let e=EL(),{scrollerRefs:t,scrollerElRefs:i}=this,r=!1,o={},s={};for(let l in t.currentMap){let c=t.currentMap[l];if(c&&c.needsYScrolling()){r=!0;break}}for(let l of this.props.sections){let c=l.key,u=i.currentMap[c];if(u){let f=u.parentNode;o[c]=Math.floor(f.getBoundingClientRect().width-(r?e.y:0)),s[c]=Math.floor(f.getBoundingClientRect().height)}}return{forceYScrollbars:r,scrollerClientWidths:o,scrollerClientHeights:s}}};As.addStateEquality({scrollerClientWidths:Ci,scrollerClientHeights:Ci});function Aq(n,e){for(let t of n)if(t.key===e)return t;return null}var ol=class extends Ke{constructor(){super(...arguments),this.buildPublicEvent=ve((e,t,i)=>new St(e,t,i)),this.handleEl=e=>{this.el=e,Ni(this.props.elRef,e),e&&W2(e,this.props.seg)}}render(){let{props:e,context:t}=this,{options:i}=t,{seg:r}=e,{eventRange:o}=r,{ui:s}=o,l={event:this.buildPublicEvent(t,o.def,o.instance),view:t.viewApi,timeText:e.timeText,textColor:s.textColor,backgroundColor:s.backgroundColor,borderColor:s.borderColor,isDraggable:!e.disableDragging&&sq(r,t),isStartResizable:!e.disableResizing&&aq(r,t),isEndResizable:!e.disableResizing&&lq(r),isMirror:!!(e.isDragging||e.isResizing||e.isDateSelecting),isStart:!!r.isStart,isEnd:!!r.isEnd,isPast:!!e.isPast,isFuture:!!e.isFuture,isToday:!!e.isToday,isSelected:!!e.isSelected,isDragging:!!e.isDragging,isResizing:!!e.isResizing};return k(ci,{elRef:this.handleEl,elTag:e.elTag,elAttrs:e.elAttrs,elClasses:[...cq(l),...r.eventRange.ui.classNames,...e.elClasses||[]],elStyle:e.elStyle,renderProps:l,generatorName:"eventContent",customGenerator:i.eventContent,defaultGenerator:e.defaultGenerator,classNameGenerator:i.eventClassNames,didMount:i.eventDidMount,willUnmount:i.eventWillUnmount},e.children)}componentDidUpdate(e){this.el&&this.props.seg!==e.seg&&W2(this.el,this.props.seg)}},Rs=class extends Ke{render(){let{props:e,context:t}=this,{options:i}=t,{seg:r}=e,{ui:o}=r.eventRange,s=i.eventTimeFormat||e.defaultTimeFormat,l=B_(r,s,t,e.defaultDisplayEventTime,e.defaultDisplayEventEnd);return k(ol,Object.assign({},e,{elTag:"a",elStyle:{borderColor:o.borderColor,backgroundColor:o.backgroundColor},elAttrs:U_(r,t),defaultGenerator:Rq,timeText:l}),(c,u)=>k(Xe,null,k(c,{elTag:"div",elClasses:["fc-event-main"],elStyle:{color:u.textColor}}),!!u.isStartResizable&&k("div",{className:"fc-event-resizer fc-event-resizer-start"}),!!u.isEndResizable&&k("div",{className:"fc-event-resizer fc-event-resizer-end"})))}};Rs.addPropsEquality({seg:Ci});function Rq(n){return k("div",{className:"fc-event-main-frame"},n.timeText&&k("div",{className:"fc-event-time"},n.timeText),k("div",{className:"fc-event-title-container"},k("div",{className:"fc-event-title fc-sticky"},n.event.title||k(Xe,null,"\xA0"))))}var bp=n=>k(tr.Consumer,null,e=>{let{options:t}=e,i={isAxis:n.isAxis,date:e.dateEnv.toDate(n.date),view:e.viewApi};return k(ci,{elRef:n.elRef,elTag:n.elTag||"div",elAttrs:n.elAttrs,elClasses:n.elClasses,elStyle:n.elStyle,renderProps:i,generatorName:"nowIndicatorContent",customGenerator:t.nowIndicatorContent,classNameGenerator:t.nowIndicatorClassNames,didMount:t.nowIndicatorDidMount,willUnmount:t.nowIndicatorWillUnmount},n.children)}),kq=wt({day:"numeric"}),ks=class extends Ke{constructor(){super(...arguments),this.refineRenderProps=Xc(Oq)}render(){let{props:e,context:t}=this,{options:i}=t,r=this.refineRenderProps({date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,isMonthStart:e.isMonthStart||!1,showDayNumber:e.showDayNumber,extraRenderProps:e.extraRenderProps,viewApi:t.viewApi,dateEnv:t.dateEnv,monthStartFormat:i.monthStartFormat});return k(ci,{elRef:e.elRef,elTag:e.elTag,elAttrs:Object.assign(Object.assign({},e.elAttrs),r.isDisabled?{}:{"data-date":lp(e.date)}),elClasses:[...W_(r,t.theme),...e.elClasses||[]],elStyle:e.elStyle,renderProps:r,generatorName:"dayCellContent",customGenerator:i.dayCellContent,defaultGenerator:e.defaultGenerator,classNameGenerator:r.isDisabled?void 0:i.dayCellClassNames,didMount:i.dayCellDidMount,willUnmount:i.dayCellWillUnmount},e.children)}};function rd(n){return!!(n.dayCellContent||hx("dayCellContent",n))}function Oq(n){let{date:e,dateEnv:t,dateProfile:i,isMonthStart:r}=n,o=oD(e,n.todayRange,null,i),s=n.showDayNumber?t.format(e,r?n.monthStartFormat:kq):"";return Object.assign(Object.assign(Object.assign({date:t.toDate(e),view:n.viewApi},o),{isMonthStart:r,dayNumberText:s}),n.extraRenderProps)}var sl=class extends Ke{render(){let{props:e}=this,{seg:t}=e;return k(ol,{elTag:"div",elClasses:["fc-bg-event"],elStyle:{backgroundColor:t.eventRange.ui.backgroundColor},defaultGenerator:Nq,seg:t,timeText:"",isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,isPast:e.isPast,isFuture:e.isFuture,isToday:e.isToday,disableDragging:!0,disableResizing:!0})}};function Nq(n){let{title:e}=n.event;return e&&k("div",{className:"fc-event-title"},n.event.title)}function wp(n){return k("div",{className:`fc-${n}`})}var Sp=n=>k(tr.Consumer,null,e=>{let{dateEnv:t,options:i}=e,{date:r}=n,o=i.weekNumberFormat||n.defaultFormat,s=t.computeWeekNumber(r),l=t.format(r,o),c={num:s,text:l,date:r};return k(ci,{elRef:n.elRef,elTag:n.elTag,elAttrs:n.elAttrs,elClasses:n.elClasses,elStyle:n.elStyle,renderProps:c,generatorName:"weekNumberContent",customGenerator:i.weekNumberContent,defaultGenerator:Lq,classNameGenerator:i.weekNumberClassNames,didMount:i.weekNumberDidMount,willUnmount:i.weekNumberWillUnmount},n.children)});function Lq(n){return n.text}var ax=10,mx=class extends Ke{constructor(){super(...arguments),this.state={titleId:cl()},this.handleRootEl=e=>{this.rootEl=e,this.props.elRef&&Ni(this.props.elRef,e)},this.handleDocumentMouseDown=e=>{let t=T_(e);this.rootEl.contains(t)||this.handleCloseClick()},this.handleDocumentKeyDown=e=>{e.key==="Escape"&&this.handleCloseClick()},this.handleCloseClick=()=>{let{onClose:e}=this.props;e&&e()}}render(){let{theme:e,options:t}=this.context,{props:i,state:r}=this,o=["fc-popover",e.getClass("popover")].concat(i.extraClassNames||[]);return R2(k("div",Object.assign({},i.extraAttrs,{id:i.id,className:o.join(" "),"aria-labelledby":r.titleId,ref:this.handleRootEl}),k("div",{className:"fc-popover-header "+e.getClass("popoverHeader")},k("span",{className:"fc-popover-title",id:r.titleId},i.title),k("span",{className:"fc-popover-close "+e.getIconClass("close"),title:t.closeHint,onClick:this.handleCloseClick})),k("div",{className:"fc-popover-body "+e.getClass("popoverContent")},i.children)),i.parentEl)}componentDidMount(){document.addEventListener("mousedown",this.handleDocumentMouseDown),document.addEventListener("keydown",this.handleDocumentKeyDown),this.updateSize()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleDocumentMouseDown),document.removeEventListener("keydown",this.handleDocumentKeyDown)}updateSize(){let{isRtl:e}=this.context,{alignmentEl:t,alignGridTop:i}=this.props,{rootEl:r}=this,o=Cq(t);if(o){let s=r.getBoundingClientRect(),l=i?yn(t,".fc-scrollgrid").getBoundingClientRect().top:o.top,c=e?o.right-s.width:o.left;l=Math.max(l,ax),c=Math.min(c,document.documentElement.clientWidth-ax-s.width),c=Math.max(c,ax);let u=r.offsetParent.getBoundingClientRect();ll(r,{top:l-u.top,left:c-u.left})}}},vx=class extends li{constructor(){super(...arguments),this.handleRootEl=e=>{this.rootEl=e,e?this.context.registerInteractiveComponent(this,{el:e,useEventCenter:!1}):this.context.unregisterInteractiveComponent(this)}}render(){let{options:e,dateEnv:t}=this.context,{props:i}=this,{startDate:r,todayRange:o,dateProfile:s}=i,l=t.format(r,e.dayPopoverFormat);return k(ks,{elRef:this.handleRootEl,date:r,dateProfile:s,todayRange:o},(c,u,f)=>k(mx,{elRef:f.ref,id:i.id,title:l,extraClassNames:["fc-more-popover"].concat(f.className||[]),extraAttrs:f,parentEl:i.parentEl,alignmentEl:i.alignmentEl,alignGridTop:i.alignGridTop,onClose:i.onClose},rd(e)&&k(c,{elTag:"div",elClasses:["fc-more-popover-misc"]}),i.children))}queryHit(e,t,i,r){let{rootEl:o,props:s}=this;return e>=0&&e<i&&t>=0&&t<r?{dateProfile:s.dateProfile,dateSpan:Object.assign({allDay:!s.forceTimed,range:{start:s.startDate,end:s.endDate}},s.extraDateSpan),dayEl:o,rect:{left:0,top:0,right:i,bottom:r},layer:1}:null}},al=class extends Ke{constructor(){super(...arguments),this.state={isPopoverOpen:!1,popoverId:cl()},this.handleLinkEl=e=>{this.linkEl=e,this.props.elRef&&Ni(this.props.elRef,e)},this.handleClick=e=>{let{props:t,context:i}=this,{moreLinkClick:r}=i.options,o=$2(t).start;function s(l){let{def:c,instance:u,range:f}=l.eventRange;return{event:new St(i,c,u),start:i.dateEnv.toDate(f.start),end:i.dateEnv.toDate(f.end),isStart:l.isStart,isEnd:l.isEnd}}typeof r=="function"&&(r=r({date:o,allDay:!!t.allDayDate,allSegs:t.allSegs.map(s),hiddenSegs:t.hiddenSegs.map(s),jsEvent:e,view:i.viewApi})),!r||r==="popover"?this.setState({isPopoverOpen:!0}):typeof r=="string"&&i.calendarApi.zoomTo(o,r)},this.handlePopoverClose=()=>{this.setState({isPopoverOpen:!1})}}render(){let{props:e,state:t}=this;return k(tr.Consumer,null,i=>{let{viewApi:r,options:o,calendarApi:s}=i,{moreLinkText:l}=o,{moreCnt:c}=e,u=$2(e),f=typeof l=="function"?l.call(s,c):`+${c} ${l}`,m=Jc(o.moreLinkHint,[c],f),w={num:c,shortText:`+${c}`,text:f,view:r};return k(Xe,null,!!e.moreCnt&&k(ci,{elTag:e.elTag||"a",elRef:this.handleLinkEl,elClasses:[...e.elClasses||[],"fc-more-link"],elStyle:e.elStyle,elAttrs:Object.assign(Object.assign(Object.assign({},e.elAttrs),J2(this.handleClick)),{title:m,"aria-expanded":t.isPopoverOpen,"aria-controls":t.isPopoverOpen?t.popoverId:""}),renderProps:w,generatorName:"moreLinkContent",customGenerator:o.moreLinkContent,defaultGenerator:e.defaultGenerator||Fq,classNameGenerator:o.moreLinkClassNames,didMount:o.moreLinkDidMount,willUnmount:o.moreLinkWillUnmount},e.children),t.isPopoverOpen&&k(vx,{id:t.popoverId,startDate:u.start,endDate:u.end,dateProfile:e.dateProfile,todayRange:e.todayRange,extraDateSpan:e.extraDateSpan,parentEl:this.parentEl,alignmentEl:e.alignmentElRef?e.alignmentElRef.current:this.linkEl,alignGridTop:e.alignGridTop,forceTimed:e.forceTimed,onClose:this.handlePopoverClose},e.popoverContent()))})}componentDidMount(){this.updateParentEl()}componentDidUpdate(){this.updateParentEl()}updateParentEl(){this.linkEl&&(this.parentEl=yn(this.linkEl,".fc-view-harness"))}};function Fq(n){return n.text}function $2(n){if(n.allDayDate)return{start:n.allDayDate,end:Kt(n.allDayDate,1)};let{hiddenSegs:e}=n;return{start:G_(e),end:Vq(e)}}function G_(n){return n.reduce(zq).eventRange.range.start}function zq(n,e){return n.eventRange.range.start<e.eventRange.range.start?n:e}function Vq(n){return n.reduce(jq).eventRange.range.end}function jq(n,e){return n.eventRange.range.end>e.eventRange.range.end?n:e}var _x=class{constructor(){this.handlers=[]}set(e){this.currentValue=e;for(let t of this.handlers)t(e)}subscribe(e){this.handlers.push(e),this.currentValue!==void 0&&e(this.currentValue)}},tp=class extends _x{constructor(){super(...arguments),this.map=new Map}handle(e){let{map:t}=this,i=!1;e.isActive?(t.set(e.id,e),i=!0):t.has(e.id)&&(t.delete(e.id),i=!0),i&&this.set(t)}};var Bq=[],ZL={code:"en",week:{dow:0,doy:4},direction:"ltr",buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day",list:"list"},weekText:"W",weekTextLong:"Week",closeHint:"Close",timeHint:"Time",eventHint:"Event",allDayText:"all-day",moreLinkText:"more",noEventsText:"No events to display"},YL=Object.assign(Object.assign({},ZL),{buttonHints:{prev:"Previous $0",next:"Next $0",today(n,e){return e==="day"?"Today":`This ${n}`}},viewHint:"$0 view",navLinkHint:"Go to $0",moreLinkHint(n){return`Show ${n} more event${n===1?"":"s"}`}});function Uq(n){let e=n.length>0?n[0].code:"en",t=Bq.concat(n),i={en:YL};for(let r of t)i[r.code]=r;return{map:i,defaultCode:e}}function QL(n,e){return typeof n=="object"&&!Array.isArray(n)?KL(n.code,[n.code],n):Hq(n,e)}function Hq(n,e){let t=[].concat(n||[]),i=Wq(t,e)||YL;return KL(n,t,i)}function Wq(n,e){for(let t=0;t<n.length;t+=1){let i=n[t].toLocaleLowerCase().split("-");for(let r=i.length;r>0;r-=1){let o=i.slice(0,r).join("-");if(e[o])return e[o]}}return null}function KL(n,e,t){let i=O_([ZL,t],["buttonText"]);delete i.code;let{week:r}=i;return delete i.week,{codeArg:n,codes:e,week:r,simpleNumberFormat:new Intl.NumberFormat(n),options:i}}function nr(n){return{id:$o(),name:n.name,premiumReleaseDate:n.premiumReleaseDate?new Date(n.premiumReleaseDate):void 0,deps:n.deps||[],reducers:n.reducers||[],isLoadingFuncs:n.isLoadingFuncs||[],contextInit:[].concat(n.contextInit||[]),eventRefiners:n.eventRefiners||{},eventDefMemberAdders:n.eventDefMemberAdders||[],eventSourceRefiners:n.eventSourceRefiners||{},isDraggableTransformers:n.isDraggableTransformers||[],eventDragMutationMassagers:n.eventDragMutationMassagers||[],eventDefMutationAppliers:n.eventDefMutationAppliers||[],dateSelectionTransformers:n.dateSelectionTransformers||[],datePointTransforms:n.datePointTransforms||[],dateSpanTransforms:n.dateSpanTransforms||[],views:n.views||{},viewPropsTransformers:n.viewPropsTransformers||[],isPropsValid:n.isPropsValid||null,externalDefTransforms:n.externalDefTransforms||[],viewContainerAppends:n.viewContainerAppends||[],eventDropTransformers:n.eventDropTransformers||[],componentInteractions:n.componentInteractions||[],calendarInteractions:n.calendarInteractions||[],themeClasses:n.themeClasses||{},eventSourceDefs:n.eventSourceDefs||[],cmdFormatter:n.cmdFormatter,recurringTypes:n.recurringTypes||[],namedTimeZonedImpl:n.namedTimeZonedImpl,initialView:n.initialView||"",elementDraggingImpl:n.elementDraggingImpl,optionChangeHandlers:n.optionChangeHandlers||{},scrollGridImpl:n.scrollGridImpl||null,listenerRefiners:n.listenerRefiners||{},optionRefiners:n.optionRefiners||{},propSetHandlers:n.propSetHandlers||{}}}function $q(n,e){let t={},i={premiumReleaseDate:void 0,reducers:[],isLoadingFuncs:[],contextInit:[],eventRefiners:{},eventDefMemberAdders:[],eventSourceRefiners:{},isDraggableTransformers:[],eventDragMutationMassagers:[],eventDefMutationAppliers:[],dateSelectionTransformers:[],datePointTransforms:[],dateSpanTransforms:[],views:{},viewPropsTransformers:[],isPropsValid:null,externalDefTransforms:[],viewContainerAppends:[],eventDropTransformers:[],componentInteractions:[],calendarInteractions:[],themeClasses:{},eventSourceDefs:[],cmdFormatter:null,recurringTypes:[],namedTimeZonedImpl:null,initialView:"",elementDraggingImpl:null,optionChangeHandlers:{},scrollGridImpl:null,listenerRefiners:{},optionRefiners:{},propSetHandlers:{}};function r(o){for(let s of o){let l=s.name,c=t[l];c===void 0?(t[l]=s.id,r(s.deps),i=Gq(i,s)):c!==s.id&&console.warn(`Duplicate plugin '${l}'`)}}return n&&r(n),r(e),i}function qq(){let n=[],e=[],t;return(i,r)=>((!t||!ho(i,n)||!ho(r,e))&&(t=$q(i,r)),n=i,e=r,t)}function Gq(n,e){return{premiumReleaseDate:Zq(n.premiumReleaseDate,e.premiumReleaseDate),reducers:n.reducers.concat(e.reducers),isLoadingFuncs:n.isLoadingFuncs.concat(e.isLoadingFuncs),contextInit:n.contextInit.concat(e.contextInit),eventRefiners:Object.assign(Object.assign({},n.eventRefiners),e.eventRefiners),eventDefMemberAdders:n.eventDefMemberAdders.concat(e.eventDefMemberAdders),eventSourceRefiners:Object.assign(Object.assign({},n.eventSourceRefiners),e.eventSourceRefiners),isDraggableTransformers:n.isDraggableTransformers.concat(e.isDraggableTransformers),eventDragMutationMassagers:n.eventDragMutationMassagers.concat(e.eventDragMutationMassagers),eventDefMutationAppliers:n.eventDefMutationAppliers.concat(e.eventDefMutationAppliers),dateSelectionTransformers:n.dateSelectionTransformers.concat(e.dateSelectionTransformers),datePointTransforms:n.datePointTransforms.concat(e.datePointTransforms),dateSpanTransforms:n.dateSpanTransforms.concat(e.dateSpanTransforms),views:Object.assign(Object.assign({},n.views),e.views),viewPropsTransformers:n.viewPropsTransformers.concat(e.viewPropsTransformers),isPropsValid:e.isPropsValid||n.isPropsValid,externalDefTransforms:n.externalDefTransforms.concat(e.externalDefTransforms),viewContainerAppends:n.viewContainerAppends.concat(e.viewContainerAppends),eventDropTransformers:n.eventDropTransformers.concat(e.eventDropTransformers),calendarInteractions:n.calendarInteractions.concat(e.calendarInteractions),componentInteractions:n.componentInteractions.concat(e.componentInteractions),themeClasses:Object.assign(Object.assign({},n.themeClasses),e.themeClasses),eventSourceDefs:n.eventSourceDefs.concat(e.eventSourceDefs),cmdFormatter:e.cmdFormatter||n.cmdFormatter,recurringTypes:n.recurringTypes.concat(e.recurringTypes),namedTimeZonedImpl:e.namedTimeZonedImpl||n.namedTimeZonedImpl,initialView:n.initialView||e.initialView,elementDraggingImpl:n.elementDraggingImpl||e.elementDraggingImpl,optionChangeHandlers:Object.assign(Object.assign({},n.optionChangeHandlers),e.optionChangeHandlers),scrollGridImpl:e.scrollGridImpl||n.scrollGridImpl,listenerRefiners:Object.assign(Object.assign({},n.listenerRefiners),e.listenerRefiners),optionRefiners:Object.assign(Object.assign({},n.optionRefiners),e.optionRefiners),propSetHandlers:Object.assign(Object.assign({},n.propSetHandlers),e.propSetHandlers)}}function Zq(n,e){return n===void 0?e:e===void 0?n:new Date(Math.max(n.valueOf(),e.valueOf()))}var mo=class extends Uo{};mo.prototype.classes={root:"fc-theme-standard",tableCellShaded:"fc-cell-shaded",buttonGroup:"fc-button-group",button:"fc-button fc-button-primary",buttonActive:"fc-button-active"};mo.prototype.baseIconClass="fc-icon";mo.prototype.iconClasses={close:"fc-icon-x",prev:"fc-icon-chevron-left",next:"fc-icon-chevron-right",prevYear:"fc-icon-chevrons-left",nextYear:"fc-icon-chevrons-right"};mo.prototype.rtlIconClasses={prev:"fc-icon-chevron-right",next:"fc-icon-chevron-left",prevYear:"fc-icon-chevrons-right",nextYear:"fc-icon-chevrons-left"};mo.prototype.iconOverrideOption="buttonIcons";mo.prototype.iconOverrideCustomButtonOption="icon";mo.prototype.iconOverridePrefix="fc-icon-";function Yq(n,e){let t={},i;for(i in n)uD(i,t,n,e);for(i in e)uD(i,t,n,e);return t}function uD(n,e,t,i){if(e[n])return e[n];let r=Qq(n,e,t,i);return r&&(e[n]=r),r}function Qq(n,e,t,i){let r=t[n],o=i[n],s=f=>r&&r[f]!==null?r[f]:o&&o[f]!==null?o[f]:null,l=s("component"),c=s("superType"),u=null;if(c){if(c===n)throw new Error("Can't have a custom view type that references itself");u=uD(c,e,t,i)}return!l&&u&&(l=u.component),l?{type:n,component:l,defaults:Object.assign(Object.assign({},u?u.defaults:{}),r?r.rawOptions:{}),overrides:Object.assign(Object.assign({},u?u.overrides:{}),o?o.rawOptions:{})}:null}function UL(n){return er(n,Kq)}function Kq(n){let e=typeof n=="function"?{component:n}:n,{component:t}=e;return e.content?t=HL(e):t&&!(t.prototype instanceof Ke)&&(t=HL(Object.assign(Object.assign({},e),{content:t}))),{superType:e.type,component:t,rawOptions:e}}function HL(n){return e=>k(tr.Consumer,null,t=>k(ci,{elTag:"div",elClasses:jx(t.viewSpec),renderProps:Object.assign(Object.assign({},e),{nextDayThreshold:t.options.nextDayThreshold}),generatorName:void 0,customGenerator:n.content,classNameGenerator:n.classNames,didMount:n.didMount,willUnmount:n.willUnmount}))}function Jq(n,e,t,i){let r=UL(n),o=UL(e.views),s=Yq(r,o);return er(s,l=>Xq(l,o,e,t,i))}function Xq(n,e,t,i,r){let o=n.overrides.duration||n.defaults.duration||i.duration||t.duration,s=null,l="",c="",u={};if(o&&(s=eG(o),s)){let w=jf(s);l=w.unit,w.value===1&&(c=l,u=e[l]?e[l].rawOptions:{})}let f=w=>{let b=w.buttonText||{},D=n.defaults.buttonTextKey;return D!=null&&b[D]!=null?b[D]:b[n.type]!=null?b[n.type]:b[c]!=null?b[c]:null},m=w=>{let b=w.buttonHints||{},D=n.defaults.buttonTextKey;return D!=null&&b[D]!=null?b[D]:b[n.type]!=null?b[n.type]:b[c]!=null?b[c]:null};return{type:n.type,component:n.component,duration:s,durationUnit:l,singleUnit:c,optionDefaults:n.defaults,optionOverrides:Object.assign(Object.assign({},u),n.overrides),buttonTextOverride:f(i)||f(t)||n.overrides.buttonText,buttonTextDefault:f(r)||n.defaults.buttonText||f(Os)||n.type,buttonTitleOverride:m(i)||m(t)||n.overrides.buttonHint,buttonTitleDefault:m(r)||n.defaults.buttonHint||m(Os)}}var WL={};function eG(n){let e=JSON.stringify(n),t=WL[e];return t===void 0&&(t=qe(n),WL[e]=t),t}function tG(n,e){switch(e.type){case"CHANGE_VIEW_TYPE":n=e.viewType}return n}function nG(n,e){switch(e.type){case"CHANGE_DATE":return e.dateMarker;default:return n}}function iG(n,e,t){let i=n.initialDate;return i!=null?e.createMarker(i):t.getDateMarker()}function rG(n,e){switch(e.type){case"SET_OPTION":return Object.assign(Object.assign({},n),{[e.optionName]:e.rawOptionValue});default:return n}}function oG(n,e,t,i){let r;switch(e.type){case"CHANGE_VIEW_TYPE":return i.build(e.dateMarker||t);case"CHANGE_DATE":return i.build(e.dateMarker);case"PREV":if(r=i.buildPrev(n,t),r.isValid)return r;break;case"NEXT":if(r=i.buildNext(n,t),r.isValid)return r;break}return n}function sG(n,e,t){let i=e?e.activeRange:null;return XL({},pG(n,t),i,t)}function aG(n,e,t,i){let r=t?t.activeRange:null;switch(e.type){case"ADD_EVENT_SOURCES":return XL(n,e.sources,r,i);case"REMOVE_EVENT_SOURCE":return cG(n,e.sourceId);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return t?eF(n,r,i):n;case"FETCH_EVENT_SOURCES":return bD(n,e.sourceIds?Fx(e.sourceIds):tF(n,i),r,e.isRefetch||!1,i);case"RECEIVE_EVENTS":case"RECEIVE_EVENT_ERROR":return fG(n,e.sourceId,e.fetchId,e.fetchRange);case"REMOVE_ALL_EVENT_SOURCES":return{};default:return n}}function lG(n,e,t){let i=e?e.activeRange:null;return bD(n,tF(n,t),i,!0,t)}function JL(n){for(let e in n)if(n[e].isFetching)return!0;return!1}function XL(n,e,t,i){let r={};for(let o of e)r[o.sourceId]=o;return t&&(r=eF(r,t,i)),Object.assign(Object.assign({},n),r)}function cG(n,e){return Bo(n,t=>t.sourceId!==e)}function eF(n,e,t){return bD(n,Bo(n,i=>dG(i,e,t)),e,!1,t)}function dG(n,e,t){return nF(n,t)?!t.options.lazyFetching||!n.fetchRange||n.isFetching||e.start<n.fetchRange.start||e.end>n.fetchRange.end:!n.latestFetchId}function bD(n,e,t,i,r){let o={};for(let s in n){let l=n[s];e[s]?o[s]=uG(l,t,i,r):o[s]=l}return o}function uG(n,e,t,i){let{options:r,calendarApi:o}=i,s=i.pluginHooks.eventSourceDefs[n.sourceDefId],l=$o();return s.fetch({eventSource:n,range:e,isRefetch:t,context:i},c=>{let{rawEvents:u}=c;r.eventSourceSuccess&&(u=r.eventSourceSuccess.call(o,u,c.response)||u),n.success&&(u=n.success.call(o,u,c.response)||u),i.dispatch({type:"RECEIVE_EVENTS",sourceId:n.sourceId,fetchId:l,fetchRange:e,rawEvents:u})},c=>{let u=!1;r.eventSourceFailure&&(r.eventSourceFailure.call(o,c),u=!0),n.failure&&(n.failure(c),u=!0),u||console.warn(c.message,c),i.dispatch({type:"RECEIVE_EVENT_ERROR",sourceId:n.sourceId,fetchId:l,fetchRange:e,error:c})}),Object.assign(Object.assign({},n),{isFetching:!0,latestFetchId:l})}function fG(n,e,t,i){let r=n[e];return r&&t===r.latestFetchId?Object.assign(Object.assign({},n),{[e]:Object.assign(Object.assign({},r),{isFetching:!1,fetchRange:i})}):n}function tF(n,e){return Bo(n,t=>nF(t,e))}function pG(n,e){let t=$x(e),i=[].concat(n.eventSources||[]),r=[];n.initialEvents&&i.unshift(n.initialEvents),n.events&&i.unshift(n.events);for(let o of i){let s=Wx(o,e,t);s&&r.push(s)}return r}function nF(n,e){return!e.pluginHooks.eventSourceDefs[n.sourceDefId].ignoreRange}function hG(n,e){switch(e.type){case"UNSELECT_DATES":return null;case"SELECT_DATES":return e.selection;default:return n}}function gG(n,e){switch(e.type){case"UNSELECT_EVENT":return"";case"SELECT_EVENT":return e.eventInstanceId;default:return n}}function mG(n,e){let t;switch(e.type){case"UNSET_EVENT_DRAG":return null;case"SET_EVENT_DRAG":return t=e.state,{affectedEvents:t.affectedEvents,mutatedEvents:t.mutatedEvents,isEvent:t.isEvent};default:return n}}function vG(n,e){let t;switch(e.type){case"UNSET_EVENT_RESIZE":return null;case"SET_EVENT_RESIZE":return t=e.state,{affectedEvents:t.affectedEvents,mutatedEvents:t.mutatedEvents,isEvent:t.isEvent};default:return n}}function _G(n,e,t,i,r){let o=n.headerToolbar?$L(n.headerToolbar,n,e,t,i,r):null,s=n.footerToolbar?$L(n.footerToolbar,n,e,t,i,r):null;return{header:o,footer:s}}function $L(n,e,t,i,r,o){let s={},l=[],c=!1;for(let u in n){let f=n[u],m=yG(f,e,t,i,r,o);s[u]=m.widgets,l.push(...m.viewsWithButtons),c=c||m.hasTitle}return{sectionWidgets:s,viewsWithButtons:l,hasTitle:c}}function yG(n,e,t,i,r,o){let s=e.direction==="rtl",l=e.customButtons||{},c=t.buttonText||{},u=e.buttonText||{},f=t.buttonHints||{},m=e.buttonHints||{},w=n?n.split(" "):[],b=[],D=!1;return{widgets:w.map(M=>M.split(",").map(P=>{if(P==="title")return D=!0,{buttonName:P};let U,K,W,re,fe,ce;if(U=l[P])W=le=>{U.click&&U.click.call(le.target,le,le.target)},(re=i.getCustomButtonIconClass(U))||(re=i.getIconClass(P,s))||(fe=U.text),ce=U.hint||U.text;else if(K=r[P]){b.push(P),W=()=>{o.changeView(P)},(fe=K.buttonTextOverride)||(re=i.getIconClass(P,s))||(fe=K.buttonTextDefault);let le=K.buttonTextOverride||K.buttonTextDefault;ce=Jc(K.buttonTitleOverride||K.buttonTitleDefault||e.viewHint,[le,P],le)}else if(o[P])if(W=()=>{o[P]()},(fe=c[P])||(re=i.getIconClass(P,s))||(fe=u[P]),P==="prevYear"||P==="nextYear"){let le=P==="prevYear"?"prev":"next";ce=Jc(f[le]||m[le],[u.year||"year","year"],u[P])}else ce=le=>Jc(f[P]||m[P],[u[le]||le,le],u[P]);return{buttonName:P,buttonClick:W,buttonIcon:re,buttonText:fe,buttonHint:ce}})),viewsWithButtons:b,hasTitle:D}}var fD=class{constructor(e,t,i){this.type=e,this.getCurrentData=t,this.dateEnv=i}get calendar(){return this.getCurrentData().calendarApi}get title(){return this.getCurrentData().viewTitle}get activeStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start)}get activeEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end)}get currentStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start)}get currentEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end)}getOption(e){return this.getCurrentData().options[e]}},bG={ignoreRange:!0,parseMeta(n){return Array.isArray(n.events)?n.events:null},fetch(n,e){e({rawEvents:n.eventSource.meta})}},wG=nr({name:"array-event-source",eventSourceDefs:[bG]}),SG={parseMeta(n){return typeof n.events=="function"?n.events:null},fetch(n,e,t){let{dateEnv:i}=n.context,r=n.eventSource.meta;Jx(r.bind(null,Kx(n.range,i)),o=>e({rawEvents:o}),t)}},CG=nr({name:"func-event-source",eventSourceDefs:[SG]}),EG={method:String,extraParams:H,startParam:String,endParam:String,timeZoneParam:String},xG={parseMeta(n){return n.url&&(n.format==="json"||!n.format)?{url:n.url,format:"json",method:(n.method||"GET").toUpperCase(),extraParams:n.extraParams,startParam:n.startParam,endParam:n.endParam,timeZoneParam:n.timeZoneParam}:null},fetch(n,e,t){let{meta:i}=n.eventSource,r=IG(i,n.range,n.context);Xx(i.method,i.url,r).then(([o,s])=>{e({rawEvents:o,response:s})},t)}},DG=nr({name:"json-event-source",eventSourceRefiners:EG,eventSourceDefs:[xG]});function IG(n,e,t){let{dateEnv:i,options:r}=t,o,s,l,c,u={};return o=n.startParam,o==null&&(o=r.startParam),s=n.endParam,s==null&&(s=r.endParam),l=n.timeZoneParam,l==null&&(l=r.timeZoneParam),typeof n.extraParams=="function"?c=n.extraParams():c=n.extraParams||{},Object.assign(u,c),u[o]=i.formatIso(e.start),u[s]=i.formatIso(e.end),i.timeZone!=="local"&&(u[l]=i.timeZone),u}var MG={daysOfWeek:H,startTime:qe,endTime:qe,duration:qe,startRecur:H,endRecur:H},TG={parse(n,e){if(n.daysOfWeek||n.startTime||n.endTime||n.startRecur||n.endRecur){let t={daysOfWeek:n.daysOfWeek||null,startTime:n.startTime||null,endTime:n.endTime||null,startRecur:n.startRecur?e.createMarker(n.startRecur):null,endRecur:n.endRecur?e.createMarker(n.endRecur):null,dateEnv:e},i;return n.duration&&(i=n.duration),!i&&n.startTime&&n.endTime&&(i=iL(n.endTime,n.startTime)),{allDayGuess:!n.startTime&&!n.endTime,duration:i,typeData:t}}return null},expand(n,e,t){let i=Pr(e,{start:n.startRecur,end:n.endRecur});return i?AG(n.daysOfWeek,n.startTime,n.dateEnv,t,i):[]}},PG=nr({name:"simple-recurring-event",recurringTypes:[TG],eventRefiners:MG});function AG(n,e,t,i,r){let o=n?Fx(n):null,s=lt(r.start),l=r.end,c=[];for(e&&(e.milliseconds<0?l=Kt(l,1):e.milliseconds>=1e3*60*60*24&&(s=Kt(s,-1)));s<l;){let u;(!o||o[s.getUTCDay()])&&(e?u=i.add(s,e):u=s,c.push(i.createMarker(t.toDate(u)))),s=Kt(s,1)}return c}var RG=nr({name:"change-handler",optionChangeHandlers:{events(n,e){qL([n],e)},eventSources:qL}});function qL(n,e){let t=N_(e.getCurrentData().eventSources);if(t.length===1&&n.length===1&&Array.isArray(t[0]._raw)&&Array.isArray(n[0])){e.dispatch({type:"RESET_RAW_EVENTS",sourceId:t[0].sourceId,rawEvents:n[0]});return}let i=[];for(let r of n){let o=!1;for(let s=0;s<t.length;s+=1)if(t[s]._raw===r){t.splice(s,1),o=!0;break}o||i.push(r)}for(let r of t)e.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:r.sourceId});for(let r of i)e.calendarApi.addEventSource(r)}function kG(n,e){e.emitter.trigger("datesSet",Object.assign(Object.assign({},Kx(n.activeRange,e.dateEnv)),{view:e.viewApi}))}function OG(n,e){let{emitter:t}=e;t.hasHandlers("eventsSet")&&t.trigger("eventsSet",go(n,e))}var NG=[wG,CG,DG,PG,RG,nr({name:"misc",isLoadingFuncs:[n=>JL(n.eventSources)],propSetHandlers:{dateProfile:kG,eventStore:OG}})],pD=class{constructor(e,t){this.runTaskOption=e,this.drainedOption=t,this.queue=[],this.delayedRunner=new Qa(this.drain.bind(this))}request(e,t){this.queue.push(e),this.delayedRunner.request(t)}pause(e){this.delayedRunner.pause(e)}resume(e,t){this.delayedRunner.resume(e,t)}drain(){let{queue:e}=this;for(;e.length;){let t=[],i;for(;i=e.shift();)this.runTask(i),t.push(i);this.drained(t)}}runTask(e){this.runTaskOption&&this.runTaskOption(e)}drained(e){this.drainedOption&&this.drainedOption(e)}};function LG(n,e,t){let i;return/^(year|month)$/.test(n.currentRangeUnit)?i=n.currentRange:i=n.activeRange,t.formatRange(i.start,i.end,wt(e.titleFormat||FG(n)),{isEndExclusive:n.isRangeAllDay,defaultSeparator:e.titleRangeSeparator})}function FG(n){let{currentRangeUnit:e}=n;if(e==="year")return{year:"numeric"};if(e==="month")return{year:"numeric",month:"long"};let t=Qc(n.currentRange.start,n.currentRange.end);return t!==null&&t>1?{year:"numeric",month:"short",day:"numeric"}:{year:"numeric",month:"long",day:"numeric"}}var Z_=class{constructor(){this.resetListeners=new Set}handleInput(e,t){let i=this.dateEnv;if(e!==i&&(typeof t=="function"?this.nowFn=t:i||(this.nowAnchorDate=e.toDate(t?e.createMarker(t):e.createNowMarker()),this.nowAnchorQueried=Date.now()),this.dateEnv=e,i))for(let r of this.resetListeners.values())r()}getDateMarker(){return this.nowAnchorDate?this.dateEnv.timestampToMarker(this.nowAnchorDate.valueOf()+(Date.now()-this.nowAnchorQueried)):this.dateEnv.createMarker(this.nowFn())}addResetListener(e){this.resetListeners.add(e)}removeResetListener(e){this.resetListeners.delete(e)}},hD=class{constructor(e){this.computeCurrentViewData=ve(this._computeCurrentViewData),this.organizeRawLocales=ve(Uq),this.buildLocale=ve(QL),this.buildPluginHooks=qq(),this.buildDateEnv=ve(zG),this.buildTheme=ve(VG),this.parseToolbars=ve(_G),this.buildViewSpecs=ve(Jq),this.buildDateProfileGenerator=Xc(jG),this.buildViewApi=ve(BG),this.buildViewUiProps=Xc(WG),this.buildEventUiBySource=ve(UG,Ci),this.buildEventUiBases=ve(HG),this.parseContextBusinessHours=Xc($G),this.buildTitle=ve(LG),this.nowManager=new Z_,this.emitter=new Wo,this.actionRunner=new pD(this._handleAction.bind(this),this.updateData.bind(this)),this.currentCalendarOptionsInput={},this.currentCalendarOptionsRefined={},this.currentViewOptionsInput={},this.currentViewOptionsRefined={},this.currentCalendarOptionsRefiners={},this.optionsForRefining=[],this.optionsForHandling=[],this.getCurrentData=()=>this.data,this.dispatch=w=>{this.actionRunner.request(w)},this.props=e,this.actionRunner.pause(),this.nowManager=new Z_;let t={},i=this.computeOptionsData(e.optionOverrides,t,e.calendarApi),r=i.calendarOptions.initialView||i.pluginHooks.initialView,o=this.computeCurrentViewData(r,i,e.optionOverrides,t);e.calendarApi.currentDataManager=this,this.emitter.setThisContext(e.calendarApi),this.emitter.setOptions(o.options);let s={nowManager:this.nowManager,dateEnv:i.dateEnv,options:i.calendarOptions,pluginHooks:i.pluginHooks,calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},l=iG(i.calendarOptions,i.dateEnv,this.nowManager),c=o.dateProfileGenerator.build(l);Xi(c.activeRange,l)||(l=c.currentRange.start);for(let w of i.pluginHooks.contextInit)w(s);let u=sG(i.calendarOptions,c,s),f={dynamicOptionOverrides:t,currentViewType:r,currentDate:l,dateProfile:c,businessHours:this.parseContextBusinessHours(s),eventSources:u,eventUiBases:{},eventStore:Gn(),renderableEventStore:Gn(),dateSelection:null,eventSelection:"",eventDrag:null,eventResize:null,selectionConfig:this.buildViewUiProps(s).selectionConfig},m=Object.assign(Object.assign({},s),f);for(let w of i.pluginHooks.reducers)Object.assign(f,w(null,null,m));dD(f,s)&&this.emitter.trigger("loading",!0),this.state=f,this.updateData(),this.actionRunner.resume()}resetOptions(e,t){let{props:i}=this;t===void 0?i.optionOverrides=e:(i.optionOverrides=Object.assign(Object.assign({},i.optionOverrides||{}),e),this.optionsForRefining.push(...t)),(t===void 0||t.length)&&this.actionRunner.request({type:"NOTHING"})}_handleAction(e){let{props:t,state:i,emitter:r}=this,o=rG(i.dynamicOptionOverrides,e),s=this.computeOptionsData(t.optionOverrides,o,t.calendarApi),l=tG(i.currentViewType,e),c=this.computeCurrentViewData(l,s,t.optionOverrides,o);t.calendarApi.currentDataManager=this,r.setThisContext(t.calendarApi),r.setOptions(c.options);let u={nowManager:this.nowManager,dateEnv:s.dateEnv,options:s.calendarOptions,pluginHooks:s.pluginHooks,calendarApi:t.calendarApi,dispatch:this.dispatch,emitter:r,getCurrentData:this.getCurrentData},{currentDate:f,dateProfile:m}=i;this.data&&this.data.dateProfileGenerator!==c.dateProfileGenerator&&(m=c.dateProfileGenerator.build(f)),f=nG(f,e),m=oG(m,e,f,c.dateProfileGenerator),(e.type==="PREV"||e.type==="NEXT"||!Xi(m.currentRange,f))&&(f=m.currentRange.start);let w=aG(i.eventSources,e,m,u),b=mL(i.eventStore,e,w,m,u),T=JL(w)&&!c.options.progressiveEventRendering&&i.renderableEventStore||b,{eventUiSingleBase:M,selectionConfig:P}=this.buildViewUiProps(u),U=this.buildEventUiBySource(w),K=this.buildEventUiBases(T.defs,M,U),W={dynamicOptionOverrides:o,currentViewType:l,currentDate:f,dateProfile:m,eventSources:w,eventStore:b,renderableEventStore:T,selectionConfig:P,eventUiBases:K,businessHours:this.parseContextBusinessHours(u),dateSelection:hG(i.dateSelection,e),eventSelection:gG(i.eventSelection,e),eventDrag:mG(i.eventDrag,e),eventResize:vG(i.eventResize,e)},re=Object.assign(Object.assign({},u),W);for(let le of s.pluginHooks.reducers)Object.assign(W,le(i,e,re));let fe=dD(i,u),ce=dD(W,u);!fe&&ce?r.trigger("loading",!0):fe&&!ce&&r.trigger("loading",!1),this.state=W,t.onAction&&t.onAction(e)}updateData(){let{props:e,state:t}=this,i=this.data,r=this.computeOptionsData(e.optionOverrides,t.dynamicOptionOverrides,e.calendarApi),o=this.computeCurrentViewData(t.currentViewType,r,e.optionOverrides,t.dynamicOptionOverrides),s=this.data=Object.assign(Object.assign(Object.assign({nowManager:this.nowManager,viewTitle:this.buildTitle(t.dateProfile,o.options,r.dateEnv),calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},r),o),t),l=r.pluginHooks.optionChangeHandlers,c=i&&i.calendarOptions,u=r.calendarOptions;if(c&&c!==u){c.timeZone!==u.timeZone&&(t.eventSources=s.eventSources=lG(s.eventSources,t.dateProfile,s),t.eventStore=s.eventStore=qx(s.eventStore,i.dateEnv,s.dateEnv),t.renderableEventStore=s.renderableEventStore=qx(s.renderableEventStore,i.dateEnv,s.dateEnv));for(let f in l)(this.optionsForHandling.indexOf(f)!==-1||c[f]!==u[f])&&l[f](u[f],s)}this.optionsForHandling=[],e.onData&&e.onData(s)}computeOptionsData(e,t,i){if(!this.optionsForRefining.length&&e===this.stableOptionOverrides&&t===this.stableDynamicOptionOverrides)return this.stableCalendarOptionsData;let{refinedOptions:r,pluginHooks:o,localeDefaults:s,availableLocaleData:l,extra:c}=this.processRawCalendarOptions(e,t);GL(c);let u=this.buildDateEnv(r.timeZone,r.locale,r.weekNumberCalculation,r.firstDay,r.weekText,o,l,r.defaultRangeSeparator),f=this.buildViewSpecs(o.views,this.stableOptionOverrides,this.stableDynamicOptionOverrides,s),m=this.buildTheme(r,o),w=this.parseToolbars(r,this.stableOptionOverrides,m,f,i);return this.stableCalendarOptionsData={calendarOptions:r,pluginHooks:o,dateEnv:u,viewSpecs:f,theme:m,toolbarConfig:w,localeDefaults:s,availableRawLocales:l.map}}processRawCalendarOptions(e,t){let{locales:i,locale:r}=R_([Os,e,t]),o=this.organizeRawLocales(i),s=o.map,l=this.buildLocale(r||o.defaultCode,s).options,c=this.buildPluginHooks(e.plugins||[],NG),u=this.currentCalendarOptionsRefiners=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ox),Nx),Lx),c.listenerRefiners),c.optionRefiners),f={},m=R_([Os,l,e,t]),w={},b=this.currentCalendarOptionsInput,D=this.currentCalendarOptionsRefined,T=!1;for(let M in m)this.optionsForRefining.indexOf(M)===-1&&(m[M]===b[M]||Ns[M]&&M in b&&Ns[M](b[M],m[M]))?w[M]=D[M]:u[M]?(w[M]=u[M](m[M]),T=!0):f[M]=b[M];return T&&(this.currentCalendarOptionsInput=m,this.currentCalendarOptionsRefined=w,this.stableOptionOverrides=e,this.stableDynamicOptionOverrides=t),this.optionsForHandling.push(...this.optionsForRefining),this.optionsForRefining=[],{rawOptions:this.currentCalendarOptionsInput,refinedOptions:this.currentCalendarOptionsRefined,pluginHooks:c,availableLocaleData:o,localeDefaults:l,extra:f}}_computeCurrentViewData(e,t,i,r){let o=t.viewSpecs[e];if(!o)throw new Error(`viewType "${e}" is not available. Please make sure you've loaded all neccessary plugins`);let{refinedOptions:s,extra:l}=this.processRawViewOptions(o,t.pluginHooks,t.localeDefaults,i,r);GL(l),this.nowManager.handleInput(t.dateEnv,s.now);let c=this.buildDateProfileGenerator({dateProfileGeneratorClass:o.optionDefaults.dateProfileGeneratorClass,nowManager:this.nowManager,duration:o.duration,durationUnit:o.durationUnit,usesMinMaxTime:o.optionDefaults.usesMinMaxTime,dateEnv:t.dateEnv,calendarApi:this.props.calendarApi,slotMinTime:s.slotMinTime,slotMaxTime:s.slotMaxTime,showNonCurrentDates:s.showNonCurrentDates,dayCount:s.dayCount,dateAlignment:s.dateAlignment,dateIncrement:s.dateIncrement,hiddenDays:s.hiddenDays,weekends:s.weekends,validRangeInput:s.validRange,visibleRangeInput:s.visibleRange,fixedWeekCount:s.fixedWeekCount}),u=this.buildViewApi(e,this.getCurrentData,t.dateEnv);return{viewSpec:o,options:s,dateProfileGenerator:c,viewApi:u}}processRawViewOptions(e,t,i,r,o){let s=R_([Os,e.optionDefaults,i,r,e.optionOverrides,o]),l=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Ox),Nx),Lx),sL),t.listenerRefiners),t.optionRefiners),c={},u=this.currentViewOptionsInput,f=this.currentViewOptionsRefined,m=!1,w={};for(let b in s)s[b]===u[b]||Ns[b]&&Ns[b](s[b],u[b])?c[b]=f[b]:(s[b]===this.currentCalendarOptionsInput[b]||Ns[b]&&Ns[b](s[b],this.currentCalendarOptionsInput[b])?b in this.currentCalendarOptionsRefined&&(c[b]=this.currentCalendarOptionsRefined[b]):l[b]?c[b]=l[b](s[b]):w[b]=s[b],m=!0);return m&&(this.currentViewOptionsInput=s,this.currentViewOptionsRefined=c),{rawOptions:this.currentViewOptionsInput,refinedOptions:this.currentViewOptionsRefined,extra:w}}};function zG(n,e,t,i,r,o,s,l){let c=QL(e||s.defaultCode,s.map);return new Bf({calendarSystem:"gregory",timeZone:n,namedTimeZoneImpl:o.namedTimeZonedImpl,locale:c,weekNumberCalculation:t,firstDay:i,weekText:r,cmdFormatter:o.cmdFormatter,defaultSeparator:l})}function VG(n,e){let t=e.themeClasses[n.themeSystem]||mo;return new t(n)}function jG(n){let e=n.dateProfileGeneratorClass||Ka;return new e(n)}function BG(n,e,t){return new fD(n,e,t)}function UG(n){return er(n,e=>e.ui)}function HG(n,e,t){let i={"":e};for(let r in n){let o=n[r];o.sourceId&&t[o.sourceId]&&(i[r]=t[o.sourceId])}return i}function WG(n){let{options:e}=n;return{eventUiSingleBase:td({display:e.eventDisplay,editable:e.editable,startEditable:e.eventStartEditable,durationEditable:e.eventDurationEditable,constraint:e.eventConstraint,overlap:typeof e.eventOverlap=="boolean"?e.eventOverlap:void 0,allow:e.eventAllow,backgroundColor:e.eventBackgroundColor,borderColor:e.eventBorderColor,textColor:e.eventTextColor,color:e.eventColor},n),selectionConfig:td({constraint:e.selectConstraint,overlap:typeof e.selectOverlap=="boolean"?e.selectOverlap:void 0,allow:e.selectAllow},n)}}function dD(n,e){for(let t of e.pluginHooks.isLoadingFuncs)if(t(n))return!0;return!1}function $G(n){return Gx(n.options.businessHours,n)}function GL(n,e){for(let t in n)console.warn(`Unknown option '${t}'`+(e?` for view '${e}'`:""))}var gD=class extends Ke{render(){let e=this.props.widgetGroups.map(t=>this.renderWidgetGroup(t));return k("div",{className:"fc-toolbar-chunk"},...e)}renderWidgetGroup(e){let{props:t}=this,{theme:i}=this.context,r=[],o=!0;for(let s of e){let{buttonName:l,buttonClick:c,buttonText:u,buttonIcon:f,buttonHint:m}=s;if(l==="title")o=!1,r.push(k("h2",{className:"fc-toolbar-title",id:t.titleId},t.title));else{let w=l===t.activeButton,b=!t.isTodayEnabled&&l==="today"||!t.isPrevEnabled&&l==="prev"||!t.isNextEnabled&&l==="next",D=[`fc-${l}-button`,i.getClass("button")];w&&D.push(i.getClass("buttonActive")),r.push(k("button",{type:"button",title:typeof m=="function"?m(t.navUnit):m,disabled:b,"aria-pressed":w,className:D.join(" "),onClick:c},u||(f?k("span",{className:f,role:"img"}):"")))}}if(r.length>1){let s=o&&i.getClass("buttonGroup")||"";return k("div",{className:s},...r)}return r[0]}},Y_=class extends Ke{render(){let{model:e,extraClassName:t}=this.props,i=!1,r,o,s=e.sectionWidgets,l=s.center;return s.left?(i=!0,r=s.left):r=s.start,s.right?(i=!0,o=s.right):o=s.end,k("div",{className:[t||"","fc-toolbar",i?"fc-toolbar-ltr":""].join(" ")},this.renderSection("start",r||[]),this.renderSection("center",l||[]),this.renderSection("end",o||[]))}renderSection(e,t){let{props:i}=this;return k(gD,{key:e,widgetGroups:t,title:i.title,navUnit:i.navUnit,activeButton:i.activeButton,isTodayEnabled:i.isTodayEnabled,isPrevEnabled:i.isPrevEnabled,isNextEnabled:i.isNextEnabled,titleId:i.titleId})}},mD=class extends Ke{constructor(){super(...arguments),this.state={availableWidth:null},this.handleEl=e=>{this.el=e,Ni(this.props.elRef,e),this.updateAvailableWidth()},this.handleResize=()=>{this.updateAvailableWidth()}}render(){let{props:e,state:t}=this,{aspectRatio:i}=e,r=["fc-view-harness",i||e.liquid||e.height?"fc-view-harness-active":"fc-view-harness-passive"],o="",s="";return i?t.availableWidth!==null?o=t.availableWidth/i:s=`${1/i*100}%`:o=e.height||"",k("div",{"aria-labelledby":e.labeledById,ref:this.handleEl,className:r.join(" "),style:{height:o,paddingBottom:s}},e.children)}componentDidMount(){this.context.addResizeHandler(this.handleResize)}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}updateAvailableWidth(){this.el&&this.props.aspectRatio&&this.setState({availableWidth:this.el.offsetWidth})}},vD=class extends Ar{constructor(e){super(e),this.handleSegClick=(t,i)=>{let{component:r}=this,{context:o}=r,s=Go(i);if(s&&r.isValidSegDownEl(t.target)){let l=yn(t.target,".fc-event-forced-url"),c=l?l.querySelector("a[href]").href:"";o.emitter.trigger("eventClick",{el:i,event:new St(r.context,s.eventRange.def,s.eventRange.instance),jsEvent:t,view:o.viewApi}),c&&!t.defaultPrevented&&(window.location.href=c)}},this.destroy=wx(e.el,"click",".fc-event",this.handleSegClick)}},_D=class extends Ar{constructor(e){super(e),this.handleEventElRemove=t=>{t===this.currentSegEl&&this.handleSegLeave(null,this.currentSegEl)},this.handleSegEnter=(t,i)=>{Go(i)&&(this.currentSegEl=i,this.triggerEvent("eventMouseEnter",t,i))},this.handleSegLeave=(t,i)=>{this.currentSegEl&&(this.currentSegEl=null,this.triggerEvent("eventMouseLeave",t,i))},this.removeHoverListeners=K2(e.el,".fc-event",this.handleSegEnter,this.handleSegLeave)}destroy(){this.removeHoverListeners()}triggerEvent(e,t,i){let{component:r}=this,{context:o}=r,s=Go(i);(!t||r.isValidSegDownEl(t.target))&&o.emitter.trigger(e,{el:i,event:new St(o,s.eventRange.def,s.eventRange.instance),jsEvent:t,view:o.viewApi})}},yD=class extends cp{constructor(){super(...arguments),this.buildViewContext=ve(uL),this.buildViewPropTransformers=ve(GG),this.buildToolbarProps=ve(qG),this.headerRef=cn(),this.footerRef=cn(),this.interactionsStore={},this.state={viewLabelId:cl()},this.registerInteractiveComponent=(e,t)=>{let i=SL(e,t),s=[vD,_D].concat(this.props.pluginHooks.componentInteractions).map(l=>new l(i));this.interactionsStore[e.uid]=s,nd[e.uid]=i},this.unregisterInteractiveComponent=e=>{let t=this.interactionsStore[e.uid];if(t){for(let i of t)i.destroy();delete this.interactionsStore[e.uid]}delete nd[e.uid]},this.resizeRunner=new Qa(()=>{this.props.emitter.trigger("_resize",!0),this.props.emitter.trigger("windowResize",{view:this.props.viewApi})}),this.handleWindowResize=e=>{let{options:t}=this.props;t.handleWindowResize&&e.target===window&&this.resizeRunner.request(t.windowResizeDelay)}}render(){let{props:e}=this,{toolbarConfig:t,options:i}=e,r=!1,o="",s;e.isHeightAuto||e.forPrint?o="":i.height!=null?r=!0:i.contentHeight!=null?o=i.contentHeight:s=Math.max(i.aspectRatio,.5);let l=this.buildViewContext(e.viewSpec,e.viewApi,e.options,e.dateProfileGenerator,e.dateEnv,e.nowManager,e.theme,e.pluginHooks,e.dispatch,e.getCurrentData,e.emitter,e.calendarApi,this.registerInteractiveComponent,this.unregisterInteractiveComponent),c=t.header&&t.header.hasTitle?this.state.viewLabelId:void 0;return k(tr.Provider,{value:l},k(Zo,{unit:"day"},u=>{let f=this.buildToolbarProps(e.viewSpec,e.dateProfile,e.dateProfileGenerator,e.currentDate,u,e.viewTitle);return k(Xe,null,t.header&&k(Y_,Object.assign({ref:this.headerRef,extraClassName:"fc-header-toolbar",model:t.header,titleId:c},f)),k(mD,{liquid:r,height:o,aspectRatio:s,labeledById:c},this.renderView(e),this.buildAppendContent()),t.footer&&k(Y_,Object.assign({ref:this.footerRef,extraClassName:"fc-footer-toolbar",model:t.footer,titleId:""},f)))}))}componentDidMount(){let{props:e}=this;this.calendarInteractions=e.pluginHooks.calendarInteractions.map(i=>new i(e)),window.addEventListener("resize",this.handleWindowResize);let{propSetHandlers:t}=e.pluginHooks;for(let i in t)t[i](e[i],e)}componentDidUpdate(e){let{props:t}=this,{propSetHandlers:i}=t.pluginHooks;for(let r in i)t[r]!==e[r]&&i[r](t[r],t)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),this.resizeRunner.clear();for(let e of this.calendarInteractions)e.destroy();this.props.emitter.trigger("_unmount")}buildAppendContent(){let{props:e}=this,t=e.pluginHooks.viewContainerAppends.map(i=>i(e));return k(Xe,{},...t)}renderView(e){let{pluginHooks:t}=e,{viewSpec:i}=e,r={dateProfile:e.dateProfile,businessHours:e.businessHours,eventStore:e.renderableEventStore,eventUiBases:e.eventUiBases,dateSelection:e.dateSelection,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,isHeightAuto:e.isHeightAuto,forPrint:e.forPrint},o=this.buildViewPropTransformers(t.viewPropsTransformers);for(let l of o)Object.assign(r,l.transform(r,e));let s=i.component;return k(s,Object.assign({},r))}};function qG(n,e,t,i,r,o){let s=t.build(r,void 0,!1),l=t.buildPrev(e,i,!1),c=t.buildNext(e,i,!1);return{title:o,activeButton:n.type,navUnit:n.singleUnit,isTodayEnabled:s.isValid&&!Xi(e.currentRange,r),isPrevEnabled:l.isValid,isNextEnabled:c.isValid}}function GG(n){return n.map(e=>new e)}var Q_=class extends Zf{constructor(e,t={}){super(),this.isRendering=!1,this.isRendered=!1,this.currentClassNames=[],this.customContentRenderId=0,this.handleAction=i=>{switch(i.type){case"SET_EVENT_DRAG":case"SET_EVENT_RESIZE":this.renderRunner.tryDrain()}},this.handleData=i=>{this.currentData=i,this.renderRunner.request(i.calendarOptions.rerenderDelay)},this.handleRenderRequest=()=>{if(this.isRendering){this.isRendered=!0;let{currentData:i}=this;Uf(()=>{Ds(k(Gf,{options:i.calendarOptions,theme:i.theme,emitter:i.emitter},(r,o,s,l)=>(this.setClassNames(r),this.setHeight(o),k(Vx.Provider,{value:this.customContentRenderId},k(yD,Object.assign({isHeightAuto:s,forPrint:l},i))))),this.el)})}else this.isRendered&&(this.isRendered=!1,Ds(null,this.el),this.setClassNames([]),this.setHeight(""))},G2(e),this.el=e,this.renderRunner=new Qa(this.handleRenderRequest),new hD({optionOverrides:t,calendarApi:this,onAction:this.handleAction,onData:this.handleData})}render(){let e=this.isRendering;e?this.customContentRenderId+=1:this.isRendering=!0,this.renderRunner.request(),e&&this.updateSize()}destroy(){this.isRendering&&(this.isRendering=!1,this.renderRunner.request())}updateSize(){Uf(()=>{super.updateSize()})}batchRendering(e){this.renderRunner.pause("batchRendering"),e(),this.renderRunner.resume("batchRendering")}pauseRendering(){this.renderRunner.pause("pauseRendering")}resumeRendering(){this.renderRunner.resume("pauseRendering",!0)}resetOptions(e,t){this.currentDataManager.resetOptions(e,t)}setClassNames(e){if(!ho(e,this.currentClassNames)){let{classList:t}=this.el;for(let i of this.currentClassNames)t.remove(i);for(let i of e)t.add(i);this.currentClassNames=e}}setHeight(e){bx(this.el,"height",e)}};var YG=["*"],QG=["rootEl"],sd=n=>({$implicit:n});function KG(n,e){if(n&1&&(g(0,"div",2,0),ko(2,3),p()),n&2){let t=E();x("ngClass",t.elClasses||"")("ngStyle",t.elStyle||null),_(2),x("ngTemplateOutlet",t.template)("ngTemplateOutletContext",Wi(4,sd,t.renderProps))}}function JG(n,e){if(n&1&&(g(0,"span",2,0),ko(2,3),p()),n&2){let t=E();x("ngClass",t.elClasses||"")("ngStyle",t.elStyle||null),_(2),x("ngTemplateOutlet",t.template)("ngTemplateOutletContext",Wi(4,sd,t.renderProps))}}function XG(n,e){if(n&1&&(g(0,"a",2,0),ko(2,3),p()),n&2){let t=E();x("ngClass",t.elClasses||"")("ngStyle",t.elStyle||null),_(2),x("ngTemplateOutlet",t.template)("ngTemplateOutletContext",Wi(4,sd,t.renderProps))}}function e7(n,e){if(n&1&&(g(0,"tr",2,0),ko(2,3),p()),n&2){let t=E();x("ngClass",t.elClasses||"")("ngStyle",t.elStyle||null),_(2),x("ngTemplateOutlet",t.template)("ngTemplateOutletContext",Wi(4,sd,t.renderProps))}}function t7(n,e){if(n&1&&(g(0,"th",2,0),ko(2,3),p()),n&2){let t=E();x("ngClass",t.elClasses||"")("ngStyle",t.elStyle||null),_(2),x("ngTemplateOutlet",t.template)("ngTemplateOutletContext",Wi(4,sd,t.renderProps))}}function n7(n,e){if(n&1&&(g(0,"td",2,0),ko(2,3),p()),n&2){let t=E();x("ngClass",t.elClasses||"")("ngStyle",t.elStyle||null),_(2),x("ngTemplateOutlet",t.template)("ngTemplateOutletContext",Wi(4,sd,t.renderProps))}}var i7=["dayHeaderContent"],r7=["dayCellContent"],o7=["weekNumberContent"],s7=["nowIndicatorContent"],a7=["eventContent"],l7=["slotLaneContent"],c7=["slotLabelContent"],d7=["allDayContent"],u7=["moreLinkContent"],f7=["noEventsContent"],p7=["resourceAreaHeaderContent"],h7=["resourceGroupLabelContent"],g7=["resourceLabelContent"],m7=["resourceLaneContent"],v7=["resourceGroupLaneContent"];function _7(n,e){if(n&1&&ie(0,"transport-container",1),n&2){let t=e.$implicit;x("inPlaceOf",t.containerEl)("reportEl",t.reportNewContainerEl)("elTag",t.elTag)("elClasses",t.elClasses)("elStyle",t.elStyle)("elAttrs",t.elAttrs)("template",t.generatorMeta)("renderProps",t.renderProps)}}var iF={headerToolbar:!0,footerToolbar:!0,events:!0,eventSources:!0,resources:!0},y7=["events","eventSources","resources"],b7=Object.prototype.hasOwnProperty;function J_(n){return Array.isArray(n)?n.map(J_):n instanceof Date?new Date(n.valueOf()):typeof n=="object"&&n?oF(n,J_):n}function oF(n,e){let t={};for(let i in n)b7.call(n,i)&&(t[i]=e(n[i],i));return t}function SD(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){if(n.constructor!==e.constructor)return!1;var t,i,r;if(Array.isArray(n)){if(t=n.length,t!=e.length)return!1;for(i=t;i--!==0;)if(!SD(n[i],e[i]))return!1;return!0}if(n.constructor===RegExp)return n.source===e.source&&n.flags===e.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===e.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===e.toString();if(r=Object.keys(n),t=r.length,t!==Object.keys(e).length)return!1;for(i=t;i--!==0;)if(!Object.prototype.hasOwnProperty.call(e,r[i]))return!1;for(i=t;i--!==0;){var o=r[i];if(!SD(n[o],e[o]))return!1}return!0}return n!==n&&e!==e}var K_=typeof document<"u"?document.createDocumentFragment():null,w7=(()=>{class n{constructor(t){this.element=t}ngAfterViewInit(){K_&&K_.appendChild(this.element.nativeElement)}ngOnDestroy(){K_&&K_.removeChild(this.element.nativeElement)}}return n.\u0275fac=function(t){return new(t||n)(z(ft))},n.\u0275cmp=he({type:n,selectors:[["offscreen-fragment"]],standalone:!1,ngContentSelectors:YG,decls:1,vars:0,template:function(t,i){t&1&&(Qg(),Kg(0))},encapsulation:2}),n})(),od=typeof document<"u"?document.createDocumentFragment():null,S7=(()=>{class n{ngAfterViewInit(){let t=this.rootElRef?.nativeElement;rF(t,this.inPlaceOf),wD(t,void 0,this.elAttrs),this.inPlaceOf.style.display="none",this.reportEl(t)}ngOnChanges(t){let i=this.rootElRef?.nativeElement;if(i)if(this.inPlaceOf.parentNode!==od)rF(i,this.inPlaceOf),wD(i,void 0,this.elAttrs),this.reportEl(i);else{let r=t.elAttrs;r&&wD(i,r.previousValue,r.currentValue)}}ngOnDestroy(){this.inPlaceOf.parentNode===od&&od&&od.removeChild(this.inPlaceOf),this.reportEl(null)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=he({type:n,selectors:[["transport-container"]],viewQuery:function(t,i){if(t&1&&cc(QG,5),t&2){let r;jt(r=Bt())&&(i.rootElRef=r.first)}},inputs:{inPlaceOf:"inPlaceOf",reportEl:"reportEl",elTag:"elTag",elClasses:"elClasses",elStyle:"elStyle",elAttrs:"elAttrs",template:"template",renderProps:"renderProps"},standalone:!1,features:[Dn],decls:6,vars:6,consts:[["rootEl",""],[3,"ngIf"],[3,"ngClass","ngStyle"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,i){t&1&&N(0,KG,3,6,"ng-template",1)(1,JG,3,6,"ng-template",1)(2,XG,3,6,"ng-template",1)(3,e7,3,6,"ng-template",1)(4,t7,3,6,"ng-template",1)(5,n7,3,6,"ng-template",1),t&2&&(x("ngIf",i.elTag=="div"),_(),x("ngIf",i.elTag=="span"),_(),x("ngIf",i.elTag=="a"),_(),x("ngIf",i.elTag=="tr"),_(),x("ngIf",i.elTag=="th"),_(),x("ngIf",i.elTag=="td"))},dependencies:[Ne,va,WS,$S],encapsulation:2}),n})();function rF(n,e){e.parentNode?.insertBefore(n,e.nextSibling),od&&od.appendChild(e)}function wD(n,e={},t={}){for(let i in e)i in t||(n[i]=null);for(let i in t)n[i]=t[i]}var sF=(()=>{class n{constructor(t,i){this.element=t,this.calendar=null,this.optionSnapshot={},this.customRenderingMap=new Map;let r=new tp;r.subscribe(o=>{this.customRenderingMap=o,this.customRenderingArray=void 0,i.detectChanges()}),this.handleCustomRendering=r.handle.bind(r)}ngAfterViewInit(){let{deepChangeDetection:t}=this,i=B(B({},this.options),this.buildInputOptions());this.optionSnapshot=oF(i,(l,c)=>t&&iF[c]?J_(l):l);let r=this.element.nativeElement,o=this.calendar=new Q_(r,B(B({},i),this.buildExtraOptions())),s=r.closest("ion-content");s&&s.componentOnReady?s.componentOnReady().then(()=>{window.requestAnimationFrame(()=>{o.render()})}):o.render(),setTimeout(()=>o.updateSize())}ngDoCheck(){if(this.calendar){let{deepChangeDetection:t,optionSnapshot:i}=this,r=B(B({},this.options),this.buildInputOptions()),o={},s=[];for(let c in r)if(r.hasOwnProperty(c)){let u=r[c];t&&iF[c]?SD(i[c],u)||(i[c]=J_(u),s.push(c)):i[c]!==u&&(i[c]=u,s.push(c)),o[c]=u}let l=Object.keys(i);for(let c of l)c in r||(delete i[c],s.push(c));s.length&&(this.calendar.pauseRendering(),this.calendar.resetOptions(B(B({},o),this.buildExtraOptions()),s))}}ngAfterContentChecked(){this.calendar&&this.calendar.resumeRendering()}ngOnDestroy(){this.calendar&&(this.calendar.destroy(),this.calendar=null)}get customRenderings(){return this.customRenderingArray||(this.customRenderingArray=[...this.customRenderingMap.values()])}getApi(){return this.calendar}buildInputOptions(){let t={};for(let i of y7){let r=this[i];r!=null&&(t[i]=r)}return t}buildExtraOptions(){return{handleCustomRendering:this.handleCustomRendering,customRenderingMetaMap:this,customRenderingReplaces:!0}}trackCustomRendering(t,i){return i.id}}return n.\u0275fac=function(t){return new(t||n)(z(ft),z(Pn))},n.\u0275cmp=he({type:n,selectors:[["full-calendar"]],contentQueries:function(t,i,r){if(t&1&&(gn(r,i7,7),gn(r,r7,7),gn(r,o7,7),gn(r,s7,7),gn(r,a7,7),gn(r,l7,7),gn(r,c7,7),gn(r,d7,7),gn(r,u7,7),gn(r,f7,7),gn(r,p7,7),gn(r,h7,7),gn(r,g7,7),gn(r,m7,7),gn(r,v7,7)),t&2){let o;jt(o=Bt())&&(i.dayHeaderContent=o.first),jt(o=Bt())&&(i.dayCellContent=o.first),jt(o=Bt())&&(i.weekNumberContent=o.first),jt(o=Bt())&&(i.nowIndicatorContent=o.first),jt(o=Bt())&&(i.eventContent=o.first),jt(o=Bt())&&(i.slotLaneContent=o.first),jt(o=Bt())&&(i.slotLabelContent=o.first),jt(o=Bt())&&(i.allDayContent=o.first),jt(o=Bt())&&(i.moreLinkContent=o.first),jt(o=Bt())&&(i.noEventsContent=o.first),jt(o=Bt())&&(i.resourceAreaHeaderContent=o.first),jt(o=Bt())&&(i.resourceGroupLabelContent=o.first),jt(o=Bt())&&(i.resourceLabelContent=o.first),jt(o=Bt())&&(i.resourceLaneContent=o.first),jt(o=Bt())&&(i.resourceGroupLaneContent=o.first)}},inputs:{options:"options",deepChangeDetection:"deepChangeDetection",events:"events",eventSources:"eventSources",resources:"resources"},standalone:!1,decls:2,vars:2,consts:[[3,"inPlaceOf","reportEl","elTag","elClasses","elStyle","elAttrs","template","renderProps",4,"ngFor","ngForOf","ngForTrackBy"],[3,"inPlaceOf","reportEl","elTag","elClasses","elStyle","elAttrs","template","renderProps"]],template:function(t,i){t&1&&(g(0,"offscreen-fragment"),N(1,_7,1,8,"transport-container",0),p()),t&2&&(_(),x("ngForOf",i.customRenderings)("ngForTrackBy",i.trackCustomRendering))},dependencies:[w7,S7,Ze],encapsulation:2}),n})(),aF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=pn({type:n}),n.\u0275inj=nn({imports:[[Se]]}),n})();var CD=class extends li{constructor(){super(...arguments),this.headerElRef=cn()}renderSimpleLayout(e,t){let{props:i,context:r}=this,o=[],s=ul(r.options);return e&&o.push({type:"header",key:"header",isSticky:s,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),o.push({type:"body",key:"body",liquid:!0,chunk:{content:t}}),k(Ho,{elClasses:["fc-daygrid"],viewSpec:r.viewSpec},k(As,{liquid:!i.isHeightAuto&&!i.forPrint,collapsibleWidth:i.forPrint,cols:[],sections:o}))}renderHScrollLayout(e,t,i,r){let o=this.context.pluginHooks.scrollGridImpl;if(!o)throw new Error("No ScrollGrid implementation");let{props:s,context:l}=this,c=!s.forPrint&&ul(l.options),u=!s.forPrint&&yp(l.options),f=[];return e&&f.push({type:"header",key:"header",isSticky:c,chunks:[{key:"main",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),f.push({type:"body",key:"body",liquid:!0,chunks:[{key:"main",content:t}]}),u&&f.push({type:"footer",key:"footer",isSticky:!0,chunks:[{key:"main",content:id}]}),k(Ho,{elClasses:["fc-daygrid"],viewSpec:l.viewSpec},k(o,{liquid:!s.isHeightAuto&&!s.forPrint,forPrint:s.forPrint,collapsibleWidth:s.forPrint,colGroups:[{cols:[{span:i,minWidth:r}]}],sections:f}))}};function e0(n,e){let t=[];for(let i=0;i<e;i+=1)t[i]=[];for(let i of n)t[i.row].push(i);return t}function X_(n,e){let t=[];for(let i=0;i<e;i+=1)t[i]=[];for(let i of n)t[i.firstCol].push(i);return t}function lF(n,e){let t=[];if(n){for(let i=0;i<e;i+=1)t[i]={affectedInstances:n.affectedInstances,isEvent:n.isEvent,segs:[]};for(let i of n.segs)t[i.row].segs.push(i)}else for(let i=0;i<e;i+=1)t[i]=null;return t}var cF=wt({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"});function dF(n){let{display:e}=n.eventRange.ui;return e==="list-item"||e==="auto"&&!n.eventRange.def.allDay&&n.firstCol===n.lastCol&&n.isStart&&n.isEnd}var t0=class extends Ke{render(){let{props:e}=this;return k(Rs,Object.assign({},e,{elClasses:["fc-daygrid-event","fc-daygrid-block-event","fc-h-event"],defaultTimeFormat:cF,defaultDisplayEventEnd:e.defaultDisplayEventEnd,disableResizing:!e.seg.eventRange.def.allDay}))}},n0=class extends Ke{render(){let{props:e,context:t}=this,{options:i}=t,{seg:r}=e,o=i.eventTimeFormat||cF,s=B_(r,o,t,!0,e.defaultDisplayEventEnd);return k(ol,Object.assign({},e,{elTag:"a",elClasses:["fc-daygrid-event","fc-daygrid-dot-event"],elAttrs:U_(e.seg,t),defaultGenerator:E7,timeText:s,isResizing:!1,isDateSelecting:!1}))}};function E7(n){return k(Xe,null,k("div",{className:"fc-daygrid-event-dot",style:{borderColor:n.borderColor||n.backgroundColor}}),n.timeText&&k("div",{className:"fc-event-time"},n.timeText),k("div",{className:"fc-event-title"},n.event.title||k(Xe,null,"\xA0")))}var ED=class extends Ke{constructor(){super(...arguments),this.compileSegs=ve(x7)}render(){let{props:e}=this,{allSegs:t,invisibleSegs:i}=this.compileSegs(e.singlePlacements);return k(al,{elClasses:["fc-daygrid-more-link"],dateProfile:e.dateProfile,todayRange:e.todayRange,allDayDate:e.allDayDate,moreCnt:e.moreCnt,allSegs:t,hiddenSegs:i,alignmentElRef:e.alignmentElRef,alignGridTop:e.alignGridTop,extraDateSpan:e.extraDateSpan,popoverContent:()=>{let r=(e.eventDrag?e.eventDrag.affectedInstances:null)||(e.eventResize?e.eventResize.affectedInstances:null)||{};return k(Xe,null,t.map(o=>{let s=o.eventRange.instance.instanceId;return k("div",{className:"fc-daygrid-event-harness",key:s,style:{visibility:r[s]?"hidden":""}},dF(o)?k(n0,Object.assign({seg:o,isDragging:!1,isSelected:s===e.eventSelection,defaultDisplayEventEnd:!1},kr(o,e.todayRange))):k(t0,Object.assign({seg:o,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:s===e.eventSelection,defaultDisplayEventEnd:!1},kr(o,e.todayRange))))}))}})}};function x7(n){let e=[],t=[];for(let i of n)e.push(i.seg),i.isVisible||t.push(i.seg);return{allSegs:e,invisibleSegs:t}}var D7=wt({week:"narrow"}),xD=class extends li{constructor(){super(...arguments),this.rootElRef=cn(),this.state={dayNumberId:cl()},this.handleRootEl=e=>{Ni(this.rootElRef,e),Ni(this.props.elRef,e)}}render(){let{context:e,props:t,state:i,rootElRef:r}=this,{options:o,dateEnv:s}=e,{date:l,dateProfile:c}=t,u=t.showDayNumber&&M7(l,c.currentRange,s);return k(ks,{elTag:"td",elRef:this.handleRootEl,elClasses:["fc-daygrid-day",...t.extraClassNames||[]],elAttrs:Object.assign(Object.assign(Object.assign({},t.extraDataAttrs),t.showDayNumber?{"aria-labelledby":i.dayNumberId}:{}),{role:"gridcell"}),defaultGenerator:I7,date:l,dateProfile:c,todayRange:t.todayRange,showDayNumber:t.showDayNumber,isMonthStart:u,extraRenderProps:t.extraRenderProps},(f,m)=>k("div",{ref:t.innerElRef,className:"fc-daygrid-day-frame fc-scrollgrid-sync-inner",style:{minHeight:t.minHeight}},t.showWeekNumber&&k(Sp,{elTag:"a",elClasses:["fc-daygrid-week-number"],elAttrs:dl(e,l,"week"),date:l,defaultFormat:D7}),!m.isDisabled&&(t.showDayNumber||rd(o)||t.forceDayTop)?k("div",{className:"fc-daygrid-day-top"},k(f,{elTag:"a",elClasses:["fc-daygrid-day-number",u&&"fc-daygrid-month-start"],elAttrs:Object.assign(Object.assign({},dl(e,l)),{id:i.dayNumberId})})):t.showDayNumber?k("div",{className:"fc-daygrid-day-top",style:{visibility:"hidden"}},k("a",{className:"fc-daygrid-day-number"},"\xA0")):void 0,k("div",{className:"fc-daygrid-day-events",ref:t.fgContentElRef},t.fgContent,k("div",{className:"fc-daygrid-day-bottom",style:{marginTop:t.moreMarginTop}},k(ED,{allDayDate:l,singlePlacements:t.singlePlacements,moreCnt:t.moreCnt,alignmentElRef:r,alignGridTop:!t.showDayNumber,extraDateSpan:t.extraDateSpan,dateProfile:t.dateProfile,eventSelection:t.eventSelection,eventDrag:t.eventDrag,eventResize:t.eventResize,todayRange:t.todayRange}))),k("div",{className:"fc-daygrid-day-bg"},t.bgContent)))}};function I7(n){return n.dayNumberText||k(Xe,null,"\xA0")}function M7(n,e,t){let{start:i,end:r}=e,o=fo(r,-1),s=t.getYear(i),l=t.getMonth(i),c=t.getYear(o),u=t.getMonth(o);return!(s===c&&l===u)&&(n.valueOf()===i.valueOf()||t.getDay(n)===1&&n.valueOf()<r.valueOf())}function uF(n){return n.eventRange.instance.instanceId+":"+n.firstCol}function fF(n){return uF(n)+":"+n.lastCol}function T7(n,e,t,i,r,o,s){let l=new DD(P=>{let U=n[P.index].eventRange.instance.instanceId+":"+P.span.start+":"+(P.span.end-1);return r[U]||1});l.allowReslicing=!0,l.strictOrder=i,e===!0||t===!0?(l.maxCoord=o,l.hiddenConsumes=!0):typeof e=="number"?l.maxStackCnt=e:typeof t=="number"&&(l.maxStackCnt=t,l.hiddenConsumes=!0);let c=[],u=[];for(let P=0;P<n.length;P+=1){let U=n[P],K=fF(U);r[K]!=null?c.push({index:P,span:{start:U.firstCol,end:U.lastCol+1}}):u.push(U)}let f=l.addSegs(c),m=l.toRects(),{singleColPlacements:w,multiColPlacements:b,leftoverMargins:D}=P7(m,n,s),T=[],M=[];for(let P of u){b[P.firstCol].push({seg:P,isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let U=P.firstCol;U<=P.lastCol;U+=1)w[U].push({seg:ad(P,U,U+1,s),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let P=0;P<s.length;P+=1)T.push(0);for(let P of f){let U=n[P.index],K=P.span;b[K.start].push({seg:ad(U,K.start,K.end,s),isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let W=K.start;W<K.end;W+=1)T[W]+=1,w[W].push({seg:ad(U,W,W+1,s),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let P=0;P<s.length;P+=1)M.push(D[P]);return{singleColPlacements:w,multiColPlacements:b,moreCnts:T,moreMarginTops:M}}function P7(n,e,t){let i=A7(n,t.length),r=[],o=[],s=[];for(let l=0;l<t.length;l+=1){let c=i[l],u=[],f=0,m=0;for(let b of c){let D=e[b.index];u.push({seg:ad(D,l,l+1,t),isVisible:!0,isAbsolute:!1,absoluteTop:b.levelCoord,marginTop:b.levelCoord-f}),f=b.levelCoord+b.thickness}let w=[];f=0,m=0;for(let b of c){let D=e[b.index],T=b.span.end-b.span.start>1,M=b.span.start===l;m+=b.levelCoord-f,f=b.levelCoord+b.thickness,T?(m+=b.thickness,M&&w.push({seg:ad(D,b.span.start,b.span.end,t),isVisible:!0,isAbsolute:!0,absoluteTop:b.levelCoord,marginTop:0})):M&&(w.push({seg:ad(D,b.span.start,b.span.end,t),isVisible:!0,isAbsolute:!1,absoluteTop:b.levelCoord,marginTop:m}),m=0)}r.push(u),o.push(w),s.push(m)}return{singleColPlacements:r,multiColPlacements:o,leftoverMargins:s}}function A7(n,e){let t=[];for(let i=0;i<e;i+=1)t.push([]);for(let i of n)for(let r=i.span.start;r<i.span.end;r+=1)t[r].push(i);return t}function ad(n,e,t,i){if(n.firstCol===e&&n.lastCol===t-1)return n;let r=n.eventRange,o=r.range,s=Pr(o,{start:i[e].date,end:Kt(i[t-1].date,1)});return Object.assign(Object.assign({},n),{firstCol:e,lastCol:t-1,eventRange:{def:r.def,ui:Object.assign(Object.assign({},r.ui),{durationEditable:!1}),instance:r.instance,range:s},isStart:n.isStart&&s.start.valueOf()===o.start.valueOf(),isEnd:n.isEnd&&s.end.valueOf()===o.end.valueOf()})}var DD=class extends el{constructor(){super(...arguments),this.hiddenConsumes=!1,this.forceHidden={}}addSegs(e){let t=super.addSegs(e),{entriesByLevel:i}=this,r=o=>!this.forceHidden[po(o)];for(let o=0;o<i.length;o+=1)i[o]=i[o].filter(r);return t}handleInvalidInsertion(e,t,i){let{entriesByLevel:r,forceHidden:o}=this,{touchingEntry:s,touchingLevel:l,touchingLateral:c}=e;if(this.hiddenConsumes&&s){let u=po(s);if(!o[u])if(this.allowReslicing){let f=Object.assign(Object.assign({},s),{span:vp(s.span,t.span)}),m=po(f);o[m]=!0,r[l][c]=f,i.push(f),this.splitEntry(s,t,i)}else o[u]=!0,i.push(s)}super.handleInvalidInsertion(e,t,i)}},i0=class extends li{constructor(){super(...arguments),this.cellElRefs=new Ei,this.frameElRefs=new Ei,this.fgElRefs=new Ei,this.segHarnessRefs=new Ei,this.rootElRef=cn(),this.state={framePositions:null,maxContentHeight:null,segHeights:{}},this.handleResize=e=>{e&&this.updateSizing(!0)}}render(){let{props:e,state:t,context:i}=this,{options:r}=i,o=e.cells.length,s=X_(e.businessHourSegs,o),l=X_(e.bgEventSegs,o),c=X_(this.getHighlightSegs(),o),u=X_(this.getMirrorSegs(),o),{singleColPlacements:f,multiColPlacements:m,moreCnts:w,moreMarginTops:b}=T7(pp(e.fgEventSegs,r.eventOrder),e.dayMaxEvents,e.dayMaxEventRows,r.eventOrderStrict,t.segHeights,t.maxContentHeight,e.cells),D=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{};return k("tr",{ref:this.rootElRef,role:"row"},e.renderIntro&&e.renderIntro(),e.cells.map((T,M)=>{let P=this.renderFgSegs(M,e.forPrint?f[M]:m[M],e.todayRange,D),U=this.renderFgSegs(M,R7(u[M],m),e.todayRange,{},!!e.eventDrag,!!e.eventResize,!1);return k(xD,{key:T.key,elRef:this.cellElRefs.createRef(T.key),innerElRef:this.frameElRefs.createRef(T.key),dateProfile:e.dateProfile,date:T.date,showDayNumber:e.showDayNumbers,showWeekNumber:e.showWeekNumbers&&M===0,forceDayTop:e.showWeekNumbers,todayRange:e.todayRange,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,extraRenderProps:T.extraRenderProps,extraDataAttrs:T.extraDataAttrs,extraClassNames:T.extraClassNames,extraDateSpan:T.extraDateSpan,moreCnt:w[M],moreMarginTop:b[M],singlePlacements:f[M],fgContentElRef:this.fgElRefs.createRef(T.key),fgContent:k(Xe,null,k(Xe,null,P),k(Xe,null,U)),bgContent:k(Xe,null,this.renderFillSegs(c[M],"highlight"),this.renderFillSegs(s[M],"non-business"),this.renderFillSegs(l[M],"bg-event")),minHeight:e.cellMinHeight})}))}componentDidMount(){this.updateSizing(!0),this.context.addResizeHandler(this.handleResize)}componentDidUpdate(e,t){let i=this.props;this.updateSizing(!Ci(e,i))}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}getHighlightSegs(){let{props:e}=this;return e.eventDrag&&e.eventDrag.segs.length?e.eventDrag.segs:e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:e.dateSelectionSegs}getMirrorSegs(){let{props:e}=this;return e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:[]}renderFgSegs(e,t,i,r,o,s,l){let{context:c}=this,{eventSelection:u}=this.props,{framePositions:f}=this.state,m=this.props.cells.length===1,w=o||s||l,b=[];if(f)for(let D of t){let{seg:T}=D,{instanceId:M}=T.eventRange.instance,P=D.isVisible&&!r[M],U=D.isAbsolute,K="",W="";U&&(c.isRtl?(W=0,K=f.lefts[T.lastCol]-f.lefts[T.firstCol]):(K=0,W=f.rights[T.firstCol]-f.rights[T.lastCol])),b.push(k("div",{className:"fc-daygrid-event-harness"+(U?" fc-daygrid-event-harness-abs":""),key:uF(T),ref:w?null:this.segHarnessRefs.createRef(fF(T)),style:{visibility:P?"":"hidden",marginTop:U?"":D.marginTop,top:U?D.absoluteTop:"",left:K,right:W}},dF(T)?k(n0,Object.assign({seg:T,isDragging:o,isSelected:M===u,defaultDisplayEventEnd:m},kr(T,i))):k(t0,Object.assign({seg:T,isDragging:o,isResizing:s,isDateSelecting:l,isSelected:M===u,defaultDisplayEventEnd:m},kr(T,i)))))}return b}renderFillSegs(e,t){let{isRtl:i}=this.context,{todayRange:r}=this.props,{framePositions:o}=this.state,s=[];if(o)for(let l of e){let c=i?{right:0,left:o.lefts[l.lastCol]-o.lefts[l.firstCol]}:{left:0,right:o.rights[l.firstCol]-o.rights[l.lastCol]};s.push(k("div",{key:hp(l.eventRange),className:"fc-daygrid-bg-harness",style:c},t==="bg-event"?k(sl,Object.assign({seg:l},kr(l,r))):wp(t)))}return k(Xe,{},...s)}updateSizing(e){let{props:t,state:i,frameElRefs:r}=this;if(!t.forPrint&&t.clientWidth!==null){if(e){let c=t.cells.map(u=>r.currentMap[u.key]);if(c.length){let u=this.rootElRef.current,f=new Rr(u,c,!0,!1);(!i.framePositions||!i.framePositions.similarTo(f))&&this.setState({framePositions:new Rr(u,c,!0,!1)})}}let o=this.state.segHeights,s=this.querySegHeights(),l=t.dayMaxEvents===!0||t.dayMaxEventRows===!0;this.safeSetState({segHeights:Object.assign(Object.assign({},o),s),maxContentHeight:l?this.computeMaxContentHeight():null})}}querySegHeights(){let e=this.segHarnessRefs.currentMap,t={};for(let i in e){let r=Math.round(e[i].getBoundingClientRect().height);t[i]=Math.max(t[i]||0,r)}return t}computeMaxContentHeight(){let e=this.props.cells[0].key,t=this.cellElRefs.currentMap[e],i=this.fgElRefs.currentMap[e];return t.getBoundingClientRect().bottom-i.getBoundingClientRect().top}getCellEls(){let e=this.cellElRefs.currentMap;return this.props.cells.map(t=>e[t.key])}};i0.addStateEquality({segHeights:Ci});function R7(n,e){if(!n.length)return[];let t=k7(e);return n.map(i=>({seg:i,isVisible:!0,isAbsolute:!0,absoluteTop:t[i.eventRange.instance.instanceId],marginTop:0}))}function k7(n){let e={};for(let t of n)for(let i of t)e[i.seg.eventRange.instance.instanceId]=i.absoluteTop;return e}var ID=class extends li{constructor(){super(...arguments),this.splitBusinessHourSegs=ve(e0),this.splitBgEventSegs=ve(O7),this.splitFgEventSegs=ve(e0),this.splitDateSelectionSegs=ve(e0),this.splitEventDrag=ve(lF),this.splitEventResize=ve(lF),this.rowRefs=new Ei}render(){let{props:e,context:t}=this,i=e.cells.length,r=this.splitBusinessHourSegs(e.businessHourSegs,i),o=this.splitBgEventSegs(e.bgEventSegs,i),s=this.splitFgEventSegs(e.fgEventSegs,i),l=this.splitDateSelectionSegs(e.dateSelectionSegs,i),c=this.splitEventDrag(e.eventDrag,i),u=this.splitEventResize(e.eventResize,i),f=i>=7&&e.clientWidth?e.clientWidth/t.options.aspectRatio/6:null;return k(Zo,{unit:"day"},(m,w)=>k(Xe,null,e.cells.map((b,D)=>k(i0,{ref:this.rowRefs.createRef(D),key:b.length?b[0].date.toISOString():D,showDayNumbers:i>1,showWeekNumbers:e.showWeekNumbers,todayRange:w,dateProfile:e.dateProfile,cells:b,renderIntro:e.renderRowIntro,businessHourSegs:r[D],eventSelection:e.eventSelection,bgEventSegs:o[D],fgEventSegs:s[D],dateSelectionSegs:l[D],eventDrag:c[D],eventResize:u[D],dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,clientWidth:e.clientWidth,clientHeight:e.clientHeight,cellMinHeight:f,forPrint:e.forPrint}))))}componentDidMount(){this.registerInteractiveComponent()}componentDidUpdate(){this.registerInteractiveComponent()}registerInteractiveComponent(){if(!this.rootEl){let e=this.rowRefs.currentMap[0].getCellEls()[0],t=e?e.closest(".fc-daygrid-body"):null;t&&(this.rootEl=t,this.context.registerInteractiveComponent(this,{el:t,isHitComboAllowed:this.props.isHitComboAllowed}))}}componentWillUnmount(){this.rootEl&&(this.context.unregisterInteractiveComponent(this),this.rootEl=null)}prepareHits(){this.rowPositions=new Rr(this.rootEl,this.rowRefs.collect().map(e=>e.getCellEls()[0]),!1,!0),this.colPositions=new Rr(this.rootEl,this.rowRefs.currentMap[0].getCellEls(),!0,!1)}queryHit(e,t){let{colPositions:i,rowPositions:r}=this,o=i.leftToIndex(e),s=r.topToIndex(t);if(s!=null&&o!=null){let l=this.props.cells[s][o];return{dateProfile:this.props.dateProfile,dateSpan:Object.assign({range:this.getCellRange(s,o),allDay:!0},l.extraDateSpan),dayEl:this.getCellEl(s,o),rect:{left:i.lefts[o],right:i.rights[o],top:r.tops[s],bottom:r.bottoms[s]},layer:0}}return null}getCellEl(e,t){return this.rowRefs.currentMap[e].getCellEls()[t]}getCellRange(e,t){let i=this.props.cells[e][t].date,r=Kt(i,1);return{start:i,end:r}}};function O7(n,e){return e0(n.filter(N7),e)}function N7(n){return n.eventRange.def.allDay}var MD=class extends li{constructor(){super(...arguments),this.elRef=cn(),this.needsScrollReset=!1}render(){let{props:e}=this,{dayMaxEventRows:t,dayMaxEvents:i,expandRows:r}=e,o=i===!0||t===!0;o&&!r&&(o=!1,t=null,i=null);let s=["fc-daygrid-body",o?"fc-daygrid-body-balanced":"fc-daygrid-body-unbalanced",r?"":"fc-daygrid-body-natural"];return k("div",{ref:this.elRef,className:s.join(" "),style:{width:e.clientWidth,minWidth:e.tableMinWidth}},k("table",{role:"presentation",className:"fc-scrollgrid-sync-table",style:{width:e.clientWidth,minWidth:e.tableMinWidth,height:r?e.clientHeight:""}},e.colGroupNode,k("tbody",{role:"presentation"},k(ID,{dateProfile:e.dateProfile,cells:e.cells,renderRowIntro:e.renderRowIntro,showWeekNumbers:e.showWeekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,dayMaxEvents:i,dayMaxEventRows:t,forPrint:e.forPrint,isHitComboAllowed:e.isHitComboAllowed}))))}componentDidMount(){this.requestScrollReset()}componentDidUpdate(e){e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.props.clientWidth){let e=L7(this.elRef.current,this.props.dateProfile);if(e){let t=e.closest(".fc-daygrid-body"),i=t.closest(".fc-scroller"),r=e.getBoundingClientRect().top-t.getBoundingClientRect().top;i.scrollTop=r?r+1:0}this.needsScrollReset=!1}}};function L7(n,e){let t;return e.currentRangeUnit.match(/year|month/)&&(t=n.querySelector(`[data-date="${Ax(e.currentDate)}-01"]`)),t||(t=n.querySelector(`[data-date="${lp(e.currentDate)}"]`)),t}var TD=class extends rl{constructor(){super(...arguments),this.forceDayIfListItem=!0}sliceRange(e,t){return t.sliceRange(e)}},Cp=class extends li{constructor(){super(...arguments),this.slicer=new TD,this.tableRef=cn()}render(){let{props:e,context:t}=this;return k(MD,Object.assign({ref:this.tableRef},this.slicer.sliceProps(e,e.dateProfile,e.nextDayThreshold,t,e.dayTableModel),{dateProfile:e.dateProfile,cells:e.dayTableModel.cells,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:e.forPrint}))}},r0=class extends CD{constructor(){super(...arguments),this.buildDayTableModel=ve(F7),this.headerRef=cn(),this.tableRef=cn()}render(){let{options:e,dateProfileGenerator:t}=this.context,{props:i}=this,r=this.buildDayTableModel(i.dateProfile,t),o=e.dayHeaders&&k(tl,{ref:this.headerRef,dateProfile:i.dateProfile,dates:r.headerDates,datesRepDistinctDays:r.rowCnt===1}),s=l=>k(Cp,{ref:this.tableRef,dateProfile:i.dateProfile,dayTableModel:r,businessHours:i.businessHours,dateSelection:i.dateSelection,eventStore:i.eventStore,eventUiBases:i.eventUiBases,eventSelection:i.eventSelection,eventDrag:i.eventDrag,eventResize:i.eventResize,nextDayThreshold:e.nextDayThreshold,colGroupNode:l.tableColGroupNode,tableMinWidth:l.tableMinWidth,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.weekNumbers,expandRows:!i.isHeightAuto,headerAlignElRef:this.headerElRef,clientWidth:l.clientWidth,clientHeight:l.clientHeight,forPrint:i.forPrint});return e.dayMinWidth?this.renderHScrollLayout(o,s,r.colCnt,e.dayMinWidth):this.renderSimpleLayout(o,s)}};function F7(n,e){let t=new nl(n.renderRange,e);return new il(t,/year|month|week/.test(n.currentRangeUnit))}var o0=class extends Ka{buildRenderRange(e,t,i){let r=super.buildRenderRange(e,t,i),{props:o}=this;return z7({currentRange:r,snapToWeek:/^(year|month)$/.test(t),fixedWeekCount:o.fixedWeekCount,dateEnv:o.dateEnv})}};function z7(n){let{dateEnv:e,currentRange:t}=n,{start:i,end:r}=t,o;if(n.snapToWeek&&(i=e.startOfWeek(i),o=e.startOfWeek(r),o.valueOf()!==r.valueOf()&&(r=P_(o,1))),n.fixedWeekCount){let s=e.startOfWeek(e.startOfMonth(Kt(t.end,-1))),l=Math.ceil(Tx(s,r));r=P_(r,6-l)}return{start:i,end:r}}var V7=':root{--fc-daygrid-event-dot-width:8px}.fc-daygrid-day-events:after,.fc-daygrid-day-events:before,.fc-daygrid-day-frame:after,.fc-daygrid-day-frame:before,.fc-daygrid-event-harness:after,.fc-daygrid-event-harness:before{clear:both;content:"";display:table}.fc .fc-daygrid-body{position:relative;z-index:1}.fc .fc-daygrid-day.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-daygrid-day-frame{min-height:100%;position:relative}.fc .fc-daygrid-day-top{display:flex;flex-direction:row-reverse}.fc .fc-day-other .fc-daygrid-day-top{opacity:.3}.fc .fc-daygrid-day-number{padding:4px;position:relative;z-index:4}.fc .fc-daygrid-month-start{font-size:1.1em;font-weight:700}.fc .fc-daygrid-day-events{margin-top:1px}.fc .fc-daygrid-body-balanced .fc-daygrid-day-events{left:0;position:absolute;right:0}.fc .fc-daygrid-body-unbalanced .fc-daygrid-day-events{min-height:2em;position:relative}.fc .fc-daygrid-body-natural .fc-daygrid-day-events{margin-bottom:1em}.fc .fc-daygrid-event-harness{position:relative}.fc .fc-daygrid-event-harness-abs{left:0;position:absolute;right:0;top:0}.fc .fc-daygrid-bg-harness{bottom:0;position:absolute;top:0}.fc .fc-daygrid-day-bg .fc-non-business{z-index:1}.fc .fc-daygrid-day-bg .fc-bg-event{z-index:2}.fc .fc-daygrid-day-bg .fc-highlight{z-index:3}.fc .fc-daygrid-event{margin-top:1px;z-index:6}.fc .fc-daygrid-event.fc-event-mirror{z-index:7}.fc .fc-daygrid-day-bottom{font-size:.85em;margin:0 2px}.fc .fc-daygrid-day-bottom:after,.fc .fc-daygrid-day-bottom:before{clear:both;content:"";display:table}.fc .fc-daygrid-more-link{border-radius:3px;cursor:pointer;line-height:1;margin-top:1px;max-width:100%;overflow:hidden;padding:2px;position:relative;white-space:nowrap;z-index:4}.fc .fc-daygrid-more-link:hover{background-color:rgba(0,0,0,.1)}.fc .fc-daygrid-week-number{background-color:var(--fc-neutral-bg-color);color:var(--fc-neutral-text-color);min-width:1.5em;padding:2px;position:absolute;text-align:center;top:0;z-index:5}.fc .fc-more-popover .fc-popover-body{min-width:220px;padding:10px}.fc-direction-ltr .fc-daygrid-event.fc-event-start,.fc-direction-rtl .fc-daygrid-event.fc-event-end{margin-left:2px}.fc-direction-ltr .fc-daygrid-event.fc-event-end,.fc-direction-rtl .fc-daygrid-event.fc-event-start{margin-right:2px}.fc-direction-ltr .fc-daygrid-more-link{float:left}.fc-direction-ltr .fc-daygrid-week-number{border-radius:0 0 3px 0;left:0}.fc-direction-rtl .fc-daygrid-more-link{float:right}.fc-direction-rtl .fc-daygrid-week-number{border-radius:0 0 0 3px;right:0}.fc-liquid-hack .fc-daygrid-day-frame{position:static}.fc-daygrid-event{border-radius:3px;font-size:var(--fc-small-font-size);position:relative;white-space:nowrap}.fc-daygrid-block-event .fc-event-time{font-weight:700}.fc-daygrid-block-event .fc-event-time,.fc-daygrid-block-event .fc-event-title{padding:1px}.fc-daygrid-dot-event{align-items:center;display:flex;padding:2px 0}.fc-daygrid-dot-event .fc-event-title{flex-grow:1;flex-shrink:1;font-weight:700;min-width:0;overflow:hidden}.fc-daygrid-dot-event.fc-event-mirror,.fc-daygrid-dot-event:hover{background:rgba(0,0,0,.1)}.fc-daygrid-dot-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-daygrid-event-dot{border:calc(var(--fc-daygrid-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-daygrid-event-dot-width)/2);box-sizing:content-box;height:0;margin:0 4px;width:0}.fc-direction-ltr .fc-daygrid-event .fc-event-time{margin-right:3px}.fc-direction-rtl .fc-daygrid-event .fc-event-time{margin-left:3px}';Kc(V7);var pF=nr({name:"@fullcalendar/daygrid",initialView:"dayGridMonth",views:{dayGrid:{component:r0,dateProfileGeneratorClass:o0},dayGridDay:{type:"dayGrid",duration:{days:1}},dayGridWeek:{type:"dayGrid",duration:{weeks:1}},dayGridMonth:{type:"dayGrid",duration:{months:1},fixedWeekCount:!0},dayGridYear:{type:"dayGrid",duration:{years:1}}}});_p.touchMouseIgnoreWait=500;var PD=0,s0=0,AD=!1,a0=class{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=t=>{if(!this.shouldIgnoreMouse()&&j7(t)&&this.tryStart(t)){let i=this.createEventFromMouse(t,!0);this.emitter.trigger("pointerdown",i),this.initScrollWatch(i),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=t=>{let i=this.createEventFromMouse(t);this.recordCoords(i),this.emitter.trigger("pointermove",i)},this.handleMouseUp=t=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(t)),this.cleanup()},this.handleTouchStart=t=>{if(this.tryStart(t)){this.isTouchDragging=!0;let i=this.createEventFromTouch(t,!0);this.emitter.trigger("pointerdown",i),this.initScrollWatch(i);let r=t.target;this.shouldIgnoreMove||r.addEventListener("touchmove",this.handleTouchMove),r.addEventListener("touchend",this.handleTouchEnd),r.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=t=>{let i=this.createEventFromTouch(t);this.recordCoords(i),this.emitter.trigger("pointermove",i)},this.handleTouchEnd=t=>{if(this.isDragging){let i=t.target;i.removeEventListener("touchmove",this.handleTouchMove),i.removeEventListener("touchend",this.handleTouchEnd),i.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(t)),this.cleanup(),this.isTouchDragging=!1,B7()}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=t=>{if(!this.shouldIgnoreMove){let i=window.scrollX-this.prevScrollX+this.prevPageX,r=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:t,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:i,pageY:r,deltaX:i-this.origPageX,deltaY:r-this.origPageY})}},this.containerEl=e,this.emitter=new Wo,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),U7()}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),H7()}tryStart(e){let t=this.querySubjectEl(e),i=e.target;return t&&(!this.handleSelector||yn(i,this.handleSelector))?(this.subjectEl=t,this.isDragging=!0,this.wasTouchScroll=!1,!0):!1}cleanup(){AD=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?yn(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return PD||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(AD=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,t){let i=0,r=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(i=e.pageX-this.origPageX,r=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:i,deltaY:r}}createEventFromTouch(e,t){let i=e.touches,r,o,s=0,l=0;return i&&i.length?(r=i[0].pageX,o=i[0].pageY):(r=e.pageX,o=e.pageY),t?(this.origPageX=r,this.origPageY=o):(s=r-this.origPageX,l=o-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:r,pageY:o,deltaX:s,deltaY:l}}};function j7(n){return n.button===0&&!n.ctrlKey}function B7(){PD+=1,setTimeout(()=>{PD-=1},_p.touchMouseIgnoreWait)}function U7(){s0+=1,s0===1&&window.addEventListener("touchmove",gF,{passive:!1})}function H7(){s0-=1,s0||window.removeEventListener("touchmove",gF,{passive:!1})}function gF(n){AD&&n.preventDefault()}var RD=class{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,t,i){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.scrollX,this.origScreenY=i-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,t){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=t-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,t){let i=()=>{this.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(i,this.revertDuration):setTimeout(i,0)}doRevertAnimation(e,t){let i=this.mirrorEl,r=this.sourceEl.getBoundingClientRect();i.style.transition="top "+t+"ms,left "+t+"ms",ll(i,{left:r.left,top:r.top}),Sx(i,()=>{i.style.transition="",e()})}cleanup(){this.mirrorEl&&(np(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&ll(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,t=this.mirrorEl;return t||(t=this.mirrorEl=this.sourceEl.cloneNode(!0),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.pointerEvents="none",t.classList.add("fc-event-dragging"),ll(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t}},l0=class extends Xa{constructor(e,t){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=t,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}},c0=class extends l0{constructor(e,t){super(new Qf(e),t)}getEventTarget(){return this.scrollController.el}computeClientRect(){return sD(this.scrollController.el)}},kD=class extends l0{constructor(e){super(new Kf,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}},hF=typeof performance=="function"?performance.now:Date.now,OD=class{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let t=hF();this.handleSide(e,(t-this.msSinceRequest)/1e3),this.requestAnimation(t)}else this.isAnimating=!1}}}start(e,t,i){this.isEnabled&&(this.scrollCaches=this.buildCaches(i),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))}handleMove(e,t){if(this.isEnabled){let i=e-window.scrollX,r=t-window.scrollY,o=this.pointerScreenY===null?0:r-this.pointerScreenY,s=this.pointerScreenX===null?0:i-this.pointerScreenX;o<0?this.everMovedUp=!0:o>0&&(this.everMovedDown=!0),s<0?this.everMovedLeft=!0:s>0&&(this.everMovedRight=!0),this.pointerScreenX=i,this.pointerScreenY=r,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(hF()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,t){let{scrollCache:i}=e,{edgeThreshold:r}=this,o=r-e.distance,s=o*o/(r*r)*this.maxVelocity*t,l=1;switch(e.name){case"left":l=-1;case"right":i.setScrollLeft(i.getScrollLeft()+s*l);break;case"top":l=-1;case"bottom":i.setScrollTop(i.getScrollTop()+s*l);break}}computeBestEdge(e,t){let{edgeThreshold:i}=this,r=null,o=this.scrollCaches||[];for(let s of o){let l=s.clientRect,c=e-l.left,u=l.right-e,f=t-l.top,m=l.bottom-t;c>=0&&u>=0&&f>=0&&m>=0&&(f<=i&&this.everMovedUp&&s.canScrollUp()&&(!r||r.distance>f)&&(r={scrollCache:s,name:"top",distance:f}),m<=i&&this.everMovedDown&&s.canScrollDown()&&(!r||r.distance>m)&&(r={scrollCache:s,name:"bottom",distance:m}),c<=i&&this.everMovedLeft&&s.canScrollLeft()&&(!r||r.distance>c)&&(r={scrollCache:s,name:"left",distance:c}),u<=i&&this.everMovedRight&&s.canScrollRight()&&(!r||r.distance>u)&&(r={scrollCache:s,name:"right",distance:u}))}return r}buildCaches(e){return this.queryScrollEls(e).map(t=>t===window?new kD(!1):new c0(t,!1))}queryScrollEls(e){let t=[];for(let i of this.scrollQuery)typeof i=="object"?t.push(i):t.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(i)));return t}},fl=class extends ep{constructor(e,t){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=r=>{this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,Cx(document.body),xx(document.body),r.isTouch||r.origEvent.preventDefault(),this.emitter.trigger("pointerdown",r),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(r.subjectEl,r.pageX,r.pageY),this.startDelay(r),this.minDistance||this.handleDistanceSurpassed(r)))},this.onPointerMove=r=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",r),!this.isDistanceSurpassed){let o=this.minDistance,s,{deltaX:l,deltaY:c}=r;s=l*l+c*c,s>=o*o&&this.handleDistanceSurpassed(r)}this.isDragging&&(r.origEvent.type!=="scroll"&&(this.mirror.handleMove(r.pageX,r.pageY),this.autoScroller.handleMove(r.pageX,r.pageY)),this.emitter.trigger("dragmove",r))}},this.onPointerUp=r=>{this.isInteracting&&(this.isInteracting=!1,Ex(document.body),Dx(document.body),this.emitter.trigger("pointerup",r),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(r)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let i=this.pointer=new a0(e);i.emitter.on("pointerdown",this.onPointerDown),i.emitter.on("pointermove",this.onPointerMove),i.emitter.on("pointerup",this.onPointerUp),t&&(i.selector=t),this.mirror=new RD,this.autoScroller=new OD}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){typeof this.delay=="number"?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(!this.pointer.wasTouchScroll||this.touchScrollAllowed)&&(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),this.touchScrollAllowed===!1&&this.pointer.cancelTouchScroll())}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}},ND=class{constructor(e){this.el=e,this.origRect=mp(e),this.scrollCaches=$_(e).map(t=>new c0(t,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let t of this.scrollCaches)e+=t.origScrollLeft-t.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let t of this.scrollCaches)e+=t.origScrollTop-t.getScrollTop();return e}isWithinClipping(e,t){let i={left:e,top:t};for(let r of this.scrollCaches)if(!W7(r.getEventTarget())&&!tD(i,r.clientRect))return!1;return!0}};function W7(n){let e=n.tagName;return e==="HTML"||e==="BODY"}var ld=class{constructor(e,t){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=i=>{let{dragging:r}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(i),this.initialHit||!this.requireInitial?(r.setIgnoreMove(!1),this.emitter.trigger("pointerdown",i)):r.setIgnoreMove(!0)},this.handleDragStart=i=>{this.emitter.trigger("dragstart",i),this.handleMove(i,!0)},this.handleDragMove=i=>{this.emitter.trigger("dragmove",i),this.handleMove(i)},this.handlePointerUp=i=>{this.releaseHits(),this.emitter.trigger("pointerup",i)},this.handleDragEnd=i=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,i),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",i)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new Wo}processFirstCoord(e){let t={left:e.pageX,top:e.pageY},i=t,r=e.subjectEl,o;r instanceof HTMLElement&&(o=mp(r),i=nD(i,o));let s=this.initialHit=this.queryHitForOffset(i.left,i.top);if(s){if(this.useSubjectCenter&&o){let l=H_(o,s.rect);l&&(i=iD(l))}this.coordAdjust=rD(i,t)}else this.coordAdjust={left:0,top:0}}handleMove(e,t){let i=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);(t||!d0(this.movingHit,i))&&(this.movingHit=i,this.emitter.trigger("hitupdate",i,!1,e))}prepareHits(){this.offsetTrackers=er(this.droppableStore,e=>(e.component.prepareHits(),new ND(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let t in e)e[t].destroy();this.offsetTrackers={}}queryHitForOffset(e,t){let{droppableStore:i,offsetTrackers:r}=this,o=null;for(let s in i){let l=i[s].component,c=r[s];if(c&&c.isWithinClipping(e,t)){let u=c.computeLeft(),f=c.computeTop(),m=e-u,w=t-f,{origRect:b}=c,D=b.right-b.left,T=b.bottom-b.top;if(m>=0&&m<D&&w>=0&&w<T){let M=l.queryHit(m,w,D,T);M&&ed(M.dateProfile.activeRange,M.dateSpan.range)&&(this.disablePointCheck||c.el.contains(c.el.getRootNode().elementFromPoint(m+u-window.scrollX,w+f-window.scrollY)))&&(!o||M.layer>o.layer)&&(M.componentId=s,M.context=l.context,M.rect.left+=u,M.rect.right+=u,M.rect.top+=f,M.rect.bottom+=f,o=M)}}}return o}};function d0(n,e){return!n&&!e?!0:!!n!=!!e?!1:Qx(n.dateSpan,e.dateSpan)}function mF(n,e){let t={};for(let i of e.pluginHooks.datePointTransforms)Object.assign(t,i(n,e));return Object.assign(t,$7(n,e.dateEnv)),t}function $7(n,e){return{date:e.toDate(n.range.start),dateStr:e.formatIso(n.range.start,{omitTime:n.allDay}),allDay:n.allDay}}var LD=class extends Ar{constructor(e){super(e),this.handlePointerDown=i=>{let{dragging:r}=this,o=i.origEvent.target;r.setIgnoreMove(!this.component.isValidDateDownEl(o))},this.handleDragEnd=i=>{let{component:r}=this,{pointer:o}=this.dragging;if(!o.wasTouchScroll){let{initialHit:s,finalHit:l}=this.hitDragging;if(s&&l&&d0(s,l)){let{context:c}=r,u=Object.assign(Object.assign({},mF(s.dateSpan,c)),{dayEl:s.dayEl,jsEvent:i.origEvent,view:c.viewApi||c.calendarApi.view});c.emitter.trigger("dateClick",u)}}},this.dragging=new fl(e.el),this.dragging.autoScroller.isEnabled=!1;let t=this.hitDragging=new ld(this.dragging,gp(e));t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}},FD=class extends Ar{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=s=>{let{component:l,dragging:c}=this,{options:u}=l.context,f=u.selectable&&l.isValidDateDownEl(s.origEvent.target);c.setIgnoreMove(!f),c.delay=s.isTouch?q7(l):null},this.handleDragStart=s=>{this.component.context.calendarApi.unselect(s)},this.handleHitUpdate=(s,l)=>{let{context:c}=this.component,u=null,f=!1;if(s){let m=this.hitDragging.initialHit;s.componentId===m.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(m,s)||(u=G7(m,s,c.pluginHooks.dateSelectionTransformers)),(!u||!lD(u,s.dateProfile,c))&&(f=!0,u=null)}u?c.dispatch({type:"SELECT_DATES",selection:u}):l||c.dispatch({type:"UNSELECT_DATES"}),f?rp():op(),l||(this.dragSelection=u)},this.handlePointerUp=s=>{this.dragSelection&&(j_(this.dragSelection,s,this.component.context),this.dragSelection=null)};let{component:t}=e,{options:i}=t.context,r=this.dragging=new fl(e.el);r.touchScrollAllowed=!1,r.minDistance=i.selectMinDistance||0,r.autoScroller.isEnabled=i.dragScroll;let o=this.hitDragging=new ld(this.dragging,gp(e));o.emitter.on("pointerdown",this.handlePointerDown),o.emitter.on("dragstart",this.handleDragStart),o.emitter.on("hitupdate",this.handleHitUpdate),o.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}};function q7(n){let{options:e}=n.context,t=e.selectLongPressDelay;return t==null&&(t=e.longPressDelay),t}function G7(n,e,t){let i=n.dateSpan,r=e.dateSpan,o=[i.range.start,i.range.end,r.range.start,r.range.end];o.sort(Ix);let s={};for(let l of t){let c=l(n,e);if(c===!1)return null;c&&Object.assign(s,c)}return s.range={start:o[0],end:o[3]},s.allDay=i.allDay,s}var vF=(()=>{class n extends Ar{constructor(t){super(t),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=l=>{let c=l.origEvent.target,{component:u,dragging:f}=this,{mirror:m}=f,{options:w}=u.context,b=u.context;this.subjectEl=l.subjectEl;let D=this.subjectSeg=Go(l.subjectEl),M=(this.eventRange=D.eventRange).instance.instanceId;this.relevantEvents=up(b.getCurrentData().eventStore,M),f.minDistance=l.isTouch?0:w.eventDragMinDistance,f.delay=l.isTouch&&M!==u.props.eventSelection?Y7(u):null,w.fixedMirrorParent?m.parentNode=w.fixedMirrorParent:m.parentNode=yn(c,".fc"),m.revertDuration=w.dragRevertDuration;let P=u.isValidSegDownEl(c)&&!yn(c,".fc-event-resizer");f.setIgnoreMove(!P),this.isDragging=P&&l.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=l=>{let c=this.component.context,u=this.eventRange,f=u.instance.instanceId;l.isTouch?f!==this.component.props.eventSelection&&c.dispatch({type:"SELECT_EVENT",eventInstanceId:f}):c.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(c.calendarApi.unselect(l),c.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new St(c,u.def,u.instance),jsEvent:l.origEvent,view:c.viewApi}))},this.handleHitUpdate=(l,c)=>{if(!this.isDragging)return;let u=this.relevantEvents,f=this.hitDragging.initialHit,m=this.component.context,w=null,b=null,D=null,T=!1,M={affectedEvents:u,mutatedEvents:Gn(),isEvent:!0};if(l){w=l.context;let P=w.options;m===w||P.editable&&P.droppable?(b=Z7(f,l,this.eventRange.instance.range.start,w.getCurrentData().pluginHooks.eventDragMutationMassagers),b&&(D=fp(u,w.getCurrentData().eventUiBases,b,w),M.mutatedEvents=D,q_(M,l.dateProfile,w)||(T=!0,b=null,D=null,M.mutatedEvents=Gn()))):w=null}this.displayDrag(w,M),T?rp():op(),c||(m===w&&d0(f,l)&&(b=null),this.dragging.setMirrorNeedsRevert(!b),this.dragging.setMirrorIsVisible(!l||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=w,this.validMutation=b,this.mutatedRelevantEvents=D)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=l=>{if(this.isDragging){let c=this.component.context,u=c.viewApi,{receivingContext:f,validMutation:m}=this,w=this.eventRange.def,b=this.eventRange.instance,D=new St(c,w,b),T=this.relevantEvents,M=this.mutatedRelevantEvents,{finalHit:P}=this.hitDragging;if(this.clearDrag(),c.emitter.trigger("eventDragStop",{el:this.subjectEl,event:D,jsEvent:l.origEvent,view:u}),m){if(f===c){let U=new St(c,M.defs[w.defId],b?M.instances[b.instanceId]:null);c.dispatch({type:"MERGE_EVENTS",eventStore:M});let K={oldEvent:D,event:U,relatedEvents:go(M,c,b),revert(){c.dispatch({type:"MERGE_EVENTS",eventStore:T})}},W={};for(let re of c.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(W,re(m,c));c.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},K),W),{el:l.subjectEl,delta:m.datesDelta,jsEvent:l.origEvent,view:u})),c.emitter.trigger("eventChange",K)}else if(f){let U={event:D,relatedEvents:go(T,c,b),revert(){c.dispatch({type:"MERGE_EVENTS",eventStore:T})}};c.emitter.trigger("eventLeave",Object.assign(Object.assign({},U),{draggedEl:l.subjectEl,view:u})),c.dispatch({type:"REMOVE_EVENTS",eventStore:T}),c.emitter.trigger("eventRemove",U);let K=M.defs[w.defId],W=M.instances[b.instanceId],re=new St(f,K,W);f.dispatch({type:"MERGE_EVENTS",eventStore:M});let fe={event:re,relatedEvents:go(M,f,W),revert(){f.dispatch({type:"REMOVE_EVENTS",eventStore:M})}};f.emitter.trigger("eventAdd",fe),l.isTouch&&f.dispatch({type:"SELECT_EVENT",eventInstanceId:b.instanceId}),f.emitter.trigger("drop",Object.assign(Object.assign({},mF(P.dateSpan,f)),{draggedEl:l.subjectEl,jsEvent:l.origEvent,view:P.context.viewApi})),f.emitter.trigger("eventReceive",Object.assign(Object.assign({},fe),{draggedEl:l.subjectEl,view:P.context.viewApi}))}}else c.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:i}=this,{options:r}=i.context,o=this.dragging=new fl(t.el);o.pointer.selector=n.SELECTOR,o.touchScrollAllowed=!1,o.autoScroller.isEnabled=r.dragScroll;let s=this.hitDragging=new ld(this.dragging,nd);s.useSubjectCenter=t.useEventCenter,s.emitter.on("pointerdown",this.handlePointerDown),s.emitter.on("dragstart",this.handleDragStart),s.emitter.on("hitupdate",this.handleHitUpdate),s.emitter.on("pointerup",this.handlePointerUp),s.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(t,i){let r=this.component.context,o=this.receivingContext;o&&o!==t&&(o===r?o.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:i.affectedEvents,mutatedEvents:Gn(),isEvent:!0}}):o.dispatch({type:"UNSET_EVENT_DRAG"})),t&&t.dispatch({type:"SET_EVENT_DRAG",state:i})}clearDrag(){let t=this.component.context,{receivingContext:i}=this;i&&i.dispatch({type:"UNSET_EVENT_DRAG"}),t!==i&&t.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}return n.SELECTOR=".fc-event-draggable, .fc-event-resizable",n})();function Z7(n,e,t,i){let r=n.dateSpan,o=e.dateSpan,s=r.range.start,l=o.range.start,c={};r.allDay!==o.allDay&&(c.allDay=o.allDay,c.hasEnd=e.context.options.allDayMaintainDuration,o.allDay?s=lt(t):s=t);let u=Ps(s,l,n.context.dateEnv,n.componentId===e.componentId?n.largeUnit:null);u.milliseconds&&(c.allDay=!1);let f={datesDelta:u,standardProps:c};for(let m of i)m(f,n,e);return f}function Y7(n){let{options:e}=n.context,t=e.eventLongPressDelay;return t==null&&(t=e.longPressDelay),t}var zD=class extends Ar{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=o=>{let{component:s}=this,l=this.querySegEl(o),c=Go(l),u=this.eventRange=c.eventRange;this.dragging.minDistance=s.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(o.origEvent.target)||o.isTouch&&this.component.props.eventSelection!==u.instance.instanceId)},this.handleDragStart=o=>{let{context:s}=this.component,l=this.eventRange;this.relevantEvents=up(s.getCurrentData().eventStore,this.eventRange.instance.instanceId);let c=this.querySegEl(o);this.draggingSegEl=c,this.draggingSeg=Go(c),s.calendarApi.unselect(),s.emitter.trigger("eventResizeStart",{el:c,event:new St(s,l.def,l.instance),jsEvent:o.origEvent,view:s.viewApi})},this.handleHitUpdate=(o,s,l)=>{let{context:c}=this.component,u=this.relevantEvents,f=this.hitDragging.initialHit,m=this.eventRange.instance,w=null,b=null,D=!1,T={affectedEvents:u,mutatedEvents:Gn(),isEvent:!0};o&&(o.componentId===f.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(f,o)||(w=Q7(f,o,l.subjectEl.classList.contains("fc-event-resizer-start"),m.range))),w&&(b=fp(u,c.getCurrentData().eventUiBases,w,c),T.mutatedEvents=b,q_(T,o.dateProfile,c)||(D=!0,w=null,b=null,T.mutatedEvents=null)),b?c.dispatch({type:"SET_EVENT_RESIZE",state:T}):c.dispatch({type:"UNSET_EVENT_RESIZE"}),D?rp():op(),s||(w&&d0(f,o)&&(w=null),this.validMutation=w,this.mutatedRelevantEvents=b)},this.handleDragEnd=o=>{let{context:s}=this.component,l=this.eventRange.def,c=this.eventRange.instance,u=new St(s,l,c),f=this.relevantEvents,m=this.mutatedRelevantEvents;if(s.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:u,jsEvent:o.origEvent,view:s.viewApi}),this.validMutation){let w=new St(s,m.defs[l.defId],c?m.instances[c.instanceId]:null);s.dispatch({type:"MERGE_EVENTS",eventStore:m});let b={oldEvent:u,event:w,relatedEvents:go(m,s,c),revert(){s.dispatch({type:"MERGE_EVENTS",eventStore:f})}};s.emitter.trigger("eventResize",Object.assign(Object.assign({},b),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||qe(0),endDelta:this.validMutation.endDelta||qe(0),jsEvent:o.origEvent,view:s.viewApi})),s.emitter.trigger("eventChange",b)}else s.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:t}=e,i=this.dragging=new fl(e.el);i.pointer.selector=".fc-event-resizer",i.touchScrollAllowed=!1,i.autoScroller.isEnabled=t.context.options.dragScroll;let r=this.hitDragging=new ld(this.dragging,gp(e));r.emitter.on("pointerdown",this.handlePointerDown),r.emitter.on("dragstart",this.handleDragStart),r.emitter.on("hitupdate",this.handleHitUpdate),r.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return yn(e.subjectEl,".fc-event")}};function Q7(n,e,t,i){let r=n.context.dateEnv,o=n.dateSpan.range.start,s=e.dateSpan.range.start,l=Ps(o,s,r,n.largeUnit);if(t){if(r.add(i.start,l)<i.end)return{startDelta:l}}else if(r.add(i.end,l)>i.start)return{endDelta:l};return null}var VD=class{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=i=>{i.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=i=>{let r=this.context.options.unselectCancel,o=T_(i.origEvent);this.matchesCancel=!!yn(o,r),this.matchesEvent=!!yn(o,vF.SELECTOR)},this.onDocumentPointerUp=i=>{let{context:r}=this,{documentPointer:o}=this,s=r.getCurrentData();if(!o.wasTouchScroll){if(s.dateSelection&&!this.isRecentPointerDateSelect){let l=r.options.unselectAuto;l&&(!l||!this.matchesCancel)&&r.calendarApi.unselect(i)}s.eventSelection&&!this.matchesEvent&&r.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let t=this.documentPointer=new a0(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerdown",this.onDocumentPointerDown),t.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}},K7={fixedMirrorParent:H},J7={dateClick:H,eventDragStart:H,eventDragStop:H,eventDrop:H,eventResizeStart:H,eventResizeStop:H,eventResize:H,drop:H,eventReceive:H,eventLeave:H};_p.dataAttrPrefix="";var _F=nr({name:"@fullcalendar/interaction",componentInteractions:[LD,FD,vF,zD],calendarInteractions:[VD],elementDraggingImpl:fl,optionRefiners:K7,listenerRefiners:J7});var BD=class extends Yf{getKeyInfo(){return{allDay:{},timed:{}}}getKeysForDateSpan(e){return e.allDay?["allDay"]:["timed"]}getKeysForEventDef(e){return e.allDay?Yx(e)?["timed","allDay"]:["allDay"]:["timed"]}},X7=wt({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"short"});function CF(n){let e=["fc-timegrid-slot","fc-timegrid-slot-label",n.isLabeled?"fc-scrollgrid-shrink":"fc-timegrid-slot-minor"];return k(tr.Consumer,null,t=>{if(!n.isLabeled)return k("td",{className:e.join(" "),"data-time":n.isoTimeStr});let{dateEnv:i,options:r,viewApi:o}=t,s=r.slotLabelFormat==null?X7:Array.isArray(r.slotLabelFormat)?wt(r.slotLabelFormat[0]):wt(r.slotLabelFormat),l={level:0,time:n.time,date:i.toDate(n.date),view:o,text:i.format(n.date,s)};return k(ci,{elTag:"td",elClasses:e,elAttrs:{"data-time":n.isoTimeStr},renderProps:l,generatorName:"slotLabelContent",customGenerator:r.slotLabelContent,defaultGenerator:eZ,classNameGenerator:r.slotLabelClassNames,didMount:r.slotLabelDidMount,willUnmount:r.slotLabelWillUnmount},c=>k("div",{className:"fc-timegrid-slot-label-frame fc-scrollgrid-shrink-frame"},k(c,{elTag:"div",elClasses:["fc-timegrid-slot-label-cushion","fc-scrollgrid-shrink-cushion"]})))})}function eZ(n){return n.text}var UD=class extends Ke{render(){return this.props.slatMetas.map(e=>k("tr",{key:e.key},k(CF,Object.assign({},e))))}},tZ=wt({week:"short"}),nZ=5,HD=class extends li{constructor(){super(...arguments),this.allDaySplitter=new BD,this.headerElRef=cn(),this.rootElRef=cn(),this.scrollerElRef=cn(),this.state={slatCoords:null},this.handleScrollTopRequest=e=>{let t=this.scrollerElRef.current;t&&(t.scrollTop=e)},this.renderHeadAxis=(e,t="")=>{let{options:i}=this.context,{dateProfile:r}=this.props,o=r.renderRange,l=qo(o.start,o.end)===1?dl(this.context,o.start,"week"):{};return i.weekNumbers&&e==="day"?k(Sp,{elTag:"th",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},date:o.start,defaultFormat:tZ},c=>k("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame","fc-timegrid-axis-frame-liquid"].join(" "),style:{height:t}},k(c,{elTag:"a",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"],elAttrs:l}))):k("th",{"aria-hidden":!0,className:"fc-timegrid-axis"},k("div",{className:"fc-timegrid-axis-frame",style:{height:t}}))},this.renderTableRowAxis=e=>{let{options:t,viewApi:i}=this.context,r={text:t.allDayText,view:i};return k(ci,{elTag:"td",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},renderProps:r,generatorName:"allDayContent",customGenerator:t.allDayContent,defaultGenerator:iZ,classNameGenerator:t.allDayClassNames,didMount:t.allDayDidMount,willUnmount:t.allDayWillUnmount},o=>k("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame",e==null?" fc-timegrid-axis-frame-liquid":""].join(" "),style:{height:e}},k(o,{elTag:"span",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"]})))},this.handleSlatCoords=e=>{this.setState({slatCoords:e})}}renderSimpleLayout(e,t,i){let{context:r,props:o}=this,s=[],l=ul(r.options);return e&&s.push({type:"header",key:"header",isSticky:l,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),t&&(s.push({type:"body",key:"all-day",chunk:{content:t}}),s.push({type:"body",key:"all-day-divider",outerContent:k("tr",{role:"presentation",className:"fc-scrollgrid-section"},k("td",{className:"fc-timegrid-divider "+r.theme.getClass("tableCellShaded")}))})),s.push({type:"body",key:"body",liquid:!0,expandRows:!!r.options.expandRows,chunk:{scrollerElRef:this.scrollerElRef,content:i}}),k(Ho,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:r.viewSpec},k(As,{liquid:!o.isHeightAuto&&!o.forPrint,collapsibleWidth:o.forPrint,cols:[{width:"shrink"}],sections:s}))}renderHScrollLayout(e,t,i,r,o,s,l){let c=this.context.pluginHooks.scrollGridImpl;if(!c)throw new Error("No ScrollGrid implementation");let{context:u,props:f}=this,m=!f.forPrint&&ul(u.options),w=!f.forPrint&&yp(u.options),b=[];e&&b.push({type:"header",key:"header",isSticky:m,syncRowHeights:!0,chunks:[{key:"axis",rowContent:T=>k("tr",{role:"presentation"},this.renderHeadAxis("day",T.rowSyncHeights[0]))},{key:"cols",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),t&&(b.push({type:"body",key:"all-day",syncRowHeights:!0,chunks:[{key:"axis",rowContent:T=>k("tr",{role:"presentation"},this.renderTableRowAxis(T.rowSyncHeights[0]))},{key:"cols",content:t}]}),b.push({key:"all-day-divider",type:"body",outerContent:k("tr",{role:"presentation",className:"fc-scrollgrid-section"},k("td",{colSpan:2,className:"fc-timegrid-divider "+u.theme.getClass("tableCellShaded")}))}));let D=u.options.nowIndicator;return b.push({type:"body",key:"body",liquid:!0,expandRows:!!u.options.expandRows,chunks:[{key:"axis",content:T=>k("div",{className:"fc-timegrid-axis-chunk"},k("table",{"aria-hidden":!0,style:{height:T.expandRows?T.clientHeight:""}},T.tableColGroupNode,k("tbody",null,k(UD,{slatMetas:s}))),k("div",{className:"fc-timegrid-now-indicator-container"},k(Zo,{unit:D?"minute":"day"},M=>{let P=D&&l&&l.safeComputeTop(M);return typeof P=="number"?k(bp,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:P},isAxis:!0,date:M}):null})))},{key:"cols",scrollerElRef:this.scrollerElRef,content:i}]}),w&&b.push({key:"footer",type:"footer",isSticky:!0,chunks:[{key:"axis",content:id},{key:"cols",content:id}]}),k(Ho,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:u.viewSpec},k(c,{liquid:!f.isHeightAuto&&!f.forPrint,forPrint:f.forPrint,collapsibleWidth:!1,colGroups:[{width:"shrink",cols:[{width:"shrink"}]},{cols:[{span:r,minWidth:o}]}],sections:b}))}getAllDayMaxEventProps(){let{dayMaxEvents:e,dayMaxEventRows:t}=this.context.options;return(e===!0||t===!0)&&(e=void 0,t=nZ),{dayMaxEvents:e,dayMaxEventRows:t}}};function iZ(n){return n.text}var WD=class{constructor(e,t,i){this.positions=e,this.dateProfile=t,this.slotDuration=i}safeComputeTop(e){let{dateProfile:t}=this;if(Xi(t.currentRange,e)){let i=lt(e),r=e.valueOf()-i.valueOf();if(r>=Oi(t.slotMinTime)&&r<Oi(t.slotMaxTime))return this.computeTimeTop(qe(r))}return null}computeDateTop(e,t){return t||(t=lt(e)),this.computeTimeTop(qe(e.valueOf()-t.valueOf()))}computeTimeTop(e){let{positions:t,dateProfile:i}=this,r=t.els.length,o=(e.milliseconds-Oi(i.slotMinTime))/Oi(this.slotDuration),s,l;return o=Math.max(0,o),o=Math.min(r,o),s=Math.floor(o),s=Math.min(s,r-1),l=o-s,t.tops[s]+t.getHeight(s)*l}},$D=class extends Ke{render(){let{props:e,context:t}=this,{options:i}=t,{slatElRefs:r}=e;return k("tbody",null,e.slatMetas.map((o,s)=>{let l={time:o.time,date:t.dateEnv.toDate(o.date),view:t.viewApi};return k("tr",{key:o.key,ref:r.createRef(o.key)},e.axis&&k(CF,Object.assign({},o)),k(ci,{elTag:"td",elClasses:["fc-timegrid-slot","fc-timegrid-slot-lane",!o.isLabeled&&"fc-timegrid-slot-minor"],elAttrs:{"data-time":o.isoTimeStr},renderProps:l,generatorName:"slotLaneContent",customGenerator:i.slotLaneContent,classNameGenerator:i.slotLaneClassNames,didMount:i.slotLaneDidMount,willUnmount:i.slotLaneWillUnmount}))}))}},qD=class extends Ke{constructor(){super(...arguments),this.rootElRef=cn(),this.slatElRefs=new Ei}render(){let{props:e,context:t}=this;return k("div",{ref:this.rootElRef,className:"fc-timegrid-slots"},k("table",{"aria-hidden":!0,className:t.theme.getClass("table"),style:{minWidth:e.tableMinWidth,width:e.clientWidth,height:e.minHeight}},e.tableColGroupNode,k($D,{slatElRefs:this.slatElRefs,axis:e.axis,slatMetas:e.slatMetas})))}componentDidMount(){this.updateSizing()}componentDidUpdate(){this.updateSizing()}componentWillUnmount(){this.props.onCoords&&this.props.onCoords(null)}updateSizing(){let{context:e,props:t}=this;t.onCoords&&t.clientWidth!==null&&this.rootElRef.current.offsetHeight&&t.onCoords(new WD(new Rr(this.rootElRef.current,rZ(this.slatElRefs.currentMap,t.slatMetas),!1,!0),this.props.dateProfile,e.options.slotDuration))}};function rZ(n,e){return e.map(t=>n[t.key])}function Ep(n,e){let t=[],i;for(i=0;i<e;i+=1)t.push([]);if(n)for(i=0;i<n.length;i+=1)t[n[i].col].push(n[i]);return t}function yF(n,e){let t=[];if(n){for(let i=0;i<e;i+=1)t[i]={affectedInstances:n.affectedInstances,isEvent:n.isEvent,segs:[]};for(let i of n.segs)t[i.col].segs.push(i)}else for(let i=0;i<e;i+=1)t[i]=null;return t}var GD=class extends Ke{render(){let{props:e}=this;return k(al,{elClasses:["fc-timegrid-more-link"],elStyle:{top:e.top,bottom:e.bottom},allDayDate:null,moreCnt:e.hiddenSegs.length,allSegs:e.hiddenSegs,hiddenSegs:e.hiddenSegs,extraDateSpan:e.extraDateSpan,dateProfile:e.dateProfile,todayRange:e.todayRange,popoverContent:()=>EF(e.hiddenSegs,e),defaultGenerator:oZ,forceTimed:!0},t=>k(t,{elTag:"div",elClasses:["fc-timegrid-more-link-inner","fc-sticky"]}))}};function oZ(n){return n.shortText}function sZ(n,e,t){let i=new el;e!=null&&(i.strictOrder=e),t!=null&&(i.maxStackCnt=t);let r=i.addSegs(n),o=aD(r),s=aZ(i);return s=uZ(s,1),{segRects:fZ(s),hiddenGroups:o}}function aZ(n){let{entriesByLevel:e}=n,t=XD((i,r)=>i+":"+r,(i,r)=>{let o=dZ(n,i,r),s=bF(o,t),l=e[i][r];return[Object.assign(Object.assign({},l),{nextLevelNodes:s[0]}),l.thickness+s[1]]});return bF(e.length?{level:0,lateralStart:0,lateralEnd:e[0].length}:null,t)[0]}function bF(n,e){if(!n)return[[],0];let{level:t,lateralStart:i,lateralEnd:r}=n,o=i,s=[];for(;o<r;)s.push(e(t,o)),o+=1;return s.sort(lZ),[s.map(cZ),s[0][1]]}function lZ(n,e){return e[1]-n[1]}function cZ(n){return n[0]}function dZ(n,e,t){let{levelCoords:i,entriesByLevel:r}=n,o=r[e][t],s=i[e]+o.thickness,l=i.length,c=e;for(;c<l&&i[c]<s;c+=1);for(;c<l;c+=1){let u=r[c],f,m=Xf(u,o.span.start,Jf),w=m[0]+m[1],b=w;for(;(f=u[b])&&f.span.start<o.span.end;)b+=1;if(w<b)return{level:c,lateralStart:w,lateralEnd:b}}return null}function uZ(n,e){let t=XD((i,r,o)=>po(i),(i,r,o)=>{let{nextLevelNodes:s,thickness:l}=i,c=l+o,u=l/c,f,m=[];if(!s.length)f=e;else for(let b of s)if(f===void 0){let D=t(b,r,c);f=D[0],m.push(D[1])}else{let D=t(b,f,0);m.push(D[1])}let w=(f-r)*u;return[f-w,Object.assign(Object.assign({},i),{thickness:w,nextLevelNodes:m})]});return n.map(i=>t(i,0,0)[1])}function fZ(n){let e=[],t=XD((r,o,s)=>po(r),(r,o,s)=>{let l=Object.assign(Object.assign({},r),{levelCoord:o,stackDepth:s,stackForward:0});return e.push(l),l.stackForward=i(r.nextLevelNodes,o+r.thickness,s+1)+1});function i(r,o,s){let l=0;for(let c of r)l=Math.max(t(c,o,s),l);return l}return i(n,0,0),e}function XD(n,e){let t={};return(...i)=>{let r=n(...i);return r in t?t[r]:t[r]=e(...i)}}function wF(n,e,t=null,i=0){let r=[];if(t)for(let o=0;o<n.length;o+=1){let s=n[o],l=t.computeDateTop(s.start,e),c=Math.max(l+(i||0),t.computeDateTop(s.end,e));r.push({start:Math.round(l),end:Math.round(c)})}return r}function pZ(n,e,t,i){let r=[],o=[];for(let u=0;u<n.length;u+=1){let f=e[u];f?r.push({index:u,thickness:1,span:f}):o.push(n[u])}let{segRects:s,hiddenGroups:l}=sZ(r,t,i),c=[];for(let u of s)c.push({seg:n[u.index],rect:u});for(let u of o)c.push({seg:u,rect:null});return{segPlacements:c,hiddenGroups:l}}var hZ=wt({hour:"numeric",minute:"2-digit",meridiem:!1}),u0=class extends Ke{render(){return k(Rs,Object.assign({},this.props,{elClasses:["fc-timegrid-event","fc-v-event",this.props.isShort&&"fc-timegrid-event-short"],defaultTimeFormat:hZ}))}},ZD=class extends Ke{constructor(){super(...arguments),this.sortEventSegs=ve(pp)}render(){let{props:e,context:t}=this,{options:i}=t,r=i.selectMirror,o=e.eventDrag&&e.eventDrag.segs||e.eventResize&&e.eventResize.segs||r&&e.dateSelectionSegs||[],s=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{},l=this.sortEventSegs(e.fgEventSegs,i.eventOrder);return k(ks,{elTag:"td",elRef:e.elRef,elClasses:["fc-timegrid-col",...e.extraClassNames||[]],elAttrs:Object.assign({role:"gridcell"},e.extraDataAttrs),date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,extraRenderProps:e.extraRenderProps},c=>k("div",{className:"fc-timegrid-col-frame"},k("div",{className:"fc-timegrid-col-bg"},this.renderFillSegs(e.businessHourSegs,"non-business"),this.renderFillSegs(e.bgEventSegs,"bg-event"),this.renderFillSegs(e.dateSelectionSegs,"highlight")),k("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(l,s,!1,!1,!1)),k("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(o,{},!!e.eventDrag,!!e.eventResize,!!r,"mirror")),k("div",{className:"fc-timegrid-now-indicator-container"},this.renderNowIndicator(e.nowIndicatorSegs)),rd(i)&&k(c,{elTag:"div",elClasses:["fc-timegrid-col-misc"]})))}renderFgSegs(e,t,i,r,o,s){let{props:l}=this;return l.forPrint?EF(e,l):this.renderPositionedFgSegs(e,t,i,r,o,s)}renderPositionedFgSegs(e,t,i,r,o,s){let{eventMaxStack:l,eventShortHeight:c,eventOrderStrict:u,eventMinHeight:f}=this.context.options,{date:m,slatCoords:w,eventSelection:b,todayRange:D,nowDate:T}=this.props,M=i||r||o,P=wF(e,m,w,f),{segPlacements:U,hiddenGroups:K}=pZ(e,P,u,l);return k(Xe,null,this.renderHiddenGroups(K,e),U.map(W=>{let{seg:re,rect:fe}=W,ce=re.eventRange.instance.instanceId,le=M||!!(!t[ce]&&fe),ct=jD(fe&&fe.span),Wt=!M&&fe?this.computeSegHStyle(fe):{left:0,right:0},Li=!!fe&&fe.stackForward>0,xi=!!fe&&fe.span.end-fe.span.start<c;return k("div",{className:"fc-timegrid-event-harness"+(Li?" fc-timegrid-event-harness-inset":""),key:s||ce,style:Object.assign(Object.assign({visibility:le?"":"hidden"},ct),Wt)},k(u0,Object.assign({seg:re,isDragging:i,isResizing:r,isDateSelecting:o,isSelected:ce===b,isShort:xi},kr(re,D,T))))}))}renderHiddenGroups(e,t){let{extraDateSpan:i,dateProfile:r,todayRange:o,nowDate:s,eventSelection:l,eventDrag:c,eventResize:u}=this.props;return k(Xe,null,e.map(f=>{let m=jD(f.span),w=gZ(f.entries,t);return k(GD,{key:A_(G_(w)),hiddenSegs:w,top:m.top,bottom:m.bottom,extraDateSpan:i,dateProfile:r,todayRange:o,nowDate:s,eventSelection:l,eventDrag:c,eventResize:u})}))}renderFillSegs(e,t){let{props:i,context:r}=this,s=wF(e,i.date,i.slatCoords,r.options.eventMinHeight).map((l,c)=>{let u=e[c];return k("div",{key:hp(u.eventRange),className:"fc-timegrid-bg-harness",style:jD(l)},t==="bg-event"?k(sl,Object.assign({seg:u},kr(u,i.todayRange,i.nowDate))):wp(t))});return k(Xe,null,s)}renderNowIndicator(e){let{slatCoords:t,date:i}=this.props;return t?e.map((r,o)=>k(bp,{key:o,elClasses:["fc-timegrid-now-indicator-line"],elStyle:{top:t.computeDateTop(r.start,i)},isAxis:!1,date:i})):null}computeSegHStyle(e){let{isRtl:t,options:i}=this.context,r=i.slotEventOverlap,o=e.levelCoord,s=e.levelCoord+e.thickness,l,c;r&&(s=Math.min(1,o+(s-o)*2)),t?(l=1-s,c=o):(l=o,c=1-s);let u={zIndex:e.stackDepth+1,left:l*100+"%",right:c*100+"%"};return r&&!e.stackForward&&(u[t?"marginLeft":"marginRight"]=10*2),u}};function EF(n,{todayRange:e,nowDate:t,eventSelection:i,eventDrag:r,eventResize:o}){let s=(r?r.affectedInstances:null)||(o?o.affectedInstances:null)||{};return k(Xe,null,n.map(l=>{let c=l.eventRange.instance.instanceId;return k("div",{key:c,style:{visibility:s[c]?"hidden":""}},k(u0,Object.assign({seg:l,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:c===i,isShort:!1},kr(l,e,t))))}))}function jD(n){return n?{top:n.start,bottom:-n.end}:{top:"",bottom:""}}function gZ(n,e){return n.map(t=>e[t.index])}var YD=class extends Ke{constructor(){super(...arguments),this.splitFgEventSegs=ve(Ep),this.splitBgEventSegs=ve(Ep),this.splitBusinessHourSegs=ve(Ep),this.splitNowIndicatorSegs=ve(Ep),this.splitDateSelectionSegs=ve(Ep),this.splitEventDrag=ve(yF),this.splitEventResize=ve(yF),this.rootElRef=cn(),this.cellElRefs=new Ei}render(){let{props:e,context:t}=this,i=t.options.nowIndicator&&e.slatCoords&&e.slatCoords.safeComputeTop(e.nowDate),r=e.cells.length,o=this.splitFgEventSegs(e.fgEventSegs,r),s=this.splitBgEventSegs(e.bgEventSegs,r),l=this.splitBusinessHourSegs(e.businessHourSegs,r),c=this.splitNowIndicatorSegs(e.nowIndicatorSegs,r),u=this.splitDateSelectionSegs(e.dateSelectionSegs,r),f=this.splitEventDrag(e.eventDrag,r),m=this.splitEventResize(e.eventResize,r);return k("div",{className:"fc-timegrid-cols",ref:this.rootElRef},k("table",{role:"presentation",style:{minWidth:e.tableMinWidth,width:e.clientWidth}},e.tableColGroupNode,k("tbody",{role:"presentation"},k("tr",{role:"row"},e.axis&&k("td",{"aria-hidden":!0,className:"fc-timegrid-col fc-timegrid-axis"},k("div",{className:"fc-timegrid-col-frame"},k("div",{className:"fc-timegrid-now-indicator-container"},typeof i=="number"&&k(bp,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:i},isAxis:!0,date:e.nowDate})))),e.cells.map((w,b)=>k(ZD,{key:w.key,elRef:this.cellElRefs.createRef(w.key),dateProfile:e.dateProfile,date:w.date,nowDate:e.nowDate,todayRange:e.todayRange,extraRenderProps:w.extraRenderProps,extraDataAttrs:w.extraDataAttrs,extraClassNames:w.extraClassNames,extraDateSpan:w.extraDateSpan,fgEventSegs:o[b],bgEventSegs:s[b],businessHourSegs:l[b],nowIndicatorSegs:c[b],dateSelectionSegs:u[b],eventDrag:f[b],eventResize:m[b],slatCoords:e.slatCoords,eventSelection:e.eventSelection,forPrint:e.forPrint}))))))}componentDidMount(){this.updateCoords()}componentDidUpdate(){this.updateCoords()}updateCoords(){let{props:e}=this;e.onColCoords&&e.clientWidth!==null&&e.onColCoords(new Rr(this.rootElRef.current,mZ(this.cellElRefs.currentMap,e.cells),!0,!1))}};function mZ(n,e){return e.map(t=>n[t.key])}var QD=class extends li{constructor(){super(...arguments),this.processSlotOptions=ve(vZ),this.state={slatCoords:null},this.handleRootEl=e=>{e?this.context.registerInteractiveComponent(this,{el:e,isHitComboAllowed:this.props.isHitComboAllowed}):this.context.unregisterInteractiveComponent(this)},this.handleScrollRequest=e=>{let{onScrollTopRequest:t}=this.props,{slatCoords:i}=this.state;if(t&&i){if(e.time){let r=i.computeTimeTop(e.time);r=Math.ceil(r),r&&(r+=1),t(r)}return!0}return!1},this.handleColCoords=e=>{this.colCoords=e},this.handleSlatCoords=e=>{this.setState({slatCoords:e}),this.props.onSlatCoords&&this.props.onSlatCoords(e)}}render(){let{props:e,state:t}=this;return k("div",{className:"fc-timegrid-body",ref:this.handleRootEl,style:{width:e.clientWidth,minWidth:e.tableMinWidth}},k(qD,{axis:e.axis,dateProfile:e.dateProfile,slatMetas:e.slatMetas,clientWidth:e.clientWidth,minHeight:e.expandRows?e.clientHeight:"",tableMinWidth:e.tableMinWidth,tableColGroupNode:e.axis?e.tableColGroupNode:null,onCoords:this.handleSlatCoords}),k(YD,{cells:e.cells,axis:e.axis,dateProfile:e.dateProfile,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,todayRange:e.todayRange,nowDate:e.nowDate,nowIndicatorSegs:e.nowIndicatorSegs,clientWidth:e.clientWidth,tableMinWidth:e.tableMinWidth,tableColGroupNode:e.tableColGroupNode,slatCoords:t.slatCoords,onColCoords:this.handleColCoords,forPrint:e.forPrint}))}componentDidMount(){this.scrollResponder=this.context.createScrollResponder(this.handleScrollRequest)}componentDidUpdate(e){this.scrollResponder.update(e.dateProfile!==this.props.dateProfile)}componentWillUnmount(){this.scrollResponder.detach()}queryHit(e,t){let{dateEnv:i,options:r}=this.context,{colCoords:o}=this,{dateProfile:s}=this.props,{slatCoords:l}=this.state,{snapDuration:c,snapsPerSlot:u}=this.processSlotOptions(this.props.slotDuration,r.snapDuration),f=o.leftToIndex(e),m=l.positions.topToIndex(t);if(f!=null&&m!=null){let w=this.props.cells[f],b=l.positions.tops[m],D=l.positions.getHeight(m),T=(t-b)/D,M=Math.floor(T*u),P=m*u+M,U=this.props.cells[f].date,K=sp(s.slotMinTime,Mx(c,P)),W=i.add(U,K),re=i.add(W,c);return{dateProfile:s,dateSpan:Object.assign({range:{start:W,end:re},allDay:!1},w.extraDateSpan),dayEl:o.els[f],rect:{left:o.lefts[f],right:o.rights[f],top:b,bottom:b+D},layer:0}}return null}};function vZ(n,e){let t=e||n,i=ap(n,t);return i===null&&(t=n,i=1),{snapDuration:t,snapsPerSlot:i}}var KD=class extends rl{sliceRange(e,t){let i=[];for(let r=0;r<t.length;r+=1){let o=Pr(e,t[r]);o&&i.push({start:o.start,end:o.end,isStart:o.start.valueOf()===e.start.valueOf(),isEnd:o.end.valueOf()===e.end.valueOf(),col:r})}return i}},JD=class extends li{constructor(){super(...arguments),this.buildDayRanges=ve(_Z),this.slicer=new KD,this.timeColsRef=cn()}render(){let{props:e,context:t}=this,{dateProfile:i,dayTableModel:r}=e,{nowIndicator:o,nextDayThreshold:s}=t.options,l=this.buildDayRanges(r,i,t.dateEnv);return k(Zo,{unit:o?"minute":"day"},(c,u)=>k(QD,Object.assign({ref:this.timeColsRef},this.slicer.sliceProps(e,i,null,t,l),{forPrint:e.forPrint,axis:e.axis,dateProfile:i,slatMetas:e.slatMetas,slotDuration:e.slotDuration,cells:r.cells[0],tableColGroupNode:e.tableColGroupNode,tableMinWidth:e.tableMinWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight,expandRows:e.expandRows,nowDate:c,nowIndicatorSegs:o&&this.slicer.sliceNowDate(c,i,s,t,l),todayRange:u,onScrollTopRequest:e.onScrollTopRequest,onSlatCoords:e.onSlatCoords})))}};function _Z(n,e,t){let i=[];for(let r of n.headerDates)i.push({start:t.add(r,e.slotMinTime),end:t.add(r,e.slotMaxTime)});return i}var SF=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];function yZ(n,e,t,i,r){let o=new Date(0),s=n,l=qe(0),c=t||bZ(i),u=[];for(;Oi(s)<Oi(e);){let f=r.add(o,s),m=ap(l,c)!==null;u.push({date:f,time:s,key:f.toISOString(),isoTimeStr:Rx(f),isLabeled:m}),s=sp(s,i),l=sp(l,i)}return u}function bZ(n){let e,t,i;for(e=SF.length-1;e>=0;e-=1)if(t=qe(SF[e]),i=ap(t,n),i!==null&&i>1)return t;return n}var f0=class extends HD{constructor(){super(...arguments),this.buildTimeColsModel=ve(wZ),this.buildSlatMetas=ve(yZ)}render(){let{options:e,dateEnv:t,dateProfileGenerator:i}=this.context,{props:r}=this,{dateProfile:o}=r,s=this.buildTimeColsModel(o,i),l=this.allDaySplitter.splitProps(r),c=this.buildSlatMetas(o.slotMinTime,o.slotMaxTime,e.slotLabelInterval,e.slotDuration,t),{dayMinWidth:u}=e,f=!u,m=u,w=e.dayHeaders&&k(tl,{dates:s.headerDates,dateProfile:o,datesRepDistinctDays:!0,renderIntro:f?this.renderHeadAxis:null}),b=e.allDaySlot!==!1&&(T=>k(Cp,Object.assign({},l.allDay,{dateProfile:o,dayTableModel:s,nextDayThreshold:e.nextDayThreshold,tableMinWidth:T.tableMinWidth,colGroupNode:T.tableColGroupNode,renderRowIntro:f?this.renderTableRowAxis:null,showWeekNumbers:!1,expandRows:!1,headerAlignElRef:this.headerElRef,clientWidth:T.clientWidth,clientHeight:T.clientHeight,forPrint:r.forPrint},this.getAllDayMaxEventProps()))),D=T=>k(JD,Object.assign({},l.timed,{dayTableModel:s,dateProfile:o,axis:f,slotDuration:e.slotDuration,slatMetas:c,forPrint:r.forPrint,tableColGroupNode:T.tableColGroupNode,tableMinWidth:T.tableMinWidth,clientWidth:T.clientWidth,clientHeight:T.clientHeight,onSlatCoords:this.handleSlatCoords,expandRows:T.expandRows,onScrollTopRequest:this.handleScrollTopRequest}));return m?this.renderHScrollLayout(w,b,D,s.colCnt,u,c,this.state.slatCoords):this.renderSimpleLayout(w,b,D)}};function wZ(n,e){let t=new nl(n.renderRange,e);return new il(t,!1)}var SZ='.fc-v-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-v-event .fc-event-main{color:var(--fc-event-text-color);height:100%}.fc-v-event .fc-event-main-frame{display:flex;flex-direction:column;height:100%}.fc-v-event .fc-event-time{flex-grow:0;flex-shrink:0;max-height:100%;overflow:hidden}.fc-v-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-height:0}.fc-v-event .fc-event-title{bottom:0;max-height:100%;overflow:hidden;top:0}.fc-v-event:not(.fc-event-start){border-top-left-radius:0;border-top-right-radius:0;border-top-width:0}.fc-v-event:not(.fc-event-end){border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-width:0}.fc-v-event.fc-event-selected:before{left:-10px;right:-10px}.fc-v-event .fc-event-resizer-start{cursor:n-resize}.fc-v-event .fc-event-resizer-end{cursor:s-resize}.fc-v-event:not(.fc-event-selected) .fc-event-resizer{height:var(--fc-event-resizer-thickness);left:0;right:0}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-start{top:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer{left:50%;margin-left:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-start{top:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc .fc-timegrid .fc-daygrid-body{z-index:2}.fc .fc-timegrid-divider{padding:0 0 2px}.fc .fc-timegrid-body{min-height:100%;position:relative;z-index:1}.fc .fc-timegrid-axis-chunk{position:relative}.fc .fc-timegrid-axis-chunk>table,.fc .fc-timegrid-slots{position:relative;z-index:1}.fc .fc-timegrid-slot{border-bottom:0;height:1.5em}.fc .fc-timegrid-slot:empty:before{content:"\\00a0"}.fc .fc-timegrid-slot-minor{border-top-style:dotted}.fc .fc-timegrid-slot-label-cushion{display:inline-block;white-space:nowrap}.fc .fc-timegrid-slot-label{vertical-align:middle}.fc .fc-timegrid-axis-cushion,.fc .fc-timegrid-slot-label-cushion{padding:0 4px}.fc .fc-timegrid-axis-frame-liquid{height:100%}.fc .fc-timegrid-axis-frame{align-items:center;display:flex;justify-content:flex-end;overflow:hidden}.fc .fc-timegrid-axis-cushion{flex-shrink:0;max-width:60px}.fc-direction-ltr .fc-timegrid-slot-label-frame{text-align:right}.fc-direction-rtl .fc-timegrid-slot-label-frame{text-align:left}.fc-liquid-hack .fc-timegrid-axis-frame-liquid{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-timegrid-col-frame{min-height:100%;position:relative}.fc-media-screen.fc-liquid-hack .fc-timegrid-col-frame{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols{bottom:0;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols>table{height:100%}.fc-media-screen .fc-timegrid-col-bg,.fc-media-screen .fc-timegrid-col-events,.fc-media-screen .fc-timegrid-now-indicator-container{left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col-bg{z-index:2}.fc .fc-timegrid-col-bg .fc-non-business{z-index:1}.fc .fc-timegrid-col-bg .fc-bg-event{z-index:2}.fc .fc-timegrid-col-bg .fc-highlight{z-index:3}.fc .fc-timegrid-bg-harness{left:0;position:absolute;right:0}.fc .fc-timegrid-col-events{z-index:3}.fc .fc-timegrid-now-indicator-container{bottom:0;overflow:hidden}.fc-direction-ltr .fc-timegrid-col-events{margin:0 2.5% 0 2px}.fc-direction-rtl .fc-timegrid-col-events{margin:0 2px 0 2.5%}.fc-timegrid-event-harness{position:absolute}.fc-timegrid-event-harness>.fc-timegrid-event{bottom:0;left:0;position:absolute;right:0;top:0}.fc-timegrid-event-harness-inset .fc-timegrid-event,.fc-timegrid-event.fc-event-mirror,.fc-timegrid-more-link{box-shadow:0 0 0 1px var(--fc-page-bg-color)}.fc-timegrid-event,.fc-timegrid-more-link{border-radius:3px;font-size:var(--fc-small-font-size)}.fc-timegrid-event{margin-bottom:1px}.fc-timegrid-event .fc-event-main{padding:1px 1px 0}.fc-timegrid-event .fc-event-time{font-size:var(--fc-small-font-size);margin-bottom:1px;white-space:nowrap}.fc-timegrid-event-short .fc-event-main-frame{flex-direction:row;overflow:hidden}.fc-timegrid-event-short .fc-event-time:after{content:"\\00a0-\\00a0"}.fc-timegrid-event-short .fc-event-title{font-size:var(--fc-small-font-size)}.fc-timegrid-more-link{background:var(--fc-more-link-bg-color);color:var(--fc-more-link-text-color);cursor:pointer;margin-bottom:1px;position:absolute;z-index:9999}.fc-timegrid-more-link-inner{padding:3px 2px;top:0}.fc-direction-ltr .fc-timegrid-more-link{right:0}.fc-direction-rtl .fc-timegrid-more-link{left:0}.fc .fc-timegrid-now-indicator-arrow,.fc .fc-timegrid-now-indicator-line{pointer-events:none}.fc .fc-timegrid-now-indicator-line{border-color:var(--fc-now-indicator-color);border-style:solid;border-width:1px 0 0;left:0;position:absolute;right:0;z-index:4}.fc .fc-timegrid-now-indicator-arrow{border-color:var(--fc-now-indicator-color);border-style:solid;margin-top:-5px;position:absolute;z-index:4}.fc-direction-ltr .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 0 5px 6px;left:0}.fc-direction-rtl .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 6px 5px 0;right:0}';Kc(SZ);var CZ={allDaySlot:Boolean},xF=nr({name:"@fullcalendar/timegrid",initialView:"timeGridWeek",optionRefiners:CZ,views:{timeGrid:{component:f0,usesMinMaxTime:!0,allDaySlot:!0,slotDuration:"00:30:00",slotEventOverlap:!0},timeGridDay:{type:"timeGrid",duration:{days:1}},timeGridWeek:{type:"timeGrid",duration:{weeks:1}}}});var ir=class n{constructor(e,t){this.supabase=e;this.auth=t}generateTemporaryUid(){return`temp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}createClient(e){return C(this,null,function*(){try{let i=(yield this.supabase.getMyProfile(!0))?.id;if(!i)throw new Error("Salone non trovato");let r={first_name:e.first_name,last_name:e.last_name,email:e.email,phone:e.phone,data_nascita:e.data_nascita,full_name:`${e.first_name} ${e.last_name}`,salon_id:i,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),sesso:e.sesso},{data:o,error:s}=yield this.supabase.getClient().from("clients").insert([r]).select();if(s)throw console.error("Errore nella creazione del cliente:",s),s;return o&&o[0]&&(yield this.addClientToSalon(o[0].id,i)),o?o[0]:null}catch(t){throw console.error("Errore nella creazione del cliente:",t),t}})}getClientsBySalon(){return C(this,null,function*(){try{let t=(yield this.supabase.getMyProfile(!0))?.id;if(!t)return[];let{data:i,error:r}=yield this.supabase.getClient().from("clients").select("*").eq("salon_id",t);r&&console.error("Errore nel recupero clienti diretti:",r);let{data:o,error:s}=yield this.supabase.getClient().from("client_salons").select("client:clients(*)").eq("salon_id",t);s&&console.error("Errore nel recupero clienti collegati:",s);let l=new Map;if(i&&Array.isArray(i))for(let c of i)c&&typeof c=="object"&&"id"in c&&l.set(c.id,c);if(o&&Array.isArray(o)){for(let c of o)if(c&&typeof c=="object"&&"client"in c){let u=c.client;u&&typeof u=="object"&&"id"in u&&l.set(u.id,u)}}return Array.from(l.values())}catch(e){return console.error("Errore nel recupero clienti:",e),[]}})}searchClients(e){return C(this,null,function*(){try{let i=(yield this.supabase.getMyProfile(!0))?.id;if(!i||!e)return[];let{data:r,error:o}=yield this.supabase.getClient().from("clients").select("*").eq("salon_id",i).or(`first_name.ilike.%${e}%,last_name.ilike.%${e}%,email.ilike.%${e}%,phone.ilike.%${e}%`).order("first_name");return o?(console.error("Errore nella ricerca clienti:",o),[]):r||[]}catch(t){return console.error("Errore nella ricerca clienti:",t),[]}})}clientExists(e,t,i,r){return C(this,null,function*(){try{let s=(yield this.auth.getMyProfile(!0))?.id;if(!s)return!1;let l=this.supabase.getClient().from("clients").select("*").eq("salon_id",s).eq("first_name",e).eq("last_name",t);i&&(l=l.eq("email",i)),r&&(l=l.eq("phone",r));let{data:c,error:u}=yield l;return u?(console.error("Errore nella verifica cliente:",u),!1):c&&c.length>0}catch(o){return console.error("Errore nella verifica cliente:",o),!1}})}filterClientsLocally(e,t){if(!t)return e;let i=t.toLowerCase();return e.filter(r=>r.full_name?.toLowerCase().includes(i)||r.email&&r.email.toLowerCase().includes(i)||r.phone&&r.phone.includes(t))}getClientById(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("clients").select("*").eq("id",e).single();return i?(console.error("Errore nel recupero del cliente:",i),null):t}catch(t){return console.error("Errore nel recupero del cliente:",t),null}})}deleteClient(e){return C(this,null,function*(){try{let i=(yield this.supabase.getMyProfile(!0))?.id;if(!i)throw new Error("Salone non trovato");if(!(yield this.getClientById(e)))throw new Error("Cliente non trovato");if(yield this.checkClientAppointments(e))throw new Error("Impossibile eliminare il cliente: ha appuntamenti associati. Cancella prima tutti gli appuntamenti.");if(yield this.checkActiveLoyaltyCard(e))throw new Error("Impossibile eliminare il cliente: ha una tessera fedelt\xE0 attiva. Disattiva prima la tessera.");let{error:l}=yield this.supabase.getClient().from("clients").delete().eq("id",e).eq("salon_id",i);if(l)throw console.error("Errore nell'eliminazione del cliente:",l),new Error("Errore durante l'eliminazione del cliente dal database");return!0}catch(t){throw console.error("Errore nell'eliminazione del cliente:",t),t}})}updateClient(e,t){return C(this,null,function*(){try{let r=(yield this.supabase.getMyProfile(!0))?.id;if(!r)throw new Error("Salone non trovato");let o={first_name:t.first_name,last_name:t.last_name,email:t.email,phone:t.phone,data_nascita:t.data_nascita,full_name:`${t.first_name} ${t.last_name}`,updated_at:new Date().toISOString(),sesso:t.sesso},{data:s,error:l}=yield this.supabase.getClient().from("clients").update(o).eq("id",e).eq("salon_id",r).select();if(l)throw console.error("Errore nell'aggiornamento del cliente:",l),l;return s?s[0]:null}catch(i){throw console.error("Errore nell'aggiornamento del cliente:",i),i}})}checkClientAppointments(e){return C(this,null,function*(){try{let i=(yield this.supabase.getMyProfile(!0))?.id;if(!i)return!1;let{data:r,error:o}=yield this.supabase.getClient().from("appointments").select("id").eq("client_id",e).eq("salon_id",i).limit(1);return o?(console.error("Errore nel controllo appuntamenti:",o),!1):r&&r.length>0}catch(t){return console.error("Errore nel controllo appuntamenti:",t),!1}})}checkActiveLoyaltyCard(e){return C(this,null,function*(){try{let i=(yield this.supabase.getMyProfile(!0))?.id;if(!i)return!1;let{data:r,error:o}=yield this.supabase.getClient().from("loyalty_cards").select("id").eq("client_id",e).eq("salon_id",i).eq("active",!0).limit(1);return o?(console.error("Errore nel controllo tessera fedelt\xE0:",o),!1):r&&r.length>0}catch(t){return console.error("Errore nel controllo tessera fedelt\xE0:",t),!1}})}addClientToSalon(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.getClient().from("client_salons").insert([{client_id:e,salon_id:t}]);if(i)throw i})}removeClientFromSalon(e,t){return C(this,null,function*(){let{error:i}=yield this.supabase.getClient().from("client_salons").delete().eq("client_id",e).eq("salon_id",t);if(i)throw i})}migrateAppointmentClients(){return C(this,null,function*(){try{let e=yield this.supabase.getMyProfile(!0);if(!e?.id)return;let{data:t,error:i}=yield this.supabase.getClient().from("appointments").select("*").eq("salon_id",e.id).not("client_id","in",`(SELECT id FROM clients WHERE salon_id = '${e.id}')`);if(i)throw i;for(let r of t){let{data:o}=yield this.supabase.getClient().from("profiles").select("*").eq("id",r.client_id).single();if(o){let s=yield this.createClient({first_name:o.first_name||"Cliente",last_name:o.last_name||"Appuntamento",email:o.email,phone:o.telefono,profile_id:r.client_id,salon_id:e.id});yield this.supabase.getClient().from("appointments").update({client_id:s.id}).eq("id",r.id)}}}catch(e){console.error("Errore nella migrazione dei clienti:",e)}})}static \u0275fac=function(t){return new(t||n)(te(ue),te(ln))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};function EZ(n,e){n&1&&(g(0,"div",25)(1,"div",26),ie(2,"div",27),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}function xZ(n,e){if(n&1&&(g(0,"span")(1,"i",28),v(2,"phone"),p(),v(3),p()),n&2){let t=E();_(3),J(" ",(t.clientDetails==null?null:t.clientDetails.telefono)||(t.clientDetails==null?null:t.clientDetails.phone)," ")}}function DZ(n,e){if(n&1&&(g(0,"span")(1,"i",28),v(2,"email"),p(),v(3),p()),n&2){let t=E();_(3),J(" ",t.clientDetails.email," ")}}function IZ(n,e){if(n&1&&(g(0,"div",29)(1,"div",30),v(2),p(),g(3,"div",31),v(4),p(),g(5,"div",32),v(6),Me(7,"currency"),p()()),n&2){let t=E();_(2),q((t.event==null||t.event.extendedProps==null?null:t.event.extendedProps.serviceName)||"N/D"),_(2),J(" Durata: ",(t.event==null||t.event.extendedProps==null?null:t.event.extendedProps.serviceTiming)||60," minuti "),_(2),J(" Prezzo: ",Te(7,3,(t.event==null||t.event.extendedProps==null?null:t.event.extendedProps.price)||0,"EUR")," ")}}function MZ(n,e){if(n&1&&ie(0,"optgroup",39),n&2){let t=E().$implicit;x("label",t.name)}}function TZ(n,e){if(n&1&&(g(0,"option",35),v(1),Me(2,"currency"),p()),n&2){let t=E().$implicit;x("ngValue",t),_(),No(" ",t.name," - ",t.timing," min - ",Te(2,4,t.price,"EUR")," ")}}function PZ(n,e){if(n&1&&(tt(0),N(1,MZ,1,1,"optgroup",37)(2,TZ,3,7,"option",38),nt()),n&2){let t=e.$implicit;_(),x("ngIf",t.is_group),_(),x("ngIf",!t.is_group)}}function AZ(n,e){if(n&1){let t=ee();g(0,"div",33)(1,"select",34),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editedService,r)||(o.editedService=r),R(r)}),F("change",function(){A(t);let r=E();return R(r.calculateEndTime())}),g(2,"option",35),v(3,"Seleziona un servizio"),p(),N(4,PZ,3,2,"ng-container",36),p()()}if(n&2){let t=E();_(),G("ngModel",t.editedService),_(),x("ngValue",null),_(2),x("ngForOf",t.servicesWithGroups)}}function RZ(n,e){if(n&1&&(g(0,"div",40)(1,"div",41),v(2),p(),g(3,"div",42),v(4),p()()),n&2){let t=E();_(2),q(t.formatDate(t.event==null?null:t.event.start)),_(2),yt(" Dalle ",t.formatTime(t.event==null?null:t.event.start)," alle ",t.formatTime(t.event==null?null:t.event.end)," ")}}function kZ(n,e){if(n&1){let t=ee();g(0,"div",43)(1,"div",44)(2,"div",45)(3,"input",46),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editedStartDate,r)||(o.editedStartDate=r),R(r)}),F("change",function(){A(t);let r=E();return R(r.calculateEndTime())}),p()()(),g(4,"div",44)(5,"div",45)(6,"label",47),v(7,"Ora inizio *"),p(),g(8,"input",48),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editedStartTime,r)||(o.editedStartTime=r),R(r)}),F("change",function(){A(t);let r=E();return R(r.calculateEndTime())}),p()(),g(9,"div",45)(10,"label",49),v(11,"Ora fine"),p(),g(12,"input",50),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editedEndTime,r)||(o.editedEndTime=r),R(r)}),p()()()()}if(n&2){let t=E();_(3),G("ngModel",t.editedStartDate),_(5),G("ngModel",t.editedStartTime),_(4),G("ngModel",t.editedEndTime)}}function OZ(n,e){if(n&1&&(g(0,"div",51),v(1),p()),n&2){let t=E();_(),J(" ",t.editedNotes||"Nessuna nota"," ")}}function NZ(n,e){if(n&1){let t=ee();g(0,"div",52)(1,"label",53),v(2,"Note"),p(),g(3,"textarea",54),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editedNotes,r)||(o.editedNotes=r),R(r)}),p()()}if(n&2){let t=E();_(3),G("ngModel",t.editedNotes)}}function LZ(n,e){if(n&1&&(g(0,"div",6)(1,"h4"),v(2,"Stato Pagamento"),p(),g(3,"div",55),v(4),p()()),n&2){let t=E();_(3),Oe("paid",t.event.extendedProps.payment_status==="paid")("unpaid",t.event.extendedProps.payment_status==="unpaid"),_(),J(" ",t.event.extendedProps.payment_status==="paid"?"Pagato":"Da pagare"," ")}}function FZ(n,e){if(n&1&&(g(0,"div",56)(1,"span",57),v(2,"\u26A0"),p(),v(3),p()),n&2){let t=E();_(3),J(" ",t.errorMsg," ")}}function zZ(n,e){if(n&1){let t=ee();g(0,"button",58),F("click",function(){A(t);let r=E();return R(r.enableEditing())}),v(1," Modifica "),p()}}function VZ(n,e){if(n&1){let t=ee();g(0,"button",59),F("click",function(){A(t);let r=E();return R(r.saveChanges())}),v(1," Salva modifiche "),p()}if(n&2){let t=E();x("disabled",t.saving)}}var cd=class n{constructor(e,t,i,r,o,s){this.appointmentService=e;this.clientService=t;this.salonService=i;this.dipendentiService=r;this.supabase=o;this.auth=s}event;close=new ye;saved=new ye;deleted=new ye;loading=!0;editing=!1;saving=!1;errorMsg="";editedNotes="";editedService=null;editedStartDate="";editedStartTime="";editedEndTime="";services=[];servicesWithGroups=[];clientDetails=null;dipendenteDetails=null;displayServiceName="N/D";displayServiceTiming=null;displayServicePrice=null;displayStart=null;displayEnd=null;dipendenti=[];editedDipendenteId=null;editedDipendente=null;ngOnInit(){return C(this,null,function*(){if(this.loading=!0,this.servicesWithGroups=yield this.salonService.getServicesOnly(!0),this.services=this.servicesWithGroups.filter(f=>!f.is_group),console.log("--- popup init raw event ---",this.event),!this.event)return;let e=(f,m=this.event)=>{for(let w of f)try{if(typeof w=="string"){let b=this._get(m,w);if(b!=null)return b}else if(Array.isArray(w))for(let b of w){let D=this._get(m,b);if(D!=null)return D}}catch{}return null},t=e(["extendedProps","_def.extendedProps","_instance?.range?.def.extendedProps","_def?.publicId",["extendedProps","_def.extendedProps","props","extendedProps"]])||{};console.log("extendedProps resolved:",t);let i=t.notes??t.note??this.event.notes??this.event.titleNotes??null;this.editedNotes=i??"";let r=e(["extendedProps.service_id","_def.extendedProps.service_id","extendedProps.serviceId","service_id","serviceId","extendedProps.service?.id","id"]),o=e(["extendedProps.serviceName","_def.extendedProps.serviceName","title","_def.title","extendedProps.service_name","extendedProps.service"]);if(r&&(this.editedService=this.services.find(f=>String(f.id)===String(r))||null,!this.editedService))try{let f=yield this.salonService.getServiceById(String(r));f&&(this.editedService=f)}catch(f){console.warn("getServiceById failed",f)}if(!this.editedService&&o){let f=this.services.find(m=>String(m.name).trim().toLowerCase()===String(o).trim().toLowerCase());f&&(this.editedService=f)}this.displayServiceName=this.editedService?.name||o||"N/D",this.displayServiceTiming=this.editedService?.timing??t.serviceTiming??t.timing??null,this.displayServicePrice=this.editedService?.price??t.price??null;let s=e(["start","startStr","_instance?.range?.start","_def?.start","extendedProps.start_time","extendedProps.startTime","extendedProps.start"]),l=e(["end","endStr","_instance?.range?.end","_def?.end","extendedProps.end_time","extendedProps.endTime","extendedProps.end"]);if(this.displayStart=this._toDate(s),this.displayEnd=this._toDate(l),!this.displayStart&&t.start_time&&(this.displayStart=this._toDate(t.start_time)),!this.displayEnd&&this.displayStart&&(this.displayServiceTiming||t.serviceTiming||t.timing)){let f=this.displayServiceTiming??t.serviceTiming??t.timing??60;this.displayEnd=new Date(this.displayStart.getTime()+f*6e4)}this.displayStart&&(this.editedStartDate=this.displayStart.toISOString().split("T")[0],this.editedStartTime=this.displayStart.toTimeString().substring(0,5)),this.displayEnd&&(this.editedEndTime=this.displayEnd.toTimeString().substring(0,5)),console.log("displayServiceName, timing, price",this.displayServiceName,this.displayServiceTiming,this.displayServicePrice),console.log("displayStart/displayEnd",this.displayStart,this.displayEnd);let c=t.client_id??t.clientId??this.event.client_id??this.event.extendedProps?.client_id??null;if(c)try{this.clientDetails=yield this.clientService.getClientById(c),this.clientDetails||(this.clientDetails=yield this.getClientFromProfiles(c))}catch(f){console.error("Errore caricamento clientDetails",f)}else this.clientDetails={full_name:t.clientName??t.client_name??this.event.title??null,telefono:t.clientPhone??t.client_phone??null,email:t.clientEmail??t.client_email??null};this.loading=!1;let u=t.dipendente_id??t.dipendenteId??t.employee_id??t.employeeId??null;if(u)try{this.dipendenteDetails=yield this.dipendentiService.getDipendenteById(u)}catch(f){console.error("Errore caricamento dipendente",f)}else this.dipendenteDetails={nome:t.dipendenteName??t.employeeName??t.dipendente_name??null,cognome:t.dipendenteSurname??t.employeeSurname??t.dipendente_surname??null};console.log("clientDetails resolved:",this.clientDetails),console.log("dipendenteDetails resolved:",this.dipendenteDetails)})}_get(e,t){if(!e||!t)return;let i=t.split("."),r=e;for(let o of i){let s=o.replace("?","");if(r==null)return;r=r[s]}return r}_toDate(e){if(!e&&e!==0)return null;if(e instanceof Date)return e;if(e&&typeof e=="object"&&e.start)return this._toDate(e.start);let t=new Date(e);return isNaN(t.getTime())?null:t}calculateEndTime(){if(this.editedService&&this.editedStartDate&&this.editedStartTime){let e=this.editedService.timing||60,t=new Date(`${this.editedStartDate}T${this.editedStartTime}`),i=new Date(t.getTime()+e*6e4);this.editedEndTime=i.toTimeString().substring(0,5)}}enableEditing(){this.editing=!0}cancelEditing(){this.editing=!1,this.ngOnInit()}saveChanges(){return C(this,null,function*(){this.saving=!0,this.errorMsg="";try{if(!this.editedService){this.errorMsg="Seleziona un servizio",this.saving=!1;return}let e=new Date(`${this.editedStartDate}T${this.editedStartTime}`),t=new Date(`${this.editedStartDate}T${this.editedEndTime}`);if(t<=e){this.errorMsg="L'orario di fine deve essere successivo all'orario di inizio",this.saving=!1;return}let i={id:this.event.id,service_id:this.editedService.id,start_time:e.toISOString(),end_time:t.toISOString(),notes:this.editedNotes,status:this.event.extendedProps?.status||"confirmed",client_id:this.event.extendedProps?.client_id,price:this.editedService.price},o=(yield this.auth.getMyProfile())?.id,s=yield this.appointmentService.updateAppointment(i,o);console.log("Risultato aggiornamento appuntamento:",s),s&&s.status==="pending"?(this.errorMsg="Richiesta di modifica inviata al cliente. Attendi la conferma.",setTimeout(()=>{this.editing=!1,this.close.emit()},2e3)):(this.editing=!1,this.saved.emit(s),this.close.emit())}catch(e){console.error("Errore aggiornamento appuntamento:",e),this.errorMsg=e?.message||"Errore nel salvataggio"}finally{this.saving=!1}})}deleteAppointment(){return C(this,null,function*(){if(confirm("Sei sicuro di voler cancellare questo appuntamento?")){this.saving=!0;try{yield this.appointmentService.cancelAppointment(this.event.id),this.deleted.emit(this.event.id),this.close.emit()}catch(e){console.error("Errore cancellazione appuntamento:",e),this.errorMsg=e?.message||"Errore durante la cancellazione"}finally{this.saving=!1}}})}formatDate(e){if(!e)return"N/D";let t=e instanceof Date?e:new Date(e);return isNaN(t.getTime())?"N/D":t.toLocaleDateString("it-IT",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}formatTime(e){if(!e)return"N/D";let t=e instanceof Date?e:new Date(e);return isNaN(t.getTime())?"N/D":t.toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"})}closePopup(){this.close.emit()}getClientFromProfiles(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("profiles").select("id, first_name, last_name, full_name, telefono, email").eq("id",e).single();return i?(console.error("Errore recupero cliente da profiles:",i),null):t}catch(t){return console.error("Errore recupero cliente da profiles:",t),null}})}getSalonIdFromEventOrUser(e){return C(this,null,function*(){let t=e?.salon_id??e?.salonId??this.event?.extendedProps?.salon_id??null;if(t)return String(t);try{return(yield this.auth.getMyProfile())?.id??null}catch{return null}})}static \u0275fac=function(t){return new(t||n)(z(qn),z(ir),z(Ji),z(_i),z(ue),z(ln))};static \u0275cmp=he({type:n,selectors:[["app-popup-calendario"]],inputs:{event:"event"},outputs:{close:"close",saved:"saved",deleted:"deleted"},decls:49,vars:20,consts:[[1,"popup-backdrop",3,"click"],[1,"popup-card",3,"click"],["class","loading-overlay",4,"ngIf"],[1,"popup-header"],[1,"btn-remove",3,"click","disabled"],[1,"popup-content"],[1,"detail-section"],[1,"client-info"],[1,"client-name"],[1,"client-contact"],[4,"ngIf"],["class","service-info",4,"ngIf"],["class","edit-service",4,"ngIf"],["class","datetime-info",4,"ngIf"],["class","edit-datetime",4,"ngIf"],["class","notes-info",4,"ngIf"],["class","edit-notes",4,"ngIf"],["class","detail-section",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"popup-actions"],[1,"btn","btn-danger",3,"click","disabled"],[1,"action-group"],[1,"btn",3,"click","disabled"],["class","btn-primary",3,"click",4,"ngIf"],["class","btn-primary",3,"disabled","click",4,"ngIf"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"],[1,"material-icons"],[1,"service-info"],[1,"service-name"],[1,"service-duration"],[1,"service-price"],[1,"edit-service"],["id","serviceSelect","required","",1,"input-field",3,"ngModelChange","change","ngModel"],[3,"ngValue"],[4,"ngFor","ngForOf"],[3,"label",4,"ngIf"],[3,"ngValue",4,"ngIf"],[3,"label"],[1,"datetime-info"],[1,"appointment-date"],[1,"appointment-time"],[1,"edit-datetime"],[1,"form-row"],[1,"form-group"],["id","appointmentDate","type","date","required","",1,"input-field",3,"ngModelChange","change","ngModel"],["for","startTime"],["id","startTime","type","time","required","",1,"input-field",3,"ngModelChange","change","ngModel"],["for","endTime"],["id","endTime","type","time","readonly","",1,"input-field",3,"ngModelChange","ngModel"],[1,"notes-info"],[1,"edit-notes"],["for","appointmentNotes"],["id","appointmentNotes","placeholder","Aggiungi note opzionali","rows","3",1,"input-field",3,"ngModelChange","ngModel"],[1,"payment-status"],[1,"error-message"],[1,"error-icon"],[1,"btn-primary",3,"click"],[1,"btn-primary",3,"click","disabled"]],template:function(t,i){t&1&&(g(0,"div",0),F("click",function(){return i.closePopup()}),g(1,"div",1),F("click",function(o){return o.stopPropagation()}),N(2,EZ,5,0,"div",2),g(3,"div",3)(4,"h3"),v(5,"Dettagli Appuntamento"),p(),g(6,"button",4),F("click",function(){return i.closePopup()}),v(7," \xD7 "),p()(),g(8,"div",5)(9,"div",6)(10,"h4"),v(11,"Cliente"),p(),g(12,"div",7)(13,"div",8),v(14),p(),g(15,"div",9),N(16,xZ,4,1,"span",10)(17,DZ,4,1,"span",10),p()()(),g(18,"div",6)(19,"h4"),v(20,"Servizio"),p(),N(21,IZ,8,6,"div",11)(22,AZ,5,3,"div",12),p(),g(23,"div",6)(24,"h4"),v(25,"Data e Orario"),p(),N(26,RZ,5,3,"div",13)(27,kZ,13,3,"div",14),p(),g(28,"div",6)(29,"h4"),v(30,"Dipendente"),p(),g(31,"div",7)(32,"div",8),v(33),p()()(),g(34,"div",6)(35,"h4"),v(36,"Note"),p(),N(37,OZ,2,1,"div",15)(38,NZ,4,1,"div",16),p(),N(39,LZ,5,5,"div",17)(40,FZ,4,1,"div",18),p(),g(41,"div",19)(42,"button",20),F("click",function(){return i.deleteAppointment()}),v(43," Elimina "),p(),g(44,"div",21)(45,"button",22),F("click",function(){return i.editing?i.cancelEditing():i.closePopup()}),v(46),p(),N(47,zZ,2,0,"button",23)(48,VZ,2,1,"button",24),p()()()()),t&2&&(_(2),x("ngIf",i.loading),_(4),x("disabled",i.saving),_(8),J(" ",(i.clientDetails==null?null:i.clientDetails.full_name)||(i.clientDetails!=null&&i.clientDetails.first_name&&(i.clientDetails!=null&&i.clientDetails.last_name)?i.clientDetails.first_name+" "+i.clientDetails.last_name:"Cliente sconosciuto")," "),_(2),x("ngIf",(i.clientDetails==null?null:i.clientDetails.telefono)||(i.clientDetails==null?null:i.clientDetails.phone)),_(),x("ngIf",i.clientDetails==null?null:i.clientDetails.email),_(4),x("ngIf",!i.editing),_(),x("ngIf",i.editing),_(4),x("ngIf",!i.editing),_(),x("ngIf",i.editing),_(6),yt("",i.dipendenteDetails.nome," ",i.dipendenteDetails.cognome),_(4),x("ngIf",!i.editing),_(),x("ngIf",i.editing),_(),x("ngIf",i.event==null||i.event.extendedProps==null?null:i.event.extendedProps.payment_status),_(),x("ngIf",i.errorMsg),_(2),x("disabled",i.saving),_(3),x("disabled",i.saving),_(),J(" ",i.editing?"Annulla":"Chiudi"," "),_(),x("ngIf",!i.editing),_(),x("ngIf",i.editing))},dependencies:[Se,Ze,Ne,vt,Ot,Nt,st,Dt,at,Ln,pt,Sr],styles:[".popup-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000bf;display:flex;align-items:center;justify-content:center;z-index:10000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);animation:_ngcontent-%COMP%_fadeIn .2s ease-out;padding:20px;box-sizing:border-box;overflow-y:auto}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.popup-card[_ngcontent-%COMP%]{background:var(--background);color:var(--text-light);width:min(95vw,600px);max-height:90vh;border-radius:var(--border-radius);box-shadow:0 10px 30px #00000080;border:1px solid var(--primary);overflow:hidden;animation:_ngcontent-%COMP%_scaleIn .2s ease-out;display:flex;flex-direction:column}@keyframes _ngcontent-%COMP%_scaleIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.popup-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.2rem 1.5rem;border-bottom:1px solid var(--text-light);background:var(--background2);flex-shrink:0}.popup-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--primary);font-size:1.3rem;font-weight:700}.popup-content[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;flex:1;display:flex;flex-direction:column;gap:1.5rem}.detail-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.8rem}.detail-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:var(--primary);font-size:1.1rem;font-weight:600;border-bottom:1px solid var(--secondary);padding-bottom:.5rem}.client-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.client-name[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem;color:var(--text-light)}.client-contact[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;font-size:.9rem;color:var(--text-muted)}.client-contact[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.icon-phone[_ngcontent-%COMP%], .icon-email[_ngcontent-%COMP%]{width:16px;height:16px;opacity:.7}.service-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.3rem}.service-name[_ngcontent-%COMP%]{font-weight:600;font-size:1rem}.service-duration[_ngcontent-%COMP%], .service-price[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-muted)}.datetime-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.3rem}.appointment-date[_ngcontent-%COMP%]{font-weight:600;font-size:1rem}.appointment-time[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-muted)}.notes-info[_ngcontent-%COMP%]{font-style:italic;line-height:1.5;color:var(--text-muted);padding:.8rem;background:#ffffff08;border-radius:8px;border-left:3px solid var(--secondary)}.payment-status[_ngcontent-%COMP%]{display:inline-block;padding:var(--padding-v);border-radius:20px;font-size:var(--font-size-base);font-weight:600;max-width:fit-content}.payment-status.paid[_ngcontent-%COMP%]{background:#4caf5033;color:var(--success);border:1px solid var(--success)}.payment-status.unpaid[_ngcontent-%COMP%]{background:#f4433633;color:var(--text-light);border:1px solid var(--danger)}.edit-service[_ngcontent-%COMP%], .edit-datetime[_ngcontent-%COMP%], .edit-notes[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;width:100%}.form-group[_ngcontent-%COMP%]{flex:1;min-width:min(100%,200px)}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:var(--text-light);font-size:.95rem}.input-field[_ngcontent-%COMP%]{width:100%;padding:.85rem 1rem;border:1.5px solid rgba(255,255,255,.15);border-radius:8px;background:var(--background2);color:var(--text-light);font-size:1rem;transition:all .3s ease}.input-field[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px #d4af3733}textarea.input-field[_ngcontent-%COMP%]{min-height:100px;resize:vertical;width:100%}.popup-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;padding:1rem 1.5rem;border-top:1px solid rgba(255,255,255,.1);background:#ffffff08}.action-group[_ngcontent-%COMP%]{display:flex;gap:.8rem;flex-wrap:wrap}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important}.btn-danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6e0101,#d32f2f);border:none;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#d32f2f,#6e0101);transform:translateY(-2px);box-shadow:0 4px 12px #f443364d}.btn-icon[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem}.popup-card[_ngcontent-%COMP%]{width:min(95vw,600px)}.form-row[_ngcontent-%COMP%]{flex-direction:row}.form-group[_ngcontent-%COMP%]{min-width:min(100%,200px)}.popup-actions[_ngcontent-%COMP%], .action-group[_ngcontent-%COMP%]{flex-direction:row}@media (max-width: 480px){.popup-content[_ngcontent-%COMP%], .popup-header[_ngcontent-%COMP%], .popup-actions[_ngcontent-%COMP%]{padding:1rem}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:.8rem}.form-group[_ngcontent-%COMP%]{min-width:100%}.popup-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.action-group[_ngcontent-%COMP%]{justify-content:stretch}.action-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1;justify-content:center}}.popup-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.popup-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#ffffff0d;border-radius:4px}.popup-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--primary);border-radius:4px}.popup-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--secondary)}"]})};var p0=class n{constructor(e){this.http=e}base="/api/salons";getSalonsForMap(e={}){let t=new Cr;return Object.keys(e).forEach(i=>{e[i]!==void 0&&e[i]!==null&&(t=t.set(i,e[i]))}),this.http.get(`${this.base}/map`,{params:t})}static \u0275fac=function(t){return new(t||n)(te(Em))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var vo=class n{constructor(e){this.supabase=e}getOpeningHours(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("opening_hours").select("*").eq("salon_id",e).order("day_index",{ascending:!0});if(i)return console.error("Errore recupero orari:",i),[];let r=(t||[]).map(o=>ne(B({},o),{dayIndex:o.day_index}));return this.orderWeekMondayFirst(r)}catch(t){return console.error("Errore critico recupero orari:",t),[]}})}saveOpeningHours(e,t){return C(this,null,function*(){try{let i=t.map(o=>({salon_id:e,day_index:o.dayIndex,day_name:o.dayName,intervals:o.intervals,updated_at:new Date().toISOString()})),{error:r}=yield this.supabase.getClient().from("opening_hours").upsert(i,{onConflict:"salon_id,day_index"});if(r)throw r}catch(i){throw console.error("Errore salvataggio orari:",i),new Error("Impossibile salvare gli orari")}})}deleteAllOpeningHours(e){return C(this,null,function*(){try{let{error:t}=yield this.supabase.getClient().from("opening_hours").delete().eq("salon_id",e);if(t)throw t}catch(t){throw console.error("Errore eliminazione orari:",t),new Error("Impossibile eliminare gli orari")}})}formatTimeForFilter(e){if(!e)return"00:00";let[t,i]=e.split(":");return`${t.padStart(2,"0")}:${i.padStart(2,"0")}`}getOpeningHoursForSalon(e,t){return C(this,null,function*(){let{data:i,error:r}=yield this.supabase.getClient().from("opening_hours").select("*").eq("salon_id",e).eq("day_index",t).single();return r?(console.error("Errore recupero orari apertura:",r),null):i})}isSalonOpen(e,t){return C(this,null,function*(){let i=t.getDay(),r=yield this.getOpeningHoursForSalon(e,i);return!!(r&&r.intervals&&r.intervals.length>0)})}orderWeekMondayFirst(e,t="dayIndex"){return(e||[]).slice().sort((i,r)=>{let o=(Number(i[t]??i.day_index)+6)%7,s=(Number(r[t]??r.day_index)+6)%7;return o-s})}static \u0275fac=function(t){return new(t||n)(te(ue))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var BZ=["fc"];function UZ(n,e){n&1&&(g(0,"div",10)(1,"div",11),ie(2,"div",12),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}function HZ(n,e){if(n&1&&(g(0,"div",13),ie(1,"full-calendar",14,0),p()),n&2){let t=E();_(),x("options",t.calendarOptions)("events",t.events)}}function WZ(n,e){if(n&1&&(g(0,"span"),v(1),p()),n&2){let t=E().$implicit;_(),q(t.phone)}}function $Z(n,e){if(n&1&&(g(0,"span"),v(1),p()),n&2){let t=E().$implicit;_(),q(t.email)}}function qZ(n,e){if(n&1){let t=ee();g(0,"div",49),F("click",function(){let r=A(t).$implicit,o=E(4);return R(o.selectClientFromSearch(r))}),g(1,"div",50),v(2),p(),g(3,"div",51),N(4,WZ,2,1,"span",52)(5,$Z,2,1,"span",52),p()()}if(n&2){let t=e.$implicit;_(2),yt("",t.first_name," ",t.last_name),_(2),x("ngIf",t.phone),_(),x("ngIf",t.email)}}function GZ(n,e){if(n&1&&(g(0,"div",47),N(1,qZ,6,4,"div",48),p()),n&2){let t=E(3);_(),x("ngForOf",t.searchResults)}}function ZZ(n,e){n&1&&(g(0,"div",47)(1,"div",53),v(2,"Nessun cliente trovato"),p()())}function YZ(n,e){if(n&1){let t=ee();g(0,"div",42)(1,"div",43)(2,"input",44),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.searchQuery,r)||(o.searchQuery=r),R(r)}),F("input",function(){A(t);let r=E(2);return R(r.onSearchInput())})("focus",function(){A(t);let r=E(2);return R(r.onSearchInput())}),p(),g(3,"button",45),F("click",function(){A(t);let r=E(2);return r.showClientForm=!0,R(r.showSearchResults=!1)}),v(4," + Aggiungi "),p()(),N(5,GZ,2,1,"div",46)(6,ZZ,3,0,"div",46),p()}if(n&2){let t=E(2);_(2),Oe("searching",t.isSearching),G("ngModel",t.searchQuery),_(3),x("ngIf",t.showSearchResults&&t.searchResults.length>0),_(),x("ngIf",t.showSearchResults&&t.searchResults.length===0&&!t.isSearching)}}function QZ(n,e){if(n&1){let t=ee();g(0,"div",54)(1,"h4",55),v(2,"Aggiungi nuovo cliente"),p(),g(3,"div",29)(4,"div",20)(5,"label"),v(6,"Nome "),g(7,"span",56),v(8,"*"),p()(),g(9,"input",57),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.newClient.first_name,r)||(o.newClient.first_name=r),R(r)}),p()(),g(10,"div",20)(11,"label"),v(12,"Cognome "),g(13,"span",56),v(14,"*"),p()(),g(15,"input",57),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.newClient.last_name,r)||(o.newClient.last_name=r),R(r)}),p()()(),g(16,"div",29)(17,"div",20)(18,"label"),v(19,"Email"),p(),g(20,"input",58),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.newClient.email,r)||(o.newClient.email=r),R(r)}),p()(),g(21,"div",20)(22,"label"),v(23,"Telefono"),p(),g(24,"input",59),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.newClient.phone,r)||(o.newClient.phone=r),R(r)}),p()()(),g(25,"div",29)(26,"div",20)(27,"label"),v(28,"Data di Nascita (opzionale)"),p(),g(29,"input",60),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.newClient.data_nascita,r)||(o.newClient.data_nascita=r),R(r)}),p()(),g(30,"div",20)(31,"label"),v(32,"Sesso (opzionale)"),p(),g(33,"select",61),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.newClient.sesso,r)||(o.newClient.sesso=r),R(r)}),g(34,"option",27),v(35,"Seleziona sesso"),p(),g(36,"option",62),v(37,"Maschio"),p(),g(38,"option",63),v(39,"Femmina"),p()()()(),g(40,"div",64)(41,"button",65),F("click",function(){A(t);let r=E(2);return R(r.createClient())}),v(42," Salva cliente "),p(),g(43,"button",66),F("click",function(){A(t);let r=E(2);return R(r.showClientForm=!1)}),v(44," Annulla "),p()()()}if(n&2){let t=E(2);_(9),G("ngModel",t.newClient.first_name),_(6),G("ngModel",t.newClient.last_name),_(5),G("ngModel",t.newClient.email),_(4),G("ngModel",t.newClient.phone),_(5),G("ngModel",t.newClient.data_nascita),_(4),G("ngModel",t.newClient.sesso),_(),x("ngValue",null),_(7),x("disabled",!t.newClient.first_name||!t.newClient.last_name)}}function KZ(n,e){if(n&1){let t=ee();g(0,"div",67)(1,"strong"),v(2,"Cliente selezionato:"),p(),v(3),g(4,"button",68),F("click",function(){A(t);let r=E(2);return r.selectedClient=null,r.searchQuery="",R(r.resetServiceFilter())}),v(5," \xD7 "),p()()}if(n&2){let t=E(2);_(3),yt(" ",t.selectedClient.first_name," ",t.selectedClient.last_name," ")}}function JZ(n,e){if(n&1&&(g(0,"option",27),v(1),Me(2,"currency"),p()),n&2){let t=e.$implicit;x("ngValue",t),_(),No(" ",t.name," - ",t.timing," min - ",Te(2,4,t.price,"EUR")," ")}}function XZ(n,e){if(n&1&&(g(0,"optgroup",70),N(1,JZ,3,7,"option",71),p()),n&2){let t=E().$implicit,i=E(2);x("label",t.name),_(),x("ngForOf",i.getServicesInGroup(t.id))}}function eY(n,e){if(n&1&&(tt(0),N(1,XZ,2,2,"optgroup",69),nt()),n&2){let t=e.$implicit,i=E(2);_(),x("ngIf",t.is_group&&i.hasServicesInGroup(t.id))}}function tY(n,e){if(n&1&&(g(0,"div",72)(1,"span",73),v(2,"\u26A0"),p(),v(3),p()),n&2){let t=E(2);_(3),J(" ",t.errorMsg," ")}}function nY(n,e){n&1&&(g(0,"span",83),v(1,"\u2713 Disponibile"),p())}function iY(n,e){n&1&&(g(0,"span",84),v(1,"\u2717 Non disponibile"),p())}function rY(n,e){if(n&1&&(g(0,"option",78)(1,"span",79)(2,"span",80),v(3),p(),N(4,nY,2,0,"span",81)(5,iY,2,0,"span",82),p()()),n&2){let t=e.$implicit;x("ngValue",t)("disabled",!t.disponibile),_(3),yt("",t.nome," ",t.cognome),_(),x("ngIf",t.disponibile),_(),x("ngIf",!t.disponibile)}}function oY(n,e){n&1&&(g(0,"div",85),v(1," Nessun dipendente abilitato per questo servizio. "),p())}function sY(n,e){n&1&&(g(0,"div",85),ie(1,"i",86),v(2,' I dipendenti contrassegnati come "Non disponibile" hanno gi\xE0 appuntamenti in questo orario. '),p())}function aY(n,e){if(n&1){let t=ee();g(0,"div",20)(1,"label",74),v(2,"Dipendente:"),p(),g(3,"select",75),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.selectedDipendente,r)||(o.selectedDipendente=r),R(r)}),g(4,"option",27),v(5,"Seleziona un dipendente"),p(),N(6,rY,6,6,"option",76),p(),N(7,oY,2,0,"div",77)(8,sY,3,0,"div",77),p()}if(n&2){let t=E(2);_(3),G("ngModel",t.selectedDipendente),_(),x("ngValue",null),_(2),x("ngForOf",t.availableDipendenti),_(),x("ngIf",t.availableDipendenti.length===0),_(),x("ngIf",t.availableDipendenti.length>0)}}function lY(n,e){if(n&1){let t=ee();g(0,"button",87),F("click",function(){A(t);let r=E(2);return R(r.deleteEditor())}),g(1,"span",88),v(2,"\xD7"),p(),v(3," Elimina "),p()}if(n&2){let t=E(2);x("disabled",t.saving)}}function cY(n,e){if(n&1){let t=ee();g(0,"div",15)(1,"div",16)(2,"div",17)(3,"h3"),v(4),p(),g(5,"button",18),F("click",function(){A(t);let r=E();return R(r.openEditor=!1)}),v(6," \xD7 "),p()(),g(7,"div",19)(8,"div",20)(9,"label",21),v(10,"Cliente"),p(),N(11,YZ,7,5,"div",22)(12,QZ,45,8,"div",23)(13,KZ,6,2,"div",24),p(),g(14,"div",20)(15,"label",25),v(16,"Servizio"),p(),g(17,"select",26),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.selectedService,r)||(o.selectedService=r),R(r)}),F("change",function(){A(t);let r=E();return R(r.onServiceChange())}),g(18,"option",27),v(19,"Seleziona un servizio"),p(),N(20,eY,2,1,"ng-container",28),p()(),g(21,"div",29)(22,"div",20)(23,"label",30),v(24,"Data e ora inizio *"),p(),g(25,"input",31),Me(26,"date"),F("ngModelChange",function(r){A(t);let o=E();return o.updateDateTime(r,"start"),R(o.onServiceChange())}),p()(),g(27,"div",20)(28,"label",32),v(29,"Ora fine"),p(),ie(30,"input",33),Me(31,"date"),p()(),N(32,tY,4,1,"div",34)(33,aY,9,5,"div",35),g(34,"div",20)(35,"label",36),v(36,"Note"),p(),g(37,"textarea",37),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.editorNotes,r)||(o.editorNotes=r),R(r)}),p()(),g(38,"div",38)(39,"button",39),F("click",function(){A(t);let r=E();return R(r.saveEditor())}),v(40," Salva "),p(),N(41,lY,4,1,"button",40),g(42,"button",41),F("click",function(){A(t);let r=E();return R(r.openEditor=!1)}),v(43," Annulla "),p()()()()()}if(n&2){let t=E();_(4),q(t.editorModel!=null&&t.editorModel.id?"Modifica appuntamento":"Nuovo appuntamento"),_(),x("disabled",t.saving),_(6),x("ngIf",!t.showClientForm),_(),x("ngIf",t.showClientForm),_(),x("ngIf",t.selectedClient&&!t.showClientForm&&!t.showSearchResults),_(4),G("ngModel",t.selectedService),_(),x("ngValue",null),_(2),x("ngForOf",t.servicesWithGroups),_(5),x("ngModel",Te(26,16,t.editorModel.start,"yyyy-MM-ddTHH:mm")),_(5),x("value",t.editorModel.end?Te(31,19,t.editorModel.end,"HH:mm"):""),_(2),x("ngIf",t.errorMsg),_(),x("ngIf",t.appointmentSettings.mode==="advanced"&&t.selectedService),_(4),G("ngModel",t.editorNotes),_(2),x("disabled",t.saving||!t.selectedService||!t.selectedClient),_(2),x("ngIf",t.editorModel==null?null:t.editorModel.id),_(),x("disabled",t.saving)}}function dY(n,e){if(n&1){let t=ee();g(0,"app-popup-calendario",89),F("close",function(){A(t);let r=E();return R(r.selectedEvent=null)})("saved",function(r){A(t);let o=E();return R(o.onEventSaved(r))})("deleted",function(r){A(t);let o=E();return R(o.onEventDeleted(r))}),p()}if(n&2){let t=E();x("event",t.selectedEvent)}}function uY(n,e){if(n&1&&(g(0,"span",99),v(1),p()),n&2){let t=E().$implicit;_(),yt(" Dipendente: ",t.dipendenteData.nome," ",t.dipendenteData.cognome," ")}}function fY(n,e){if(n&1&&(g(0,"div",94)(1,"div",95)(2,"strong"),v(3),p(),v(4),Me(5,"date"),p(),g(6,"div",96)(7,"span",97),v(8),Me(9,"date"),p(),N(10,uY,2,2,"span",98),p()()),n&2){let t=e.$implicit;_(3),yt("",t.client==null?null:t.client.first_name," ",t.client==null?null:t.client.last_name),_(),yt(" ",t.servizio==null?null:t.servizio.name," - ",Te(5,6,t.start_time,"dd/MM/yyyy HH:mm")," "),_(4),J(" Cancellato il: ",Te(9,9,t.cancelled_at,"dd/MM/yyyy HH:mm")," "),_(2),x("ngIf",t.dipendenteData)}}function pY(n,e){n&1&&(g(0,"div",100),v(1," Nessun appuntamento cancellato negli ultimi 10 giorni "),p())}function hY(n,e){if(n&1&&(g(0,"div",90)(1,"h3"),v(2,"Appuntamenti Cancellati (Ultimi 10 giorni)"),p(),g(3,"div",91),N(4,fY,11,12,"div",92)(5,pY,2,0,"div",93),p()()),n&2){let t=E();_(4),x("ngForOf",t.cancelledAppointments),_(),x("ngIf",t.cancelledAppointments.length===0)}}var g0=class n{constructor(e,t,i,r,o,s,l,c,u,f,m,w,b){this.productService=e;this.renderer=t;this.el=i;this.auth=r;this.appointment=o;this.salonservice=s;this.profileservice=l;this.salonHttpService=c;this.clientService=u;this.dipendentiService=f;this.openingHoursService=m;this.supabase=w;this.changeRequestService=b}calendarComponent;loading=!0;events=[];openEditor=!1;editorModel=null;saving=!1;errorMsg="";services=[];selectedService=null;editorNotes="";myProfile=null;filteredServices=[];clients=[];selectedClient=null;showClientForm=!1;newClient={first_name:"",last_name:"",email:"",phone:"",data_nascita:null,sesso:null};searchQuery="";filteredClients=[];searchResults=[];showSearchResults=!1;isSearching=!1;servicesWithGroups=[];selectedEvent=null;cancelledAppointments=[];showCancelledAppointments=!1;appointmentSettings={mode:"simple",maxConcurrentAppointments:1};availableDipendenti=[];selectedDipendente=null;loadDipendentiTimeout=null;isLoadingDipendenti=!1;calendarOptions={plugins:[pF,_F,xF],initialView:"timeGridWeek",headerToolbar:{left:"prev,next today addEventButton",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},customButtons:{addEventButton:{text:"Nuovo Appuntamento",click:()=>this.handleAddEvent()}},selectable:!1,selectMirror:!0,editable:!1,eventClick:this.handleEventClick.bind(this),allDaySlot:!1,slotMinTime:"08:00:00",slotMaxTime:"20:00:00",slotDuration:"00:30:00",slotLabelInterval:"01:00",slotLabelFormat:{hour:"2-digit",minute:"2-digit",hour12:!1},views:{timeGridWeek:{},timeGridDay:{},dayGridMonth:{}},eventContent:this.renderEventContent.bind(this),locale:"it",firstDay:1,aspectRatio:1.35,height:"auto",timeZone:"Europe/Rome",initialDate:new Date,eventDisplay:"block",nowIndicator:!0,dayHeaderContent:e=>{let t=e.date,i=this.events.filter(r=>new Date(r.start).toDateString()===t.toDateString());return{html:`
      <div class="fc-day-header">
        <div>
          <div>${t.toLocaleDateString("it-IT",{weekday:"short"})}</div>
          <div>${t.getDate()}/${t.getMonth()+1}</div>
        </div>
        ${i.length>0?`<span class="event-count">${i.length}</span>`:""}
      </div>
      `}},viewDidMount:()=>{this.loading=!1}};ngOnInit(){return C(this,null,function*(){this.loading=!0;try{if(this.myProfile=yield this.auth.getMyProfile(!0),!this.myProfile)return;let e=yield this.profileservice.getAppointmentMode(this.myProfile.id);this.appointmentSettings.mode=e||"simple";let t=yield this.profileservice.getMaxConcurrentAppointments(this.myProfile.id);this.appointmentSettings.maxConcurrentAppointments=t??1,this.servicesWithGroups=yield this.salonservice.getServicesOnly(!0),this.services=this.servicesWithGroups.filter(r=>!r.is_group),this.filteredServices=this.services,yield this.aggiornaOrariCalendarioDaOpeningHours(),yield this.loadEventsForMySalon(),yield this.loadClients();let i=this.calendarComponent?.getApi();i&&(i.removeAllEvents(),i.addEventSource(this.events),i.updateSize()),this.loading=!1,this.setupPopupCloseHandler()}catch(e){console.error("Errore caricamento calendario:",e),this.loading=!1}})}ngOnDestroy(){this.loadDipendentiTimeout&&clearTimeout(this.loadDipendentiTimeout);let e=document.getElementById("event-tooltip");e&&e.remove()}onServiceChange(){if(this.selectedService&&this.editorModel){let e=this.selectedService.timing||60,t=new Date(this.editorModel.start),i=new Date(t.getTime()+e*6e4);this.editorModel.end=i.toISOString(),this.appointmentSettings.mode==="advanced"&&(this.selectedDipendente=null,this.availableDipendenti=[],this.loadDipendentiTimeout&&clearTimeout(this.loadDipendentiTimeout),this.loadDipendentiTimeout=setTimeout(()=>{this.loadAvailableDipendenti()},300))}else this.editorModel&&(this.editorModel.end=this.editorModel.start)}setupPopupCloseHandler(){let e=new MutationObserver(i=>{i.forEach(r=>{r.addedNodes.length&&r.addedNodes.forEach(o=>{if(o.nodeType===1){let s=o;if(s.classList.contains("fc-popover")){let l=s.querySelector(".fc-popover-close");l&&l.addEventListener("click",()=>{this.closePopup(s)})}}})})}),t=document.querySelector(".cal-body");t&&e.observe(t,{childList:!0,subtree:!0})}closePopup(e){e.style.opacity="0",e.style.transform="translate(-50%, -50%) scale(0.95)",e.style.transition="all 0.3s ease",setTimeout(()=>{e.remove()},300)}handleDateSelect(e){this.editorModel={title:"",start:e.startStr,end:e.endStr,allDay:e.allDay},this.openEditor=!0}handleEventClick(e){let t=e.event;this.selectedEvent={id:t.id,title:t.title,start:t.startStr,end:t.endStr,allDay:t.allDay,extendedProps:t.extendedProps},this.openEditor=!1}saveEditor(){return C(this,null,function*(){if(!this.editorModel||!this.selectedService||!this.selectedClient){this.errorMsg="Seleziona un servizio e un cliente";return}let e=new Date;if(new Date(this.editorModel.start)<e){this.errorMsg="Non \xE8 possibile creare appuntamenti nel passato";return}if(!this.myProfile||!this.myProfile.id){this.errorMsg="Profilo non caricato correttamente",this.saving=!1;return}if(this.appointmentSettings.mode==="advanced"&&this.selectedDipendente&&!(yield this.isDipendenteDisponibile(this.selectedDipendente.id,this.editorModel.start,this.editorModel.end))){this.errorMsg="Il dipendente selezionato non \xE8 pi\xF9 disponibile per questo orario";return}if(!this.editorModel.end){this.errorMsg="Orario di fine non calcolato correttamente",this.saving=!1;return}let i=yield this.checkAppointmentAvailability(this.editorModel.start,this.editorModel.end,this.selectedService.id);if(!i.available){this.errorMsg=i.reason||"Non \xE8 possibile prenotare in questo orario";return}this.saving=!0,this.errorMsg="";try{let r=null;if(this.appointmentSettings.mode==="advanced"){if(!this.selectedDipendente){this.errorMsg="Seleziona un dipendente";return}r=this.selectedDipendente.id}if(this.editorModel.id)if((yield this.appointment.getAppointmentById(this.editorModel.id)).source==="client"){yield this.changeRequestService.createChangeRequest({appointment_id:this.editorModel.id,requested_by:this.myProfile.id,requested_start_time:this.editorModel.start,requested_end_time:this.editorModel.end,requested_service_id:this.selectedService.id,requested_notes:this.editorNotes,status:"pending"}),this.errorMsg="Richiesta di modifica inviata al cliente. Attendi la conferma.",this.openEditor=!1,this.saving=!1;return}else yield this.appointment.updateAppointment({id:this.editorModel.id,start_time:this.editorModel.start,end_time:this.editorModel.end,service_id:this.selectedService.id,notes:this.editorNotes,dipendente_id:r});else{let o={salon_id:this.myProfile.id,service_id:this.selectedService.id,start_time:this.editorModel.start,end_time:this.editorModel.end,notes:this.editorNotes,status:"confirmed",client_id:this.selectedClient.id,price:this.selectedService.price,payment_status:"unpaid",dipendente_id:r,source:"salon"};yield this.appointment.createAppointment(o)}yield this.loadEventsForMySalon(),this.openEditor=!1,this.editorModel=null,this.selectedService=null,this.selectedClient=null,this.selectedDipendente=null,this.availableDipendenti=[],this.editorNotes=""}catch(r){console.error("Errore salvataggio appuntamento",r),this.errorMsg=r?.message||"Errore nel salvataggio"}finally{this.saving=!1}})}loadEventsForMySalon(){return C(this,null,function*(){try{let t=(yield this.auth.getMyProfile(!0))?.id;if(!t)return;let i=yield this.appointment.getAppointmentsBySalon(t),[r,o]=yield Promise.all([this.salonservice.getMyServices(),this.dipendentiService.getDipendentiWithServizi(t)]),s=new Map(r.map(D=>[D.id,D])),l=new Map(o.map(D=>[D.id,D])),c=i.map(D=>D.client_id).filter(D=>!!D),{data:u,error:f}=yield this.supabase.getClient().from("clients").select("*").in("id",c);f&&console.error("Errore nel recupero clienti:",f);let m=new Map(u?.map(D=>[D.id,D])||[]),w=u?.filter(D=>D.profile_id).map(D=>D.profile_id).filter(D=>!!D)||[],b=new Map;if(w.length>0){let D=yield this.supabase.getProfilesByIds(w);b=new Map(D.map(T=>[T.id,T]))}this.events=i.map(D=>{let T=s.get(D.service_id),M=T?.name||"Servizio sconosciuto",P=T?.timing||60,U="Cliente sconosciuto",K="Nessun telefono",W="Nessuna email",re=m.get(D.client_id);if(re)if(re.profile_id){let Li=b.get(re.profile_id);Li?(U=Li.full_name||`${Li.first_name||""} ${Li.last_name||""}`.trim(),K=Li.telefono||"Nessun telefono",W=Li.email||"Nessuna email"):(U=`${re.first_name} ${re.last_name}`,K=re.phone||"Nessun telefono",W=re.email||"Nessuna email")}else U=`${re.first_name} ${re.last_name}`,K=re.phone||"Nessun telefono",W=re.email||"Nessuna email";let fe=D.dipendente_id?l.get(D.dipendente_id):null,ce=fe?`${fe.nome} ${fe.cognome}`:"Non assegnato",le=new Date(D.start_time),ct=new Date(D.end_time),Wt=le.toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"});return{id:String(D.id),title:`${Wt} - ${M}`,start:D.start_time,end:D.end_time,allDay:!1,extendedProps:ne(B({},D),{serviceName:M,serviceTiming:P,clientName:U,clientPhone:K,clientEmail:W,dipendenteName:ce})}}),this.calendarComponent?.getApi()&&(this.calendarComponent.getApi().removeAllEvents(),this.calendarComponent.getApi().addEventSource(this.events))}catch(e){console.error("Errore caricamento eventi:",e)}})}renderEventContent(e){let i=e.event.extendedProps.payment_status==="paid"?'<div class="fc-event-status">\u2705 Pagato</div>':"",r=e.event.extendedProps.notes,o=r?`<div class="fc-event-notes">${r}</div>`:"",s=e.event.extendedProps.dipendenteName,l=s?`<div class="fc-event-dipendente">Dipendente: ${s}</div>`:"";return{html:`
    <div class="fc-event-content" data-event-id="${e.event.id}">
      <div class="fc-event-client">${e.event.extendedProps.clientName}</div>
      <div class="fc-event-service">${e.event.extendedProps.serviceName}</div>
      ${l}
      ${o}
      ${i}
    </div>
  `}}handleAddEvent(){let e=new Date,t=Math.ceil(e.getMinutes()/30)*30;e.setMinutes(t),e.setSeconds(0),e.setMilliseconds(0),e.getTime()<Date.now()&&e.setMinutes(e.getMinutes()+30);let i=this.convertToLocalISOString(e);this.editorModel={title:"",start:i,end:i,allDay:!1},this.selectedService=null,this.selectedDipendente=null,this.availableDipendenti=[],this.editorNotes="",this.openEditor=!0,this.resetServiceFilter()}updateDate(e,t){if(!this.editorModel||!this.editorModel[t])return;let i=new Date(this.editorModel[t]),r=new Date(e);if(r.setHours(i.getHours(),i.getMinutes()),r<new Date){this.errorMsg="Non \xE8 possibile selezionare una data nel passato";return}if(t==="start"){if(this.editorModel.start=r.toISOString(),this.editorModel.end){let s=new Date(this.editorModel.end).getTime()-i.getTime(),l=new Date(r.getTime()+s);this.editorModel.end=l.toISOString()}}else this.editorModel.end=r.toISOString();this.errorMsg=""}updateTime(e,t){if(!this.editorModel||!this.editorModel[t])return;let[i,r]=e.split(":").map(Number),o=new Date(this.editorModel[t]);if(o.setHours(i,r),o<new Date){this.errorMsg="Non \xE8 possibile selezionare un orario nel passato";return}if(t==="start"){if(this.editorModel.start=o.toISOString(),this.editorModel.end){let s=new Date(this.editorModel.end);s<=o&&(s.setHours(o.getHours()+1,o.getMinutes()),this.editorModel.end=s.toISOString())}}else{this.editorModel.end=o.toISOString();let s=new Date(this.editorModel.start);o<=s&&(this.editorModel.start=new Date(o.getTime()-60*60*1e3).toISOString())}this.errorMsg="",this.appointmentSettings.mode==="advanced"&&this.selectedService&&this.loadAvailableDipendenti()}convertToLocalISOString(e){(!e||isNaN(e.getTime()))&&(e=new Date);let t=-e.getTimezoneOffset(),i=t>=0?"+":"-",r=o=>`${Math.floor(Math.abs(o))}`.padStart(2,"0");return`${e.getFullYear()}-${r(e.getMonth()+1)}-${r(e.getDate())}T${r(e.getHours())}:${r(e.getMinutes())}:${r(e.getSeconds())}${i}${r(t/60)}:${r(t%60)}`}updateDateTime(e,t){if(!this.editorModel)return;let i=new Date(e);if(i<new Date){this.errorMsg="Non \xE8 possibile selezionare una data/ora nel passato";return}this.editorModel[t]=this.convertToLocalISOString(i),this.errorMsg="",t==="start"&&this.selectedService&&this.onServiceChange(),this.appointmentSettings.mode==="advanced"&&this.selectedService&&this.loadAvailableDipendenti()}formatTime(e){return e?new Date(e).toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit",hour12:!1}):""}createClient(){return C(this,null,function*(){try{if(!this.newClient.first_name||!this.newClient.last_name){this.errorMsg="Nome e cognome sono obbligatori";return}if(console.log("Creazione cliente con dati:",this.newClient),yield this.clientService.clientExists(this.newClient.first_name,this.newClient.last_name,this.newClient.email,this.newClient.phone)){this.errorMsg="Un cliente con questi dati esiste gi\xE0";return}let t=yield this.clientService.createClient(this.newClient);console.log("Cliente creato con successo:",t),this.clients.push(t),this.selectedClient=t,this.searchQuery=`${t.first_name} ${t.last_name}`,this.showClientForm=!1,this.newClient={first_name:"",last_name:"",email:"",phone:"",data_nascita:null,sesso:null},this.showSearchResults=!1,this.filterServicesByClientGender()}catch(e){console.error("Errore nella creazione del cliente:",e),this.errorMsg=e.message||"Errore nella creazione del cliente"}})}loadClients(){return C(this,null,function*(){try{this.clients=yield this.clientService.getClientsBySalon(),this.filteredClients=[...this.clients],console.log("Clienti caricati:",this.clients.length)}catch(e){console.error("Errore nel caricamento clienti:",e),this.errorMsg="Impossibile caricare i clienti"}})}filterClients(){if(!this.searchQuery){this.filteredClients=[...this.clients];return}this.filteredClients=this.clientService.filterClientsLocally(this.clients,this.searchQuery)}resetServiceFilter(){this.filteredServices=this.servicesWithGroups.filter(e=>!e.is_group)}onSearchInput(){return C(this,null,function*(){if(this.searchQuery.length<2){this.searchResults=[],this.showSearchResults=!1;return}this.isSearching=!0;try{this.searchResults=yield this.clientService.searchClients(this.searchQuery),this.showSearchResults=!0}catch(e){console.error("Errore nella ricerca:",e),this.searchResults=[],this.errorMsg="Errore durante la ricerca"}finally{this.isSearching=!1}})}selectClientFromSearch(e){this.selectedClient=e,this.searchQuery=`${e.first_name} ${e.last_name}`,this.showSearchResults=!1,this.filterServicesByClientGender()}onEventSaved(e){this.loadEventsForMySalon(),this.selectedEvent=null}checkAppointmentAvailability(e,t,i){return C(this,null,function*(){try{if(!this.myProfile||!this.myProfile.id)return{available:!1,reason:"Profilo non caricato correttamente"};if(this.appointmentSettings.mode==="simple")return(yield this.appointment.getAppointmentsBySalonAndTimeRange(this.myProfile.id,e,t)).filter(s=>s.status!=="cancelled").length>=this.appointmentSettings.maxConcurrentAppointments?{available:!1,reason:`Numero massimo di appuntamenti contemporanei (${this.appointmentSettings.maxConcurrentAppointments}) raggiunto`}:{available:!0};if(this.appointmentSettings.mode==="advanced"){if(!i)return{available:!1,reason:"Servizio non selezionato"};let o=(yield this.dipendentiService.getDipendentiWithServizi(this.myProfile.id)).filter(s=>s.servizi&&s.servizi.includes(i));if(o.length===0)return{available:!1,reason:"Nessun dipendente disponibile per questo servizio"};for(let s of o)if(yield this.isDipendenteDisponibile(s.id,e,t))return{available:!0};return{available:!1,reason:"Nessun dipendente disponibile in questo orario"}}return{available:!0}}catch(r){return console.error("Errore nel controllo disponibilit\xE0:",r),{available:!1,reason:"Errore nel controllo disponibilit\xE0"}}})}isDipendenteDisponibile(e,t,i){return C(this,null,function*(){try{return(yield this.appointment.getAppointmentsByDipendenteAndTimeRange(e,t,i)).filter(s=>s.status!=="cancelled"&&s.status!=="completed").length===0}catch(r){return console.error("Errore nel controllo disponibilit\xE0:",r),!1}})}trovaDipendenteDisponibile(e,t,i){return C(this,null,function*(){try{if(!this.myProfile||!this.myProfile.id)return console.error("Profilo non caricato correttamente"),null;let o=(yield this.dipendentiService.getDipendentiWithServizi(this.myProfile.id)).filter(s=>s.servizi&&s.servizi.includes(i));for(let s of o)if(yield this.isDipendenteDisponibile(s.id,e,t))return s;return null}catch(r){return console.error("Errore nella ricerca di un dipendente disponibile:",r),null}})}loadAvailableDipendenti(){return C(this,null,function*(){if(!this.isLoadingDipendenti){if(!this.selectedService||!this.editorModel||!this.editorModel.start||!this.editorModel.end||!this.myProfile){this.availableDipendenti=[],this.selectedDipendente=null;return}this.isLoadingDipendenti=!0;try{let i=(yield this.dipendentiService.getDipendentiWithServizi(this.myProfile.id)).filter((o,s,l)=>s===l.findIndex(c=>c.id===o.id)).filter(o=>o.servizi?o.servizi.some(s=>(typeof s=="object"?s.id:s)===this.selectedService.id):!1);this.availableDipendenti=[];for(let o of i){let s=yield this.isDipendenteDisponibile(o.id,this.editorModel.start,this.editorModel.end);this.availableDipendenti.push(ne(B({},o),{disponibile:s}))}let r=this.availableDipendenti.filter(o=>o.disponibile);r.length===1?this.selectedDipendente=r[0]:this.selectedDipendente=null}catch(e){console.error("Errore nel caricamento dei dipendenti:",e),this.availableDipendenti=[],this.selectedDipendente=null}finally{this.isLoadingDipendenti=!1}}})}aggiornaOrariCalendarioDaOpeningHours(){return C(this,null,function*(){let e=this.myProfile?.id;if(!e)return;let t=yield this.openingHoursService.getOpeningHours(e),i=24*60,r=i,o=0;for(let U of t||[])if(!(!U.intervals||!Array.isArray(U.intervals)))for(let K of U.intervals){if(!K||!K.start||!K.end)continue;let[W,re]=K.start.split(":").map(Number),[fe,ce]=K.end.split(":").map(Number);if(Number.isNaN(W)||Number.isNaN(re)||Number.isNaN(fe)||Number.isNaN(ce))continue;let le=W*60+re,ct=fe*60+ce;le<r&&(r=le),ct>o&&(o=ct)}if(o===0&&r===i)return;let l=(this.calendarOptions.slotDuration||"00:30:00").split(":").map(Number),c=(l[0]||0)*60+(l[1]||0),u=o+c;u>i&&(u=i);let f=Math.max(0,r);f>=i&&(f=0);let m=U=>String(U).padStart(2,"0"),w=Math.floor(f/60),b=f%60,D=Math.floor(u/60),T=u%60,M=`${m(w)}:${m(b)}:00`,P=u===i?"24:00:00":`${m(D)}:${m(T)}:00`;this.calendarOptions.slotMinTime=M,this.calendarOptions.slotMaxTime=P,this.calendarComponent?.getApi()&&(this.calendarComponent.getApi().setOption("slotMinTime",M),this.calendarComponent.getApi().setOption("slotMaxTime",P),this.calendarComponent.getApi().updateSize())})}loadCancelledAppointments(){return C(this,null,function*(){try{if(!this.myProfile)return;if(this.cancelledAppointments=yield this.appointment.getCancelledAppointments(this.myProfile.id,10),console.log("Appuntamenti cancellati caricati (raw):",this.cancelledAppointments),!Array.isArray(this.cancelledAppointments)||this.cancelledAppointments.length===0){console.log("Nessun appuntamento cancellato trovato.");return}let e=Array.from(new Set(this.cancelledAppointments.map(i=>i.dipendente_id).filter(i=>i!=null))),t={};e.length>0&&(yield Promise.all(e.map(i=>C(this,null,function*(){try{let r=yield this.dipendentiService.getDipendenteById(i),o=r&&typeof r=="object"&&"data"in r?r.data:r;t[String(i)]=o??null}catch(r){console.error(`Errore nel caricamento dipendente ${i}:`,r),t[String(i)]=null}})))),this.cancelledAppointments=this.cancelledAppointments.map(i=>{let r=i.dipendente_id!==null&&i.dipendente_id!==void 0?String(i.dipendente_id):null;return ne(B({},i),{dipendenteData:r?t[r]??null:null})}),console.log("Appuntamenti cancellati arricchiti con dipendenteData:",this.cancelledAppointments)}catch(e){console.error("Errore nel caricamento appuntamenti cancellati:",e)}})}deleteEditor(){return C(this,null,function*(){if(!this.editorModel?.id){this.openEditor=!1;return}try{yield this.appointment.cancelAppointment(this.editorModel.id),yield this.loadEventsForMySalon(),this.showCancelledAppointments&&(yield this.loadCancelledAppointments()),this.openEditor=!1,this.editorModel=null}catch(e){console.error("Errore durante la cancellazione:",e),this.errorMsg="Errore durante la cancellazione"}})}onEventDeleted(e){return C(this,null,function*(){try{yield this.appointment.cancelAppointment(e),yield this.loadEventsForMySalon(),this.showCancelledAppointments&&(yield this.loadCancelledAppointments()),this.selectedEvent=null}catch(t){console.error("Errore durante la cancellazione dal popup:",t),this.errorMsg="Errore durante la cancellazione"}})}toggleCancelledAppointments(){this.showCancelledAppointments=!this.showCancelledAppointments,this.showCancelledAppointments&&this.loadCancelledAppointments()}filterServicesByClientGender(){if(console.log("Filtro servizi per cliente:",this.selectedClient),!this.selectedClient||!this.selectedClient.sesso){this.filteredServices=this.servicesWithGroups.filter(t=>!t.is_group),console.log("Nessun sesso specificato, mostro tutti i servizi:",this.filteredServices.length);return}let e=this.selectedClient.sesso.toLowerCase();console.log("Sesso cliente:",e),this.filteredServices=this.servicesWithGroups.filter(t=>!t.is_group).filter(t=>{let i=t.sesso?t.sesso.toLowerCase():"unisex",r=i==="unisex"||i===e;return r||console.log("Escludo servizio:",t.name,"con sesso:",t.sesso),r}),console.log("Servizi filtrati:",this.filteredServices.map(t=>t.name))}onClientSelect(e){this.selectedClient=e,this.filterServicesByClientGender()}isServiceInFiltered(e){return this.filteredServices.some(t=>t.id===e)}getServicesInGroup(e){return this.filteredServices.filter(t=>t.parent_id===e)}hasServicesInGroup(e){return this.filteredServices.some(t=>t.parent_id===e)}static \u0275fac=function(t){return new(t||n)(z(Es),z(Wn),z(ft),z(ln),z(qn),z(Ji),z(wi),z(p0),z(ir),z(_i),z(vo),z(ue),z(Ss))};static \u0275cmp=he({type:n,selectors:[["app-calendario"]],viewQuery:function(t,i){if(t&1&&cc(BZ,5),t&2){let r;jt(r=Bt())&&(i.calendarComponent=r.first)}},decls:11,vars:6,consts:[["fc",""],[1,"container"],[1,"section-title"],["class","loading-overlay",4,"ngIf"],["class","cal-body",4,"ngIf"],["class","editor-backdrop",4,"ngIf"],[3,"event","close","saved","deleted",4,"ngIf"],[1,"cancelled-appointments-toggle"],[1,"btn",3,"click"],["class","cancelled-appointments-section",4,"ngIf"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"],[1,"cal-body"],[3,"options","events"],[1,"editor-backdrop"],[1,"editor-card"],[1,"editor-header"],[1,"btn-close",3,"click","disabled"],[1,"editor-content"],[1,"form-group"],["for","clientSearch"],["class","search-container",4,"ngIf"],["class","container card client-form",4,"ngIf"],["class","selected-client",4,"ngIf"],["for","serviceSelect"],["id","serviceSelect","required","",1,"input-field",3,"ngModelChange","change","ngModel"],[3,"ngValue"],[4,"ngFor","ngForOf"],[1,"form-row"],["for","startDateTime"],["id","startDateTime","type","datetime-local","required","",1,"input-field",3,"ngModelChange","ngModel"],["for","endTime"],["id","endTime","type","time","disabled","","readonly","",1,"input-field",3,"value"],["class","error-message",4,"ngIf"],["class","form-group",4,"ngIf"],["for","eventNotes"],["id","eventNotes","placeholder","Note opzionali per l'appuntamento","rows","3",1,"input-field",3,"ngModelChange","ngModel"],[1,"editor-actions"],[1,"btn-primary",3,"click","disabled"],["class","btn btn-danger",3,"disabled","click",4,"ngIf"],[1,"btn",3,"click","disabled"],[1,"search-container"],[1,"search-input-row"],["id","clientSearch","type","text","placeholder","Cerca per nome o cognome...",1,"input-field",3,"ngModelChange","input","focus","ngModel"],["type","button",1,"btn","btn-secondary","add-client-btn",3,"click"],["class","search-results",4,"ngIf"],[1,"search-results"],["class","search-result-item",3,"click",4,"ngFor","ngForOf"],[1,"search-result-item",3,"click"],[1,"client-name"],[1,"client-details"],[4,"ngIf"],[1,"no-results"],[1,"container","card","client-form"],[1,"section-subtitle"],[1,"required"],["type","text","required","",3,"ngModelChange","ngModel"],["type","email",3,"ngModelChange","ngModel"],["type","tel",3,"ngModelChange","ngModel"],["type","date",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["value","maschio"],["value","femmina"],[1,"form-row",2,"justify-content","flex-end","gap","var(--padding-v)"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["type","button",1,"btn",3,"click"],[1,"selected-client"],["type","button","title","Rimuovi cliente",1,"btn-remove",3,"click"],[3,"label",4,"ngIf"],[3,"label"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"error-message"],[1,"error-icon"],["for","dipendente"],["id","dipendente",3,"ngModelChange","ngModel"],[3,"ngValue","disabled",4,"ngFor","ngForOf"],["class","dipendenti-info",4,"ngIf"],[3,"ngValue","disabled"],[1,"dipendente-option"],[1,"dipendente-nome"],["class","dipendente-disponibile",4,"ngIf"],["class","dipendente-non-disponibile",4,"ngIf"],[1,"dipendente-disponibile"],[1,"dipendente-non-disponibile"],[1,"dipendenti-info"],[1,"icon-info"],[1,"btn","btn-danger",3,"click","disabled"],[1,"btn-icon"],[3,"close","saved","deleted","event"],[1,"cancelled-appointments-section"],[1,"cancelled-list"],["class","cancelled-item",4,"ngFor","ngForOf"],["class","no-cancelled",4,"ngIf"],[1,"cancelled-item"],[1,"cancelled-info"],[1,"cancelled-meta"],[1,"cancelled-reason"],["class","cancelled-dipendente",4,"ngIf"],[1,"cancelled-dipendente"],[1,"no-cancelled"]],template:function(t,i){t&1&&(g(0,"div",1)(1,"h2",2),v(2,"Calendario"),p(),N(3,UZ,5,0,"div",3)(4,HZ,3,2,"div",4)(5,cY,44,22,"div",5)(6,dY,1,1,"app-popup-calendario",6),g(7,"div",7)(8,"button",8),F("click",function(){return i.toggleCancelledAppointments()}),v(9),p()(),N(10,hY,6,2,"div",9),p()),t&2&&(_(3),x("ngIf",i.loading),_(),x("ngIf",!i.loading),_(),x("ngIf",i.openEditor),_(),x("ngIf",i.selectedEvent),_(3),J(" ",i.showCancelledAppointments?"Nascondi":"Mostra"," Appuntamenti Cancellati "),_(),x("ngIf",i.showCancelledAppointments))},dependencies:[Se,Ze,Ne,aF,sF,vt,Ot,Nt,st,Dt,at,Ln,pt,bt,cd,Sr,Pi],styles:[`.cal-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(min(200px,100%),1fr));gap:var(--padding-v);align-items:center;margin-bottom:var(--padding-v)}.cal-body[_ngcontent-%COMP%]     .fc{--fc-border-color: var(--secondary);--fc-page-bg-color: var(--background2);--fc-neutral-bg-color: var(--text-light);--fc-event-border-color: var(--secondary);--fc-event-bg-color: var(--background2);--fc-event-text-color: var(--text-light);--fc-today-bg-color: color-mix(in srgb, var(--primary) 15% , transparent);--fc-today-border-color: var(--primary)}.cal-body[_ngcontent-%COMP%]     .fc-header-toolbar{display:grid;grid-template-columns:1fr;grid-template-rows:auto auto;gap:var(--padding-v);align-items:center;justify-items:center;padding:var(v);background:color-mix(in srgb,var(--secondary) 15%,transparent);border-radius:var(--border-radius)}.cal-body[_ngcontent-%COMP%]     .fc-toolbar-title{font-size:var(--font-size-lg);font-weight:700;color:var(--text-light);white-space:normal;text-overflow:ellipsis;overflow:hidden}.cal-body[_ngcontent-%COMP%]     .fc-button{background:var(--background2);border:1px solid color-mix(in srgb,var(--text-light) 20%,transparent);color:var(--text-light);padding:clamp(.3rem,1.5cqi,.8rem);font-size:clamp(.7rem,2cqi,var(--font-size-base));border-radius:var(--border-radius);min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.cal-body[_ngcontent-%COMP%]     .fc-toolbar-chunk{grid-row:2;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:var(--padding-v);padding:var(--padding-v)}.cal-body[_ngcontent-%COMP%]     .fc-button-group{border-radius:var(--border-radius);overflow:hidden;display:flex;flex-wrap:wrap;padding:0;gap:var(--padding-v)}.cal-body[_ngcontent-%COMP%]     .fc-button-group .fc-button{border-radius:var(--border-radius);margin:0;border-right:1px solid color-mix(in srgb,var(--text-light) 20%,transparent);font-size:clamp(.5rem,2cqi,var(--font-size-base))}.cal-body[_ngcontent-%COMP%]     .fc-col-header-cell{width:min(14.28%,100%)}.cal-body[_ngcontent-%COMP%]     .fc-button-primary:not(:disabled).fc-button-active{background:var(--primary);border-color:var(--secondary);color:var(--background)}.cal-body[_ngcontent-%COMP%]     .fc-today-button{background:var(--secondary);border-color:var(--primary);padding:var(--padding-v);margin:0;min-width:auto;height:100%}.cal-body[_ngcontent-%COMP%]     .fc-addEventButton-button{background:var(--secondary);color:var(--text-light);border:none;font-weight:600;padding-inline:var(--padding-v)}.cal-body[_ngcontent-%COMP%]     .fc-col-header-cell .fc-day-header{display:flex;flex-direction:row;justify-content:space-between;align-items:center;flex-wrap:wrap;padding:0;font-size:clamp(.5rem,2cqi,var(--font-size-base));gap:var(--padding-v);font-weight:500}.cal-body[_ngcontent-%COMP%]     .fc-day-header{text-align:center;font-size:var(--font-size-base);font-weight:500}.cal-body[_ngcontent-%COMP%]     .fc-day-header div:last-child{opacity:.9}.cal-body[_ngcontent-%COMP%]     .event-count{background:var(--secondary);color:var(--text-light);border-radius:50%;width:clamp(1.2rem,4cqi,1.8rem);height:clamp(1.2rem,4cqi,1.8rem);font-size:clamp(.5rem,2cqi,.9rem);display:flex;align-items:center;justify-content:center}.cal-body[_ngcontent-%COMP%]     .fc-timegrid-slot{height:clamp(1.2rem,4cqi,2.5rem)}.cal-body[_ngcontent-%COMP%]     .fc-timegrid-axis{font-size:clamp(.6rem,1.8cqi,.8rem);padding:0 clamp(.2rem,1cqi,.5rem);background:var(--background2)}.cal-body[_ngcontent-%COMP%]     .fc-timegrid-slot-label{color:var(--text-light);font-size:clamp(.6rem,1.8cqi,.8rem);padding:0 clamp(.2rem,1cqi,.5rem)}.cal-body[_ngcontent-%COMP%]     .fc-timegrid-event{font-size:clamp(.6rem,1.5cqi,.8rem);padding:clamp(.1rem,.5cqi,.3rem);margin:0;border-left:3px solid var(--primary);border-radius:var(--border-radius)}.cal-body[_ngcontent-%COMP%]     .fc-event{border:none;border-left:3px solid var(--primary);padding:clamp(.2rem,.5vw,.4rem);margin:clamp(.1rem,.5vw,.5rem);cursor:pointer;transition:all .3s ease;overflow:hidden}.cal-body[_ngcontent-%COMP%]     .fc-event:hover{transform:translateY(-2px);box-shadow:0 2px 8px color-mix(in srgb,var(--background) 70%,transparent)}.cal-body[_ngcontent-%COMP%]     .fc-event-client{font-weight:700;color:var(--primary);font-size:clamp(.5rem,1vw,3rem);line-height:1.2}.editor-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:color-mix(in srgb,var(--background) 80%,transparent);display:flex;align-items:center;justify-content:center;z-index:10000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);animation:_ngcontent-%COMP%_fadeIn .2s ease-out;padding:var(--padding-v);box-sizing:border-box;overflow-y:auto}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.editor-card[_ngcontent-%COMP%]{width:min(95vw,600px);max-height:90vh;border-radius:var(--border-radius);box-shadow:0 10px 30px color-mix(in srgb,var(--secondary) 40%,transparent);border:1px solid var(--primary);overflow:auto;animation:_ngcontent-%COMP%_scaleIn .2s ease-out;display:flex;flex-direction:column}@keyframes _ngcontent-%COMP%_scaleIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.editor-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:var(--padding-v);border-bottom:1px solid color-mix(in srgb,var(--text-light) 40%,transparent);flex-shrink:0;background:var(--background2)}.editor-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--primary);font-size:var(--font-size-lg);font-weight:700}.editor-actions[_ngcontent-%COMP%]{display:flex;gap:var(--padding-h);justify-content:flex-end;margin-top:var(--padding-v);flex-wrap:wrap;padding:var(--padding-v);flex-shrink:0}.search-container[_ngcontent-%COMP%]{position:relative;margin-bottom:var(--padding-v);width:100%}.search-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:2px solid var(--secondary);border-radius:var(--border-radius);color:var(--text-light);transition:all .3s ease;box-sizing:border-box}.search-results[_ngcontent-%COMP%]{position:static;background:var(--background);border:2px solid var(--primary);border-radius:8px;max-height:300px;overflow-y:auto;z-index:1000;margin-top:var(--padding-h);box-shadow:0 10px 25px color-mix(in srgb,var(--background) 70%,transparent);animation:_ngcontent-%COMP%_slideDown .3s ease;width:100%;box-sizing:border-box}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.search-result-item[_ngcontent-%COMP%]{padding:.8rem;cursor:pointer;border-bottom:1px solid color-mix(in srgb,var(--text-light) 70%,transparent);transition:all .2s ease;display:flex;flex-direction:column}.search-result-item[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,color-mix(in srgb,var(--primary) 30%,transparent),color-mix(in srgb,var(--secondary) 30%,transparent))}.search-result-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.search-input-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px;align-items:stretch;width:100%}.search-input-row[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]{flex:1 1 min(100%,200px);min-width:0}.add-client-btn[_ngcontent-%COMP%]{flex:0 0 auto;white-space:nowrap;display:flex;align-items:center;justify-content:center;padding:0 16px;height:auto}.client-name[_ngcontent-%COMP%]{font-weight:600;color:var(--primary);margin-bottom:5px;font-size:1.05rem}.client-details[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px;font-size:.9rem}.client-details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--text-muted)}.client-details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{content:"";display:inline-block;width:16px;height:16px;margin-right:5px;background-size:contain;background-repeat:no-repeat;background-position:center;opacity:.7}.client-details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child:before{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z'/%3E%3C/svg%3E")}.client-details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child:before{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z'/%3E%3Cpolyline points='22,6 12,13 2,6'/%3E%3C/svg%3E")}.selected-client[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--primary) 10%,transparent);border:2px solid var(--primary);border-radius:var(--border-radius);padding:var(--padding-v);margin-top:var(--padding-v);display:flex;justify-content:space-between;align-items:center;animation:_ngcontent-%COMP%_fadeIn .3s ease}.selected-client-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.selected-client-name[_ngcontent-%COMP%]{font-weight:600;color:var(--primary);margin-bottom:var(--padding-v);font-size:var(--font-size-lg)}.selected-client-contact[_ngcontent-%COMP%]{font-size:var(--font-size-base);color:var(--text-muted);display:flex;gap:var(--padding-v)}.cancelled-appointments-toggle[_ngcontent-%COMP%]{margin:var(--padding-h) 0;text-align:center}.cancelled-appointments-section[_ngcontent-%COMP%]{margin-top:var(--padding-v);padding:var(--padding-v);border:1px solid var(--secondary);border-radius:8px;background-color:var(--background2)}.cancelled-appointments-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:var(--font-size-base);margin-top:var(--padding-v);padding:0}.cancelled-item[_ngcontent-%COMP%]{padding:var(--padding-v);margin-bottom:var(--padding-v);border-bottom:1px solid var(--secondary);border-radius:var(--border-radius)}.cancelled-info[_ngcontent-%COMP%]{font-size:var(--font-size-base);margin-bottom:var(--padding-v)}.cancelled-meta[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:clamp(.4rem,2.5cqi,var(--font-size-base));color:var(--text-light);font-style:italic}.cancelled-reason[_ngcontent-%COMP%]{color:var(--secondary)}.no-cancelled[_ngcontent-%COMP%]{text-align:center;padding:20px;color:var(--text-muted);font-style:italic}.fc-event-cancelled[_ngcontent-%COMP%]{color:#d9534f;font-weight:700}.fc-event[data-status=cancelled][_ngcontent-%COMP%]{opacity:.9;text-decoration:line-through}.dipendenti-info[_ngcontent-%COMP%]{background-color:color-mix(in srgb,var(--secondary) 20%,transparent);border-left:3px solid var(--primary);padding:var(--padding-h);margin-top:var(--padding-v);border-radius:var(--border-radius);font-size:var(--font-size-base);color:var(--text-light);line-height:1.4}`]})};var Ls=class n{constructor(e){this.supabase=e}getClientLoyaltyCard(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("loyalty_cards").select(`
        *,
        services:service_id (name)
      `).eq("client_id",e).eq("active",!0).order("created_at",{ascending:!1}).limit(1).single();if(i){if(i.code==="PGRST116")return null;throw console.error("Errore nel recupero della tessera:",i),i}return t}catch(t){return console.error("Errore nel recupero della tessera fedelt\xE0:",t),null}})}createLoyaltyCard(e){return C(this,null,function*(){try{let t=ne(B({},e),{price:e.price||0,total_services:e.total_services||0,used_services:e.used_services||0,initial_amount:e.initial_amount||0,remaining_amount:e.remaining_amount||0,issue_date:e.issue_date||new Date().toISOString()}),{data:i,error:r}=yield this.supabase.getClient().from("loyalty_cards").insert([t]).select(`
          id,
          client_id,
          salon_id,
          card_type,
          issue_date,
          expiration_date,
          price,
          total_services,
          used_services,
          active,
          notes,
          created_at,
          updated_at,
          initial_amount,
          remaining_amount,
          last_used,
          service_id
        `);if(r)throw console.error("Errore dettagliato Supabase:",r),r;return i?i[0]:null}catch(t){throw console.error("Errore nella creazione della tessera:",t),t}})}handleSupabaseError(e,t){throw console.error(`Errore in ${t}:`,e),e.code==="23502"?new Error(`Campo obbligatorio mancante: ${e.details}`):e.code==="42501"?new Error("Permessi insufficienti per questa operazione"):e.code==="23505"?new Error("Elemento duplicato"):e}updateLoyaltyCard(e,t){return C(this,null,function*(){try{let{data:i,error:r}=yield this.supabase.getClient().from("loyalty_cards").update(t).eq("id",e).select();if(r)throw r;return i?i[0]:null}catch(i){throw console.error("Errore nell'aggiornamento della tessera fedelt\xE0:",i),i}})}deactivateLoyaltyCard(e){return C(this,null,function*(){return this.updateLoyaltyCard(e,{active:!1})})}incrementUsedServices(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().rpc("increment_used_services",{card_id:e});if(i)throw i;return t}catch(t){throw console.error("Errore nell'incremento dei servizi utilizzati:",t),t}})}useLoyaltyService(e,t){return C(this,null,function*(){let{data:i,error:r}=yield this.supabase.getClient().from("loyalty_cards").select("*").eq("id",e).single();if(r)throw r;if(!i)throw new Error("Tessera non trovata");let o={},s=new Date().toISOString();if(i.card_type==="services"){let u=(i.used_services||0)+1;o.used_services=u,o.last_used=s,i.total_services&&u>=i.total_services&&(o.active=!1,o.finished_at=s)}else{let u=t&&t>0?t:0,f=i.initial_amount??0,m=(i.remaining_amount??f)-u;o.remaining_amount=m,u>0&&(o.last_used=s),m<=0&&(o.active=!1,o.finished_at=s,o.remaining_amount=0)}let{data:l,error:c}=yield this.supabase.getClient().from("loyalty_cards").update(o).eq("id",e).select("*").single();if(c)throw c;return l})}deactivateCard(e,t){return C(this,null,function*(){let i={active:!1,finished_at:new Date().toISOString(),finished_reason:t??"automatic"},{data:r,error:o}=yield this.supabase.getClient().from("loyalty_cards").update(i).eq("id",e).single();if(o)throw o;return r})}getLoyaltyCardById(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("loyalty_cards").select("*").eq("id",e).single();if(i)throw i;return t}catch(t){throw console.error("Errore nel recupero della tessera:",t),t}})}static \u0275fac=function(t){return new(t||n)(te(ue))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};function gY(n,e){if(n&1){let t=ee();g(0,"div",15),v(1),Me(2,"date"),Me(3,"date"),g(4,"button",16),F("click",function(){A(t);let r=E(2);return R(r.createNewCard())}),v(5,"Crea nuova tessera"),p()()}if(n&2){let t=E(2);_(),J(" Tessera esaurita il ",t.loyaltyCard.finished_at?Te(2,1,t.loyaltyCard.finished_at,"dd/MM/yyyy"):t.loyaltyCard.last_used?Te(3,4,t.loyaltyCard.last_used,"dd/MM/yyyy"):"Data non disponibile",". ")}}function mY(n,e){if(n&1&&(g(0,"div",9)(1,"span",10),v(2,"Servizio associato:"),p(),g(3,"span",11),v(4),p()()),n&2){let t=E(2);_(4),q(t.getServiceName())}}function vY(n,e){if(n&1&&(g(0,"div",9)(1,"span",10),v(2,"Servizi totali:"),p(),g(3,"span",11),v(4),p()()),n&2){let t=E(2);_(4),q(t.loyaltyCard.total_services)}}function _Y(n,e){if(n&1&&(g(0,"div",9)(1,"span",10),v(2,"Servizi utilizzati:"),p(),g(3,"span",11),v(4),p()()),n&2){let t=E(2);_(4),q(t.loyaltyCard.used_services)}}function yY(n,e){if(n&1&&(g(0,"div",9)(1,"span",10),v(2,"Servizi rimanenti:"),p(),g(3,"span",11),v(4),p()()),n&2){let t=E(2);_(4),q(t.getRemainingServices())}}function bY(n,e){if(n&1&&(g(0,"div",9)(1,"span",10),v(2,"Importo iniziale:"),p(),g(3,"span",11),v(4),p()()),n&2){let t=E(2);_(4),J("\u20AC",t.loyaltyCard.initial_amount)}}function wY(n,e){if(n&1&&(g(0,"div",9)(1,"span",10),v(2,"Importo rimanente:"),p(),g(3,"span",11),v(4),p()()),n&2){let t=E(2);_(4),J("\u20AC",t.loyaltyCard.remaining_amount)}}function SY(n,e){if(n&1&&(g(0,"div",17),ie(1,"div",18),p()),n&2){let t=E(2);_(),Oo("width",t.getProgressPercentage()+"%")}}function CY(n,e){if(n&1&&(g(0,"div",19)(1,"span",10),v(2,"Avanzamento:"),p(),g(3,"span",11),v(4),Me(5,"number"),p()()),n&2){let t=E(2);_(4),No("",t.loyaltyCard.used_services," / ",t.loyaltyCard.total_services," (",Te(5,3,t.getProgressPercentage(),"1.0-0"),"%)")}}function EY(n,e){if(n&1&&(g(0,"div",19)(1,"span",10),v(2,"Saldo:"),p(),g(3,"span",11),v(4),Me(5,"number"),Me(6,"number"),Me(7,"number"),p()()),n&2){let t=E(2);_(4),No("\u20AC",Te(5,3,t.loyaltyCard.initial_amount-(t.loyaltyCard.remaining_amount||0),"1.2-2")," spesi / \u20AC",Te(6,6,t.loyaltyCard.initial_amount,"1.2-2")," (",Te(7,9,t.getProgressPercentage(),"1.0-0"),"%)")}}function xY(n,e){if(n&1&&(g(0,"div",7),N(1,gY,6,7,"div",8),g(2,"div",9)(3,"span",10),v(4,"Tipo:"),p(),g(5,"span",11),v(6),p()(),N(7,mY,5,1,"div",12)(8,vY,5,1,"div",12)(9,_Y,5,1,"div",12)(10,yY,5,1,"div",12)(11,bY,5,1,"div",12)(12,wY,5,1,"div",12),g(13,"div",9)(14,"span",10),v(15,"Data emissione:"),p(),g(16,"span",11),v(17),Me(18,"date"),p()(),g(19,"div",9)(20,"span",10),v(21,"Ultimo utilizzo:"),p(),g(22,"span",11),v(23),Me(24,"date"),p()(),N(25,SY,2,2,"div",13)(26,CY,6,6,"div",14)(27,EY,8,12,"div",14),p()),n&2){let t=E();_(),x("ngIf",t.loyaltyCard&&!t.loyaltyCard.active),_(5),q(t.loyaltyCard.card_type==="services"?"A servizi":"A importo"),_(),x("ngIf",t.loyaltyCard.card_type==="services"),_(),x("ngIf",t.loyaltyCard.card_type==="services"),_(),x("ngIf",t.loyaltyCard.card_type==="services"),_(),x("ngIf",t.loyaltyCard.card_type==="services"),_(),x("ngIf",t.loyaltyCard.card_type==="amount"),_(),x("ngIf",t.loyaltyCard.card_type==="amount"),_(5),q(Te(18,13,t.loyaltyCard.issue_date,"dd/MM/yyyy")),_(6),q(t.loyaltyCard.last_used?Te(24,16,t.loyaltyCard.last_used,"dd/MM/yyyy HH:mm"):"Mai utilizzata"),_(2),x("ngIf",t.loyaltyCard.card_type==="services"||t.loyaltyCard.card_type==="amount"),_(),x("ngIf",t.loyaltyCard.card_type==="services"),_(),x("ngIf",t.loyaltyCard.card_type==="amount")}}function DY(n,e){n&1&&(g(0,"span",27),v(1," (Nessun servizio rimanente)"),p())}function IY(n,e){if(n&1&&(g(0,"div",28),v(1),p()),n&2){let t=E(3);_(),q(t.errorMessage)}}function MY(n,e){if(n&1){let t=ee();g(0,"div")(1,"p"),v(2," Questa tessera \xE8 "),g(3,"strong"),v(4,"a servizi"),p(),v(5,". Verr\xE0 scalato 1 servizio associato: "),g(6,"strong"),v(7),p(),v(8,". "),N(9,DY,2,0,"span",22),p(),N(10,IY,2,1,"div",23),g(11,"div",24)(12,"button",25),F("click",function(){A(t);let r=E(2);return r.deductionType="service",R(r.deductFromCard())}),v(13),p(),g(14,"button",26),F("click",function(){A(t);let r=E(2);return R(r.closePopup())}),v(15,"Annulla"),p()()()}if(n&2){let t=E(2);_(7),q(t.getServiceName()),_(2),x("ngIf",t.getRemainingServices()===0),_(),x("ngIf",t.errorMessage),_(2),x("disabled",t.isLoading||t.getRemainingServices()===0),_(),J(" ",t.isLoading?"Elaborazione...":"Scala servizio"," ")}}function TY(n,e){if(n&1&&(g(0,"div",28),v(1),p()),n&2){let t=E(3);_(),q(t.errorMessage)}}function PY(n,e){if(n&1){let t=ee();g(0,"div")(1,"div",29)(2,"label"),v(3,"Importo da scalare (\u20AC):"),p(),g(4,"input",30),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.amountToDeduct,r)||(o.amountToDeduct=r),R(r)}),p(),g(5,"small",31),v(6),p()(),N(7,TY,2,1,"div",23),g(8,"div",24)(9,"button",25),F("click",function(){A(t);let r=E(2);return r.deductionType="amount",R(r.deductFromCard())}),v(10),p(),g(11,"button",26),F("click",function(){A(t);let r=E(2);return R(r.closePopup())}),v(12,"Annulla"),p()()()}if(n&2){let t=E(2);_(4),G("ngModel",t.amountToDeduct),x("max",t.loyaltyCard.remaining_amount||null),_(2),J("Massimo disponibile: \u20AC",t.loyaltyCard.remaining_amount||0),_(),x("ngIf",t.errorMessage),_(2),x("disabled",t.isLoading),_(),J(" ",t.isLoading?"Elaborazione...":"Conferma scalata"," ")}}function AY(n,e){if(n&1&&(g(0,"div",20)(1,"h3"),v(2,"Scala dalla tessera"),p(),N(3,MY,16,5,"div",21)(4,PY,13,6,"div",21),p()),n&2){let t=E();_(3),x("ngIf",t.loyaltyCard.card_type==="services"),_(),x("ngIf",t.loyaltyCard.card_type==="amount")}}function RY(n,e){if(n&1){let t=ee();g(0,"div",29)(1,"label"),v(2,"Numero di servizi inclusi:"),p(),g(3,"input",38),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.newCardTotalServices,r)||(o.newCardTotalServices=r),R(r)}),p()()}if(n&2){let t=E(2);_(3),G("ngModel",t.newCardTotalServices)}}function kY(n,e){if(n&1&&(g(0,"option",42),v(1),p()),n&2){let t=e.$implicit;x("value",t.id)("disabled",t.is_group),_(),yt(" ",t.name,"",t.is_group?" (Gruppo)":""," ")}}function OY(n,e){n&1&&(g(0,"small"),v(1,"Caricamento servizi..."),p())}function NY(n,e){if(n&1){let t=ee();g(0,"div",29)(1,"label"),v(2,"Servizio associato:"),p(),g(3,"select",39),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.newCardServiceId,r)||(o.newCardServiceId=r),R(r)}),g(4,"option",40),v(5,"Seleziona un servizio"),p(),N(6,kY,2,4,"option",41),p(),N(7,OY,2,0,"small",21),p()}if(n&2){let t=E(2);_(3),G("ngModel",t.newCardServiceId),x("disabled",t.loadingServices),_(),x("value",null),_(2),x("ngForOf",t.availableServices),_(),x("ngIf",t.loadingServices)}}function LY(n,e){if(n&1){let t=ee();g(0,"div",29)(1,"label"),v(2,"Importo iniziale (\u20AC):"),p(),g(3,"input",43),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.newCardInitialAmount,r)||(o.newCardInitialAmount=r),R(r)}),p()()}if(n&2){let t=E(2);_(3),G("ngModel",t.newCardInitialAmount)}}function FY(n,e){if(n&1&&(g(0,"div",28),v(1),p()),n&2){let t=E(2);_(),q(t.errorMessage)}}function zY(n,e){if(n&1){let t=ee();g(0,"div",32)(1,"div",29)(2,"label"),v(3,"Tipo di tessera:"),p(),g(4,"select",33),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.newCardType,r)||(o.newCardType=r),R(r)}),g(5,"option",34),v(6,"A servizi"),p(),g(7,"option",35),v(8,"A importo"),p()()(),N(9,RY,4,1,"div",36)(10,NY,8,5,"div",36)(11,LY,4,1,"div",36),g(12,"div",29)(13,"label"),v(14,"Giorni alla scadenza (opzionale):"),p(),g(15,"input",37),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.newCardExpirationDays,r)||(o.newCardExpirationDays=r),R(r)}),p()(),N(16,FY,2,1,"div",23),g(17,"div",24)(18,"button",25),F("click",function(){A(t);let r=E();return R(r.createNewCard())}),v(19),p(),g(20,"button",26),F("click",function(){A(t);let r=E();return R(r.closePopup())}),v(21,"Annulla"),p()()()}if(n&2){let t=E();_(4),G("ngModel",t.newCardType),_(5),x("ngIf",t.newCardType==="services"),_(),x("ngIf",t.newCardType==="services"),_(),x("ngIf",t.newCardType==="amount"),_(4),G("ngModel",t.newCardExpirationDays),_(),x("ngIf",t.errorMessage),_(2),x("disabled",t.isLoading),_(),J(" ",t.isLoading?"Creazione...":"Crea Tessera"," ")}}var dd=class n{constructor(e,t,i){this.loyaltyService=e;this.supabase=t;this.salonServiceService=i}client;loyaltyCard;close=new ye;cardUpdated=new ye;cardCreated=new ye;newCardType="services";newCardTotalServices=10;newCardInitialAmount=100;newCardExpirationDays=null;newCardServiceId=null;availableServices=[];deductionType="service";amountToDeduct=0;isLoading=!1;errorMessage="";loadingServices=!1;ngOnInit(){return C(this,null,function*(){this.loyaltyCard||(yield this.loadAvailableServices(),this.deductionType=this.loyaltyCard?.card_type==="amount"?"amount":"service")})}loadAvailableServices(){return C(this,null,function*(){this.loadingServices=!0;try{if(this.availableServices=yield this.salonServiceService.getServicesOnly(!0),this.loyaltyCard&&this.loyaltyCard.service_id&&!this.availableServices.some(t=>t.id===this.loyaltyCard.service_id)){let t=yield this.salonServiceService.getServiceById(this.loyaltyCard.service_id);t&&this.availableServices.push(t)}}catch(e){console.error("Errore nel caricamento dei servizi:",e),this.errorMessage="Errore nel caricamento dei servizi disponibili"}finally{this.loadingServices=!1}})}deductFromCard(){return C(this,null,function*(){this.isLoading=!0,this.errorMessage="";try{let e;if(this.deductionType==="service")e=yield this.loyaltyService.useLoyaltyService(this.loyaltyCard.id);else{if(!this.amountToDeduct||this.amountToDeduct<=0)throw new Error("Inserisci un importo valido");e=yield this.loyaltyService.useLoyaltyService(this.loyaltyCard.id,this.amountToDeduct)}this.cardUpdated.emit(e),this.closePopup()}catch(e){this.errorMessage=e.message||"Errore durante l'operazione"}finally{this.isLoading=!1}})}createNewCard(){return C(this,null,function*(){this.isLoading=!0,this.errorMessage="";try{let e=yield this.supabase.getMyProfile();if(!e||!e.id)throw new Error("Impossibile identificare il salone");if(this.newCardType==="services"){if(!this.newCardTotalServices||this.newCardTotalServices<=0)throw new Error("Inserisci un numero valido di servizi");if(!this.newCardServiceId)throw new Error("Seleziona un servizio per la tessera")}else if(!this.newCardInitialAmount||this.newCardInitialAmount<=0)throw new Error("Inserisci un importo valido");let t={client_id:this.client.id,salon_id:e.id,card_type:this.newCardType,active:!0,price:0,issue_date:new Date().toISOString()};if(this.newCardType==="services"){t.total_services=this.newCardTotalServices,t.used_services=0,t.service_id=this.newCardServiceId;let r=this.availableServices.find(o=>o.id===this.newCardServiceId);r&&r.price&&(t.price=r.price)}else t.initial_amount=this.newCardInitialAmount,t.remaining_amount=this.newCardInitialAmount,t.price=this.newCardInitialAmount;if(this.newCardExpirationDays){let r=new Date;r.setDate(r.getDate()+this.newCardExpirationDays),t.expiration_date=r.toISOString()}let i=yield this.loyaltyService.createLoyaltyCard(t);this.cardCreated.emit(i),this.closePopup()}catch(e){console.error("Errore dettagliato nella creazione:",e),this.errorMessage=e.message||"Errore durante la creazione della tessera"}finally{this.isLoading=!1}})}closePopup(){this.close.emit()}getRemainingServices(){return this.loyaltyCard.total_services-this.loyaltyCard.used_services}getProgressPercentage(){if(!this.loyaltyCard)return 0;if(this.loyaltyCard.card_type==="services"){let e=Number(this.loyaltyCard.total_services)||0,t=Number(this.loyaltyCard.used_services)||0;return e<=0?0:Math.min(100,Math.max(0,t/e*100))}else{let e=Number(this.loyaltyCard.initial_amount)||0,t=Number(this.loyaltyCard.remaining_amount);if(e<=0)return 0;let i=isNaN(t)?0:e-t;return Math.min(100,Math.max(0,i/e*100))}}getServiceName(){if(!this.loyaltyCard)return"Nessun servizio associato";if(this.loyaltyCard.services&&this.loyaltyCard.services.name)return this.loyaltyCard.services.name;if(this.loyaltyCard.service_id){let e=this.availableServices.find(t=>t.id===this.loyaltyCard.service_id);return e?e.name:"Servizio non trovato"}return"Nessun servizio associato"}static \u0275fac=function(t){return new(t||n)(z(Ls),z(ue),z(Ji))};static \u0275cmp=he({type:n,selectors:[["app-popup-fedelity"]],inputs:{client:"client",loyaltyCard:"loyaltyCard"},outputs:{close:"close",cardUpdated:"cardUpdated",cardCreated:"cardCreated"},decls:10,vars:4,consts:[[1,"popup-overlay",3,"click"],[1,"popup-content",3,"click"],[1,"popup-header"],[1,"close-btn",3,"click"],["class","card-details",4,"ngIf"],["class","deduction-section",4,"ngIf"],["class","creation-section",4,"ngIf"],[1,"card-details"],["class","muted loyalty-finished",4,"ngIf"],[1,"detail-row"],[1,"label"],[1,"value"],["class","detail-row",4,"ngIf"],["class","progress-bar",4,"ngIf"],["class","detail-row progress-label",4,"ngIf"],[1,"muted","loyalty-finished"],[1,"btn",3,"click"],[1,"progress-bar"],[1,"progress-fill"],[1,"detail-row","progress-label"],[1,"deduction-section"],[4,"ngIf"],["class","muted",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"action-buttons"],[1,"btn","btn-primary",3,"click","disabled"],[1,"btn","btn-secondary",3,"click"],[1,"muted"],[1,"error-message"],[1,"form-group"],["type","number","min","0.01","step","0.01","placeholder","0.00",1,"form-control",3,"ngModelChange","ngModel","max"],[1,"help"],[1,"creation-section"],[1,"form-control",3,"ngModelChange","ngModel"],["value","services"],["value","amount"],["class","form-group",4,"ngIf"],["type","number","min","1","step","1","placeholder","Lascia vuoto per nessuna scadenza",1,"form-control",3,"ngModelChange","ngModel"],["type","number","min","1","step","1",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-control",3,"ngModelChange","ngModel","disabled"],[3,"value"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"],["type","number","min","0.01","step","0.01",1,"form-control",3,"ngModelChange","ngModel"]],template:function(t,i){t&1&&(g(0,"div",0),F("click",function(){return i.closePopup()}),g(1,"div",1),F("click",function(o){return o.stopPropagation()}),g(2,"div",2)(3,"h2"),v(4),p(),g(5,"button",3),F("click",function(){return i.closePopup()}),v(6,"\xD7"),p()(),N(7,xY,28,19,"div",4)(8,AY,5,2,"div",5)(9,zY,22,8,"div",6),p()()),t&2&&(_(4),q(i.loyaltyCard?"Tessera Fedelt\xE0":"Crea Tessera Fedelt\xE0"),_(3),x("ngIf",i.loyaltyCard),_(),x("ngIf",i.loyaltyCard&&i.loyaltyCard.active),_(),x("ngIf",!i.loyaltyCard))},dependencies:[vt,Ot,Nt,st,Wa,Dt,at,qa,Tf,pt,Se,Ze,Ne,_a,Pi],styles:[`.popup-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000000b3;display:flex;justify-content:center;align-items:center;z-index:1000;padding:1rem;box-sizing:border-box}.popup-content[_ngcontent-%COMP%]{background-color:var(--background);border-radius:var(--border-radius);padding:0;width:100%;max-width:min(85vw,420px);max-height:min(85vh,550px);overflow-y:auto;box-shadow:0 4px 20px #00000026;border:1px solid var(--primary);display:flex;flex-direction:column}.popup-header[_ngcontent-%COMP%]{position:sticky;top:0;background-color:var(--background);display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;padding-bottom:.5rem;z-index:10;border-bottom:1px solid rgba(255,255,255,.1);padding:clamp(.8rem,2vw,1.2rem)}.popup-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:var(--primary);font-size:var(--font-size-lg);font-weight:700}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;color:var(--text-muted);display:flex;align-items:center;justify-content:center;width:2rem;height:2rem;border-radius:50%;transition:all .2s ease}.close-btn[_ngcontent-%COMP%]:hover{color:var(--text-light);background-color:#ffffff1a}.card-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.6rem;padding:clamp(.8rem,2vw,1.2rem)}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.4rem 0;border-bottom:1px solid rgba(255,255,255,.05)}.detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:600;color:var(--text-muted);font-size:.9rem}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--text-light);text-align:right;max-width:60%;word-break:break-word;font-size:.9rem}.progress-bar[_ngcontent-%COMP%]{width:100%;height:.5rem;background-color:var(--background2);border-radius:999px;margin:.5rem 0;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(135deg,var(--primary),var(--secondary));border-radius:999px;transition:width .3s ease}.deduction-section[_ngcontent-%COMP%], .creation-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.8rem;padding-top:.8rem;padding:clamp(.8rem,2vw,1.2rem)}.deduction-section[_ngcontent-%COMP%]{border-top:1px solid rgba(255,255,255,.1)}.deduction-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .creation-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--primary);font-size:1rem;font-weight:600}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.4rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--text-light);font-weight:600;font-size:.9rem}.form-control[_ngcontent-%COMP%]{width:100%;padding:.5rem .7rem;border:1px solid rgba(255,255,255,.15);border-radius:6px;background:var(--background2);color:var(--text-light);font-size:.9rem;box-sizing:border-box}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 2px #d4af374d}.error-message[_ngcontent-%COMP%]{color:var(--danger);background-color:#f443361a;padding:.6rem;border-radius:6px;font-size:.85rem;margin:.4rem 0}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.6rem;justify-content:flex-end;flex-wrap:wrap;margin-top:.5rem}.action-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:100px;padding:.5rem 1rem;font-size:.9rem}select.form-control[_ngcontent-%COMP%]{appearance:none;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23d4af37' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right .7rem center;background-size:.9rem}input[type=number].form-control[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number].form-control[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}@media (max-width: 480px){.popup-content[_ngcontent-%COMP%]{padding:0;max-width:92vw;max-height:90vh}.detail-row[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.2rem}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{max-width:100%;text-align:left}.action-buttons[_ngcontent-%COMP%]{flex-direction:column}.action-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}.form-group[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:var(--text-muted);font-size:.8rem;margin-top:.25rem;display:block}select.form-control[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]:disabled{color:var(--text-muted);font-style:italic}.loyalty-finished[_ngcontent-%COMP%]{background:#ffffff05;padding:.6rem;border-radius:8px;margin-bottom:.6rem;color:var(--text-muted);display:flex;align-items:center;justify-content:space-between;gap:.6rem}.loyalty-finished[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:0 0 auto;padding:.35rem .6rem;font-size:.9rem}.progress-label[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:600;color:var(--text-muted);font-size:.85rem}.progress-label[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--text-light);font-size:.9rem;text-align:right}.progress-fill[_ngcontent-%COMP%]{min-width:2%}`]})};var ud=class n{constructor(e){this.supabase=e}createInvite(e,t,i){return C(this,null,function*(){let r=this.generateToken(),{data:o,error:s}=yield this.supabase.getClient().from("invites").insert([{salon_id:e,client_id:t,email:i,token:r,expires_at:new Date(Date.now()+7*24*60*60*1e3).toISOString()}]).select();if(s)throw s;return o[0]})}getInviteByToken(e){return C(this,null,function*(){let{data:t,error:i}=yield this.supabase.getClient().from("invites").select("*, salon:salon_id(*)").eq("token",e).single();if(i)throw i;return t})}markInviteAsUsed(e){return C(this,null,function*(){let{error:t}=yield this.supabase.getClient().from("invites").update({used:!0,used_at:new Date().toISOString()}).eq("token",e);if(t)throw t})}generateToken(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}static \u0275fac=function(t){return new(t||n)(te(ue))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};function VY(n,e){if(n&1){let t=ee();g(0,"div",6)(1,"p",7),v(2),p(),g(3,"button",8),F("click",function(){A(t);let r=E();return R(r.loadClients())}),v(4,"Riprova"),p()()}if(n&2){let t=E();_(2),q(t.error)}}function jY(n,e){if(n&1){let t=ee();g(0,"button",31),F("click",function(){A(t);let r=E().$implicit,o=E(2);return R(o.sendInvite(r))}),v(1," Invita ad iscriversi "),p()}}function BY(n,e){n&1&&(g(0,"span",32),v(1," Gi\xE0 iscritto "),p())}function UY(n,e){if(n&1){let t=ee();g(0,"tr")(1,"td"),v(2),p(),g(3,"td"),v(4),p(),g(5,"td"),v(6),p(),g(7,"td")(8,"span",24),v(9),p()(),g(10,"td"),v(11),Me(12,"date"),p(),g(13,"td"),N(14,jY,2,0,"button",25)(15,BY,2,0,"span",26),p(),g(16,"td",27)(17,"button",28),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.openLoyaltyPopup(r))}),g(18,"i",18),v(19,"loyalty"),p()(),g(20,"button",29),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.onEdit(r))}),g(21,"i",18),v(22,"edit"),p()(),g(23,"button",30),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.onDelete(r))}),g(24,"i",18),v(25,"delete"),p()()()()}if(n&2){let t=e.$implicit;_(2),q(t.full_name||t.first_name+" "+t.last_name),_(2),q(t.phone),_(2),q(t.email),_(2),Oe("badge-success",t.hasLoyaltyCard)("badge-secondary",!t.hasLoyaltyCard),_(),J(" ",t.hasLoyaltyCard?"Attiva":"Non attiva"," "),_(2),q(Te(12,11,t.created_at,"dd/MM/yyyy")),_(3),x("ngIf",!t.profile_id),_(),x("ngIf",t.profile_id)}}function HY(n,e){n&1&&(g(0,"div",33)(1,"p"),v(2,"Nessun cliente trovato con i criteri di ricerca specificati."),p()())}function WY(n,e){n&1&&(g(0,"div",34)(1,"p"),v(2,"Nessun cliente presente."),p()())}function $Y(n,e){if(n&1){let t=ee();g(0,"div")(1,"div",9)(2,"div",10)(3,"h3",11),v(4,"Clienti Totali"),p(),g(5,"p",12),v(6),p()(),g(7,"div",10)(8,"h3",11),v(9,"Clienti Registrati"),p(),g(10,"p",12),v(11),p()(),g(12,"div",10)(13,"h3",11),v(14,"Nuovi Clienti (30gg)"),p(),g(15,"p",12),v(16),p()(),g(17,"div",10)(18,"h3",11),v(19,"Tessere Attive"),p(),g(20,"p",12),v(21),p()()(),g(22,"div",13)(23,"div",14)(24,"input",15),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.searchTerm,r)||(o.searchTerm=r),R(r)}),F("input",function(){A(t);let r=E();return R(r.applyFilter())}),p(),g(25,"span",16),v(26," \u{1F50D} "),p()(),g(27,"button",17),F("click",function(){A(t);let r=E();return R(r.openNewClient())}),g(28,"i",18),v(29,"add"),p(),v(30," Nuovo Cliente "),p()(),g(31,"div",19)(32,"table",20)(33,"thead")(34,"tr")(35,"th"),v(36,"Nome Completo"),p(),g(37,"th"),v(38,"Telefono"),p(),g(39,"th"),v(40,"Email"),p(),g(41,"th"),v(42,"Tessera Fedelt\xE0"),p(),g(43,"th"),v(44,"Data Registrazione"),p(),g(45,"th"),v(46,"Stato Iscrizione"),p(),g(47,"th"),v(48,"Azioni"),p()()(),g(49,"tbody"),N(50,UY,26,14,"tr",21),p()(),N(51,HY,3,0,"div",22)(52,WY,3,0,"div",23),p()()}if(n&2){let t=E();_(6),q(t.clients.length),_(5),q(t.registeredCount),_(5),q(t.newLast30Days),_(5),q(t.clientsWithLoyaltyCard),_(3),G("ngModel",t.searchTerm),_(26),x("ngForOf",t.filteredClients),_(),x("ngIf",t.filteredClients.length===0&&t.clients.length>0),_(),x("ngIf",t.clients.length===0)}}function qY(n,e){if(n&1){let t=ee();g(0,"app-popup-fedelity",35),F("close",function(){A(t);let r=E();return R(r.showLoyaltyPopup=!1)})("cardUpdated",function(r){A(t);let o=E();return R(o.onLoyaltyCardUpdated(r))})("cardCreated",function(r){A(t);let o=E();return R(o.onLoyaltyCardCreated(r))}),p()}if(n&2){let t=E();x("client",t.currentClient)("loyaltyCard",t.currentLoyaltyCard)}}function GY(n,e){n&1&&(g(0,"div",36)(1,"div",37),ie(2,"div",38),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}var m0=class n{constructor(e,t,i,r,o){this.supabase=e;this.clientService=t;this.loyaltyService=i;this.inviteService=r;this.router=o}clients=[];filteredClients=[];appointments=[];loading=!0;error=null;searchTerm="";currentClient;registeredCount=0;newLast30Days=0;guestCount=0;clientsWithLoyaltyCard=0;currentLoyaltyCard=null;showLoyaltyPopup=!1;sessoFilter="";sessiDisponibili=[{valore:"",label:"Tutti"},{valore:"maschio",label:"Uomini"},{valore:"femmina",label:"Donne"}];ngOnInit(){return C(this,null,function*(){yield this.loadClients()})}loadClients(){return C(this,null,function*(){this.loading=!0,this.error=null;try{this.clients=yield this.clientService.getClientsBySalon(),console.log("Clienti caricati:",this.clients.length),this.filteredClients=yield Promise.all(this.clients.map(e=>C(this,null,function*(){try{console.log("Caricamento tessera per cliente:",e.id);let t=yield this.loyaltyService.getClientLoyaltyCard(e.id);console.log("Tessera trovata:",t);let i=!!t&&(!!t.active||t.active===!0);return ne(B({},e),{hasLoyaltyCard:!!t&&i,loyaltyCard:i?t:null,lastLoyaltyCard:t&&!i?t:null})}catch(t){return console.error(`Errore nel caricamento della tessera per il cliente ${e.id}:`,t),ne(B({},e),{hasLoyaltyCard:!1,loyaltyCard:null,lastLoyaltyCard:null})}}))),this.calculateKPIs()}catch(e){console.error("Errore completo nel caricamento dei clienti:",e),this.error=e.message||"Errore nel caricamento dei clienti"}finally{this.loading=!1}})}loadAppointments(){return C(this,null,function*(){try{let e=yield this.supabase.getMyProfile();if(!e||!e.salon_id)return;let{data:t,error:i}=yield this.supabase.getClient().from("appointments").select("id, client_id, start_time, status").eq("salon_id",e.salon_id);if(i)throw i;this.appointments=t||[]}catch(e){console.error("Errore nel caricamento degli appuntamenti:",e)}})}calculateKPIs(){let e=new Date;e.setDate(e.getDate()-30),this.registeredCount=this.clients.filter(t=>t.profile_id).length,this.guestCount=this.clients.filter(t=>!t.profile_id).length,this.newLast30Days=this.clients.filter(t=>new Date(t.created_at)>=e).length,this.clientsWithLoyaltyCard=this.filteredClients.filter(t=>t.hasLoyaltyCard).length}applyFilter(){let e=this.searchTerm.toLowerCase();this.filteredClients=this.clients.map(t=>B({},t)).filter(t=>{let i=t.full_name&&t.full_name.toLowerCase().includes(e)||t.first_name&&t.first_name.toLowerCase().includes(e)||t.last_name&&t.last_name.toLowerCase().includes(e)||t.email&&t.email.toLowerCase().includes(e)||t.phone&&t.phone.toLowerCase().includes(e),r=!this.sessoFilter||t.sesso===this.sessoFilter;return i&&r})}getLastAppointmentDate(e){let t=this.appointments.filter(i=>i.client_id===e&&i.status!=="cancelled").sort((i,r)=>new Date(r.start_time).getTime()-new Date(i.start_time).getTime());return t.length>0?new Date(t[0].start_time):null}getAppointmentCount(e){return this.appointments.filter(t=>t.client_id===e&&t.status!=="cancelled").length}viewAppointmentHistory(e){console.log("Visualizza storico appuntamenti per:",e)}openNewClient(){this.router.navigate(["/admin/clienti/nuovo"])}manageLoyaltyCard(e){return C(this,null,function*(){e.hasLoyaltyCard&&e.loyaltyCard?this.openLoyaltyPopup(e):this.createNewLoyaltyCard(e)})}openLoyaltyPopup(e){this.currentClient=e,this.currentLoyaltyCard=e.loyaltyCard??e.lastLoyaltyCard??null,this.showLoyaltyPopup=!0}onLoyaltyCardCreated(e){let t=this.filteredClients.findIndex(i=>i.id===this.currentClient.id);t!==-1&&(this.filteredClients[t].hasLoyaltyCard=!0,this.filteredClients[t].loyaltyCard=e),this.calculateKPIs(),this.showLoyaltyPopup=!1}onLoyaltyCardUpdated(e){let t=this.filteredClients.findIndex(i=>i.loyaltyCard?.id===e.id||i.lastLoyaltyCard?.id===e.id);t!==-1&&(e.card_type==="services"&&(e.used_services??0)>=(e.total_services??1/0)||e.card_type==="amount"&&(e.remaining_amount??0)<=0||e.active===!1?(this.filteredClients[t].lastLoyaltyCard=e,this.filteredClients[t].loyaltyCard=null,this.filteredClients[t].hasLoyaltyCard=!1):(this.filteredClients[t].loyaltyCard=e,this.filteredClients[t].hasLoyaltyCard=!0,this.filteredClients[t].lastLoyaltyCard?.id===e.id&&(this.filteredClients[t].lastLoyaltyCard=null))),this.calculateKPIs(),this.showLoyaltyPopup=!1}createNewLoyaltyCard(e){return C(this,null,function*(){let t=prompt("Tipo di tessera (servizi/importo):","servizi");if(t)try{let i=yield this.supabase.getMyProfile();if(!i||!i.id)throw new Error("Impossibile identificare il salone");let r={client_id:e.id,salon_id:i.id,card_type:t,active:!0};if(t==="servizi"||t==="services"){let l=prompt("Inserisci il numero totale di servizi inclusi:");if(!l)return;r.card_type="services",r.total_services=parseInt(l),r.used_services=0}else if(t==="importo"||t==="amount"){let l=prompt("Inserisci l'importo iniziale della tessera:");if(!l)return;r.card_type="amount",r.initial_amount=parseFloat(l),r.remaining_amount=parseFloat(l)}let o=prompt("Inserisci il numero di giorni per la scadenza (lascia vuoto per nessuna scadenza):");o&&(r.expiration_date=new Date(Date.now()+parseInt(o)*24*60*60*1e3).toISOString());let s=yield this.loyaltyService.createLoyaltyCard(r);e.hasLoyaltyCard=!0,e.loyaltyCard=s,this.calculateKPIs(),alert("Tessera fedelt\xE0 creata con successo!")}catch(i){console.error("Errore nella creazione della tessera:",i),alert("Errore nella creazione della tessera fedelt\xE0: "+i.message)}})}onEdit(e){this.router.navigate(["/add-cliente",e.id])}onDelete(e){return C(this,null,function*(){let t=e.full_name||`${e.first_name} ${e.last_name}`,i=`Sei sicuro di voler eliminare definitivamente il cliente "${t}"?
  
ATTENZIONE: Questa operazione non pu\xF2 essere annullata.
Tutti i dati associati a questo cliente verranno eliminati permanentemente.`;if(confirm(i))try{let r=`Eliminazione di "${t}" in corso...`;if(alert(r),yield this.clientService.deleteClient(e.id)){this.clients=this.clients.filter(l=>l.id!==e.id),this.filteredClients=this.filteredClients.filter(l=>l.id!==e.id),this.calculateKPIs();let s=`Cliente "${t}" eliminato con successo`;alert(s)}}catch(r){console.error("Errore durante l'eliminazione del cliente:",r);let o="Errore durante l'eliminazione del cliente";r.message.includes("appuntamenti")||r.message.includes("tessera")?o=r.message:r.message.includes("non trovato")?o="Cliente non trovato nel database":r.message.includes("database")&&(o="Errore di comunicazione con il database"),alert(`ERRORE: ${o}`)}})}onSessoFilterChange(){this.applyFilter()}sendInvite(e){return C(this,null,function*(){try{let t=yield this.supabase.getMyProfile(!0);if(!t?.id)throw new Error("Salone non trovato");let i=yield this.inviteService.createInvite(t.id,e.id,e.email||""),r=`${window.location.origin}/register?invite=${i.token}`;navigator.clipboard?(yield navigator.clipboard.writeText(r),alert("Link di invito copiato negli appunti!")):prompt("Copia questo link per invitare il cliente:",r)}catch(t){console.error("Errore nell'invio dell'invito:",t),alert("Errore nell'invio dell'invito")}})}static \u0275fac=function(t){return new(t||n)(z(ue),z(ir),z(Ls),z(ud),z(We))};static \u0275cmp=he({type:n,selectors:[["app-clienti"]],decls:7,vars:4,consts:[[1,"container"],[1,"section-title"],["class","error-state",4,"ngIf"],[4,"ngIf"],[3,"client","loyaltyCard","close","cardUpdated","cardCreated",4,"ngIf"],["class","loading-overlay",4,"ngIf"],[1,"error-state"],[1,"error-message"],[1,"btn","btn-primary",3,"click"],[1,"kpi-cards"],[1,"kpi-card"],[1,"kpi-title"],[1,"kpi-value"],[1,"filters-bar"],[1,"search-box"],["type","search","placeholder","Cerca per nome, telefono o email","aria-label","Cerca per nome, telefono o email",3,"ngModelChange","input","ngModel"],[1,"search-icon"],["title","Nuovo Cliente",1,"btn","btn-primary",3,"click"],[1,"material-icons"],[1,"table-responsive"],[1,"data-table"],[4,"ngFor","ngForOf"],["class","no-results",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"badge"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["class","badge badge-success",4,"ngIf"],[1,"actions"],["title","Gestisci Tessera Fedelt\xE0",1,"btn-icon",3,"click"],["title","Modifica",1,"btn-icon",3,"click"],["title","Elimina",1,"btn-icon","btn-danger",3,"click"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"badge","badge-success"],[1,"no-results"],[1,"empty-state"],[3,"close","cardUpdated","cardCreated","client","loyaltyCard"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"]],template:function(t,i){t&1&&(g(0,"div",0)(1,"h2",1),v(2,"Clienti"),p(),N(3,VY,5,1,"div",2)(4,$Y,53,8,"div",3)(5,qY,1,2,"app-popup-fedelity",4)(6,GY,5,0,"div",5),p()),t&2&&(_(3),x("ngIf",i.error&&!i.loading),_(),x("ngIf",!i.loading&&!i.error),_(),x("ngIf",i.showLoyaltyPopup),_(),x("ngIf",i.loading))},dependencies:[Se,Ze,Ne,vt,st,at,pt,dd,Pi],styles:[".badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500}.badge-success[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.badge-warning[_ngcontent-%COMP%]{background-color:#ff9800;color:#fff}.badge-secondary[_ngcontent-%COMP%]{background-color:#9e9e9e;color:#fff}"]})};var fd=class n{constructor(e){this.supabase=e}getSuppliers(){return C(this,null,function*(){try{let{data:e,error:t}=yield this.supabase.getClient().from("suppliers").select("*").order("ragione_sociale",{ascending:!0});if(t)throw t;return e||[]}catch(e){return console.error("Errore recupero fornitori:",e),[]}})}createSupplier(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("suppliers").insert([e]).select().single();if(i)throw i;return t}catch(t){throw console.error("Errore creazione fornitore:",t),t}})}updateSupplier(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("suppliers").update(e).eq("id",e.id).select().single();if(i)throw i;return t}catch(t){throw console.error("Errore aggiornamento fornitore:",t),t}})}deleteSupplier(e){return C(this,null,function*(){try{let{error:t}=yield this.supabase.getClient().from("suppliers").delete().eq("id",e);if(t)throw t}catch(t){throw console.error("Errore eliminazione fornitore:",t),t}})}getSupplierById(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("suppliers").select("*").eq("id",e).single();if(i)throw i;return t||null}catch(t){return console.error("Errore recupero fornitore per id:",t),null}})}static \u0275fac=function(t){return new(t||n)(te(ue))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};function ZY(n,e){n&1&&(g(0,"div",5)(1,"div",6),ie(2,"div",7),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}function YY(n,e){if(n&1){let t=ee();g(0,"div",8)(1,"p",9),v(2),p(),g(3,"button",10),F("click",function(){A(t);let r=E();return R(r.loadSuppliers())}),v(4,"Riprova"),p()()}if(n&2){let t=E();_(2),q(t.error)}}function QY(n,e){if(n&1){let t=ee();g(0,"tr")(1,"td"),v(2),p(),g(3,"td"),v(4),p(),g(5,"td"),v(6),p(),g(7,"td"),v(8),p(),g(9,"td"),v(10),p(),g(11,"td"),v(12),p(),g(13,"td"),v(14),p(),g(15,"td",26)(16,"button",27),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.onEdit(r))}),g(17,"i",20),v(18,"edit"),p()(),g(19,"button",28),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.onDelete(r))}),g(20,"i",20),v(21,"delete"),p()()()()}if(n&2){let t=e.$implicit;_(2),q(t.ragione_sociale),_(2),q(t.partita_iva),_(2),q(t.indirizzo),_(2),q(t.citta),_(2),q(t.provincia),_(2),q(t.telefono),_(2),q(t.email)}}function KY(n,e){n&1&&(g(0,"div",29)(1,"p"),v(2,"Nessun fornitore trovato con i criteri di ricerca specificati."),p()())}function JY(n,e){if(n&1){let t=ee();g(0,"div",30)(1,"p"),v(2,"Nessun fornitore presente."),p(),g(3,"button",31),F("click",function(){A(t);let r=E(2);return R(r.openNewSupplier())}),g(4,"i",20),v(5,"add"),p(),v(6," Aggiungi il primo fornitore "),p()()}}function XY(n,e){if(n&1){let t=ee();g(0,"div")(1,"div",11)(2,"div",12)(3,"h3",13),v(4,"Fornitori Totali"),p(),g(5,"p",14),v(6),p()(),g(7,"div",12)(8,"h3",13),v(9,"Fornitori Attivi"),p(),g(10,"p",14),v(11),p()(),g(12,"div",12)(13,"h3",13),v(14,"Nuovi Fornitori (30gg)"),p(),g(15,"p",14),v(16),p()(),g(17,"div",12)(18,"h3",13),v(19,"Fornitori Inattivi"),p(),g(20,"p",14),v(21),p()()(),g(22,"div",15)(23,"div",16)(24,"input",17),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.searchTerm,r)||(o.searchTerm=r),R(r)}),F("input",function(){A(t);let r=E();return R(r.applyFilter())}),p(),g(25,"span",18),v(26," \u{1F50D} "),p()(),g(27,"button",19),F("click",function(){A(t);let r=E();return R(r.openNewSupplier())}),g(28,"i",20),v(29,"add"),p(),v(30," Nuovo Fornitore "),p()(),g(31,"div",21)(32,"table",22)(33,"thead")(34,"tr")(35,"th"),v(36,"Ragione Sociale"),p(),g(37,"th"),v(38,"P.IVA"),p(),g(39,"th"),v(40,"Indirizzo"),p(),g(41,"th"),v(42,"Citt\xE0"),p(),g(43,"th"),v(44,"Provincia"),p(),g(45,"th"),v(46,"Telefono"),p(),g(47,"th"),v(48,"Email"),p(),g(49,"th"),v(50,"Azioni"),p()()(),g(51,"tbody"),N(52,QY,22,7,"tr",23),p()(),N(53,KY,3,0,"div",24)(54,JY,7,0,"div",25),p()()}if(n&2){let t=E();_(6),q(t.suppliers.length),_(5),q(t.activeCount),_(5),q(t.newLast30Days),_(5),q(t.inactiveCount),_(3),G("ngModel",t.searchTerm),_(28),x("ngForOf",t.filteredSuppliers),_(),x("ngIf",t.filteredSuppliers.length===0&&t.suppliers.length>0),_(),x("ngIf",t.suppliers.length===0)}}var v0=class n{constructor(e,t){this.supplierService=e;this.router=t}suppliers=[];filteredSuppliers=[];searchTerm="";activeCount=0;newLast30Days=0;inactiveCount=0;loading=!0;error=null;ngOnInit(){return C(this,null,function*(){yield this.loadSuppliers()})}loadSuppliers(){return C(this,null,function*(){try{this.loading=!0,this.error=null,this.suppliers=yield this.supplierService.getSuppliers(),this.filteredSuppliers=[...this.suppliers],this.calculateKPI()}catch(e){console.error("Errore nel caricamento:",e),this.error="Impossibile caricare i fornitori. Riprovare pi\xF9 tardi."}finally{this.loading=!1}})}onEdit(e){e.id&&this.router.navigate(["/admin/fornitori/edita",e.id])}onDelete(e){return C(this,null,function*(){if(!e.id){console.error("ID fornitore mancante");return}if(confirm("Vuoi davvero eliminare questo fornitore?"))try{yield this.supplierService.deleteSupplier(e.id),this.suppliers=this.suppliers.filter(t=>t.id!==e.id),this.filteredSuppliers=this.filteredSuppliers.filter(t=>t.id!==e.id),this.calculateKPI()}catch(t){console.error("Errore eliminazione:",t),alert("Errore durante l'eliminazione del fornitore")}})}calculateKPI(){let e=new Date,t=new Date;t.setDate(e.getDate()-30),this.newLast30Days=this.suppliers.filter(i=>{if(!i.created_at)return!1;let r=new Date(i.created_at);return!isNaN(r.getTime())&&r>=t}).length,this.activeCount=this.suppliers.length,this.inactiveCount=0}applyFilter(){let e=this.searchTerm.trim().toLowerCase();e?this.filteredSuppliers=this.suppliers.filter(t=>{let i=(t.ragione_sociale||"").toLowerCase(),r=(t.partita_iva||"").toLowerCase(),o=(t.citta||"").toLowerCase();return i.includes(e)||r.includes(e)||o.includes(e)}):this.filteredSuppliers=[...this.suppliers]}openNewSupplier(){this.router.navigate(["/admin/fornitori/nuovo"])}static \u0275fac=function(t){return new(t||n)(z(fd),z(We))};static \u0275cmp=he({type:n,selectors:[["app-fornitori"]],decls:6,vars:3,consts:[[1,"container"],[1,"section-title"],["class","loading-overlay",4,"ngIf"],["class","error-state",4,"ngIf"],[4,"ngIf"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"],[1,"error-state"],[1,"error-message"],[1,"btn","btn-primary",3,"click"],[1,"kpi-cards"],[1,"kpi-card"],[1,"kpi-title"],[1,"kpi-value"],[1,"filters-bar"],[1,"search-box"],["type","search","placeholder","Cerca per ragione sociale, P.IVA o citt\xE0","aria-label","Cerca per nome, telefono o email",3,"ngModelChange","input","ngModel"],[1,"search-icon"],["title","Nuovo Fornitore",1,"btn-primary",3,"click"],[1,"material-icons"],[1,"table-responsive"],[1,"data-table"],[4,"ngFor","ngForOf"],["class","no-results",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"actions"],["title","Modifica",1,"btn-icon",3,"click"],["title","Elimina",1,"btn-icon",3,"click"],[1,"no-results"],[1,"empty-state"],[1,"btn-primary",3,"click"]],template:function(t,i){t&1&&(g(0,"div",0)(1,"h2",1),v(2,"Fornitori"),p(),N(3,ZY,5,0,"div",2)(4,YY,5,1,"div",3)(5,XY,55,8,"div",4),p()),t&2&&(_(3),x("ngIf",i.loading),_(),x("ngIf",i.error&&!i.loading),_(),x("ngIf",!i.loading&&!i.error))},dependencies:[Se,Ze,Ne,vt,st,at,pt,bt],encapsulation:2})};var _0=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=he({type:n,selectors:[["app-tessera-clienti"]],decls:2,vars:0,template:function(t,i){t&1&&(uu(0,"p"),v(1,"tessera-clienti works!"),fu())},encapsulation:2})};var rr=class n{getFallbackProvinces(){return[{code:"AG",name:"Agrigento",region:"Sicilia"},{code:"AL",name:"Alessandria",region:"Piemonte"},{code:"AN",name:"Ancona",region:"Marche"},{code:"AO",name:"Aosta",region:"Valle d'Aosta"},{code:"AR",name:"Arezzo",region:"Toscana"},{code:"AP",name:"Ascoli Piceno",region:"Marche"},{code:"AT",name:"Asti",region:"Piemonte"},{code:"AV",name:"Avellino",region:"Campania"},{code:"BA",name:"Bari",region:"Puglia"},{code:"BG",name:"Bergamo",region:"Lombardia"},{code:"BI",name:"Biella",region:"Piemonte"},{code:"BL",name:"Belluno",region:"Veneto"},{code:"BN",name:"Benevento",region:"Campania"},{code:"BR",name:"Brindisi",region:"Puglia"},{code:"BS",name:"Brescia",region:"Lombardia"},{code:"BT",name:"Barletta-Andria-Trani",region:"Puglia"},{code:"CA",name:"Cagliari",region:"Sardegna"},{code:"CB",name:"Campobasso",region:"Molise"},{code:"CE",name:"Caserta",region:"Campania"},{code:"CH",name:"Chieti",region:"Abruzzo"},{code:"CI",name:"Carboni Iglesias",region:"Sardegna"},{code:"CL",name:"Caltanissetta",region:"Sicilia"},{code:"CN",name:"Cuneo",region:"Piemonte"},{code:"CO",name:"Como",region:"Lombardia"},{code:"CR",name:"Cremona",region:"Lombardia"},{code:"CS",name:"Cosenza",region:"Calabria"},{code:"CT",name:"Catania",region:"Sicilia"},{code:"CZ",name:"Catanzaro",region:"Calabria"},{code:"EN",name:"Enna",region:"Sicilia"},{code:"FC",name:"Forl\xEC Cesena",region:"Emilia Romagna"},{code:"FE",name:"Ferrara",region:"Emilia Romagna"},{code:"FG",name:"Foggia",region:"Puglia"},{code:"FI",name:"Firenze",region:"Toscana"},{code:"FM",name:"Fermo",region:"Marche"},{code:"FR",name:"Frosinone",region:"Lazio"},{code:"GE",name:"Genova",region:"Liguria"},{code:"GO",name:"Gorizia",region:"Friuli Venezia Giulia"},{code:"GR",name:"Grosseto",region:"Toscana"},{code:"IM",name:"Imperia",region:"Liguria"},{code:"IS",name:"Isernia",region:"Molise"},{code:"KR",name:"Crotone",region:"Calabria"},{code:"LC",name:"Lecco",region:"Lombardia"},{code:"LE",name:"Lecce",region:"Puglia"},{code:"LI",name:"Livorno",region:"Toscana"},{code:"LO",name:"Lodi",region:"Lombardia"},{code:"LT",name:"Latina",region:"Lazio"},{code:"LU",name:"Lucca",region:"Toscana"},{code:"MB",name:"Monza e della Brianza",region:"Lombardia"},{code:"MC",name:"Macerata",region:"Marche"},{code:"ME",name:"Messina",region:"Sicilia"},{code:"MI",name:"Milano",region:"Lombardia"},{code:"MN",name:"Mantova",region:"Lombardia"},{code:"MO",name:"Modena",region:"Emilia Romagna"},{code:"MS",name:"Massa Carrara",region:"Toscana"},{code:"MT",name:"Matera",region:"Basilicata"},{code:"NA",name:"Napoli",region:"Campania"},{code:"NO",name:"Novara",region:"Piemonte"},{code:"NU",name:"Nuoro",region:"Sardegna"},{code:"OG",name:"Ogliastra",region:"Sardegna"},{code:"OR",name:"Oristano",region:"Sardegna"},{code:"OT",name:"Olbia Tempio",region:"Sardegna"},{code:"PA",name:"Palermo",region:"Sicilia"},{code:"PC",name:"Piacenza",region:"Emilia Romagna"},{code:"PD",name:"Padova",region:"Veneto"},{code:"PE",name:"Pescara",region:"Abruzzo"},{code:"PG",name:"Perugia",region:"Umbria"},{code:"PI",name:"Pisa",region:"Toscana"},{code:"PN",name:"Pordenone",region:"Friuli Venezia Giulia"},{code:"PO",name:"Prato",region:"Toscana"},{code:"PR",name:"Parma",region:"Emilia Romagna"},{code:"PT",name:"Pistoia",region:"Toscana"},{code:"PV",name:"Pavia",region:"Lombardia"},{code:"PZ",name:"Potenza",region:"Basilicata"},{code:"RA",name:"Ravenna",region:"Emilia Romagna"},{code:"RC",name:"Reggio Calabria",region:"Calabria"},{code:"RE",name:"Reggio Emilia",region:"Emilia Romagna"},{code:"RG",name:"Ragusa",region:"Sicilia"},{code:"RI",name:"Rieti",region:"Lazio"},{code:"RM",name:"Roma",region:"Lazio"},{code:"RN",name:"Rimini",region:"Emilia Romagna"},{code:"RO",name:"Rovigo",region:"Veneto"},{code:"SA",name:"Salerno",region:"Campania"},{code:"SI",name:"Siena",region:"Toscana"},{code:"SO",name:"Sondrio",region:"Lombardia"},{code:"SP",name:"La Spezia",region:"Liguria"},{code:"SR",name:"Siracusa",region:"Sicilia"},{code:"SS",name:"Sassari",region:"Sardegna"},{code:"SU",name:"Medio Campidano",region:"Sardegna"},{code:"SV",name:"Savona",region:"Liguria"},{code:"TA",name:"Taranto",region:"Puglia"},{code:"TE",name:"Teramo",region:"Abruzzo"},{code:"TN",name:"Trento",region:"Trentino-Alto Adige"},{code:"TO",name:"Torino",region:"Piemonte"},{code:"TP",name:"Trapani",region:"Sicilia"},{code:"TR",name:"Terni",region:"Umbria"},{code:"TS",name:"Trieste",region:"Friuli Venezia Giulia"},{code:"TV",name:"Treviso",region:"Veneto"},{code:"UD",name:"Udine",region:"Friuli Venezia Giulia"},{code:"VA",name:"Varese",region:"Lombardia"},{code:"VB",name:"Verbano-Cusio-Ossola",region:"Piemonte"},{code:"VC",name:"Vercelli",region:"Piemonte"},{code:"VE",name:"Venezia",region:"Veneto"},{code:"VI",name:"Vicenza",region:"Veneto"},{code:"VT",name:"Viterbo",region:"Lazio"}]}getProvinceList(){return C(this,null,function*(){return this.getFallbackProvinces()})}getComuniByProvince(e){return C(this,null,function*(){try{return[]}catch(t){return console.error("Error fetching comuni:",t),[]}})}getProvinces(){return this.getFallbackProvinces()}getRegions(){let e=this.getFallbackProvinces();return[...new Set(e.map(i=>i.region))].sort()}getProvincesByRegion(e){return this.getFallbackProvinces().filter(i=>i.region===e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};function eQ(n,e){n&1&&(g(0,"div",10)(1,"div",11),ie(2,"div",12),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}function tQ(n,e){if(n&1&&(g(0,"div",13)(1,"p"),v(2),p()()),n&2){let t=E();_(2),q(t.error)}}function nQ(n,e){if(n&1&&(g(0,"small"),v(1),p()),n&2){let t=E(3);_(),J(" Ultimo utilizzo: ",t.formatDate(t.loyaltyCard.last_used)," ")}}function iQ(n,e){if(n&1&&(g(0,"div")(1,"p",17),v(2),p(),g(3,"small"),v(4),p(),N(5,nQ,2,1,"small",9),p()),n&2){let t=E(2);_(),Oe("active",t.loyaltyCard.active),_(),J(" ",t.loyaltyCard.active?"Attiva":"Non attiva"," "),_(2),J("Presso: ",(t.loyaltyCard.salon==null?null:t.loyaltyCard.salon.ragione_sociale)||"Salone"),_(),x("ngIf",t.loyaltyCard.last_used)}}function rQ(n,e){n&1&&(g(0,"div")(1,"p",17),v(2,"Nessuna tessera"),p()())}function oQ(n,e){if(n&1&&(g(0,"small"),v(1),p()),n&2){let t=E(3);_(),J(" Presso: ",t.nextAppointment.salon.ragione_sociale," ")}}function sQ(n,e){if(n&1&&(g(0,"small"),v(1),p()),n&2){let t=E(3);_(),J(" Servizio: ",t.nextAppointment.service.name," ")}}function aQ(n,e){if(n&1&&(g(0,"div")(1,"p",17),v(2),Me(3,"date"),p(),g(4,"small"),v(5),Me(6,"date"),p(),N(7,oQ,2,1,"small",9)(8,sQ,2,1,"small",9),p()),n&2){let t=E(2);_(2),q(Te(3,4,t.nextAppointment.start_time,"dd/MM")),_(3),J("Ore: ",Te(6,7,t.nextAppointment.start_time,"HH:mm")),_(2),x("ngIf",t.nextAppointment.salon==null?null:t.nextAppointment.salon.ragione_sociale),_(),x("ngIf",t.nextAppointment.service==null?null:t.nextAppointment.service.name)}}function lQ(n,e){n&1&&(g(0,"p",17),v(1,"Nessuno"),p(),g(2,"button",25),v(3," Prenota ora "),p())}function cQ(n,e){if(n&1&&(g(0,"div")(1,"p",17),v(2),p(),g(3,"small"),v(4),p(),g(5,"small"),v(6),p()()),n&2){let t=E(2);_(2),q(t.favoriteSalon.ragione_sociale),_(2),yt("",t.favoriteSalon.comune," (",t.favoriteSalon.provincia,") "),_(2),J("Visite: ",t.favoriteSalon.visitCount)}}function dQ(n,e){n&1&&(g(0,"p",17),v(1,"Nessun salone preferito"),p(),g(2,"small"),v(3,"Prenota appuntamenti per vedere il tuo salone preferito"),p())}function uQ(n,e){if(n&1&&(g(0,"div")(1,"div",14)(2,"div",15)(3,"h3",16),v(4,"Tessera Fedelt\xE0"),p(),N(5,iQ,6,5,"div",9)(6,rQ,3,0,"div",9),p(),g(7,"div",15)(8,"h3",16),v(9,"Appuntamenti Totali"),p(),g(10,"p",17),v(11),p(),g(12,"small"),v(13),Me(14,"date"),p()(),g(15,"div",15)(16,"h3",16),v(17,"Prossimo Appuntamento"),p(),N(18,aQ,9,10,"div",18)(19,lQ,4,0,"ng-template",null,0,$t),p(),g(21,"div",15)(22,"h3",16),v(23,"Salone Preferito"),p(),N(24,cQ,7,4,"div",18)(25,dQ,4,0,"ng-template",null,1,$t),p()(),g(27,"h3",19),v(28,"Azioni Rapide"),p(),g(29,"div",20)(30,"button",21),ie(31,"i",22),v(32," I Miei Appuntamenti "),p(),g(33,"button",23),ie(34,"i",24),v(35," Cerca Saloni "),p()()()),n&2){let t=Ve(20),i=Ve(26),r=E();_(5),x("ngIf",r.loyaltyCard),_(),x("ngIf",!r.loyaltyCard),_(5),q(r.totalAppointments),_(2),J("Dal ",Te(14,8,r.firstAppointmentDate,"dd/MM/yyyy")),_(5),x("ngIf",r.nextAppointment)("ngIfElse",t),_(6),x("ngIf",r.favoriteSalon)("ngIfElse",i)}}var y0=class n{constructor(e,t,i,r,o){this.loyaltyService=e;this.appointmentService=t;this.supabaseService=i;this.profileService=r;this.utilityService=o}loading=!0;error=null;loyaltyCard=null;totalAppointments=0;nextAppointment=null;firstAppointmentDate=null;favoriteSalon=null;nearbySalons=[];userProfile=null;ngOnInit(){return C(this,null,function*(){try{yield new Promise(t=>setTimeout(t,100));let e=yield this.supabaseService.getCurrentUserId();if(this.userProfile=yield this.profileService.getMyProfile(),!e)throw new Error("Utente non autenticato");yield this.debugProvinceFormats(),yield Promise.all([this.loadLoyaltyData(e),this.loadAppointmentData(e),this.loadSalonData(e)])}catch(e){console.error("Errore caricamento dati:",e),this.error="Errore nel caricamento dei dati"}finally{this.loading=!1}})}loadLoyaltyData(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabaseService.getClient().from("clients").select("id, profile_id").eq("profile_id",e).maybeSingle();if(i){if(i.code==="PGRST116"||i.message.includes("No rows found")){console.log("Nessun cliente trovato per questo utente");return}console.error("Errore recupero cliente:",i);return}t&&(this.loyaltyCard=yield this.loyaltyService.getClientLoyaltyCard(t.id))}catch(t){console.error("Errore caricamento dati fedelt\xE0:",t)}})}loadAppointmentData(e){return C(this,null,function*(){try{let t=yield this.appointmentService.getAppointmentsByClient(e);console.log("Appuntamenti recuperati:",t),this.totalAppointments=t.length;let i=new Date,r=t.filter(o=>o.start_time&&new Date(o.start_time)>i&&o.status!=="cancelled").sort((o,s)=>new Date(o.start_time).getTime()-new Date(s.start_time).getTime());if(this.nextAppointment=r[0]||null,t.length>0){let o=[...t].sort((s,l)=>new Date(s.start_time).getTime()-new Date(l.start_time).getTime());this.firstAppointmentDate=new Date(o[0].start_time)}}catch(t){console.error("Errore caricamento appuntamenti:",t)}})}formatDateTime(e){if(!e)return"N/D";try{return new Date(e).toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("Errore formattazione data:",t,e),"N/D"}}loadSalonData(e){return C(this,null,function*(){try{let t=this.userProfile||(yield this.profileService.getMyProfile());console.log("Profilo utente:",t);let i=this.utilityService.getProvinces(),r=t?.provincia,{data:o}=yield this.supabaseService.getClient().from("profiles").select("provincia, regione, ragione_sociale").eq("role","salon").limit(10);if(console.log("Esempi di province nei saloni:",o),r&&r.length>2){let l=i.find(c=>c.name.toLowerCase()===r.toLowerCase());l&&(r=l.code,console.log("Provincia convertita in codice:",r))}let s=[];r&&s.push(r),t?.provincia&&t.provincia.length>2&&s.push(t.provincia),r&&(s.push(r.toLowerCase()),s.push(r.toUpperCase())),console.log("Patterns di ricerca:",s);for(let l of s){let{data:c,error:u}=yield this.supabaseService.getClient().from("profiles").select("*").eq("role","salon").or(`provincia.eq.${l},regione.eq.${l}`).limit(6);if(!u&&c&&c.length>0){console.log(`Trovati ${c.length} saloni con pattern: ${l}`),this.nearbySalons=c;return}}yield this.loadFallbackSalons()}catch(t){console.error("Errore caricamento dati saloni:",t),yield this.loadFallbackSalons()}try{let t=yield this.appointmentService.getAppointmentsByClient(e);if(t.length===0){console.log("Nessun appuntamento trovato per calcolare il salone preferito"),this.favoriteSalon=null;return}let i={};t.forEach(o=>{if(o.profiles){let s=o.salon_id;i[s]||(i[s]={count:0,data:o.profiles}),i[s].count++}});let r=Object.entries(i).sort((o,s)=>s[1].count-o[1].count);if(r.length>0){let o=r[0];this.favoriteSalon=ne(B({},o[1].data),{visitCount:o[1].count}),console.log("Salone preferito trovato:",this.favoriteSalon)}else this.favoriteSalon=null,console.log("Nessun salone preferito trovato")}catch(t){console.error("Errore calcolo salone preferito:",t),this.favoriteSalon=null}})}loadFallbackSalons(){return C(this,null,function*(){let{data:e,error:t}=yield this.supabaseService.getClient().from("profiles").select("*").eq("role","salon").limit(6);t||(this.nearbySalons=e||[],console.log("Caricati saloni fallback:",this.nearbySalons.length))})}formatDate(e){return e?new Date(e).toLocaleDateString("it-IT"):"N/D"}calculateDistance(e){if(!this.userProfile?.latitude||!this.userProfile?.longitude||!e.latitude||!e.longitude)return"N/D";let t=6371,i=this.deg2rad(e.latitude-this.userProfile.latitude),r=this.deg2rad(e.longitude-this.userProfile.longitude),o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(this.deg2rad(this.userProfile.latitude))*Math.cos(this.deg2rad(e.latitude))*Math.sin(r/2)*Math.sin(r/2),s=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)),l=t*s;return l<1?`${Math.round(l*1e3)} m`:`${Math.round(l*10)/10} km`}deg2rad(e){return e*(Math.PI/180)}debugProvinceFormats(){return C(this,null,function*(){try{let{data:e}=yield this.supabaseService.getClient().from("profiles").select("provincia, regione, ragione_sociale").eq("role","salon").limit(20);console.log("Formati province nei saloni:",e);let t=yield this.profileService.getMyProfile();console.log("Provincia utente:",t?.provincia),console.log("Regione utente:",t?.regione)}catch(e){console.error("Errore debug formati province:",e)}})}static \u0275fac=function(t){return new(t||n)(z(Ls),z(qn),z(ue),z(wi),z(rr))};static \u0275cmp=he({type:n,selectors:[["app-home-user"]],decls:18,vars:3,consts:[["noAppointment",""],["noFavorite",""],[1,"container"],[1,"section-title"],["routerLink","/user/home",1,"active"],["routerLink","/user/lista-barbieri"],["routerLink","/user/mappa"],["class","loading-overlay",4,"ngIf"],["class","error-message",4,"ngIf"],[4,"ngIf"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"],[1,"error-message"],[1,"kpi-cards"],[1,"kpi-card"],[1,"kpi-title"],[1,"kpi-value"],[4,"ngIf","ngIfElse"],[1,"section-subtitle"],[1,"quick-actions"],["routerLink","/user/storico-apt",1,"btn"],[1,"icon-list"],["routerLink","/user/lista-barbieri",1,"btn"],[1,"icon-search"],["routerLink","/user/nuovo-appuntamento",1,"btn","btn-primary"]],template:function(t,i){t&1&&(g(0,"div",2)(1,"h2",3),v(2,"Home"),p(),g(3,"header")(4,"nav")(5,"ul")(6,"li")(7,"a",4),v(8,"Home"),p()(),g(9,"li")(10,"a",5),v(11,"Saloni"),p()(),g(12,"li")(13,"a",6),v(14,"Mappa"),p()()()()(),N(15,eQ,5,0,"div",7)(16,tQ,3,1,"div",8)(17,uQ,36,11,"div",9),p()),t&2&&(_(15),x("ngIf",i.loading),_(),x("ngIf",i.error),_(),x("ngIf",!i.loading&&!i.error))},dependencies:[bt,sn,Se,Ne,Pi],styles:['.salons-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.5rem;margin-bottom:2rem}.salon-card[_ngcontent-%COMP%]{padding:1.5rem;transition:transform .3s ease}.salon-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.salon-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1rem;gap:1rem}.salon-logo[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:8px;object-fit:cover}.salon-info[_ngcontent-%COMP%]{margin-top:1rem}.salon-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0;display:flex;align-items:center;gap:.5rem}.salon-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:1rem}.quick-actions[_ngcontent-%COMP%]{display:flex;gap:var(--padding-v);flex-wrap:wrap;justify-content:center;margin-top:var(--padding-h)}.quick-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.kpi-value.active[_ngcontent-%COMP%]{color:var(--success)}.icon-location[_ngcontent-%COMP%]:before{content:"\\1f4cd"}.icon-star[_ngcontent-%COMP%]:before{content:"\\2b50"}.icon-calendar[_ngcontent-%COMP%]:before{content:"\\1f4c5"}.icon-list[_ngcontent-%COMP%]:before{content:"\\1f4cb"}.icon-search[_ngcontent-%COMP%]:before{content:"\\1f50d"}.icon-province[_ngcontent-%COMP%]:before{content:"\\1f3e2"}.icon-region[_ngcontent-%COMP%]:before{content:"\\1f5fa\\fe0f"}@media (max-width: 768px){.salons-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.quick-actions[_ngcontent-%COMP%]{flex-direction:column}.quick-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}.no-salons-message[_ngcontent-%COMP%]{text-align:center;padding:2rem;background:var(--background2);border-radius:var(--border-radius);margin-bottom:2rem}.no-salons-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1rem;color:var(--text-light)}.debug-info[_ngcontent-%COMP%]{text-align:center;margin-bottom:1rem;color:var(--text-light);opacity:.7}header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:var(--padding-v);border-bottom:1px solid var(--secondary);margin:0 0 var(--padding-h) 0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;list-style:none;gap:var(--padding-v);padding:var(--padding-v) 0;margin:0}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--text-light);text-decoration:none;transition:color .3s;padding:var(--padding-v);border-radius:var(--border-radius)}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:var(--primary);background:color-mix(in srgb,var(--primary) 20%,transparent)}']})};var _o=class n{constructor(e){this.supabase=e}getAdminById(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabase.getClient().from("profiles").select("*").eq("id",e).single();if(i)throw i;let{data:r,error:o}=yield this.supabase.getClient().from("services").select("*").eq("owner_id",e).eq("active",!0);return o&&console.warn("Errore recupero servizi admin:",o),ne(B({},t),{services:r||[]})}catch(t){throw t}})}getAdmins(){return C(this,arguments,function*(e={}){try{let t=this.supabase.getClient().from("profiles").select("*",{count:"exact"}).eq("role","admin");if(e.search&&(t=t.ilike("ragione_sociale",`%${e.search}%`)),e.region&&(t=t.eq("regione",e.region)),e.province&&(t=t.eq("provincia",e.province)),e.comune&&(t=t.ilike("comune",`%${e.comune}%`)),e.limit){let l=e.offset||0;t=t.range(l,l+e.limit-1)}let{data:i,error:r,count:o}=yield t;if(r)throw r;return{data:yield Promise.all((i||[]).map(l=>C(this,null,function*(){let{data:c}=yield this.supabase.getClient().from("opening_hours").select("*").eq("salon_id",l.id);return ne(B({},l),{opening_hours:c||[]})}))),count:o||0}}catch(t){return console.error("Errore nel recupero degli admin:",t),{data:[],count:0}}})}getDistinctProvinces(){return C(this,null,function*(){try{let{data:e,error:t}=yield this.supabase.getClient().from("profiles").select("provincia").neq("provincia","").not("provincia","is",null).order("provincia",{ascending:!0});return t?(console.warn("Errore getDistinctProvinces:",t),[]):Array.from(new Set((e||[]).map(r=>r.provincia).filter(Boolean))).sort()}catch(e){return console.error("Errore critico getDistinctProvinces:",e),[]}})}static \u0275fac=function(t){return new(t||n)(te(ue))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};function fQ(n,e){n&1&&(g(0,"div",29)(1,"div",30),ie(2,"div",31),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}function pQ(n,e){if(n&1&&(g(0,"option",32),v(1),p()),n&2){let t=e.$implicit;x("value",t),_(),q(t)}}function hQ(n,e){if(n&1&&(g(0,"option",32),v(1),p()),n&2){let t=e.$implicit;x("value",t.code),_(),yt(" ",t.name," (",t.code,") ")}}function gQ(n,e){n&1&&(g(0,"div",33)(1,"p"),v(2,"Nessun risultato per i filtri selezionati."),p()())}function mQ(n,e){if(n&1&&(g(0,"div",40)(1,"a",46),v(2),p()()),n&2){let t=E().$implicit;_(),x("href",t.sito_web,kt),_(),q(t.sito_web)}}function vQ(n,e){if(n&1){let t=ee();g(0,"tr")(1,"td",37),ie(2,"img",38),p(),g(3,"td")(4,"div")(5,"strong"),v(6),p()(),N(7,mQ,3,2,"div",39),p(),g(8,"td")(9,"div"),v(10),p(),g(11,"div",40)(12,"a",41),v(13),p()()(),g(14,"td")(15,"div"),v(16),p()(),g(17,"td",42)(18,"div",43)(19,"button",44),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.viewProfile(r.id))}),v(20,"Visualizza"),p(),g(21,"button",45),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.book(r.id))}),v(22,"Prenota"),p()()()()}if(n&2){let t=e.$implicit;_(2),x("alt",ha("Logo ",t.ragione_sociale))("src",t.logo_url||"/assets/default-salon.png",kt),_(4),q(t.ragione_sociale),_(),x("ngIf",t.sito_web),_(3),q(t.telefono||"\u2014"),_(2),x("href","mailto:"+t.email,kt),_(),q(t.email),_(3),q(t.indirizzo)}}function _Q(n,e){if(n&1&&(g(0,"div",34)(1,"table",35)(2,"thead")(3,"tr")(4,"th"),v(5,"Logo"),p(),g(6,"th"),v(7,"Salone"),p(),g(8,"th"),v(9,"Contatti"),p(),g(10,"th"),v(11,"Indirizzo"),p(),g(12,"th"),v(13,"Azioni"),p()()(),g(14,"tbody"),N(15,vQ,23,9,"tr",36),p()()()),n&2){let t=E();_(15),x("ngForOf",t.admins)}}var w0=class n{constructor(e,t,i,r){this.adminService=e;this.profileService=t;this.router=i;this.utility=r}searchTerm="";selectedRegion="";selectedProvince="";selectedComune="";allProvinces=[];regions=[];filteredProvinces=[];provinceList=[];comuniList=[];admins=[];loading=!1;signingOut=!1;page=1;perPage=12;total=0;openNow=!1;filterTime=null;filteredAdmins=[];search$=new _e;destroy$=new _e;ngOnInit(){return C(this,null,function*(){this.setupSearchListener(),yield this.loadProvincesAndDefaults();let e=new Date;this.filterTime=e.toTimeString().slice(0,5),yield this.fetchAdmins()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setupSearchListener(){this.search$.pipe(Nd(400),jl(),Kn(this.destroy$)).subscribe(()=>{this.page=1,this.fetchAdmins()})}onSearchInput(e){this.searchTerm=e,this.search$.next(e)}loadProvincesAndDefaults(){return C(this,null,function*(){try{let e=yield this.utility.getProvinceList();this.allProvinces=Array.isArray(e)?e:[],this.regions=Array.from(new Set(this.allProvinces.map(i=>i.region).filter(Boolean))).sort();let t=yield this.profileService.getMyProfile();if(t){if(t.provincia){let i=String(t.provincia).trim().toUpperCase(),r=this.findProvinceByCode(i);r||(r=this.allProvinces.find(o=>String(o.name).toLowerCase()===String(t.provincia).toLowerCase())),r&&(this.selectedProvince=r.code,this.selectedRegion=r.region)}!this.selectedRegion&&t.regione&&(this.selectedRegion=String(t.regione).trim())}if(this.filterProvinces(),this.selectedProvince)try{this.comuniList=yield this.utility.getComuniByProvince(this.selectedProvince)}catch(i){console.warn("Errore caricamento comuni for default province",i),this.comuniList=[]}}catch(e){console.warn("Errore caricamento provinces/defaults",e),this.allProvinces=[],this.regions=[],this.filteredProvinces=[]}})}findProvinceByCode(e){if(e)return this.allProvinces.find(t=>String(t.code??"").toUpperCase()===e)}filterProvinces(){if(!this.selectedRegion){this.filteredProvinces=[];return}this.filteredProvinces=this.allProvinces.filter(e=>e.region===this.selectedRegion),this.selectedProvince&&(this.filteredProvinces.some(t=>t.code===this.selectedProvince)||(this.selectedProvince=""))}onRegionChange(){this.selectedProvince="",this.selectedComune="",this.comuniList=[],this.filterProvinces(),this.page=1,this.fetchAdmins()}onProvinceChange(){return C(this,null,function*(){if(this.selectedComune="",this.comuniList=[],!this.selectedProvince){this.page=1,this.fetchAdmins();return}try{this.comuniList=yield this.utility.getComuniByProvince(this.selectedProvince.trim())}catch(e){console.warn("Errore caricamento comuni",e),this.comuniList=[]}finally{this.page=1,this.fetchAdmins()}})}onComuneChange(){this.page=1,this.fetchAdmins()}fetchAdmins(){return C(this,null,function*(){this.loading=!0;try{let t=(yield this.adminService.getAdmins({search:this.searchTerm,region:this.selectedRegion||void 0,province:this.selectedProvince||void 0,comune:this.selectedComune||void 0,limit:1e3,offset:0})).data||[];t.forEach(r=>{this.normalizeOpeningHours(r)}),this.openNow&&(t=t.filter(r=>this.isOpenNow(r)));let i=(this.page-1)*this.perPage;this.admins=t.slice(i,i+this.perPage),this.total=t.length}catch(e){console.error("Errore fetch admins",e),this.admins=[],this.total=0}finally{this.loading=!1}})}get maxPage(){if(this.perPage<=0)return 1;let e=Math.ceil((this.total||0)/this.perPage);return Math.max(1,e)}previousPage(){this.page>1&&(this.page--,this.fetchAdmins(),window.scrollTo({top:0,behavior:"smooth"}))}nextPage(){this.page<this.maxPage&&(this.page++,this.fetchAdmins(),window.scrollTo({top:0,behavior:"smooth"}))}viewProfile(e){this.router.navigate(["/user/salone",e])}book(e){this.router.navigate(["/user/nuovo-appuntamento",e])}formatPhoneNumber(e){return e?e.replace(/(\d{2})(\d{4})(\d{4})/,"$1 $2 $3"):"\u2014"}truncate(e,t=25,i="..."){return e?e.length>t?e.substring(0,t)+i:e:""}onOpenNowChange(){this.page=1,this.fetchAdmins()}coerceDayIndex(e){if(e==null)return null;let t=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(t)?null:t>=1&&t<=7?t:t>=0&&t<=6?t===0?7:t:null}asIntervals(e){if(!e)return[];if(typeof e=="string")try{e=JSON.parse(e)}catch{return[]}return Array.isArray(e)?e.map(t=>({start:t.start||"00:00",end:t.end||"00:00"})):[]}normalizeOpeningHours(e){if(!e)return;let t=e.opening_hours;if(!t){e.opening_hours=[];return}if(Array.isArray(t)){e.opening_hours=t.map(i=>ne(B({},i),{day_index:this.coerceDayIndex(i?.day_index),intervals:this.asIntervals(i?.intervals)}));return}if(typeof t=="string")try{t=JSON.parse(t)}catch{t=[]}e.opening_hours=(Array.isArray(t)?t:[]).map(i=>ne(B({},i),{day_index:this.coerceDayIndex(i?.day_index),intervals:this.asIntervals(i?.intervals)}))}isOpenAt(e,t){if(!e||!Array.isArray(e.opening_hours))return!1;let i=new Date,r=t?.trim()||i.toTimeString().slice(0,5),o=this.timeToMinutes(r);if(o===null)return!1;let s=i.getDay(),l=s===0?7:s,c=l===1?7:l-1,u=e.opening_hours.find(m=>m.day_index===l),f=e.opening_hours.find(m=>m.day_index===c);if(u?.intervals?.length)for(let m of u.intervals){let w=this.timeToMinutes(m.start),b=this.timeToMinutes(m.end);if(!(w===null||b===null)){if(w<=b){if(o>=w&&o<b)return!0}else if(o>=w||o<b)return!0}}if(f?.intervals?.length)for(let m of f.intervals){let w=this.timeToMinutes(m.start),b=this.timeToMinutes(m.end);if(!(w===null||b===null)&&w>b&&o<b)return!0}return!1}timeToMinutes(e){if(!e)return null;e=e.trim().toUpperCase();let t=e.split(":");if(t.length<2)return null;let i=parseInt(t[0],10),r=parseInt(t[1],10);return isNaN(i)||isNaN(r)||i<0||i>23||r<0||r>59?null:i*60+r}parseTimeToMinutes(e){if(!e)return null;let t=e.split(":");if(t.length<2)return null;let i=parseInt(t[0],10),r=parseInt(t[1],10);return isNaN(i)||isNaN(r)?null:i*60+r}isOpenNow(e){if(!e||!Array.isArray(e.opening_hours))return console.log(`Admin ${e?.ragione_sociale} non ha opening_hours`),!1;let t=new Date,i=t.getDay()===0?7:t.getDay(),r=t.toTimeString().slice(0,5);console.log(`Controllo salone: ${e.ragione_sociale}`),console.log(`Giorno corrente: ${i}, Ora: ${r}`);let o=e.opening_hours.find(c=>c.day_index===i);if(o&&o.intervals){if(console.log("Trovati intervalli per oggi:",o.intervals),o.intervals.some(u=>{let f=this.isTimeInInterval(r,u.start,u.end);return console.log(`Intervallo ${u.start}-${u.end}: ${f?"APERTO":"chiuso"}`),f}))return console.log(`\u2705 ${e.ragione_sociale} \xE8 aperto oggi`),!0}else console.log("Nessun intervallo trovato per oggi");let s=i===1?7:i-1,l=e.opening_hours.find(c=>c.day_index===s);return l&&l.intervals&&(console.log("Trovati intervalli per ieri:",l.intervals),l.intervals.some(u=>{let f=this.isTimeInInterval(r,u.start,u.end);return console.log(`Intervallo ieri ${u.start}-${u.end}: ${f?"APERTO":"chiuso"}`),f}))?(console.log(`\u2705 ${e.ragione_sociale} \xE8 aperto (intervallo overnight)`),!0):(console.log(`\u274C ${e.ragione_sociale} \xE8 chiuso`),!1)}isTimeInInterval(e,t,i){let r=this.timeToMinutes(e),o=this.timeToMinutes(t),s=this.timeToMinutes(i);return r===null||o===null||s===null?!1:o<=s?r>=o&&r<=s:r>=o||r<=s}static \u0275fac=function(t){return new(t||n)(z(_o),z(wi),z(We),z(rr))};static \u0275cmp=he({type:n,selectors:[["app-lista-barbieri"]],decls:50,vars:16,consts:[[1,"container"],["class","loading-overlay",4,"ngIf"],[1,"section-title"],[1,"card-content"],[1,"filters-bar"],[1,"search-box"],["type","search","placeholder","Cerca per salone...","aria-label","Cerca per salone",1,"input-field","search-input",3,"ngModelChange","ngModel"],[1,"search-icon"],[1,"filters-inline"],[1,"form-group","compact"],["for","regionSelect",1,"vis-label"],[1,"select-wrapper"],["id","regionSelect","aria-label","Seleziona regione",1,"select-field",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["aria-hidden","true",1,"select-icon"],["width","14","height","9","viewBox","0 0 14 9","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M1 1L7 7L13 1","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["for","provinceSelect",1,"vis-label"],["id","provinceSelect","aria-label","Seleziona provincia",1,"select-field",3,"ngModelChange","change","ngModel","disabled"],[1,"checkbox-container"],["type","checkbox",3,"ngModelChange","change","ngModel"],[1,"checkmark"],["class","no-results",4,"ngIf"],["class","table-responsive",4,"ngIf"],[2,"display","flex","justify-content","space-between","align-items","center","margin-top","1rem"],[2,"display","flex","gap","0.5rem","align-items","center"],[3,"click","disabled"],[2,"display","flex","align-items","center","padding","0 0.6rem"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"],[3,"value"],[1,"no-results"],[1,"table-responsive"],["role","table",1,"data-table"],[4,"ngFor","ngForOf"],[1,"logo-cell"],[3,"src","alt"],["style","margin-top:8px;",4,"ngIf"],[2,"margin-top","8px"],[2,"text-decoration","none","color","var(--primary)","font-weight","500",3,"href"],[1,"actions"],[1,"vertical-buttons"],[1,"btn",3,"click"],[1,"btn-primary",3,"click"],["target","_blank",1,"website-link",2,"text-decoration","none","color","var(--primary)","font-weight","500",3,"href"]],template:function(t,i){t&1&&(g(0,"div",0),N(1,fQ,5,0,"div",1),g(2,"h2",2),v(3,"Ricerca"),p(),g(4,"div",3)(5,"div",4)(6,"div",5)(7,"input",6),Z("ngModelChange",function(o){return Y(i.searchTerm,o)||(i.searchTerm=o),o}),F("ngModelChange",function(o){return i.onSearchInput(o)}),p(),g(8,"span",7),v(9," \u{1F50D} "),p()(),g(10,"div",8)(11,"div",9)(12,"label",10),v(13,"Regione"),p(),g(14,"div",11)(15,"select",12),Z("ngModelChange",function(o){return Y(i.selectedRegion,o)||(i.selectedRegion=o),o}),F("change",function(){return i.onRegionChange()}),g(16,"option",13),v(17,"Tutte le regioni"),p(),N(18,pQ,2,2,"option",14),p(),g(19,"span",15),xn(),g(20,"svg",16),ie(21,"path",17),p()()()(),Bn(),g(22,"div",9)(23,"label",18),v(24,"Provincia"),p(),g(25,"div",11)(26,"select",19),Z("ngModelChange",function(o){return Y(i.selectedProvince,o)||(i.selectedProvince=o),o}),F("change",function(){return i.onProvinceChange()}),g(27,"option",13),v(28,"Tutta la regione"),p(),N(29,hQ,2,3,"option",14),p(),g(30,"span",15),xn(),g(31,"svg",16),ie(32,"path",17),p()()()(),Bn(),g(33,"label",20)(34,"input",21),Z("ngModelChange",function(o){return Y(i.openNow,o)||(i.openNow=o),o}),F("change",function(){return i.onOpenNowChange()}),p(),ie(35,"span",22),v(36," Aperti ora "),p()()(),N(37,gQ,3,0,"div",23)(38,_Q,16,1,"div",24),g(39,"div",25)(40,"div")(41,"small"),v(42),p()(),g(43,"div",26)(44,"button",27),F("click",function(){return i.previousPage()}),v(45,"\u2190 Prev"),p(),g(46,"div",28),v(47),p(),g(48,"button",27),F("click",function(){return i.nextPage()}),v(49,"Next \u2192"),p()()()()()),t&2&&(_(),x("ngIf",i.loading),_(6),G("ngModel",i.searchTerm),_(8),G("ngModel",i.selectedRegion),_(3),x("ngForOf",i.regions),_(8),G("ngModel",i.selectedProvince),x("disabled",!i.filteredProvinces.length),_(3),x("ngForOf",i.filteredProvinces),_(5),G("ngModel",i.openNow),_(3),x("ngIf",!i.loading&&i.admins.length===0),_(),x("ngIf",i.admins.length),_(4),yt("Mostrando ",i.admins.length," di ",i.total," risultati"),_(2),x("disabled",i.page<=1),_(3),yt("",i.page," / ",i.maxPage),_(),x("disabled",i.page>=i.maxPage))},dependencies:[Se,Ze,Ne,vt,Ot,Nt,st,Dr,Dt,at,pt,bt],encapsulation:2})};var It=gy(TF()),pCe=gy(AF());function yQ(n,e){n&1&&(g(0,"div",25)(1,"p"),v(2,"\u{1F4CD} Per una localizzazione precisa, assicurati di aver attivato il GPS sul tuo dispositivo e di aver concesso i permessi di posizione al browser."),p()())}function bQ(n,e){if(n&1&&(g(0,"option",26),v(1),p()),n&2){let t=e.$implicit;x("value",t),_(),q(t)}}function wQ(n,e){if(n&1&&(g(0,"option",26),v(1),p()),n&2){let t=e.$implicit;x("value",t.code),_(),q(t.name)}}function SQ(n,e){n&1&&(g(0,"div",27)(1,"div",28),ie(2,"div",29),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}var RF=It.icon({iconUrl:"assets/marker-icon-gold.png",iconRetinaUrl:"assets/marker-icon-2x-gold.png",shadowUrl:"assets/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]}),CQ=It.icon({iconUrl:"assets/marker-icon-gold.png",iconRetinaUrl:"assets/marker-icon-2x-gold.png",shadowUrl:"assets/marker-shadow.png",iconSize:[35,51],iconAnchor:[17,51],popupAnchor:[1,-44],tooltipAnchor:[16,-38],shadowSize:[51,51]}),E0=class n{constructor(e,t,i,r){this.router=e;this.utiltiy=t;this.supabase=i;this.admin=r}map=null;markersCluster=null;destroy$=new _e;resizeObserver=null;tileLayer=null;searchTerm="";selectedRegion="";selectedProvince="";selectedComune="";openNow=!1;isMapFullscreen=!1;allProvinces=[];regions=[];filteredProvinces=[];comuniList=[];admins=[];filteredAdmins=[];loading=!0;userLocation=null;userMarker=null;watchId=null;accuracyCircle=null;search$=new _e;geocodeCache=new Map;ngOnInit(){return C(this,null,function*(){this.setupSearchListener(),yield this.loadProvincesAndDefaults(),yield this.getUserLocation(),yield this.initMap(),yield this.fetchAdmins(),this.setupResizeObserver()})}ngOnDestroy(){this.resizeObserver&&this.resizeObserver.disconnect(),this.watchId!==null&&navigator.geolocation.clearWatch(this.watchId),this.destroy$.next(),this.destroy$.complete(),this.map&&this.map.remove()}setupResizeObserver(){let e=document.getElementById("map");e&&(this.resizeObserver=new ResizeObserver(()=>{this.map&&setTimeout(()=>{this.map.invalidateSize(),this.tileLayer&&this.tileLayer.redraw()},100)}),this.resizeObserver.observe(e))}setupSearchListener(){this.search$.pipe(Nd(400),jl(),Kn(this.destroy$)).subscribe(()=>{this.applyFilters()})}onSearchInput(e){this.searchTerm=e,this.search$.next(e)}loadProvincesAndDefaults(){return C(this,null,function*(){try{let e=yield this.utiltiy.getProvinceList();this.allProvinces=Array.isArray(e)?e:[],this.regions=Array.from(new Set(this.allProvinces.map(i=>i.region).filter(Boolean))).sort();let t=yield this.supabase.getMyProfile(!0);if(t){if(t.provincia){let i=String(t.provincia).trim().toUpperCase(),r=this.findProvinceByCode(i);r||(r=this.allProvinces.find(o=>String(o.name).toLowerCase()===String(t.provincia).toLowerCase())),r&&(this.selectedProvince=r.code,this.selectedRegion=r.region)}!this.selectedRegion&&t.regione&&(this.selectedRegion=String(t.regione).trim())}if(this.filterProvinces(),this.selectedProvince)try{this.comuniList=yield this.utiltiy.getComuniByProvince(this.selectedProvince)}catch(i){console.warn("Errore caricamento comuni",i),this.comuniList=[]}}catch(e){console.warn("Errore caricamento provinces/defaults",e),this.allProvinces=[],this.regions=[],this.filteredProvinces=[]}})}findProvinceByCode(e){if(e)return this.allProvinces.find(t=>String(t.code??"").toUpperCase()===e)}filterProvinces(){if(!this.selectedRegion){this.filteredProvinces=[];return}this.filteredProvinces=this.allProvinces.filter(e=>e.region===this.selectedRegion),this.selectedProvince&&(this.filteredProvinces.some(t=>t.code===this.selectedProvince)||(this.selectedProvince=""))}onRegionChange(){return C(this,null,function*(){this.selectedProvince="",this.selectedComune="",this.comuniList=[],this.filterProvinces(),yield this.fetchAdmins()})}onProvinceChange(){return C(this,null,function*(){if(this.selectedComune="",this.comuniList=[],!this.selectedProvince){yield this.fetchAdmins();return}try{this.comuniList=yield this.utiltiy.getComuniByProvince(this.selectedProvince.trim())}catch(e){console.warn("Errore caricamento comuni",e),this.comuniList=[]}finally{if(yield this.fetchAdmins(),this.map&&this.selectedProvince){let e=yield this.getProvinceCoordinates(this.selectedProvince);e&&this.map.setView([e.lat,e.lng],10)}}})}onOpenNowChange(){return C(this,null,function*(){yield this.fetchAdmins()})}getUserLocation(){return C(this,null,function*(){return new Promise(e=>{if(!navigator.geolocation){console.warn("Geolocalizzazione non supportata dal browser"),e();return}navigator.permissions?navigator.permissions.query({name:"geolocation"}).then(t=>{if(t.state==="denied"){console.warn("Permessi di geolocalizzazione negati"),alert("Per utilizzare la geolocalizzazione precisa, abilita i permessi di posizione nel tuo browser."),e();return}this.requestAccurateLocation(e)}).catch(()=>{this.requestAccurateLocation(e)}):this.requestAccurateLocation(e)})})}requestAccurateLocation(e){let t={enableHighAccuracy:!0,timeout:3e4,maximumAge:0};navigator.geolocation.getCurrentPosition(i=>{if(console.log("Posizione ottenuta con accuratezza:",i.coords.accuracy,"metri"),i.coords.accuracy>1e3&&(console.warn("Posizione non precisa - potrebbe essere basata su IP"),confirm("La tua posizione non sembra precisa. Assicurati di aver attivato il GPS sul tuo dispositivo per una localizzazione accurata. Vuoi riprovare?"))){this.requestAccurateLocation(e);return}this.userLocation={lat:i.coords.latitude,lng:i.coords.longitude,accuracy:i.coords.accuracy},console.log("Posizione utente ottenuta:",this.userLocation),e()},i=>{switch(console.warn("Errore geolocalizzazione:",i),i.code){case i.PERMISSION_DENIED:alert("Permesso di geolocalizzazione negato. Attiva i permessi di posizione nel tuo browser per utilizzare questa funzione.");break;case i.POSITION_UNAVAILABLE:alert("Impossibile ottenere la posizione. Assicurati che il GPS sia attivato sul tuo dispositivo.");break;case i.TIMEOUT:alert("Tempo scaduto per ottenere la posizione. Riprova in un area con migliore copertura GPS.");break}e()},t)}initMap(){return C(this,null,function*(){let e=document.getElementById("map");if(!e){console.error("Elemento mappa non trovato nel DOM"),setTimeout(()=>this.initMap(),500);return}if(e.offsetWidth===0||e.offsetHeight===0){setTimeout(()=>this.initMap(),500);return}let t={lat:41.9028,lng:12.4964};if(this.selectedProvince){let r=yield this.getProvinceCoordinates(this.selectedProvince);r&&typeof r.lat=="number"&&typeof r.lng=="number"&&(t=r)}else this.userLocation&&typeof this.userLocation.lat=="number"&&typeof this.userLocation.lng=="number"&&(t=this.userLocation);this.map=It.map("map",{center:[t.lat,t.lng],zoom:10,zoomControl:!1,preferCanvas:!0});let i=this;this.tileLayer=It.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19,subdomains:["a","b","c"],detectRetina:!1,crossOrigin:!0,updateWhenIdle:!0,updateInterval:150}).addTo(this.map),this.tileLayer.on("tileerror",r=>{console.warn("Errore nel caricamento del tile:",r)}),setTimeout(()=>{this.map&&this.map.invalidateSize()},300),setTimeout(()=>{if(!this.map)return;this.markersCluster=It.markerClusterGroup({chunkedLoading:!0,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,maxClusterRadius:50,disableClusteringAtZoom:16}),this.map.addLayer(this.markersCluster),It.control.zoom({position:"topright"}).addTo(this.map);let r=It.Control.extend({onAdd:s=>{let l=It.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom locate-control"),c=It.DomUtil.create("button","",l);c.innerHTML="\u{1F4CD}",c.title="Attiva geolocalizzazione in tempo reale";let u=!1;return c.addEventListener("click",()=>C(this,null,function*(){if(!i.map){console.error("Mappa non disponibile");return}if(u){i.watchId!==null&&(navigator.geolocation.clearWatch(i.watchId),i.watchId=null),i.accuracyCircle&&i.map&&(i.map.removeLayer(i.accuracyCircle),i.accuracyCircle=null),i.userMarker&&i.map&&(i.map.removeLayer(i.userMarker),i.userMarker=null),c.innerHTML="\u{1F4CD}",c.title="Attiva geolocalizzazione in tempo reale",u=!1;return}c.innerHTML="\u{1F504}",c.title="Disattiva geolocalizzazione",u=!0,i.userMarker&&i.map&&(i.map.removeLayer(i.userMarker),i.userMarker=null),i.accuracyCircle&&i.map&&(i.map.removeLayer(i.accuracyCircle),i.accuracyCircle=null);try{if(navigator.permissions&&(yield navigator.permissions.query({name:"geolocation"})).state==="denied"){alert("Permessi di geolocalizzazione negati. Attivali nelle impostazioni del browser."),c.innerHTML="\u{1F4CD}",c.title="Attiva geolocalizzazione in tempo reale",u=!1;return}}catch(f){console.warn("Errore verifica permessi:",f)}i.watchId=navigator.geolocation.watchPosition(f=>{if(!i.map){console.error("Mappa non disponibile durante l'aggiornamento della posizione");return}console.log("Posizione aggiornata con accuratezza:",f.coords.accuracy,"metri");let m={lat:f.coords.latitude,lng:f.coords.longitude,accuracy:f.coords.accuracy};i.userLocation=m,i.map.setView([m.lat,m.lng],15),i.userMarker&&i.map.removeLayer(i.userMarker),i.accuracyCircle&&i.map.removeLayer(i.accuracyCircle),i.userMarker=It.marker([m.lat,m.lng],{icon:It.divIcon({html:'<div style="background-color: var(--background2); width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 10px rgba(0,0,0,0.5);"></div>',className:"user-location-marker",iconSize:[16,16],iconAnchor:[8,8]}),zIndexOffset:1e3}).addTo(i.map),i.accuracyCircle=It.circle([m.lat,m.lng],{radius:m.accuracy,color:"#4285F4",fillColor:"#4285F4",fillOpacity:.2,weight:1}).addTo(i.map)},f=>{switch(console.warn("Errore geolocalizzazione continua:",f),c.innerHTML="\u{1F4CD}",c.title="Attiva geolocalizzazione in tempo reale",u=!1,f.code){case f.PERMISSION_DENIED:alert("Permesso di geolocalizzazione negato durante il tracking.");break;case f.POSITION_UNAVAILABLE:alert("Impossibile mantenere il tracking della posizione.");break;case f.TIMEOUT:alert("Timeout nel tracking della posizione.");break}},{enableHighAccuracy:!0,timeout:3e4,maximumAge:0})})),l}}),o=It.Control.extend({onAdd:s=>{let l=It.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom province-control"),c=It.DomUtil.create("button","",l);return c.innerHTML="\u{1F5FA}\uFE0F",c.title="Centra sulla provincia",c.addEventListener("click",()=>C(this,null,function*(){if(i.map)if(i.selectedProvince){let u=yield i.getProvinceCoordinates(i.selectedProvince);u&&i.map.setView([u.lat,u.lng],10)}else alert("Nessuna provincia selezionata. Seleziona una provincia dai filtri.")})),l}});new o({position:"topright"}).addTo(this.map),new r({position:"topright"}).addTo(this.map),this.updateMapMarkers()},500)})}getProvinceCoordinates(e){return C(this,null,function*(){try{let t=this.allProvinces.find(u=>u.code===e);if(!t)return null;let i=`province_${e}`,r=this.geocodeCache.get(i);if(r)return r;let o=`${t.name}, Italia`,s=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(o)}`,l=yield fetch(s,{headers:{"User-Agent":"BarbieriApp/1.0"}});if(!l.ok)return null;let c=yield l.json();if(c&&c.length>0&&c[0].lat&&c[0].lon){let u={lat:parseFloat(c[0].lat),lng:parseFloat(c[0].lon)};return this.geocodeCache.set(i,u),u}}catch(t){console.warn("Errore durante la geocodifica della provincia:",t)}return null})}fetchAdmins(){return C(this,null,function*(){this.loading=!0;try{let t=(yield this.admin.getAdmins({search:this.searchTerm,region:this.selectedRegion||void 0,province:this.selectedProvince||void 0,comune:this.selectedComune||void 0,limit:1e3,offset:0})).data||[];t.forEach(i=>{this.normalizeOpeningHours(i)}),this.openNow&&(t=t.filter(i=>this.isOpenNow(i))),this.admins=t,this.applyFilters()}catch(e){console.error("Errore fetch admins",e),this.admins=[]}finally{this.loading=!1}})}applyFilters(){this.filteredAdmins=this.admins.filter(e=>!this.searchTerm||e.ragione_sociale?.toLowerCase().includes(this.searchTerm.toLowerCase())||e.indirizzo?.toLowerCase().includes(this.searchTerm.toLowerCase())||e.provincia?.toLowerCase().includes(this.searchTerm.toLowerCase())),this.updateMapMarkers()}updateMapMarkers(){return C(this,null,function*(){if(!this.map||!this.markersCluster)return;this.markersCluster.clearLayers();let e=5;for(let t=0;t<this.filteredAdmins.length;t+=e){let i=this.filteredAdmins.slice(t,t+e);yield Promise.all(i.map(r=>this.addAdminMarker(r))),t+e<this.filteredAdmins.length&&(yield new Promise(r=>setTimeout(r,100)))}this.filteredAdmins.length===0&&this.userLocation&&this.map&&this.map.setView([this.userLocation.lat,this.userLocation.lng],13)})}addAdminMarker(e){return C(this,null,function*(){try{let t=null;if(e.lat&&e.lng?t={lat:e.lat,lng:e.lng}:t=yield this.geocodeAddress(e.indirizzo,e.provincia),t&&this.markersCluster){let i=It.marker([t.lat,t.lng],{icon:RF}),r=`
  <div class="salone-popup">
    <h3>${e.ragione_sociale||"Salone"}</h3>
    <p>${e.indirizzo||""}</p>
    <p>${e.telefono?`Tel: ${e.telefono}`:""}</p>
    <div class="popup-actions">
      <button class="btn" onclick="window.location.href='/user/salone/${e.id}'">Vedi profilo</button>
      <button class="btn-primary" onclick="window.location.href='/user/nuovo-appuntamento/${e.id}'">Prenota</button>
    </div>
  </div>
`;i.bindPopup(r),i.on("mouseover",()=>{i.setIcon(CQ)}),i.on("mouseout",()=>{i.setIcon(RF)}),this.markersCluster.addLayer(i)}}catch(t){console.warn(`Impossibile aggiungere marker per ${e.ragione_sociale}:`,t)}})}geocodeAddress(e,t){return C(this,null,function*(){if(!e)return null;let i=`${e}, ${t}`,r=this.geocodeCache.get(i);if(r)return r;try{yield new Promise(u=>setTimeout(u,100));let o=`${e}, ${t}, Italia`,s=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(o)}`,l=yield fetch(s,{headers:{"User-Agent":"BarbieriApp/1.0 (info@barbieriapp.it)"}});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);let c=yield l.json();if(c&&c.length>0&&c[0].lat&&c[0].lon){let u={lat:parseFloat(c[0].lat),lng:parseFloat(c[0].lon)};return this.geocodeCache.set(i,u),u}}catch(o){console.warn("Errore durante la geocodifica:",o)}return null})}isOpenNow(e){if(!e||!Array.isArray(e.opening_hours))return console.log(`Admin ${e?.ragione_sociale} non ha opening_hours`),!1;let t=new Date,i=t.getDay()===0?7:t.getDay(),r=t.toTimeString().slice(0,5);console.log(`Controllo salone: ${e.ragione_sociale}`),console.log(`Giorno corrente: ${i}, Ora: ${r}`);let o=e.opening_hours.find(c=>c.day_index===i);if(o&&o.intervals){if(console.log("Trovati intervalli per oggi:",o.intervals),o.intervals.some(u=>{let f=this.isTimeInInterval(r,u.start,u.end);return console.log(`Intervallo ${u.start}-${u.end}: ${f?"APERTO":"chiuso"}`),f}))return console.log(`\u2705 ${e.ragione_sociale} \xE8 aperto oggi`),!0}else console.log("Nessun intervallo trovato per oggi");let s=i===1?7:i-1,l=e.opening_hours.find(c=>c.day_index===s);return l&&l.intervals&&(console.log("Trovati intervalli per ieri:",l.intervals),l.intervals.some(u=>{let f=this.isTimeInInterval(r,u.start,u.end);return console.log(`Intervallo ieri ${u.start}-${u.end}: ${f?"APERTO":"chiuso"}`),f}))?(console.log(`\u2705 ${e.ragione_sociale} \xE8 aperto (intervallo overnight)`),!0):(console.log(`\u274C ${e.ragione_sociale} \xE8 chiuso`),!1)}timeToMinutes(e){if(!e)return null;e=e.trim().toUpperCase();let t=e.split(":");if(t.length<2)return null;let i=parseInt(t[0],10),r=parseInt(t[1],10);return isNaN(i)||isNaN(r)||i<0||i>23||r<0||r>59?null:i*60+r}viewProfile(e){this.router.navigate(["/user/salone",e])}book(e){this.router.navigate(["/user/nuovo-appuntamento",e])}refreshMap(){this.map&&(this.map.invalidateSize(),this.tileLayer&&this.tileLayer.redraw())}toggleMapFullscreen(){this.isMapFullscreen=!this.isMapFullscreen,setTimeout(()=>{this.refreshMap()},300)}handleKeyboardEvent(e){e.key==="Escape"&&this.isMapFullscreen&&(this.isMapFullscreen=!1,this.refreshMap())}coerceDayIndex(e){if(e==null)return null;let t=typeof e=="string"?parseInt(e,10):Number(e);return Number.isNaN(t)?null:t>=1&&t<=7?t:t>=0&&t<=6?t===0?7:t:null}asIntervals(e){if(!e)return[];if(typeof e=="string")try{e=JSON.parse(e)}catch{return[]}return Array.isArray(e)?e.map(t=>({start:t.start||"00:00",end:t.end||"00:00"})):[]}normalizeOpeningHours(e){if(!e)return;let t=e.opening_hours;if(!t){e.opening_hours=[];return}if(Array.isArray(t)){e.opening_hours=t.map(i=>ne(B({},i),{day_index:this.coerceDayIndex(i?.day_index),intervals:this.asIntervals(i?.intervals)}));return}if(typeof t=="string")try{t=JSON.parse(t)}catch{t=[]}e.opening_hours=(Array.isArray(t)?t:[]).map(i=>ne(B({},i),{day_index:this.coerceDayIndex(i?.day_index),intervals:this.asIntervals(i?.intervals)}))}isTimeInInterval(e,t,i){let r=this.timeToMinutes(e),o=this.timeToMinutes(t),s=this.timeToMinutes(i);return r===null||o===null||s===null?!1:o<=s?r>=o&&r<=s:r>=o||r<=s}static \u0275fac=function(t){return new(t||n)(z(We),z(rr),z(ue),z(_o))};static \u0275cmp=he({type:n,selectors:[["app-mappa"]],hostBindings:function(t,i){t&1&&F("keydown",function(o){return i.handleKeyboardEvent(o)},jw)},decls:39,vars:12,consts:[[1,"container"],[1,"section-title"],["class","info-banner",4,"ngIf"],[1,"filters-container"],[1,"search-box"],[1,"filters-inline"],[1,"form-group","compact"],["for","regionSelect",1,"vis-label"],[1,"select-wrapper"],["id","regionSelect","aria-label","Seleziona regione",1,"select-field",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["aria-hidden","true",1,"select-icon"],["width","14","height","9","viewBox","0 0 14 9","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M1 1L7 7L13 1","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["for","provinceSelect",1,"vis-label"],["id","provinceSelect","aria-label","Seleziona provincia",1,"select-field",3,"ngModelChange","change","ngModel","disabled"],[1,"checkbox-container"],["type","checkbox",3,"ngModelChange","change","ngModel"],[1,"checkmark"],[1,"map-wrapper"],["id","map",1,"map"],[1,"fullscreen-toggle",3,"click","title"],[1,"fullscreen-icon"],["class","loading-overlay",4,"ngIf"],[1,"info-banner"],[3,"value"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"]],template:function(t,i){t&1&&(g(0,"div",0)(1,"h2",1),v(2,"Mappa"),p(),N(3,yQ,3,0,"div",2),g(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),v(9,"Regione"),p(),g(10,"div",8)(11,"select",9),Z("ngModelChange",function(o){return Y(i.selectedRegion,o)||(i.selectedRegion=o),o}),F("change",function(){return i.onRegionChange()}),g(12,"option",10),v(13,"Tutte le regioni"),p(),N(14,bQ,2,2,"option",11),p(),g(15,"span",12),xn(),g(16,"svg",13),ie(17,"path",14),p()()()(),Bn(),g(18,"div",6)(19,"label",15),v(20,"Provincia"),p(),g(21,"div",8)(22,"select",16),Z("ngModelChange",function(o){return Y(i.selectedProvince,o)||(i.selectedProvince=o),o}),F("change",function(){return i.onProvinceChange()}),g(23,"option",10),v(24,"Tutte le province"),p(),N(25,wQ,2,2,"option",11),p(),g(26,"span",12),xn(),g(27,"svg",13),ie(28,"path",14),p()()()(),Bn(),g(29,"label",17)(30,"input",18),Z("ngModelChange",function(o){return Y(i.openNow,o)||(i.openNow=o),o}),F("change",function(){return i.onOpenNowChange()}),p(),ie(31,"span",19),v(32," Aperti ora "),p()()(),g(33,"div",20),ie(34,"div",21),g(35,"button",22),F("click",function(){return i.toggleMapFullscreen()}),g(36,"span",23),v(37),p()(),N(38,SQ,5,0,"div",24),p()()()),t&2&&(_(3),x("ngIf",!i.userLocation),_(8),G("ngModel",i.selectedRegion),_(3),x("ngForOf",i.regions),_(8),G("ngModel",i.selectedProvince),x("disabled",!i.filteredProvinces.length),_(3),x("ngForOf",i.filteredProvinces),_(5),G("ngModel",i.openNow),_(3),Oe("fullscreen",i.isMapFullscreen),_(2),x("title",i.isMapFullscreen?"Esci da schermo intero":"Attiva schermo intero"),_(2),q(i.isMapFullscreen?"\u2715":"\u26F6"),_(),x("ngIf",i.loading))},dependencies:[Se,Ze,Ne,vt,Ot,Nt,Dr,Dt,at,pt,bt,cC],styles:['.filters-container[_ngcontent-%COMP%]{background-color:var(--background2);padding:1rem;border-bottom:1px solid rgba(255,255,255,.1);z-index:1000;flex-shrink:0;display:flex;flex-wrap:wrap;gap:1rem;align-items:center}.fullscreen-toggle[_ngcontent-%COMP%]{position:absolute;bottom:20px;right:20px;z-index:1000;padding:var(--padding-v);border-radius:50%;border:1px solid color-mix(in srgb,var(--primary) 40%,transparent);background-color:var(--background);color:var(--primary);cursor:pointer;font-size:var(--font-size-xl);display:flex;align-items:center;justify-content:center;width:50px;height:50px;box-shadow:0 2px 5px color-mix(in srgb,var(--background2) 40%,transparent)}.fullscreen-toggle[_ngcontent-%COMP%]:hover{background-color:var(--primary);color:var(--background)}.filter-row[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap;align-items:center;flex:2}.filter-row[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.75rem 1rem;border-radius:var(--border-radius);border:1px solid rgba(255,255,255,.2);background-color:var(--background);color:var(--text-light);font-size:var(--font-size-base);min-width:0;max-width:fit-content;flex:1}.checkbox-container[_ngcontent-%COMP%]{display:inline-block;position:relative;padding-left:30px;cursor:pointer;-webkit-user-select:none;user-select:none}.checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.checkbox-container[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{position:absolute;left:0;top:0;height:20px;width:20px;background-color:var(--background);border:2px solid var(--text-light);border-radius:4px;transition:background-color .2s,border-color .2s}.checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .checkmark[_ngcontent-%COMP%]{background-color:var(--primary);border-color:var(--primary)}.checkbox-container[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none;left:6px;top:2px;width:5px;height:10px;border:solid var(--text-light);border-width:0 2px 2px 0;transform:rotate(45deg)}.checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .checkmark[_ngcontent-%COMP%]:after{display:block}.map-wrapper[_ngcontent-%COMP%]{flex:1;position:relative;min-height:0;overflow:hidden;padding:var(--padding-v)}.map-wrapper.fullscreen[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:9999;background-color:var(--background)}.map-wrapper.fullscreen[_ngcontent-%COMP%] ~ *[_ngcontent-%COMP%]{display:none}.container.fullscreen[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:9999}#map[_ngcontent-%COMP%]{height:100%;width:100%;min-height:400px;border-radius:var(--border-radius);border:1px solid color-mix(in srgb,var(--primary) 20%,transparent)}.leaflet-container[_ngcontent-%COMP%]   .leaflet-overlay-pane[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .leaflet-container[_ngcontent-%COMP%]   .leaflet-marker-pane[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .leaflet-container[_ngcontent-%COMP%]   .leaflet-shadow-pane[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .leaflet-container[_ngcontent-%COMP%]   .leaflet-tile-pane[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;left:0;top:0}.leaflet-container[_ngcontent-%COMP%]   .leaflet-tile[_ngcontent-%COMP%]{filter:inherit}.salone-popup[_ngcontent-%COMP%]{color:var(--background);padding:.5rem}.salone-popup[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;color:var(--primary);font-size:1.1rem}.salone-popup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0}.popup-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.5rem}.popup-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.25rem .5rem;background-color:var(--primary);color:var(--background);border:none;border-radius:var(--border-radius);cursor:pointer;font-size:.8rem}.locate-control[_ngcontent-%COMP%]{margin:10px}.locate-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:var(--text-light);border:none;border-radius:50%;width:30px;height:30px;cursor:pointer;box-shadow:0 1px 5px #000000a6}.refresh-control[_ngcontent-%COMP%]{margin:50px 10px 10px}.refresh-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:var(--text-light);border:none;border-radius:50%;width:30px;height:30px;cursor:pointer;box-shadow:0 1px 5px #000000a6}@media (max-width: 768px){.filter-row[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.filter-row[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:unset;width:100%}.filters-container[_ngcontent-%COMP%]{padding:.5rem}.mappa-container[_ngcontent-%COMP%]{height:100%;width:100%}}.leaflet-interactive.accuracy-circle[_ngcontent-%COMP%]{stroke-dasharray:5,5;animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{opacity:.7}50%{opacity:.3}to{opacity:.7}}.user-location-marker[_ngcontent-%COMP%]{background:transparent!important;border:none!important}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1);opacity:1}50%{transform:scale(1.2);opacity:.7}to{transform:scale(1);opacity:1}}.user-location-marker[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}.accuracy-circle[_ngcontent-%COMP%]{stroke-dasharray:5,5;animation:_ngcontent-%COMP%_dash 10s linear infinite}@keyframes _ngcontent-%COMP%_dash{to{stroke-dashoffset:100}}.info-banner[_ngcontent-%COMP%]{background-color:color-mix(in srgb,var(--background2) 50%,transparent);border-left:4px solid color-mix(in srgb,var(--primary) 50%,transparent);padding:var(--padding-v);margin:var(--padding-v) 0;border-radius:var(--border-radius)}.info-banner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--text-muted);font-size:var(--font-size-base)}']})};function EQ(n,e){if(n&1){let t=ee();g(0,"tr")(1,"td"),v(2),p(),g(3,"td"),v(4),p(),g(5,"td"),v(6),Me(7,"date"),p(),g(8,"td"),v(9),Me(10,"date"),p(),g(11,"td",11)(12,"div",12)(13,"button",13),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.acceptChangeRequest(r.id))}),v(14,"Accetta"),p(),g(15,"button",14),F("click",function(){let r=A(t).$implicit,o=E(2);return R(o.rejectChangeRequest(r.id))}),v(16,"Rifiuta"),p()()()()}if(n&2){let t=e.$implicit;_(2),q((t.appointment==null||t.appointment.profiles==null?null:t.appointment.profiles.ragione_sociale)||"N/A"),_(2),q((t.appointment==null||t.appointment.services==null?null:t.appointment.services.name)||"N/A"),_(2),q(Te(7,4,t.appointment==null?null:t.appointment.start_time,"dd/MM/yyyy HH:mm")),_(3),q(Te(10,7,t.requested_start_time,"dd/MM/yyyy HH:mm"))}}function xQ(n,e){if(n&1&&(g(0,"div")(1,"h3",3),v(2,"Richieste di Modifica in Sospeso"),p(),g(3,"div",8)(4,"table",9)(5,"thead")(6,"tr")(7,"th"),v(8,"Salone"),p(),g(9,"th"),v(10,"Servizio"),p(),g(11,"th"),v(12,"Data Attuale"),p(),g(13,"th"),v(14,"Nuova Data Proposta"),p(),g(15,"th"),v(16,"Azioni"),p()()(),g(17,"tbody"),N(18,EQ,17,10,"tr",10),p()()()()),n&2){let t=E();_(18),x("ngForOf",t.changeRequests)}}function DQ(n,e){if(n&1&&(g(0,"tr")(1,"td"),v(2),p(),g(3,"td"),v(4),p(),g(5,"td"),v(6),Me(7,"date"),p(),g(8,"td"),v(9),Me(10,"date"),p(),g(11,"td")(12,"span",15),v(13),p()()()),n&2){let t=e.$implicit;_(2),q((t.profiles==null?null:t.profiles.ragione_sociale)||"N/A"),_(2),q((t.services==null?null:t.services.name)||"N/A"),_(2),q(Te(7,6,t.start_time,"dd/MM/yyyy")),_(3),q(Te(10,9,t.start_time,"HH:mm")),_(3),x("ngClass",t.status),_(),q(t.status)}}function IQ(n,e){if(n&1&&(g(0,"div",8)(1,"table",9)(2,"thead")(3,"tr")(4,"th"),v(5,"Salone"),p(),g(6,"th"),v(7,"Servizio"),p(),g(8,"th"),v(9,"Data"),p(),g(10,"th"),v(11,"Ora"),p(),g(12,"th"),v(13,"Stato"),p()()(),g(14,"tbody"),N(15,DQ,14,12,"tr",10),p()()()),n&2){let t=E();_(15),x("ngForOf",t.futureAppointments)}}function MQ(n,e){n&1&&(g(0,"div",16),v(1,` Nessun appuntamento futuro.
`),p())}function TQ(n,e){if(n&1&&(g(0,"tr")(1,"td"),v(2),p(),g(3,"td"),v(4),p(),g(5,"td"),v(6),Me(7,"date"),p(),g(8,"td"),v(9),Me(10,"date"),p(),g(11,"td")(12,"span",15),v(13),p()()()),n&2){let t=e.$implicit;_(2),q((t.profiles==null?null:t.profiles.ragione_sociale)||"N/A"),_(2),q((t.services==null?null:t.services.name)||"N/A"),_(2),q(Te(7,6,t.start_time,"dd/MM/yyyy")),_(3),q(Te(10,9,t.start_time,"HH:mm")),_(3),x("ngClass",t.status),_(),q(t.status)}}function PQ(n,e){if(n&1&&(g(0,"div",8)(1,"table",9)(2,"thead")(3,"tr")(4,"th"),v(5,"Salone"),p(),g(6,"th"),v(7,"Servizio"),p(),g(8,"th"),v(9,"Data"),p(),g(10,"th"),v(11,"Ora"),p(),g(12,"th"),v(13,"Stato"),p()()(),g(14,"tbody"),N(15,TQ,14,12,"tr",10),p()()()),n&2){let t=E();_(15),x("ngForOf",t.pastAppointments)}}function AQ(n,e){n&1&&(g(0,"div",17),v(1,` Nessun appuntamento passato.
`),p())}function RQ(n,e){n&1&&(g(0,"div",18)(1,"div",19),ie(2,"div",20),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}var x0=class n{constructor(e,t,i){this.appointmentService=e;this.supabase=t;this.changeRequestService=i}appointments=[];futureAppointments=[];pastAppointments=[];changeRequests=[];loading=!1;errorMessage="";ngOnInit(){return C(this,null,function*(){this.loading=!0;try{let e=yield this.supabase.getMyProfile(!0);if(!e?.id){this.errorMessage="Utente non autenticato",this.loading=!1;return}let t=yield this.appointmentService.getAppointmentsByClient(e.id),i=new Date;this.futureAppointments=t.filter(r=>new Date(r.start_time)>=i),this.pastAppointments=t.filter(r=>new Date(r.start_time)<i),this.changeRequests=yield this.changeRequestService.getPendingRequestsByClient(e.id)}catch(e){this.errorMessage="Errore nel caricamento dello storico",console.error(e)}finally{this.loading=!1}})}acceptChangeRequest(e){return C(this,null,function*(){try{let t=yield this.changeRequestService.getRequestById(e),i={id:t.appointment_id,start_time:t.requested_start_time,end_time:t.requested_end_time,service_id:t.requested_service_id};t.requested_notes&&(i.notes=t.requested_notes),yield this.appointmentService.updateAppointment(i),yield this.changeRequestService.updateRequestStatus(e,"accepted"),alert("Modifica accettata con successo!"),yield this.ngOnInit()}catch(t){console.error("Errore accettazione modifica:",t),this.errorMessage="Errore nell'accettazione della richiesta"}})}rejectChangeRequest(e){return C(this,null,function*(){try{yield this.changeRequestService.updateRequestStatus(e,"rejected"),this.ngOnInit()}catch{this.errorMessage="Errore nel rifiuto della richiesta"}})}loadChangeRequests(){return C(this,null,function*(){try{let e=yield this.supabase.getMyProfile(!0);if(!e?.id)return;this.changeRequests=yield this.changeRequestService.getPendingRequestsByClient(e.id),console.log("Richieste di modifica caricate:",this.changeRequests)}catch(e){console.error("Errore nel caricamento delle richieste di modifica:",e)}})}static \u0275fac=function(t){return new(t||n)(z(qn),z(ue),z(Ss))};static \u0275cmp=he({type:n,selectors:[["app-storico-apt"]],decls:13,vars:6,consts:[[1,"container"],[1,"section-title"],[4,"ngIf"],[1,"section-subtitle"],["class","table-responsive",4,"ngIf"],["class","no-data",4,"ngIf"],["class","no-results",4,"ngIf"],["class","loading-overlay",4,"ngIf"],[1,"table-responsive"],[1,"data-table"],[4,"ngFor","ngForOf"],[1,"actions"],[1,"vertical-buttons"],[1,"btn-primary",3,"click"],[1,"btn",3,"click"],[1,"status-chip",3,"ngClass"],[1,"no-data"],[1,"no-results"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"]],template:function(t,i){t&1&&(g(0,"div",0)(1,"h2",1),v(2,"Storico Appuntamenti"),p(),N(3,xQ,19,1,"div",2),g(4,"h3",3),v(5,"Appuntamenti Futuri"),p(),N(6,IQ,16,1,"div",4)(7,MQ,2,0,"div",5),g(8,"h3",3),v(9,"Appuntamenti Passati"),p(),N(10,PQ,16,1,"div",4)(11,AQ,2,0,"div",6)(12,RQ,5,0,"div",7),p()),t&2&&(_(3),x("ngIf",i.changeRequests.length>0),_(3),x("ngIf",i.futureAppointments.length>0),_(),x("ngIf",!i.loading&&i.futureAppointments.length===0),_(3),x("ngIf",i.pastAppointments.length>0),_(),x("ngIf",!i.loading&&i.pastAppointments.length===0),_(),x("ngIf",i.loading))},dependencies:[Se,va,Ze,Ne,Pi],styles:[".status-chip[_ngcontent-%COMP%]{display:inline-block;padding:.3em .8em;border-radius:16px;font-size:.85rem;font-weight:600;text-transform:capitalize}.status-chip.confirmed[_ngcontent-%COMP%]{background-color:var(--success);color:#000}.status-chip.cancelled[_ngcontent-%COMP%]{background-color:#f44336;color:#000}.status-chip.in_attesa[_ngcontent-%COMP%], .status-chip.pending[_ngcontent-%COMP%]{background-color:#ff9800}.status-chip.completato[_ngcontent-%COMP%]{background-color:#2196f3}"]})};function kQ(n,e){n&1&&(g(0,"div",11)(1,"div",12),ie(2,"div",13),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}function OQ(n,e){n&1&&(g(0,"div")(1,"p",14),v(2,"Impossibile caricare i dati del profilo"),p()())}function NQ(n,e){if(n&1&&(tt(0),g(1,"p")(2,"strong"),v(3,"Nome:"),p(),v(4),p(),g(5,"p")(6,"strong"),v(7,"Cognome:"),p(),v(8),p(),g(9,"p")(10,"strong"),v(11,"Email:"),p(),v(12),p(),g(13,"p")(14,"strong"),v(15,"Sesso:"),p(),v(16),p(),nt()),n&2){let t=E(2);_(4),J(" ",t.profile.first_name||"\u2014"),_(4),J(" ",t.profile.last_name||"\u2014"),_(4),J(" ",t.profile.email||"\u2014"),_(4),J(" ",t.profile.sesso||"\u2014")}}function LQ(n,e){if(n&1&&(tt(0),g(1,"div",28)(2,"p")(3,"strong"),v(4,"Ragione Sociale:"),p(),g(5,"span"),v(6),p()()(),g(7,"p")(8,"strong"),v(9,"Nome:"),p(),v(10),p(),g(11,"p")(12,"strong"),v(13,"Cognome:"),p(),v(14),p(),g(15,"p")(16,"strong"),v(17,"Email:"),p(),v(18),p(),g(19,"p")(20,"strong"),v(21,"P.IVA:"),p(),v(22),p(),nt()),n&2){let t=E(2);_(6),q(t.profile.ragione_sociale||"\u2014"),_(4),J(" ",t.profile.first_name||"\u2014"),_(4),J(" ",t.profile.last_name||"\u2014"),_(4),J(" ",t.profile.email||"\u2014"),_(4),J(" ",t.profile.piva||"\u2014")}}function FQ(n,e){if(n&1&&(g(0,"div",28)(1,"p")(2,"strong"),v(3,"Indirizzo:"),p(),g(4,"span"),v(5),p()()()),n&2){let t=E(2);_(5),q(t.profile.indirizzo||"\u2014")}}function zQ(n,e){if(n&1&&(g(0,"div",28)(1,"p")(2,"strong"),v(3,"Telefono:"),p(),g(4,"span"),v(5),p()()()),n&2){let t=E(2);_(5),q(t.profile.telefono||"\u2014")}}function VQ(n,e){if(n&1&&(g(0,"div",29)(1,"h3")(2,"strong"),v(3,"Descrizione Aziendale"),p()(),g(4,"div")(5,"p"),v(6),p()()()),n&2){let t=E(2);_(6),J(" ",t.profile.descrizione||"Nessuna descrizione inserita"," ")}}function jQ(n,e){if(n&1&&(g(0,"div",29)(1,"h3")(2,"strong"),v(3,"Zona di Interesse"),p()(),g(4,"div")(5,"p")(6,"strong"),v(7,"Regione:"),p(),v(8),p(),g(9,"p")(10,"strong"),v(11,"Provincia:"),p(),v(12),p()()()),n&2){let t=E(2);_(8),J(" ",t.getRegionName(t.profile.provincia)||"\u2014"),_(4),J(" ",t.getProvinceName(t.profile.provincia)||"\u2014")}}function BQ(n,e){if(n&1&&(g(0,"div",30)(1,"h3")(2,"strong"),v(3,"Impostazioni Scorte"),p()(),g(4,"div")(5,"p")(6,"strong"),v(7,"Scorte Basse:"),p(),v(8),p(),g(9,"p")(10,"strong"),v(11,"Scorte Critiche:"),p(),v(12),p()()()),n&2){let t=E(2);_(8),J(" ",t.profile.scorte_basse||5),_(4),J(" ",t.profile.scorte_critiche||2)}}function UQ(n,e){if(n&1){let t=ee();g(0,"div",31)(1,"button",32),F("click",function(){A(t);let r=E(2);return R(r.startEditSettingsSection())}),v(2,"Modifica sezione"),p()()}}function HQ(n,e){if(n&1){let t=ee();g(0,"div",35)(1,"label"),v(2,"Ragione Sociale"),p(),g(3,"input",36),Z("ngModelChange",function(r){A(t);let o=E(3);return Y(o.newRagioneSociale,r)||(o.newRagioneSociale=r),R(r)}),p()()}if(n&2){let t=E(3);_(3),G("ngModel",t.newRagioneSociale)}}function WQ(n,e){if(n&1){let t=ee();g(0,"div",39)(1,"label"),v(2,"Descrizione Aziendale"),p(),g(3,"textarea",47),Z("ngModelChange",function(r){A(t);let o=E(3);return Y(o.newDescription,r)||(o.newDescription=r),R(r)}),p()()}if(n&2){let t=E(3);_(3),G("ngModel",t.newDescription)}}function $Q(n,e){if(n&1&&(g(0,"option",48),v(1),p()),n&2){let t=e.$implicit;x("value",t),_(),q(t)}}function qQ(n,e){if(n&1&&(g(0,"option",48),v(1),p()),n&2){let t=e.$implicit;x("value",t.code),_(),q(t.name)}}function GQ(n,e){if(n&1){let t=ee();g(0,"div",39)(1,"label"),v(2,"Soglia Scorte Basse"),p(),g(3,"input",49),Z("ngModelChange",function(r){A(t);let o=E(3);return Y(o.scorteBasse,r)||(o.scorteBasse=r),R(r)}),p(),g(4,"label",50),v(5,"Soglia Scorte Critiche"),p(),g(6,"input",49),Z("ngModelChange",function(r){A(t);let o=E(3);return Y(o.scorteCritiche,r)||(o.scorteCritiche=r),R(r)}),p()()}if(n&2){let t=E(3);_(3),G("ngModel",t.scorteBasse),_(3),G("ngModel",t.scorteCritiche)}}function ZQ(n,e){if(n&1&&(g(0,"div",51),v(1),p()),n&2){let t=E(3);_(),J(" ",t.settingsSectionError," ")}}function YQ(n,e){n&1&&(g(0,"div",52),v(1," Impostazioni aggiornate con successo! "),p())}function QQ(n,e){if(n&1){let t=ee();g(0,"div",33),N(1,HQ,4,1,"div",34),g(2,"div",35)(3,"label"),v(4,"Indirizzo"),p(),g(5,"input",36),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.newAddress,r)||(o.newAddress=r),R(r)}),p()(),g(6,"div",35)(7,"label"),v(8,"Telefono"),p(),g(9,"input",37),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.newPhone,r)||(o.newPhone=r),R(r)}),p()(),N(10,WQ,4,1,"div",38),g(11,"div",39)(12,"label"),v(13,"Regione"),p(),g(14,"select",40),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.selectedRegion,r)||(o.selectedRegion=r),R(r)}),F("change",function(){A(t);let r=E(2);return R(r.filterProvinces())}),g(15,"option",41),v(16,"Seleziona regione"),p(),N(17,$Q,2,2,"option",42),p()(),g(18,"div",39)(19,"label"),v(20,"Provincia"),p(),g(21,"select",43),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.selectedProvince,r)||(o.selectedProvince=r),R(r)}),g(22,"option",41),v(23,"Seleziona provincia"),p(),N(24,qQ,2,2,"option",42),p()(),N(25,GQ,7,2,"div",38),g(26,"div",31)(27,"button",27),F("click",function(){A(t);let r=E(2);return R(r.saveSettingsSection())}),v(28),p(),g(29,"button",44),F("click",function(){A(t);let r=E(2);return R(r.cancelEditSettingsSection())}),v(30," Annulla "),p()(),N(31,ZQ,2,1,"div",45)(32,YQ,2,0,"div",46),p()}if(n&2){let t=E(2);_(),x("ngIf",t.isAdmin()),_(4),G("ngModel",t.newAddress),_(4),G("ngModel",t.newPhone),_(),x("ngIf",t.isAdmin()),_(4),G("ngModel",t.selectedRegion),_(3),x("ngForOf",t.regions),_(4),G("ngModel",t.selectedProvince),x("disabled",!t.selectedRegion),_(3),x("ngForOf",t.filteredProvinces),_(),x("ngIf",t.isAdmin()),_(2),x("disabled",t.isSavingSettingsSection),_(),J(" ",t.isSavingSettingsSection?"Salvataggio...":"Salva tutte le modifiche"," "),_(),x("disabled",t.isSavingSettingsSection),_(2),x("ngIf",t.settingsSectionError),_(),x("ngIf",t.settingsSectionSuccess)}}function KQ(n,e){if(n&1&&(tt(0),g(1,"a",74),v(2),p(),nt()),n&2){let t=E(4);_(),x("href",t.formatUrl(t.profile.socials.facebook),kt),_(),J(" ",t.profile.socials.facebook," ")}}function JQ(n,e){n&1&&(g(0,"span",75),v(1,"Non presente"),p())}function XQ(n,e){if(n&1&&(tt(0),g(1,"a",74),v(2),p(),nt()),n&2){let t=E(4);_(),x("href",t.formatUrl(t.profile.socials.instagram),kt),_(),J(" ",t.profile.socials.instagram," ")}}function eK(n,e){n&1&&(g(0,"span",75),v(1,"Non presente"),p())}function tK(n,e){if(n&1&&(tt(0),g(1,"a",74),v(2),p(),nt()),n&2){let t=E(4);_(),x("href",t.formatUrl(t.profile.socials.linkedin),kt),_(),J(" ",t.profile.socials.linkedin," ")}}function nK(n,e){n&1&&(g(0,"span",75),v(1,"Non presente"),p())}function iK(n,e){if(n&1&&(tt(0),g(1,"a",74),v(2),p(),nt()),n&2){let t=E(4);_(),x("href",t.profile.socials.whatsapp,kt),_(),J(" ",t.profile.socials.whatsapp," ")}}function rK(n,e){n&1&&(g(0,"span",75),v(1,"Non presente"),p())}function oK(n,e){if(n&1){let t=ee();g(0,"div",56)(1,"div",57),xn(),g(2,"svg",58),ie(3,"path",59),p(),Bn(),g(4,"div",60),N(5,KQ,3,2,"ng-container",61)(6,JQ,2,0,"ng-template",null,0,$t),p()(),g(8,"div",62),xn(),g(9,"svg",58)(10,"defs")(11,"linearGradient",63),ie(12,"stop",64)(13,"stop",65)(14,"stop",66)(15,"stop",67)(16,"stop",68),p()(),ie(17,"path",69),p(),Bn(),g(18,"div",60),N(19,XQ,3,2,"ng-container",61)(20,eK,2,0,"ng-template",null,1,$t),p()(),g(22,"div",70),xn(),g(23,"svg",58),ie(24,"path",71),p(),Bn(),g(25,"div",60),N(26,tK,3,2,"ng-container",61)(27,nK,2,0,"ng-template",null,2,$t),p()(),g(29,"div",72),xn(),g(30,"svg",58),ie(31,"path",73),p(),Bn(),g(32,"div",60),N(33,iK,3,2,"ng-container",61)(34,rK,2,0,"ng-template",null,3,$t),p()(),g(36,"div",31)(37,"button",32),F("click",function(){A(t);let r=E(3);return R(r.startEditSocials())}),v(38,"Modifica Social"),p()()()}if(n&2){let t=Ve(7),i=Ve(21),r=Ve(28),o=Ve(35),s=E(3);_(5),x("ngIf",s.profile.socials==null?null:s.profile.socials.facebook)("ngIfElse",t),_(14),x("ngIf",s.profile.socials==null?null:s.profile.socials.instagram)("ngIfElse",i),_(7),x("ngIf",s.profile.socials==null?null:s.profile.socials.linkedin)("ngIfElse",r),_(7),x("ngIf",s.profile.socials==null?null:s.profile.socials.whatsapp)("ngIfElse",o)}}function sK(n,e){if(n&1){let t=ee();g(0,"div",76)(1,"div",39)(2,"label"),v(3,"Facebook (URL)"),p(),g(4,"input",77),Z("ngModelChange",function(r){A(t);let o=E(3);return Y(o.editableSocials.facebook,r)||(o.editableSocials.facebook=r),R(r)}),p()(),g(5,"div",39)(6,"label"),v(7,"Instagram (URL)"),p(),g(8,"input",78),Z("ngModelChange",function(r){A(t);let o=E(3);return Y(o.editableSocials.instagram,r)||(o.editableSocials.instagram=r),R(r)}),p()(),g(9,"div",39)(10,"label"),v(11,"LinkedIn (URL)"),p(),g(12,"input",79),Z("ngModelChange",function(r){A(t);let o=E(3);return Y(o.editableSocials.linkedin,r)||(o.editableSocials.linkedin=r),R(r)}),p()(),g(13,"div",39)(14,"label"),v(15,"WhatsApp (numero o link)"),p(),g(16,"input",80),Z("ngModelChange",function(r){A(t);let o=E(3);return Y(o.editableSocials.whatsapp,r)||(o.editableSocials.whatsapp=r),R(r)}),p()(),g(17,"div",31)(18,"button",32),F("click",function(){A(t);let r=E(3);return R(r.saveSocials())}),v(19,"Salva"),p(),g(20,"button",81),F("click",function(){A(t);let r=E(3);return R(r.cancelEditSocials())}),v(21,"Annulla"),p()()()}if(n&2){let t=E(3);_(4),G("ngModel",t.editableSocials.facebook),_(4),G("ngModel",t.editableSocials.instagram),_(4),G("ngModel",t.editableSocials.linkedin),_(4),G("ngModel",t.editableSocials.whatsapp)}}function aK(n,e){if(n&1&&(g(0,"div",53)(1,"h2",17),v(2,"Social"),p(),N(3,oK,39,8,"div",54)(4,sK,22,4,"div",55),p()),n&2){let t=E(2);_(3),x("ngIf",!t.editSocials),_(),x("ngIf",t.editSocials)}}function lK(n,e){n&1&&(g(0,"div",85),v(1,"Caricamento orari..."),p())}function cK(n,e){if(n&1&&(g(0,"span",89),v(1),p()),n&2){let t=E().$implicit,i=E(6);_(),J(" ",i.formatIntervals(t.intervals)," ")}}function dK(n,e){n&1&&(g(0,"span",90),v(1,"Chiuso"),p())}function uK(n,e){if(n&1&&(g(0,"div")(1,"p")(2,"strong",87),v(3),p(),N(4,cK,2,1,"span",88)(5,dK,2,0,"ng-template",null,5,$t),p()()),n&2){let t=e.$implicit,i=Ve(6);_(3),J("",t.dayName,":"),_(),x("ngIf",t.intervals==null?null:t.intervals.length)("ngIfElse",i)}}function fK(n,e){if(n&1&&(tt(0),N(1,uK,7,3,"div",86),nt()),n&2){let t=E(5);_(),x("ngForOf",t.profile.opening_hours)}}function pK(n,e){n&1&&(g(0,"p",91),v(1,"Nessun orario presente"),p())}function hK(n,e){if(n&1){let t=ee();tt(0),N(1,fK,2,1,"ng-container",61)(2,pK,2,0,"ng-template",null,4,$t),g(4,"div",31)(5,"button",32),F("click",function(){A(t);let r=E(4);return R(r.startEditHours())}),v(6,"Modifica Orari"),p()(),nt()}if(n&2){let t=Ve(3),i=E(4);_(),x("ngIf",i.profile.opening_hours==null?null:i.profile.opening_hours.length)("ngIfElse",t)}}function gK(n,e){if(n&1&&(g(0,"div"),N(1,lK,2,0,"div",84)(2,hK,7,2,"ng-container",10),p()),n&2){let t=E(3);_(),x("ngIf",t.loading),_(),x("ngIf",!t.loading)}}function mK(n,e){n&1&&(g(0,"div")(1,"p"),v(2,"Attualmente chiuso"),p()())}function vK(n,e){if(n&1){let t=ee();g(0,"div",98)(1,"label"),v(2,"Da"),p(),g(3,"input",99),Z("ngModelChange",function(r){let o=A(t).index,s=E().$implicit;return Y(s.intervals[o].start,r)||(s.intervals[o].start=r),R(r)}),p(),g(4,"label"),v(5,"A"),p(),g(6,"input",99),Z("ngModelChange",function(r){let o=A(t).index,s=E().$implicit;return Y(s.intervals[o].end,r)||(s.intervals[o].end=r),R(r)}),p(),g(7,"button",81),F("click",function(){let r=A(t).index,o=E().index,s=E(4);return R(s.removeInterval(o,r))}),v(8,"Rimuovi"),p()()}if(n&2){let t=e.index,i=E(),r=i.$implicit,o=i.index;_(3),x("name",Jg("start-",o,"-",t)),G("ngModel",r.intervals[t].start),_(3),x("name",Jg("end-",o,"-",t)),G("ngModel",r.intervals[t].end)}}function _K(n,e){if(n&1){let t=ee();g(0,"div",94)(1,"h4"),v(2),p(),N(3,mK,3,0,"div",10)(4,vK,9,8,"div",95),g(5,"button",81),F("click",function(){let r=A(t).index,o=E(4);return R(o.addInterval(r))}),v(6,"Aggiungi intervallo"),p(),g(7,"label",96)(8,"input",97),Z("ngModelChange",function(r){let o=A(t).$implicit;return Y(o.closed,r)||(o.closed=r),R(r)}),F("change",function(){let r=A(t).index,o=E(4);return R(o.toggleClosed(r))}),p(),v(9," Chiuso "),p(),ie(10,"hr"),p()}if(n&2){let t=e.$implicit;_(2),q(t.dayName),_(),x("ngIf",t.intervals.length===0),_(),x("ngForOf",t.intervals),_(4),G("ngModel",t.closed)}}function yK(n,e){if(n&1){let t=ee();g(0,"div",92),N(1,_K,11,4,"div",93),g(2,"div",31)(3,"button",32),F("click",function(){A(t);let r=E(3);return R(r.saveHours())}),v(4,"Salva Orari"),p(),g(5,"button",81),F("click",function(){A(t);let r=E(3);return R(r.cancelEditHours())}),v(6,"Annulla"),p()()()}if(n&2){let t=E(3);_(),x("ngForOf",t.editableHours)}}function bK(n,e){if(n&1&&(g(0,"div")(1,"h2",17),v(2,"Orari"),p(),g(3,"div",56)(4,"div",82),N(5,gK,3,2,"div",10)(6,yK,7,1,"div",83),p()()()),n&2){let t=E(2);_(5),x("ngIf",!t.editHours),_(),x("ngIf",t.editHours)}}function wK(n,e){n&1&&(g(0,"div")(1,"p",110)(2,"strong"),v(3,"Nota:"),p(),v(4," I dipendenti verranno mantenuti ma non utilizzati nella modalit\xE0 semplice. "),p()())}function SK(n,e){if(n&1){let t=ee();g(0,"div",107)(1,"div",108)(2,"h3"),v(3,"Conferma cambio modalit\xE0"),p(),g(4,"p"),v(5),p(),N(6,wK,5,0,"div",10),g(7,"div",109)(8,"button",32),F("click",function(){A(t);let r=E(3);return R(r.confirmModeChange())}),v(9,"Conferma"),p(),g(10,"button",81),F("click",function(){A(t);let r=E(3);return R(r.cancelModeChange())}),v(11,"Annulla"),p()()()()}if(n&2){let t=E(3);_(5),J("Sei sicuro di voler passare alla modalit\xE0 ",t.newMode==="simple"?"semplice":"avanzata","?"),_(),x("ngIf",t.newMode==="simple"&&t.dipendenti.length>0)}}function CK(n,e){if(n&1){let t=ee();g(0,"div",111)(1,"div",39)(2,"label",112),v(3,"Numero massimo di appuntamenti in contemporanea"),p(),g(4,"input",113),Z("ngModelChange",function(r){A(t);let o=E(3);return Y(o.appointmentSettings.maxConcurrentAppointments,r)||(o.appointmentSettings.maxConcurrentAppointments=r),R(r)}),p(),g(5,"div",114),v(6,"Il numero massimo di appuntamenti che possono essere eseguiti contemporaneamente nel salone"),p()()()}if(n&2){let t=E(3);_(4),G("ngModel",t.appointmentSettings.maxConcurrentAppointments)}}function EK(n,e){if(n&1&&(g(0,"span",128),v(1),p()),n&2){let t=E().$implicit;_(),J(" \u2014 ",t.ruolo)}}function xK(n,e){n&1&&(xn(),g(0,"svg",129),ie(1,"path",130),p())}function DK(n,e){n&1&&(xn(),g(0,"svg",129),ie(1,"path",131),p())}function IK(n,e){if(n&1&&(g(0,"div")(1,"p")(2,"strong"),v(3,"Ruolo:"),p(),v(4),p(),g(5,"p")(6,"strong"),v(7,"Telefono:"),p(),v(8),p(),g(9,"p")(10,"strong"),v(11,"Email:"),p(),v(12),p(),g(13,"p")(14,"strong"),v(15,"Note:"),p(),v(16),p()()),n&2){let t=E(2).$implicit;_(4),J(" ",t.ruolo||"\u2014"),_(4),J(" ",t.telefono||"\u2014"),_(4),J(" ",t.email||"\u2014"),_(4),J(" ",t.note||"\u2014")}}function MK(n,e){if(n&1){let t=ee();g(0,"div",146)(1,"div",147)(2,"div",39)(3,"input",148),Z("ngModelChange",function(r){A(t);let o=E(7);return Y(o.editingDipendente.nome,r)||(o.editingDipendente.nome=r),R(r)}),p()(),g(4,"div",39)(5,"input",149),Z("ngModelChange",function(r){A(t);let o=E(7);return Y(o.editingDipendente.cognome,r)||(o.editingDipendente.cognome=r),R(r)}),p()()(),g(6,"div",147)(7,"div",39)(8,"input",150),Z("ngModelChange",function(r){A(t);let o=E(7);return Y(o.editingDipendente.ruolo,r)||(o.editingDipendente.ruolo=r),R(r)}),p()(),g(9,"div",39)(10,"input",151),Z("ngModelChange",function(r){A(t);let o=E(7);return Y(o.editingDipendente.telefono,r)||(o.editingDipendente.telefono=r),R(r)}),p()()(),g(11,"div",147)(12,"div",39)(13,"input",152),Z("ngModelChange",function(r){A(t);let o=E(7);return Y(o.editingDipendente.email,r)||(o.editingDipendente.email=r),R(r)}),p()()(),g(14,"div",147)(15,"div",39)(16,"textarea",153),Z("ngModelChange",function(r){A(t);let o=E(7);return Y(o.editingDipendente.note,r)||(o.editingDipendente.note=r),R(r)}),p()()()()}if(n&2){let t=E(7);_(3),G("ngModel",t.editingDipendente.nome),_(2),G("ngModel",t.editingDipendente.cognome),_(3),G("ngModel",t.editingDipendente.ruolo),_(2),G("ngModel",t.editingDipendente.telefono),_(3),G("ngModel",t.editingDipendente.email),_(3),G("ngModel",t.editingDipendente.note)}}function TK(n,e){if(n&1&&N(0,MK,17,6,"div",145),n&2){let t=E(2).$implicit,i=E(4);x("ngIf",(i.editingDipendente==null?null:i.editingDipendente.id)===t.id)}}function PK(n,e){if(n&1){let t=ee();g(0,"button",32),F("click",function(){A(t);let r=E(2).$implicit,o=E(4);return R(o.startEditDipendente(r))}),v(1," Modifica "),p()}}function AK(n,e){if(n&1){let t=ee();g(0,"button",32),F("click",function(){A(t);let r=E(6);return R(r.saveEditDipendente())}),v(1," Salva "),p()}}function RK(n,e){if(n&1){let t=ee();g(0,"button",81),F("click",function(){A(t);let r=E(6);return R(r.cancelEditDipendente())}),v(1," Annulla "),p()}}function kK(n,e){n&1&&(g(0,"div")(1,"strong"),v(2,"Full-time"),p(),g(3,"div")(4,"small"),v(5,"Presente quando il salone \xE8 aperto."),p()()())}function OK(n,e){if(n&1&&(g(0,"div"),v(1),Me(2,"date"),p()),n&2){let t=E(5).$implicit;_(),J("Fino a: ",Te(2,1,t.assente_fino,"dd/MM/yyyy")," ")}}function NK(n,e){n&1&&(g(0,"div")(1,"small"),v(2,"Assente fino a revoca"),p()())}function LK(n,e){if(n&1&&(g(0,"div")(1,"strong"),v(2,"Assente"),p(),N(3,OK,3,4,"div",10)(4,NK,3,0,"div",10),p()),n&2){let t=E(4).$implicit;_(3),x("ngIf",t.assente_fino),_(),x("ngIf",!t.assente_fino)}}function FK(n,e){n&1&&(g(0,"span",75),v(1," assente"),p())}function zK(n,e){if(n&1&&(g(0,"span"),v(1),p()),n&2){let t=E().index,i=E(5).$implicit,r=E(4);_(),J(" ",r.formatOrariLine(i,t)," ")}}function VK(n,e){if(n&1&&(g(0,"div",161)(1,"strong"),v(2),p(),N(3,FK,2,0,"span",162)(4,zK,2,1,"span",10),p()),n&2){let t=e.$implicit,i=e.index,r=E(5).$implicit,o=E(4);_(2),J("",t.label,":"),_(),x("ngIf",o.getOrariByGiorno(r,i).length===0),_(),x("ngIf",o.getOrariByGiorno(r,i).length>0)}}function jK(n,e){if(n&1&&(g(0,"div"),N(1,VK,5,3,"div",160),p()),n&2){let t=E(8);_(),x("ngForOf",t.weekDays)}}function BK(n,e){if(n&1&&N(0,LK,5,2,"div",10)(1,jK,2,1,"div",10),n&2){let t=E(3).$implicit;x("ngIf",t.assente),_(),x("ngIf",!t.assente)}}function UK(n,e){if(n&1){let t=ee();g(0,"div",154)(1,"div",155),N(2,kK,6,0,"div",61)(3,BK,2,2,"ng-template",null,7,$t),p(),g(5,"div",156)(6,"label",157)(7,"span",158),v(8,"Full-time"),p(),g(9,"input",159),F("change",function(r){A(t);let o=E(2).$implicit,s=E(4);return R(s.onFulltimeChange(o,r))}),p()(),g(10,"label",157)(11,"span",158),v(12,"Assente"),p(),g(13,"input",159),F("change",function(r){A(t);let o=E(2).$implicit,s=E(4);return R(s.onAssenteToggle(o,r))}),p()(),g(14,"div",31)(15,"button",81),F("click",function(){A(t);let r=E(2).$implicit,o=E(4);return R(o.startEditOrari(r))}),v(16,"Modifica orari"),p()()()()}if(n&2){let t=Ve(4),i=E(2).$implicit;_(2),x("ngIf",i.orari==null?null:i.orari.fulltime)("ngIfElse",t),_(7),x("checked",i.orari==null?null:i.orari.fulltime),_(4),x("checked",i.assente)}}function HK(n,e){if(n&1){let t=ee();g(0,"div",165)(1,"label"),v(2,"Fino a:"),p(),g(3,"input",171),Z("ngModelChange",function(r){A(t);let o=E(3).$implicit,s=E(4);return Y(s.orariDraft[o.id].assente_fino,r)||(s.orariDraft[o.id].assente_fino=r),R(r)}),p(),g(4,"small",172),v(5,"Lascia vuoto per assenza fino a revoca"),p()()}if(n&2){let t=E(3).$implicit,i=E(4);_(3),G("ngModel",i.orariDraft[t.id].assente_fino),x("min",i.minToday)}}function WK(n,e){n&1&&(g(0,"div",179)(1,"small"),v(2,"Giorno vuoto"),p()())}function $K(n,e){if(n&1){let t=ee();g(0,"div",98)(1,"label"),v(2,"Da"),p(),g(3,"input",180),Z("ngModelChange",function(r){let o=A(t).index,s=E().index,l=E(4).$implicit,c=E(4);return Y(c.orariDraft[l.id][s.toString()][o].start,r)||(c.orariDraft[l.id][s.toString()][o].start=r),R(r)}),p(),g(4,"label"),v(5,"A"),p(),g(6,"input",180),Z("ngModelChange",function(r){let o=A(t).index,s=E().index,l=E(4).$implicit,c=E(4);return Y(c.orariDraft[l.id][s.toString()][o].end,r)||(c.orariDraft[l.id][s.toString()][o].end=r),R(r)}),p(),g(7,"button",177),F("click",function(){let r=A(t).index,o=E().index,s=E(4).$implicit,l=E(4);return R(l.removeOrarioFromDraft(s,o,r))}),v(8,"Rimuovi"),p()()}if(n&2){let t=e.index,i=E().index,r=E(4).$implicit,o=E(4);_(3),G("ngModel",o.orariDraft[r.id][i.toString()][t].start),_(3),G("ngModel",o.orariDraft[r.id][i.toString()][t].end)}}function qK(n,e){if(n&1){let t=ee();g(0,"div",175)(1,"div",176)(2,"strong"),v(3),p(),g(4,"button",177),F("click",function(){let r=A(t).index,o=E(4).$implicit,s=E(4);return R(s.addOrarioToDraft(o,r))}),v(5,"+ Aggiungi"),p()(),N(6,WK,3,0,"div",178)(7,$K,9,2,"div",95),p()}if(n&2){let t=e.$implicit,i=e.index,r=E(4).$implicit,o=E(4);_(3),q(t.label),_(3),x("ngIf",o.getOrariByGiornoDraft(r,i).length===0),_(),x("ngForOf",o.getOrariByGiornoDraft(r,i))}}function GK(n,e){if(n&1&&(g(0,"div",173),N(1,qK,8,3,"div",174),p()),n&2){let t=E(7);_(),x("ngForOf",t.weekDays)}}function ZK(n,e){n&1&&(g(0,"span",181),v(1,"Salvataggio..."),p())}function YK(n,e){if(n&1){let t=ee();g(0,"div",163)(1,"div",164)(2,"label",165)(3,"span"),v(4,"Full-time"),p(),g(5,"input",166),Z("ngModelChange",function(r){A(t);let o=E(2).$implicit,s=E(4);return Y(s.orariDraft[o.id].fulltime,r)||(s.orariDraft[o.id].fulltime=r),R(r)}),F("ngModelChange",function(r){A(t);let o=E(2).$implicit,s=E(4);return R(s.onFulltimeChangeInDraft(o,r))}),p()(),g(6,"label",165)(7,"span"),v(8,"Assente"),p(),g(9,"input",166),Z("ngModelChange",function(r){A(t);let o=E(2).$implicit,s=E(4);return Y(s.orariDraft[o.id].assente,r)||(s.orariDraft[o.id].assente=r),R(r)}),F("ngModelChange",function(r){A(t);let o=E(2).$implicit,s=E(4);return R(s.onAssenteChangeInDraft(o,r))}),p()(),N(10,HK,6,2,"div",167),p(),N(11,GK,2,1,"div",168),g(12,"div",169)(13,"button",32),F("click",function(){A(t);let r=E(2).$implicit,o=E(4);return R(o.saveDipendenteOrari(r,!0))}),v(14,"Salva Orari"),p(),g(15,"button",81),F("click",function(){A(t);let r=E(2).$implicit,o=E(4);return R(o.cancelEditOrari(r))}),v(16,"Annulla"),p(),N(17,ZK,2,0,"span",170),p()()}if(n&2){let t=E(2).$implicit,i=E(4);_(5),G("ngModel",i.orariDraft[t.id].fulltime),_(4),G("ngModel",i.orariDraft[t.id].assente),_(),x("ngIf",i.orariDraft[t.id]==null?null:i.orariDraft[t.id].assente),_(),x("ngIf",!i.orariDraft[t.id].fulltime&&!i.orariDraft[t.id].assente),_(6),x("ngIf",t.savingOrari)}}function QK(n,e){if(n&1){let t=ee();g(0,"div",186),F("click",function(){let r=A(t).$implicit,o=E(3).$implicit,s=E(4);return R(s.toggleServizio(o,r))}),v(1),p()}if(n&2){let t=e.$implicit,i=E(3).$implicit,r=E(4);Oe("selected",t.id&&r.isServizioAssigned(i,t.id)),_(),J(" ",t.name," ")}}function KK(n,e){if(n&1&&(g(0,"div",182)(1,"h6",183),v(2),p(),g(3,"div",184),N(4,QK,2,3,"div",185),p()()),n&2){let t=e.$implicit;_(2),q(t.name),_(2),x("ngForOf",t.services)}}function JK(n,e){if(n&1){let t=ee();g(0,"div",132),N(1,IK,17,4,"div",61)(2,TK,1,1,"ng-template",null,6,$t),g(4,"div",133),N(5,PK,2,0,"button",120)(6,AK,2,0,"button",120)(7,RK,2,0,"button",134),g(8,"button",81),F("click",function(){A(t);let r=E().$implicit,o=E(4);return R(o.deleteDipendente(r))}),v(9,"Elimina"),p()(),g(10,"div",135)(11,"h3",17),v(12,"Orari di lavoro"),p(),N(13,UK,17,4,"div",136)(14,YK,18,5,"div",137),p(),g(15,"div",138)(16,"h5",17),v(17,"Servizi assegnati"),p(),g(18,"div",139)(19,"div",140)(20,"span"),v(21,"Seleziona servizi:"),p(),g(22,"button",141),F("click",function(){A(t);let r=E().$implicit,o=E(4);return R(o.toggleAllServizi(r))}),v(23),p()(),g(24,"div",142),N(25,KK,5,2,"div",143),p()(),g(26,"div",144),v(27),p()()()}if(n&2){let t=Ve(3),i=E().$implicit,r=E(4);_(),x("ngIf",(r.editingDipendente==null?null:r.editingDipendente.id)!==i.id)("ngIfElse",t),_(4),x("ngIf",(r.editingDipendente==null?null:r.editingDipendente.id)!==i.id),_(),x("ngIf",(r.editingDipendente==null?null:r.editingDipendente.id)===i.id),_(),x("ngIf",(r.editingDipendente==null?null:r.editingDipendente.id)===i.id),_(6),x("ngIf",!r.editingOrari[i.id]),_(),x("ngIf",r.editingOrari[i.id]),_(9),J(" ",r.areAllServiziSelected(i)?"Deseleziona tutti":"Seleziona tutti"," "),_(2),x("ngForOf",r.serviziHierarchy),_(2),J(" ",r.getSelectedServiziCount(i)," servizi selezionati ")}}function XK(n,e){if(n&1){let t=ee();g(0,"div",122)(1,"div",123),F("click",function(){let r=A(t).$implicit,o=E(4);return R(o.expandedDipendenti[r.id]=!o.expandedDipendenti[r.id])}),g(2,"span")(3,"strong"),v(4),p(),N(5,EK,2,1,"span",124),p(),g(6,"span",125),N(7,xK,2,0,"svg",126)(8,DK,2,0,"svg",126),p()(),N(9,JK,28,10,"div",127),p()}if(n&2){let t=e.$implicit,i=E(4);_(4),yt("",t.nome," ",t.cognome),_(),x("ngIf",t.ruolo),_(2),x("ngIf",!i.expandedDipendenti[t.id]),_(),x("ngIf",i.expandedDipendenti[t.id]),_(),x("ngIf",i.expandedDipendenti[t.id])}}function eJ(n,e){if(n&1){let t=ee();g(0,"button",32),F("click",function(){A(t);let r=E(4);return R(r.showAddDipendenteForm=!0)}),v(1," + Aggiungi nuovo dipendente "),p()}}function tJ(n,e){if(n&1){let t=ee();g(0,"div",187)(1,"h4",17),v(2,"Aggiungi nuovo dipendente"),p(),g(3,"div",147)(4,"input",188),Z("ngModelChange",function(r){A(t);let o=E(4);return Y(o.newDipendenteNome,r)||(o.newDipendenteNome=r),R(r)}),p(),g(5,"input",189),Z("ngModelChange",function(r){A(t);let o=E(4);return Y(o.newDipendenteCognome,r)||(o.newDipendenteCognome=r),R(r)}),p()(),g(6,"div",147)(7,"input",150),Z("ngModelChange",function(r){A(t);let o=E(4);return Y(o.newDipendenteRuolo,r)||(o.newDipendenteRuolo=r),R(r)}),p(),g(8,"input",151),Z("ngModelChange",function(r){A(t);let o=E(4);return Y(o.newDipendenteTelefono,r)||(o.newDipendenteTelefono=r),R(r)}),p()(),g(9,"div",147)(10,"input",152),Z("ngModelChange",function(r){A(t);let o=E(4);return Y(o.newDipendenteEmail,r)||(o.newDipendenteEmail=r),R(r)}),p()(),g(11,"div",147)(12,"textarea",153),Z("ngModelChange",function(r){A(t);let o=E(4);return Y(o.newDipendenteNote,r)||(o.newDipendenteNote=r),R(r)}),p()(),g(13,"div",31)(14,"button",27),F("click",function(){A(t);let r=E(4);return R(r.addDipendente())}),v(15," Aggiungi "),p(),g(16,"button",81),F("click",function(){A(t);let r=E(4);return R(r.cancelAddDipendente())}),v(17,"Annulla"),p()()()}if(n&2){let t=E(4);_(4),G("ngModel",t.newDipendenteNome),_(),G("ngModel",t.newDipendenteCognome),_(2),G("ngModel",t.newDipendenteRuolo),_(),G("ngModel",t.newDipendenteTelefono),_(2),G("ngModel",t.newDipendenteEmail),_(2),G("ngModel",t.newDipendenteNote),_(2),x("disabled",!t.newDipendenteNome||!t.newDipendenteCognome)}}function nJ(n,e){if(n&1&&(g(0,"div",115)(1,"h3",116),v(2,"Gestione Dipendenti"),p(),g(3,"div",117),N(4,XK,10,6,"div",118),p(),g(5,"div",119)(6,"div",31),N(7,eJ,2,0,"button",120),p(),N(8,tJ,18,7,"div",121),p()()),n&2){let t=E(3);_(4),x("ngForOf",t.dipendenti),_(3),x("ngIf",!t.showAddDipendenteForm),_(),x("ngIf",t.showAddDipendenteForm)}}function iJ(n,e){if(n&1){let t=ee();g(0,"div")(1,"h2",17),v(2,"Gestione Appuntamenti"),p(),g(3,"div",100)(4,"h3",101),v(5,"Modalit\xE0 di Gestione Appuntamenti"),p(),g(6,"div",39)(7,"label",102)(8,"input",103),F("change",function(){A(t);let r=E(2);return R(r.onModeChange("simple"))}),p(),v(9," Numero massimo di appuntamenti in contemporanea "),p(),g(10,"label",102)(11,"input",103),F("change",function(){A(t);let r=E(2);return R(r.onModeChange("advanced"))}),p(),v(12," Gestione avanzata con dipendenti e servizi "),p()(),N(13,SK,12,2,"div",104)(14,CK,7,1,"div",105)(15,nJ,9,3,"div",106),g(16,"div",31)(17,"button",32),F("click",function(){A(t);let r=E(2);return R(r.saveAppointmentSettings())}),v(18,"Salva Impostazioni"),p()()()()}if(n&2){let t=E(2);_(8),x("value","simple")("checked",t.appointmentSettings.mode==="simple"),_(3),x("value","advanced")("checked",t.appointmentSettings.mode==="advanced"),_(2),x("ngIf",t.showModeChangeConfirm),_(),x("ngIf",t.appointmentSettings.mode==="simple"),_(),x("ngIf",t.appointmentSettings.mode==="advanced")}}function rJ(n,e){if(n&1&&(g(0,"div",199),ie(1,"img",200),p()),n&2){let t=E(3);_(),x("src",t.profile.logo_url,kt)}}function oJ(n,e){if(n&1){let t=ee();g(0,"button",201),F("click",function(){A(t);let r=E(3);return R(r.uploadLogo())}),v(1,"Carica Logo"),p()}}function sJ(n,e){n&1&&(g(0,"div"),v(1,"Caricamento in corso..."),p())}function aJ(n,e){n&1&&(g(0,"div",202),v(1,"Logo caricato con successo!"),p())}function lJ(n,e){n&1&&(g(0,"div",14),v(1,"Errore nel caricamento del logo."),p())}function cJ(n,e){if(n&1){let t=ee();g(0,"div")(1,"h2",17),v(2,"Logo"),p(),g(3,"aside",190),N(4,rJ,2,1,"div",191),g(5,"div",192)(6,"input",193,8),F("change",function(r){A(t);let o=E(2);return R(o.onLogoSelected(r))}),p(),g(8,"button",194),F("click",function(){A(t);let r=Ve(7);return R(r.click())}),v(9,"Scegli un file"),p(),g(10,"span",195),v(11),p(),N(12,oJ,2,0,"button",196),p(),N(13,sJ,2,0,"div",10)(14,aJ,2,0,"div",197)(15,lJ,2,0,"div",198),p()()}if(n&2){let t=E(2);_(4),x("ngIf",t.profile.logo_url),_(7),q(t.selectedLogoFile?t.selectedLogoFile.name:"Nessun file selezionato"),_(),x("ngIf",t.selectedLogoFile),_(),x("ngIf",t.logoUploadStatus==="uploading"),_(),x("ngIf",t.logoUploadStatus==="success"),_(),x("ngIf",t.logoUploadStatus==="error")}}function dJ(n,e){if(n&1){let t=ee();g(0,"div",206)(1,"label"),v(2),p(),ie(3,"div",207),g(4,"input",208),Z("ngModelChange",function(r){let o=A(t).$implicit,s=E(3);return Y(s.brand[o.key],r)||(s.brand[o.key]=r),R(r)}),p()()}if(n&2){let t=e.$implicit,i=E(3);_(2),J("",t.label,":"),_(),Oo("background",i.brand[t.key]),_(),G("ngModel",i.brand[t.key]),x("name",t.key)}}function uJ(n,e){n&1&&(g(0,"span"),v(1,"Salva Configurazione"),p())}function fJ(n,e){n&1&&(g(0,"span"),v(1,"Salvataggio..."),p())}function pJ(n,e){n&1&&(g(0,"div",202),v(1,"Configurazione salvata con successo!"),p())}function hJ(n,e){n&1&&(g(0,"div",14),v(1,"Errore durante il salvataggio!"),p())}function gJ(n,e){if(n&1){let t=ee();g(0,"div")(1,"h2",17),v(2,"Personalizzazione Brand"),p(),g(3,"form",203),F("ngSubmit",function(){A(t);let r=E(2);return R(r.saveBrand())}),N(4,dJ,5,5,"div",204),g(5,"div",133)(6,"button",205),N(7,uJ,2,0,"span",10)(8,fJ,2,0,"span",10),p(),g(9,"button",177),F("click",function(){A(t);let r=E(2);return R(r.resetBrandColors())}),v(10,"Reset"),p()(),N(11,pJ,2,0,"div",197)(12,hJ,2,0,"div",198),p()()}if(n&2){let t=E(2);_(4),x("ngForOf",t.brandKeys),_(2),x("disabled",t.brandSaveStatus==="saving"),_(),x("ngIf",t.brandSaveStatus!=="saving"),_(),x("ngIf",t.brandSaveStatus==="saving"),_(3),x("ngIf",t.brandSaveStatus==="success"),_(),x("ngIf",t.brandSaveStatus==="error")}}function mJ(n,e){n&1&&(g(0,"span"),v(1,"Disconnetti"),p())}function vJ(n,e){n&1&&(g(0,"span"),v(1,"Disconnessione in corso..."),p())}function _J(n,e){if(n&1){let t=ee();tt(0),g(1,"div",15)(2,"h2",16),v(3,"Impostazioni"),p(),g(4,"h2",17),v(5,"Dati Account"),p(),g(6,"div",18)(7,"div",19),N(8,NQ,17,4,"ng-container",10)(9,LQ,23,5,"ng-container",10)(10,FQ,6,1,"div",20)(11,zQ,6,1,"div",20)(12,VQ,7,1,"div",21)(13,jQ,13,2,"div",21)(14,BQ,13,2,"div",22)(15,UQ,3,0,"div",23)(16,QQ,33,15,"div",24),p(),N(17,aK,5,2,"div",25),p(),N(18,bK,7,2,"div",10)(19,iJ,19,7,"div",10)(20,cJ,16,6,"div",10)(21,gJ,13,6,"div",10),g(22,"div",26)(23,"button",27),F("click",function(){A(t);let r=E();return R(r.onSignOut())}),N(24,mJ,2,0,"span",10)(25,vJ,2,0,"span",10),p()()(),nt()}if(n&2){let t=E();_(8),x("ngIf",!t.isAdmin()&&!t.editSettingsSection),_(),x("ngIf",t.isAdmin()&&!t.editSettingsSection),_(),x("ngIf",!t.editSettingsSection),_(),x("ngIf",!t.editSettingsSection),_(),x("ngIf",t.isAdmin()&&!t.editSettingsSection),_(),x("ngIf",!t.editSettingsSection),_(),x("ngIf",t.isAdmin()&&!t.editSettingsSection),_(),x("ngIf",!t.editSettingsSection),_(),x("ngIf",t.editSettingsSection),_(),x("ngIf",t.isAdmin()),_(),x("ngIf",t.isAdmin()),_(),x("ngIf",t.isAdmin()),_(),x("ngIf",t.isAdmin()),_(),x("ngIf",t.isAdmin()),_(2),x("disabled",t.signingOut),_(),x("ngIf",!t.signingOut),_(),x("ngIf",t.signingOut)}}var Ip=class n{constructor(e,t,i,r,o,s,l,c,u,f){this.authService=e;this.profileService=t;this.brandSettingsService=i;this.stockService=r;this.openingHoursService=o;this.utilityService=s;this.supabaseService=l;this.router=c;this.dipendentiService=u;this.salonService=f}weekDays=[{index:0,label:"Domenica"},{index:1,label:"Luned\xEC"},{index:2,label:"Marted\xEC"},{index:3,label:"Mercoled\xEC"},{index:4,label:"Gioved\xEC"},{index:5,label:"Venerd\xEC"},{index:6,label:"Sabato"}];editingOrari={};orariDraft={};minToday="";editSettingsSection=!1;isSavingSettingsSection=!1;settingsSectionError="";settingsSectionSuccess=!1;newRagioneSociale="";newAddress="";newPhone="";newDescription="";selectedRegion="";selectedProvince="";scorteBasse=5;scorteCritiche=2;allProvinces=[];regions=[];filteredProvinces=[];loading=!0;editWebsite=!1;editBrand=!1;brandSaveStatus="idle";logoUploadStatus="idle";websiteSaveStatus="idle";profile={};newWebsite="";websiteError="";selectedLogoFile=null;addressSaveStatus="idle";appointmentSettings={mode:"simple",maxConcurrentAppointments:1};showModeChangeConfirm=!1;newMode="";brand=B({},Tr);brandKeys=[{key:"primary_color",label:"Primario"},{key:"secondary_color",label:"Secondario"},{key:"text_color",label:"Testo"},{key:"background_color",label:"Sfondo"},{key:"background2_color",label:"Sfondo 2"}];editSesso=!1;signingOut=!1;newSesso="";editSocials=!1;editableSocials={};editHours=!1;editableHours=[];loadingHours=!1;dipendenti=[];allServizi=[];serviziHierarchy=[];newDipendenteNome="";newDipendenteCognome="";newDipendenteTelefono="";newDipendenteEmail="";newDipendenteRuolo="";newDipendenteNote="";editingDipendente=null;showAddDipendenteForm=!1;expandedDipendenti={};isAdmin(){return this.profile?typeof this.profile.is_admin=="boolean"?this.profile.is_admin:!!(this.profile.role&&String(this.profile.role).toLowerCase()==="admin"||this.profile.salon_id):!1}ngOnInit(){return C(this,null,function*(){this.loading=!0;try{let t=yield this.authService.getMyProfile(!0);if(!t||!t.id){console.error("Reindirizzamento al login: sessione non valida o profilo mancante"),yield this.router.navigate(["/login"]);return}this.profile=t,this.scorteBasse=this.profile.scorte_basse||5,this.scorteCritiche=this.profile.scorte_critiche||2;try{let i=yield this.profileService.getAppointmentMode(this.profile.id);this.appointmentSettings.mode=i||"simple";let r=yield this.profileService.getMaxConcurrentAppointments(this.profile.id);this.appointmentSettings.maxConcurrentAppointments=r!==null?r:1}catch(i){console.error("Errore nel caricamento delle impostazioni appuntamenti:",i),this.appointmentSettings.mode="simple",this.appointmentSettings.maxConcurrentAppointments=1}if(console.log("Caricamento province in corso..."),this.allProvinces=this.utilityService.getProvinces(),(!Array.isArray(this.allProvinces)||this.allProvinces.length===0)&&(console.warn("Attenzione: il service non ha restituito province; array vuoto."),this.allProvinces=[]),console.log(`Caricate ${this.allProvinces.length} province`),this.regions=this.utilityService.getRegions(),this.profile.provincia){let i=String(this.profile.provincia).toUpperCase(),r=this.allProvinces.find(o=>String(o.code).toUpperCase()===i);r?(this.selectedRegion=r.region,this.filterProvinces(),this.selectedProvince=r.code):console.warn("Provincia profilo non trovata nella lista delle province:",this.profile.provincia)}this.isAdmin()&&(yield this.loadBrandSettings(),this.applyBrandColors(),yield this.loadOpeningHours(),yield this.loadServizi(),yield this.loadDipendenti())}catch(t){console.error("Errore caricamento dati in ngOnInit:",t)}finally{this.loading=!1}let e=new Date;this.minToday=e.toISOString().slice(0,10)})}filterProvinces(){if(!this.selectedRegion){this.filteredProvinces=[];return}this.filteredProvinces=this.allProvinces.filter(e=>e.region===this.selectedRegion&&e.code&&e.code!==""),this.selectedProvince=""}getProvinceName(e){if(!e)return"\u2014";let t=String(e).trim().toUpperCase(),i=this.allProvinces.find(r=>String(r.code??"").toUpperCase()===t);return i?i.name:"\u2014"}getRegionName(e){if(!e)return"\u2014";let t=String(e).trim().toUpperCase(),i=this.allProvinces.find(r=>String(r.code??"").toUpperCase()===t);return i?i.region:"\u2014"}saveBrand(){return C(this,null,function*(){try{let e=yield this.brandSettingsService.saveBrandSettings(this.profile.id,this.brand);this.brand=this.brandSettingsService.mergeWithDefaults(e),this.brandSettingsService.applyBrandColors(this.brand,this.isAdmin())}catch(e){console.error("Errore salvataggio brand:",e)}})}loadBrandSettings(){return C(this,null,function*(){try{let e=yield this.brandSettingsService.getBrandSettings(this.profile.id);e?this.brand=this.brandSettingsService.mergeWithDefaults(e):this.brand=this.brandSettingsService.mergeWithDefaults({user_id:this.profile.id}),this.brandSettingsService.applyBrandColors(this.brand,this.isAdmin())}catch(e){console.error("Errore nel caricamento brand settings:",e)}})}applyBrandColors(){this.brandSettingsService.applyBrandColors(this.brand,this.isAdmin())}resetBrandColors(){confirm("Sei sicuro di voler ripristinare i colori originali?")&&(this.brand=this.brandSettingsService.resetToDefaults(this.profile?.id),this.brandSettingsService.applyBrandColors(this.brand,this.isAdmin()),alert("Colori ripristinati ai valori originali. Ricordati di salvare per applicare permanentemente."))}startEditWebsite(){this.websiteError="",this.newWebsite=this.profile?.sito_web??"",this.editWebsite=!0}cancelEditWebsite(){this.websiteError="",this.newWebsite="",this.editWebsite=!1}isProbablyValidUrl(e){if(!e)return!1;let t=e.trim();return/^[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}(|\/.*)$/.test(t)||/^[a-zA-Z][a-zA-Z0-9+.-]*:\/\//.test(t)}formatUrl(e){if(!e)return"";let t=String(e).trim();return/^[a-zA-Z][a-zA-Z0-9+.-]*:\/\//.test(t)?t:"https://"+t}saveWebsite(){return C(this,null,function*(){if(this.websiteError="",this.newWebsite&&!this.isProbablyValidUrl(this.newWebsite)){this.websiteError="Formato URL non valido";return}this.websiteSaveStatus="saving";let e=this.newWebsite?this.newWebsite.trim():"";try{yield this.profileService.updateProfileWebsite(this.profile.id,e),this.profile=ne(B({},this.profile),{sito_web:e}),this.websiteSaveStatus="success",this.editWebsite=!1,console.log("Sito web aggiornato con successo")}catch(t){console.error("Errore aggiornamento sito web:",t),this.websiteSaveStatus="error",this.websiteError="Errore durante il salvataggio."}finally{setTimeout(()=>{this.websiteSaveStatus="idle",this.websiteError=""},3e3)}})}onLogoSelected(e){let t=e.target.files[0];t&&t.type.match("image.*")?(this.selectedLogoFile=t,this.logoUploadStatus="idle"):alert("Per favore seleziona un file immagine valido (JPEG, PNG, ecc.)")}uploadLogo(){return C(this,null,function*(){if(!(!this.selectedLogoFile||!this.profile.id)){this.logoUploadStatus="uploading";try{let e=yield this.supabaseService.uploadLogo(this.selectedLogoFile);this.profile.logo_url=e,this.logoUploadStatus="success",setTimeout(()=>{this.logoUploadStatus="idle",this.selectedLogoFile=null},3e3)}catch{this.logoUploadStatus="error",setTimeout(()=>this.logoUploadStatus="idle",5e3)}}})}onSignOut(){return C(this,null,function*(){if(confirm("Sei sicuro di voler uscire dall'account?")){this.signingOut=!0;try{yield this.authService.signOut(),this.profile=ne(B({},this.profile),{id:""}),yield this.router.navigate(["/login"])}catch(e){console.error("Errore durante logout:",e),alert("Errore durante la disconnessione. Riprova.")}finally{this.signingOut=!1}}})}startEditSocials(){this.editableSocials=B({},this.profile.socials||{}),this.editSocials=!0}cancelEditSocials(){this.editableSocials={},this.editSocials=!1}normalizeWhatsapp(e){if(!e)return;let t=e.trim();if(/^https?:\/\//.test(t))return t;let i=t.replace(/[^\d+]/g,"");return i?`https://wa.me/${i.replace(/^\+/,"")}`:void 0}saveSocials(){return C(this,null,function*(){let e=B({},this.editableSocials||{});if(e.facebook&&!this.isProbablyValidUrl(e.facebook)){alert("URL Facebook non valido");return}if(e.instagram&&!this.isProbablyValidUrl(e.instagram)){alert("URL Instagram non valido");return}if(e.linkedin&&!this.isProbablyValidUrl(e.linkedin)){alert("URL LinkedIn non valido");return}e.whatsapp&&(e.whatsapp=this.normalizeWhatsapp(e.whatsapp));try{yield this.profileService.updateProfileSocials(this.profile.id,e),this.profile.socials=e,this.editSocials=!1,console.log("Social salvati con successo")}catch(t){console.error("Errore salvataggio socials:",t),alert("Errore durante il salvataggio dei link social.")}})}startEditHours(){let e=this.profile.opening_hours&&Array.isArray(this.profile.opening_hours)&&this.profile.opening_hours.length===7?this.profile.opening_hours:this.defaultWeek();this.editableHours=e.map(t=>({dayIndex:t.dayIndex,dayName:t.dayName,intervals:(t.intervals||[]).map(i=>({start:i.start,end:i.end})),closed:!(t.intervals&&t.intervals.length>0)})),this.editHours=!0}cancelEditHours(){this.editableHours=[],this.editHours=!1}addInterval(e){let t=this.editableHours[e];t&&(t.intervals.push({start:"09:00",end:"13:00"}),t.closed=!1)}removeInterval(e,t){let i=this.editableHours[e];i&&(i.intervals.splice(t,1),i.intervals.length===0&&(i.closed=!0))}toggleClosed(e){let t=this.editableHours[e];t&&(t.closed?t.intervals=[]:t.intervals=[{start:"09:00",end:"13:00"}])}validateHours(){for(let e of this.editableHours){if(!e.intervals||e.intervals.length===0)continue;let t=[...e.intervals].sort((i,r)=>i.start.localeCompare(r.start));for(let i=0;i<t.length;i++){let r=t[i];if(!r.start||!r.end||r.start>=r.end)return{ok:!1,message:`${e.dayName}: intervallo ${i+1} non valido (controlla orari)`};if(i>0){let o=t[i-1];if(r.start<o.end)return{ok:!1,message:`${e.dayName}: gli intervalli si sovrappongono`}}}}return{ok:!0}}saveHours(){return C(this,null,function*(){let e=this.validateHours();if(!e.ok){alert(e.message||"Errore negli orari");return}let t=this.editableHours.map(i=>({dayIndex:i.dayIndex,dayName:i.dayName,intervals:i.closed?[]:i.intervals.map(r=>({start:this.formatTime(r.start),end:this.formatTime(r.end)})),closed:i.closed??i.intervals.length===0}));try{yield this.openingHoursService.saveOpeningHours(this.profile.id,t),this.profile.opening_hours=t,this.editHours=!1,console.log("Orari aggiornati con successo")}catch(i){console.error("Errore salvataggio orari:",i),alert("Errore durante il salvataggio degli orari.")}})}formatTime(e){let[t,i]=e.split(":");return`${t.padStart(2,"0")}:${i.padStart(2,"0")}`}formatIntervals(e=[]){return!e||e.length===0?"Chiuso":e.map(t=>`${t.start}-${t.end}`).join(" | ")}defaultWeek(){return["Domenica","Luned\xEC","Marted\xEC","Mercoled\xEC","Gioved\xEC","Venerd\xEC","Sabato"].map((t,i)=>({dayIndex:i,dayName:t,intervals:[]}))}loadOpeningHours(){return C(this,null,function*(){this.loadingHours=!0;try{let e=yield this.openingHoursService.getOpeningHours(this.profile.id);e&&e.length>0?this.profile.opening_hours=e.map(t=>({dayIndex:t.dayIndex,dayName:t.day_name,intervals:t.intervals||[]})):this.profile.opening_hours=this.defaultWeek()}catch(e){console.error("Errore caricamento orari:",e),this.profile.opening_hours=this.defaultWeek()}finally{this.loadingHours=!1}})}startEditSesso(){this.newSesso=this.profile.sesso,this.editSesso=!0}addDipendente(){return C(this,null,function*(){try{let e={nome:this.newDipendenteNome,cognome:this.newDipendenteCognome,telefono:this.newDipendenteTelefono,email:this.newDipendenteEmail,ruolo:this.newDipendenteRuolo,note:this.newDipendenteNote,servizi:[]},t=yield this.dipendentiService.createDipendente(this.profile.id,e);this.dipendenti.push(t),this.cancelAddDipendente()}catch(e){console.error("Errore nella creazione del dipendente:",e),alert("Errore nella creazione del dipendente")}})}deleteDipendente(e){return C(this,null,function*(){if(confirm(`Sei sicuro di voler eliminare il dipendente ${e.nome}?`))try{yield this.dipendentiService.deleteDipendente(e.id),this.dipendenti=this.dipendenti.filter(t=>t.id!==e.id)}catch(t){console.error("Errore nell'eliminazione del dipendente:",t),alert("Errore nell'eliminazione del dipendente")}})}toggleDipendenteServizio(e,t){return C(this,null,function*(){try{let i=e.servizi||[],r;this.isServizioAssigned(e,t.id)?r=i.filter(o=>o!==t.id):r=[...i,t.id],yield this.dipendentiService.setDipendenteServizi(e.id,r),e.servizi=r}catch(i){console.error("Errore nell'aggiornamento dei servizi del dipendente:",i),alert("Errore nell'aggiornamento dei servizi del dipendente")}})}checkAppointmentAvailability(e,t,i,r){return C(this,null,function*(){try{let{data:o,error:s}=yield this.supabaseService.getClient().from("profiles").select("max_concurrent_appointments, appointment_mode").eq("id",e).single();if(s)return console.error("Errore nel recupero del profilo:",s),{available:!1,reason:"Errore nel recupero delle informazioni del salone"};if(!o)return{available:!1,reason:"Profilo non trovato"};if(o.appointment_mode==="simple"||o.max_concurrent_appointments!==null){let{data:l,error:c}=yield this.supabaseService.getClient().from("appointments").select("id").eq("salon_id",e).lt("start_time",r).gt("end_time",i).neq("status","cancelled");if(c)return console.error("Errore nel recupero degli appuntamenti:",c),{available:!1,reason:"Errore nel controllo disponibilit\xE0"};let u=l?.length||0,f=o.max_concurrent_appointments||1;if(u>=f)return{available:!1,reason:`Numero massimo di appuntamenti contemporanei (${f}) raggiunto`}}return{available:!0}}catch(o){return console.error("Errore nel controllo disponibilit\xE0:",o),{available:!1,reason:"Errore nel controllo disponibilit\xE0"}}})}loadServizi(){return C(this,null,function*(){try{this.allServizi=yield this.salonService.getServicesOnly(!0),this.organizeServiziHierarchy()}catch(e){console.error("Errore nel caricamento dei servizi:",e)}})}organizeServiziHierarchy(){this.serviziHierarchy=[],this.allServizi.filter(i=>i.is_group).forEach(i=>{let r={id:i.id,name:i.name||"",services:this.allServizi.filter(o=>o.parent_id===i.id&&!o.is_group)};this.serviziHierarchy.push(r)});let t=this.allServizi.filter(i=>!i.parent_id&&!i.is_group);t.length>0&&this.serviziHierarchy.push({id:null,name:"Servizi senza gruppo",services:t})}onServiziChange(e,t){let r=Array.from(t.target.selectedOptions).map(o=>o.value);this.updateDipendenteServizi(e,r)}updateDipendenteServizi(e,t){return C(this,null,function*(){try{yield this.dipendentiService.updateDipendenteServizi(e.id,t),e.servizi=t}catch(i){console.error("Errore nell'aggiornamento dei servizi del dipendente:",i),alert("Errore nell'aggiornamento dei servizi del dipendente")}})}isServizioAssigned(e,t){return t?e.servizi&&e.servizi.includes(t):!1}loadDipendenti(){return C(this,null,function*(){try{this.dipendenti=yield this.dipendentiService.getDipendentiWithServizi(this.profile.id);for(let e of this.dipendenti){let t=yield this.dipendentiService.getDipendenteOrari(e.id);t?(e.orari=t,e.orari.fulltime===void 0&&(e.orari.fulltime=!0)):e.orari={fulltime:!0}}}catch(e){console.error("Errore nel caricamento dei dipendenti:",e)}})}toggleDipendenteFulltime(e,t){e.orari||(e.orari={});let i=t?t.target.checked:!!e.orari.fulltime;e.orari.fulltime=i,this.ensureOrariStructure(e)}ensureOrariStructure(e){e.orari||(e.orari={fulltime:!0}),e.orari.fulltime===void 0&&(e.orari.fulltime=!0);for(let t=0;t<7;t++){let i=t.toString();Array.isArray(e.orari[i])||(e.orari[i]=[])}}addOrarioToDipendente(e,t){let i=t.toString();e.orari[i]||(e.orari[i]=[]),e.orari[i].push({start:"09:00",end:"13:00"})}removeOrarioFromDipendente(e,t,i){let r=t.toString();e.orari[r]&&e.orari[r].splice(i,1)}toggleServizio(e,t){if(!t.id)return;let i=this.isServizioAssigned(e,t.id),r;i?r=(e.servizi||[]).filter(o=>o!==t.id):r=[...e.servizi||[],t.id],this.updateDipendenteServizi(e,r)}toggleAllServizi(e){let t=this.getAllServiziIds();this.areAllServiziSelected(e)?this.updateDipendenteServizi(e,[]):this.updateDipendenteServizi(e,t)}areAllServiziSelected(e){let t=this.getAllServiziIds(),i=e.servizi||[];return t.length>0&&t.every(r=>i.includes(r))}getAllServiziIds(){return this.serviziHierarchy.flatMap(e=>e.services.map(t=>t.id)).filter(e=>e!==void 0)}getSelectedServiziCount(e){return(e.servizi||[]).length}onModeChange(e){this.appointmentSettings.mode!==e&&(this.newMode=e,this.showModeChangeConfirm=!0)}startEditDipendente(e){this.editingDipendente=B({},e)}cancelEditDipendente(){this.editingDipendente=null}saveEditDipendente(){return C(this,null,function*(){if(this.editingDipendente)try{let e=yield this.dipendentiService.updateDipendente(this.editingDipendente.id,this.editingDipendente),t=this.dipendenti.findIndex(i=>i.id===e.id);t!==-1&&(this.dipendenti[t]=e),this.cancelEditDipendente()}catch(e){console.error("Errore nell'aggiornamento del dipendente:",e),alert("Errore nell'aggiornamento del dipendente")}})}confirmModeChange(){let e=this.appointmentSettings.maxConcurrentAppointments;this.appointmentSettings.mode=this.newMode,this.showModeChangeConfirm=!1,this.appointmentSettings.maxConcurrentAppointments=e,this.saveAppointmentMode()}cancelModeChange(){this.showModeChangeConfirm=!1,this.newMode=""}saveAppointmentMode(){return C(this,null,function*(){try{yield this.profileService.updateAppointmentMode(this.profile.id,this.appointmentSettings.mode)}catch(e){console.error("Errore nel salvataggio della modalit\xE0 appuntamenti:",e),alert("Errore nel salvataggio della modalit\xE0 appuntamenti")}})}saveAppointmentSettings(){return C(this,null,function*(){try{if(yield this.profileService.updateAppointmentMode(this.profile.id,this.appointmentSettings.mode),yield this.profileService.updateMaxConcurrentAppointments(this.profile.id,this.appointmentSettings.maxConcurrentAppointments),this.appointmentSettings.mode==="advanced"&&this.dipendenti.length===0){alert("Devi aggiungere almeno un dipendente per la modalit\xE0 avanzata");return}alert("Impostazioni appuntamenti salvate con successo!")}catch(e){console.error("Errore nel salvataggio delle impostazioni appuntamenti:",e),alert("Errore nel salvataggio delle impostazioni appuntamenti")}})}cancelAddDipendente(){this.showAddDipendenteForm=!1,this.newDipendenteNome="",this.newDipendenteCognome="",this.newDipendenteTelefono="",this.newDipendenteEmail="",this.newDipendenteRuolo="",this.newDipendenteNote=""}getOrariByGiorno(e,t){let i=t.toString();return e.orari&&e.orari[i]?e.orari[i]:[]}formatOrariLine(e,t){let i=this.getOrariByGiorno(e,t);return!i||i.length===0?"chiuso":i.map(r=>`${r.start}\u2013${r.end}`).join(", ")}startEditOrari(e){this.ensureOrariStructure(e),this.orariDraft[e.id]=JSON.parse(JSON.stringify(e.orari||{fulltime:!0})),this.orariDraft[e.id].assente=e.assente||!1,this.orariDraft[e.id].assente_fino=e.assente_fino||null;for(let t=0;t<7;t++){let i=t.toString();Array.isArray(this.orariDraft[e.id][i])||(this.orariDraft[e.id][i]=[])}this.editingOrari[e.id]=!0}cancelEditOrari(e){delete this.orariDraft[e.id],this.editingOrari[e.id]=!1}onFulltimeChange(e,t){let i;if(typeof t=="boolean")i=t;else{let r=t&&t.target||null;i=!!(r&&r.checked)}this.editingOrari[e.id]||this.startEditOrari(e),this.orariDraft[e.id]||this.startEditOrari(e),this.orariDraft[e.id].fulltime=!!i}onFulltimeChangeInDraft(e,t){this.orariDraft[e.id]||this.startEditOrari(e),this.orariDraft[e.id].fulltime=!!t}getOrariByGiornoDraft(e,t){let i=this.orariDraft[e.id];return i?i[t.toString()]||[]:[]}addOrarioToDraft(e,t){this.orariDraft[e.id]||this.startEditOrari(e);let i=t.toString();Array.isArray(this.orariDraft[e.id][i])||(this.orariDraft[e.id][i]=[]),this.orariDraft[e.id][i].push({start:"09:00",end:"17:00"})}removeOrarioFromDraft(e,t,i){if(!this.orariDraft[e.id])return;let r=this.orariDraft[e.id][t.toString()];r&&r.splice(i,1)}saveDipendenteOrari(e,t=!1){return C(this,null,function*(){try{e.savingOrari=!0;let i;t&&this.orariDraft[e.id]?i=JSON.parse(JSON.stringify(this.orariDraft[e.id])):i=JSON.parse(JSON.stringify(e.orari||{fulltime:!0}));let r=!!i.assente,o=i.assente_fino||null,s={fulltime:!!i.fulltime};for(let l=0;l<7;l++){let c=l.toString();s[c]=Array.isArray(i[c])?i[c]:[]}if(!r&&!s.fulltime)for(let l=0;l<7;l++){let c=s[l.toString()]||[];for(let u of c){if(!u.start||!u.end)throw new Error("Compila tutti gli orari (start/end).");if(u.start>=u.end)throw new Error("Start deve essere prima di End.")}}yield this.dipendentiService.setDipendenteOrari(e.id,s),yield this.dipendentiService.setDipendenteAssenza(e.id,r,o),e.orari=JSON.parse(JSON.stringify(s)),e.assente=r,e.assente_fino=o,delete this.orariDraft[e.id],this.editingOrari[e.id]=!1}catch(i){console.error(i),alert(i?.message||"Errore salvataggio orari/assenza")}finally{e.savingOrari=!1}})}onAssenteToggle(e,t){let i=!!(t&&t.target)?.checked;this.editingOrari[e.id]||this.startEditOrari(e),this.orariDraft[e.id]||this.startEditOrari(e),this.orariDraft[e.id].assente=i,i||(this.orariDraft[e.id].assente_fino=null)}onAssenteChangeInDraft(e,t){this.orariDraft[e.id]||this.startEditOrari(e),this.orariDraft[e.id].assente=!!t,t||(this.orariDraft[e.id].assente_fino=null)}startEditSettingsSection(){this.newRagioneSociale=this.profile.ragione_sociale||"",this.newAddress=this.profile.indirizzo||"",this.newPhone=this.profile.telefono||"",this.newDescription=this.profile.descrizione||"",this.selectedProvince=this.profile.provincia||"",this.selectedRegion=this.getRegionName(this.profile.provincia)||this.selectedRegion||"",this.selectedRegion&&this.filterProvinces(),this.scorteBasse=this.profile.scorte_basse??5,this.scorteCritiche=this.profile.scorte_critiche??2,this.settingsSectionError="",this.settingsSectionSuccess=!1,this.editSettingsSection=!0}cancelEditSettingsSection(){this.editSettingsSection=!1,this.settingsSectionError="",this.settingsSectionSuccess=!1}saveSettingsSection(){return C(this,null,function*(){if(this.profile?.id){this.isSavingSettingsSection=!0,this.settingsSectionError="",this.settingsSectionSuccess=!1;try{this.isAdmin()&&this.newRagioneSociale!==this.profile.ragione_sociale&&(yield this.profileService.updateProfileRagioneSociale(this.profile.id,this.newRagioneSociale),this.profile.ragione_sociale=this.newRagioneSociale),this.newAddress!==this.profile.indirizzo&&(yield this.profileService.updateProfileAddress(this.profile.id,this.newAddress),this.profile.indirizzo=this.newAddress),this.newPhone!==this.profile.telefono&&(yield this.profileService.updateProfilePhone(this.profile.id,this.newPhone),this.profile.telefono=this.newPhone),this.isAdmin()&&this.newDescription!==this.profile.descrizione&&(yield this.profileService.updateProfileDescription(this.profile.id,this.newDescription),this.profile.descrizione=this.newDescription),this.selectedProvince&&(this.selectedProvince!==this.profile.provincia||this.selectedRegion!==this.profile.regione)&&(yield this.profileService.updateProfileLocation(this.profile.id,this.selectedProvince,this.selectedRegion),this.profile.provincia=this.selectedProvince,this.profile.regione=this.selectedRegion),this.isAdmin()&&(this.scorteBasse!==this.profile.scorte_basse||this.scorteCritiche!==this.profile.scorte_critiche)&&(yield this.stockService.updateStockSettings(this.profile.id,this.scorteBasse,this.scorteCritiche),this.profile.scorte_basse=this.scorteBasse,this.profile.scorte_critiche=this.scorteCritiche),this.settingsSectionSuccess=!0,this.editSettingsSection=!1,setTimeout(()=>this.settingsSectionSuccess=!1,2500)}catch(e){console.error("Errore salvataggio sezione impostazioni:",e),this.settingsSectionError=e?.message||"Errore durante il salvataggio delle impostazioni"}finally{this.isSavingSettingsSection=!1}}})}static \u0275fac=function(t){return new(t||n)(z(ln),z(wi),z(Gc),z(Hc),z(vo),z(rr),z(ue),z(We),z(_i),z(Ji))};static \u0275cmp=he({type:n,selectors:[["app-impostazioni"]],decls:3,vars:3,consts:[["fbEmpty",""],["igEmpty",""],["liEmpty",""],["waEmpty",""],["noHours",""],["closed",""],["editDipendente",""],["hasHours",""],["fileInput",""],["class","loading-overlay",4,"ngIf"],[4,"ngIf"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"],[1,"error-message"],[1,"container"],[1,"section-title"],[1,"section-subtitle"],[1,"profile-row"],[1,"sezione-impostazioni"],["class","sezione-modificabile",4,"ngIf"],["class","description-section",4,"ngIf"],["class","scorte-section",4,"ngIf"],["class","form-actions",4,"ngIf"],["class","edit-settings-section",4,"ngIf"],["class","social-section",4,"ngIf"],[1,"logout-section",2,"margin-top","1.2rem"],[1,"btn-primary",3,"click","disabled"],[1,"sezione-modificabile"],[1,"description-section"],[1,"scorte-section"],[1,"form-actions"],[1,"btn-primary",3,"click"],[1,"edit-settings-section"],["class","form-group sezione-modificabile",4,"ngIf"],[1,"form-group","sezione-modificabile"],["type","text",1,"form-control",3,"ngModelChange","ngModel"],["type","tel",1,"form-control",3,"ngModelChange","ngModel"],["class","form-group",4,"ngIf"],[1,"form-group"],[1,"form-control",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-control",3,"ngModelChange","ngModel","disabled"],[1,"btn",3,"click","disabled"],["class","error-message","style","margin-top:0.6rem;",4,"ngIf"],["class","success-message","style","margin-top:0.6rem;",4,"ngIf"],["rows","5","placeholder","Inserisci una descrizione della tua attivit\xE0...",1,"form-control",3,"ngModelChange","ngModel"],[3,"value"],["type","number","min","1",1,"form-control",3,"ngModelChange","ngModel"],[2,"margin-top","0.4rem"],[1,"error-message",2,"margin-top","0.6rem"],[1,"success-message",2,"margin-top","0.6rem"],[1,"social-section"],["class","color-form",4,"ngIf"],["class","edit-socials",4,"ngIf"],[1,"color-form"],["role","group","aria-label","Facebook",1,"social-row"],["viewBox","0 0 24 24","aria-hidden","true","focusable","false",1,"social-icon"],["fill","#1877F2","d","M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"],[1,"social-content"],[4,"ngIf","ngIfElse"],["role","group","aria-label","Instagram",1,"social-row"],["id","ig-gradient","x1","0%","y1","0%","x2","100%","y2","100%"],["offset","0%","stop-color","#fdf497"],["offset","5%","stop-color","#fdf497"],["offset","45%","stop-color","#fd5949"],["offset","60%","stop-color","#d6249f"],["offset","90%","stop-color","#285AEB"],["fill","url(#ig-gradient)","d","M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"],["role","group","aria-label","LinkedIn",1,"social-row"],["fill","#0077B5","d","M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"],["role","group","aria-label","WhatsApp",1,"social-row"],["fill","#25D366","d","M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.864 3.49"],["target","_blank","rel","noopener noreferrer",1,"social-link",3,"href"],[1,"not-present"],[1,"edit-socials"],["type","url","name","facebookEdit","placeholder","https://facebook.com/tuapagina",3,"ngModelChange","ngModel"],["type","url","name","instagramEdit","placeholder","https://instagram.com/tuapagina",3,"ngModelChange","ngModel"],["type","url","name","linkedinEdit","placeholder","https://linkedin.com/in/tuoprofilo",3,"ngModelChange","ngModel"],["type","text","name","whatsappEdit","placeholder","es. +391234567890 o https://wa.me/391234567890",3,"ngModelChange","ngModel"],[1,"btn",3,"click"],[1,"hours-section"],["class","edit-hours",4,"ngIf"],["class","loading",4,"ngIf"],[1,"loading"],[4,"ngFor","ngForOf"],[1,"day-name"],["class","has-hours",4,"ngIf","ngIfElse"],[1,"has-hours"],[1,"closed"],[1,"no-hours"],[1,"edit-hours"],["class","day-block",4,"ngFor","ngForOf"],[1,"day-block"],["class","interval-row",4,"ngFor","ngForOf"],[1,"checkbox"],["type","checkbox",3,"ngModelChange","change","ngModel"],[1,"interval-row"],["type","time",3,"ngModelChange","ngModel","name"],[1,"profile-info"],[2,"margin","var(--padding-v) 0","text-align","center"],[1,"checkbox-label"],["type","radio","name","appointmentMode",3,"change","value","checked"],["class","modal-backdrop",4,"ngIf"],["class","simple-mode",4,"ngIf"],["class","advanced-mode",4,"ngIf"],[1,"modal-backdrop"],[1,"edit-modal"],[1,"modal-actions"],[1,"warning-text"],[1,"simple-mode"],["for","maxConcurrentAppointments"],["type","number","id","maxConcurrentAppointments","min","1","max","20",2,"max-width","fit-content",3,"ngModelChange","ngModel"],[2,"color","var(--text-muted)","font-style","italic","margin-top","var(--padding-v)"],[1,"advanced-mode"],[2,"color","var(--text-light)","text-align","center","border-bottom","1px solid var(--text-light)","padding","var(--padding-v)"],[1,"dipendenti-list"],["class","dipendente-card",4,"ngFor","ngForOf"],[1,"add-dipendente-section"],["class","btn-primary",3,"click",4,"ngIf"],["class","add-dipendente-form",4,"ngIf"],[1,"dipendente-card"],[1,"dipendente-header-compact",3,"click"],["class","dipendente-ruolo",4,"ngIf"],[1,"arrow-icon"],["width","24","height","24","viewBox","0 0 24 24",4,"ngIf"],["class","dipendente-details",4,"ngIf"],[1,"dipendente-ruolo"],["width","24","height","24","viewBox","0 0 24 24"],["fill","currentColor","d","M7 10l5 5 5-5z"],["fill","currentColor","d","M7 14l5-5 5 5z"],[1,"dipendente-details"],[1,"dipendente-actions"],["class","btn",3,"click",4,"ngIf"],[1,"dipendente-orari-section"],["class","orari-summary",4,"ngIf"],["class","orari-edit","style","margin-top:0.6rem;",4,"ngIf"],[1,"dipendente-servizi"],[1,"servizi-chips-container"],[1,"servizi-chips-header"],["type","button",1,"btn-chip-toggle",3,"click"],[1,"servizi-chips-grid"],["class","servizi-group",4,"ngFor","ngForOf"],[1,"selected-count"],["class","edit-dipendente-form",4,"ngIf"],[1,"edit-dipendente-form"],[1,"form-row"],["type","text","placeholder","Nome",3,"ngModelChange","ngModel"],["type","text","placeholder","Cognome",3,"ngModelChange","ngModel"],["type","text","placeholder","Ruolo",3,"ngModelChange","ngModel"],["type","tel","placeholder","Telefono",3,"ngModelChange","ngModel"],["type","email","placeholder","Email",3,"ngModelChange","ngModel"],["placeholder","Note","rows","2",3,"ngModelChange","ngModel"],[1,"orari-summary"],[1,"summary-left",2,"flex","1"],[1,"summary-actions"],[2,"display","flex","flex-direction","column","align-items","flex-end","gap","0.25rem","cursor","pointer"],[2,"font-size","0.9rem","color","var(--text-light)"],["type","checkbox",3,"change","checked"],["style","margin-bottom:0.25rem;",4,"ngFor","ngForOf"],[2,"margin-bottom","0.25rem"],["class","not-present",4,"ngIf"],[1,"orari-edit",2,"margin-top","0.6rem"],[2,"display","flex","gap","1rem","flex-wrap","wrap","align-items","flex-start"],[2,"display","flex","flex-direction","column","gap","0.25rem"],["type","checkbox",3,"ngModelChange","ngModel"],["style","display:flex; flex-direction:column; gap:0.25rem;",4,"ngIf"],["class","orari-ditails","style","margin-top:0.6rem;",4,"ngIf"],[1,"orari-actions"],["style","margin-left:0.6rem;",4,"ngIf"],["type","date","placeholder","YYYY-MM-DD",1,"input-field",3,"ngModelChange","ngModel","min"],[2,"opacity","0.8"],[1,"orari-ditails",2,"margin-top","0.6rem"],["class","giorno-block","style","margin-bottom:0.6rem;",4,"ngFor","ngForOf"],[1,"giorno-block",2,"margin-bottom","0.6rem"],[1,"giorno-settimana"],["type","button",1,"btn",3,"click"],["class","no-orari",4,"ngIf"],[1,"no-orari"],["type","time",1,"time-input","input-field",3,"ngModelChange","ngModel"],[2,"margin-left","0.6rem"],[1,"servizi-group"],[1,"servizi-group-title"],[1,"chips-container"],["class","chip",3,"selected","click",4,"ngFor","ngForOf"],[1,"chip",3,"click"],[1,"add-dipendente-form"],["type","text","placeholder","Nome","required","",3,"ngModelChange","ngModel"],["type","text","placeholder","Cognome","required","",3,"ngModelChange","ngModel"],[1,"logo-upload-section"],["class","current-logo",4,"ngIf"],[1,"upload-controls"],["type","file","accept","image/*",2,"display","none",3,"change"],["type","button",1,"btn-primary",3,"click"],[1,"file-name"],["type","button",3,"click",4,"ngIf"],["class","success-message",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"current-logo"],["alt","Logo attuale",3,"src"],["type","button",3,"click"],[1,"success-message"],[1,"profile-info",3,"ngSubmit"],["class","color-picker-group",4,"ngFor","ngForOf"],["type","submit",1,"btn-primary",3,"disabled"],[1,"color-picker-group"],[1,"color-preview"],["type","color",3,"ngModelChange","ngModel","name"]],template:function(t,i){t&1&&N(0,kQ,5,0,"div",9)(1,OQ,3,0,"div",10)(2,_J,26,17,"ng-container",10),t&2&&(x("ngIf",i.loading),_(),x("ngIf",!i.loading&&!(i.profile!=null&&i.profile.id)),_(),x("ngIf",!i.loading&&(i.profile==null?null:i.profile.id)))},dependencies:[vt,bi,Ot,Nt,st,Wa,Dr,Dt,at,yi,Ln,qa,Tf,pt,Ir,Se,Ze,Ne,Pi],styles:[".sezione-impostazioni[_ngcontent-%COMP%], .profile-info[_ngcontent-%COMP%], .color-form[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--background2) 50%,transparent);border-radius:var(--border-radius);padding:var(--padding-h);margin-bottom:var(--padding-h);border:1px solid var(--secondary);color:var(--text-light);width:100%;box-sizing:border-box}.sezione-impostazioni[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%], .profile-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--primary);font-weight:600}.sezione-impostazioni[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:var(--padding-v) 0;display:flex;flex-wrap:wrap;gap:var(--padding-v)}.location-section[_ngcontent-%COMP%], .scorte-section[_ngcontent-%COMP%], .description-section[_ngcontent-%COMP%]{padding:var(--padding-v) 0;margin:var(--padding-h) 0;border-top:1px solid var(--secondary)}h3[_ngcontent-%COMP%]{padding:0;margin:0}.social-section[_ngcontent-%COMP%]{width:100%}.social-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--padding-h);padding:var(--padding-v) 0}.social-icon[_ngcontent-%COMP%]{width:var(--font-size-xl);height:var(--font-size-xl);flex:0 0 var(--font-size-xl);fill:var(--primary);opacity:.95}.social-link[_ngcontent-%COMP%]{text-decoration:none;color:var(--text-light);word-break:break-all}.not-present[_ngcontent-%COMP%]{color:var(--text-muted);font-style:italic}.social-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.profile-info[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{width:clamp(18px,2.5vw,20px);height:clamp(18px,2.5vw,20px);accent-color:var(--primary);margin-right:var(--padding-v)}.checkbox-label[_ngcontent-%COMP%]{font-size:var(--font-size-base);font-weight:500;align-items:center;display:flex}.simple-mode[_ngcontent-%COMP%], .advanced-mode[_ngcontent-%COMP%]{margin:var(--padding-v) 0;padding:0}.dipendenti-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--padding-v);margin:var(--padding-v) 0;padding:var(--padding-v)}.dipendente-card[_ngcontent-%COMP%]{padding:0;border-radius:var(--border-radius);border:1px solid var(--secondary);transition:all .3s ease}.dipendente-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 2px 8px color-mix(in srgb,var(--secondary) 40%,transparent)}.dipendente-header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:start;flex-direction:column;gap:var(--padding-v)}.dipendente-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--text-light);margin:0;font-size:var(--font-size-lg);font-weight:600}.servizi-checkboxes[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(min(100%,clamp(180px,25vw,220px)),1fr));gap:clamp(.4rem,1.2vw,.6rem)}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:clamp(.4rem,1.2vw,.6rem);cursor:pointer;color:var(--text-light);font-weight:500;font-size:clamp(.85rem,1.6vw,.95rem);padding:clamp(.3rem,.8vw,.5rem);border-radius:6px;transition:all .2s ease}.checkbox-label[_ngcontent-%COMP%]:hover{background:#ffffff0d}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:clamp(16px,2.2vw,18px);height:clamp(16px,2.2vw,18px);accent-color:var(--primary)}.dipendente-servizi[_ngcontent-%COMP%]{overflow-y:auto;margin:var(--padding-h) 0}.servizi-chips-container[_ngcontent-%COMP%]{padding:var(--padding-v)}.servizi-chips-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--padding-v);flex-wrap:wrap;gap:var(--padding-v);font-size:var(--font-size-base);font-weight:700}.btn-chip-toggle[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--primary);color:var(--primary);padding:var(--padding-v);border-radius:16px;font-size:var(--font-size-base);cursor:pointer;transition:all .2s ease}.btn-chip-toggle[_ngcontent-%COMP%]:hover{background:var(--background2)}.servizi-chips-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--padding-v)}.servizi-group[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--background2) 30%,transparent);border-radius:var(--border-radius);padding:var(--padding-v)}.servizi-group-title[_ngcontent-%COMP%]{color:var(--primary);margin:0;font-size:var(--font-size-base);font-weight:600;margin-bottom:var(--padding-v)}.chips-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--padding-v)}.chip[_ngcontent-%COMP%]{padding:.5rem .8rem;background:var(--background);border:1px solid color-mix(in srgb,var(--text-light) 30%,transparent);border-radius:20px;cursor:pointer;transition:all .2s ease;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.chip[_ngcontent-%COMP%]:hover{border-color:var(--primary);transform:translateY(-1px)}.chip.selected[_ngcontent-%COMP%]{background:var(--primary);color:var(--background);border-color:var(--secondary);font-weight:500}.chip[_ngcontent-%COMP%]:focus{outline:2px solid var(--primary);outline-offset:2px}.selected-count[_ngcontent-%COMP%]{margin-top:var(--padding-v);color:var(--text-muted);text-align:center}.edit-dipendente-form[_ngcontent-%COMP%]{width:100%;display:block;box-sizing:border-box;padding:var(--padding-v) 0;margin-top:.5rem;flex-direction:column}.dipendente-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--padding-v);justify-content:flex-end;margin-top:var(--padding-h);width:100%;box-sizing:border-box;padding:0 var(--padding-v);flex-wrap:nowrap}.dipendente-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;color:var(--primary)}.dipendente-header-compact[_ngcontent-%COMP%]{background:var(--background2);border-radius:var(--border-radius);font-size:var(--font-size-lg);font-weight:600;min-height:32px;padding:var(--padding-v);cursor:pointer;display:flex;align-items:center;justify-content:space-between;min-height:40px}.dipendente-details[_ngcontent-%COMP%]{background:transparent;border-radius:var(--border-radius);padding:var(--padding-v)}.dipendente-ruolo[_ngcontent-%COMP%]{color:var(--text-light);font-size:var(--font-size-lg);margin-left:var(--padding-v);font-weight:400}.dipendente-orari-section[_ngcontent-%COMP%]{margin-top:var(--padding-h);padding-top:var(--padding-v)}.giorno-settimana[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background:color-mix(in srgb,var(--primary) 15%,transparent);border-radius:var(--border-radius);padding:var(--padding-v)}.interval-row[_ngcontent-%COMP%]{display:flex;gap:var(--padding-v);align-items:center;margin:var(--padding-v) 0;background:color-mix(in srgb,var(--background2) 30%,transparent);padding:var(--padding-v);border-radius:var(--border-radius);flex-wrap:wrap}.orari-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:var(--padding-v);margin:var(--padding-h) 0}.summary-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--padding-v);align-items:stretch;justify-content:space-between}.day-name[_ngcontent-%COMP%]{font-weight:700;color:var(--primary)}.hours-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{margin-right:var(--padding-v);display:inline-block}.no-hours[_ngcontent-%COMP%]{font-weight:700;color:var(--text-muted)}.hours-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .closed[_ngcontent-%COMP%], .hours-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .has-hours[_ngcontent-%COMP%]{font-weight:500}.add-dipendente-section[_ngcontent-%COMP%]{margin:var(--padding-v);border-top:1px solid color-mix(in srgb,var(--text-light) 30%,transparent);padding:var(--padding-h) 0}.add-dipendente-form[_ngcontent-%COMP%]{border-radius:var(--border-radius);margin-top:var(--padding-v)}.add-dipendente-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--padding-v);margin-bottom:var(--padding-v);align-items:stretch}.add-dipendente-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .add-dipendente-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:var(--padding-m);border:1px solid color-mix(in srgb,var(--secondary) 70%,transparent);border-radius:var(--border-radius);background-color:var(--background2);color:var(--text-light);font-size:var(--font-size-base);transition:all .3s ease;box-sizing:border-box;resize:none}.add-dipendente-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;gap:var(--padding-v);justify-content:right;margin-top:var(--padding-v)}.appointment-settings-section[_ngcontent-%COMP%], .dipendente-card[_ngcontent-%COMP%], .add-dipendente-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{width:100%;box-sizing:border-box}.logo-upload-section[_ngcontent-%COMP%]{margin-bottom:var(--padding-v);flex:0 0 clamp(140px,26%,240px);min-width:140px;align-self:flex-start;padding:var(--padding-h);border-radius:var(--border-radius);background:color-mix(in srgb,var(--background2) 50%,transparent);border:1px solid var(--secondary);box-sizing:border-box;display:flex;flex-direction:column;gap:var(--padding-v)}.current-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;max-width:220px;object-fit:contain;border-radius:8px;display:block}.upload-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--padding-v);flex-wrap:wrap}.file-name[_ngcontent-%COMP%]{color:var(--text-light);max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.color-picker-group[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;gap:clamp(.8rem,1.5vw,1.2rem);margin-bottom:clamp(1rem,1.8vw,1.5rem)}.color-picker-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{min-width:100px;font-weight:600;color:var(--primary);font-size:var(--font-size-lg)}.color-preview[_ngcontent-%COMP%]{width:clamp(48px,5vw,86px);height:clamp(48px,5vw,86px);border-radius:var(--border-radius);border:2px solid color-mix(in srgb,var(--text-light) 70%,transparent);box-shadow:0 3px 8px color-mix(in srgb,var(--background) 70%,transparent);transition:transform .3s ease}.color-preview[_ngcontent-%COMP%]:hover{transform:scale(1.1)}"]})};function yJ(n,e){if(n&1&&(g(0,"div",5),ie(1,"img",6),p()),n&2){let t=E();_(),x("src",t.prodotto.immagine,kt)("alt",t.prodotto==null?null:t.prodotto.nome)}}function bJ(n,e){if(n&1&&(g(0,"p",7),v(1),Me(2,"currency"),p()),n&2){let t=E();_(),J("Prezzo: ",Te(2,1,t.prodotto.prezzo,"EUR"))}}function wJ(n,e){if(n&1&&(g(0,"p",8),v(1),p()),n&2){let t=E();_(),q(t.prodotto.descrizione)}}function SJ(n,e){n&1&&(g(0,"h3"),v(1," Caratteristiche tecniche "),p())}function CJ(n,e){if(n&1&&(g(0,"li")(1,"strong"),v(2),p(),v(3),p()),n&2){let t=e.$implicit,i=E(2);_(2),J("",t,":"),_(),J(" ",i.prodotto.caratteristiche[t]," ")}}function EJ(n,e){if(n&1&&(g(0,"ul"),N(1,CJ,4,2,"li",9),p()),n&2){let t=E();_(),x("ngForOf",t.objectKeys(t.prodotto.caratteristiche))}}var Mp=class n{constructor(e,t,i){this.route=e;this.productService=t;this.supabaseService=i}prodottoId;prodotto={nome:"",immagine:"",prezzo:null,descrizione:"",caratteristiche:{}};objectKeys=Object.keys;ngOnInit(){return C(this,null,function*(){let e=this.route.snapshot.paramMap.get("type")||"mine",t=this.route.snapshot.paramMap.get("id");if(!t){console.error("ID mancante nella route");return}this.prodottoId=t;try{if(e==="franchising"){let i=yield this.productService.getFranchisingProductById(t);if(!i){console.warn("Prodotto franchising non trovato",t);return}this.prodotto={nome:i.name??"",immagine:i.image_path?yield this.supabaseService.getPublicLogoUrl(i.image_path):"",prezzo:i.price??null,descrizione:i.description??"",caratteristiche:i.attributes??{}}}else{let i=yield this.getMyProductFromSupabase(t);if(!i){console.warn("Prodotto personale non trovato",t);return}this.prodotto={nome:i.name??"",immagine:i.image_path?yield this.supabaseService.getPublicLogoUrl(i.image_path):"",prezzo:i.price??null,descrizione:i.description??i.usage??"",caratteristiche:i.attributes??{}}}}catch(i){console.error("Errore caricamento dettaglio prodotto",i)}})}getMyProductFromSupabase(e){return C(this,null,function*(){try{let{data:t,error:i}=yield this.supabaseService.getClient().from("products").select("*").eq("id",e).single();return i?(console.error("Errore recupero prodotto:",i),null):t}catch(t){return console.error("Errore critico recupero prodotto:",t),null}})}static \u0275fac=function(t){return new(t||n)(z(qt),z(Es),z(ue))};static \u0275cmp=he({type:n,selectors:[["app-product-detail"]],decls:8,vars:6,consts:[[1,"prodotto-dettaglio-container"],["class","immagine-prodotto",4,"ngIf"],["class","prezzo",4,"ngIf"],["class","descrizione",4,"ngIf"],[4,"ngIf"],[1,"immagine-prodotto"],[3,"src","alt"],[1,"prezzo"],[1,"descrizione"],[4,"ngFor","ngForOf"]],template:function(t,i){t&1&&(g(0,"div",0)(1,"h2"),v(2),p(),N(3,yJ,2,2,"div",1)(4,bJ,3,4,"p",2)(5,wJ,2,1,"p",3)(6,SJ,2,0,"h3",4)(7,EJ,2,1,"ul",4),p()),t&2&&(_(2),q(i.prodotto==null?null:i.prodotto.nome),_(),x("ngIf",i.prodotto==null?null:i.prodotto.immagine),_(),x("ngIf",(i.prodotto==null?null:i.prodotto.prezzo)!==null),_(),x("ngIf",i.prodotto==null?null:i.prodotto.descrizione),_(),x("ngIf",(i.prodotto==null?null:i.prodotto.caratteristiche)&&i.objectKeys(i.prodotto.caratteristiche).length>0),_(),x("ngIf",i.prodotto==null?null:i.prodotto.caratteristiche))},dependencies:[Se,Ze,Ne,Sr],styles:[".prodotto-dettaglio-container[_ngcontent-%COMP%]{max-width:800px;margin:2rem auto;padding:2rem;background-color:var(--background);color:var(--text-light);border-radius:12px;box-shadow:0 4px 12px #0000001a}.immagine-prodotto[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:400px;object-fit:contain;border-radius:12px;margin-bottom:1.5rem}.prezzo[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:700;color:var(--primary);margin-bottom:1rem}.descrizione[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:2rem}h3[_ngcontent-%COMP%]{color:var(--primary);margin-bottom:.8rem}ul[_ngcontent-%COMP%]{list-style-type:none;padding-left:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:.3rem 0;font-size:1rem;border-bottom:1px solid rgba(255,255,255,.1)}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--secondary)}"]})};function xJ(n,e){n&1&&(g(0,"div",46),v(1,"Nome \xE8 obbligatorio"),p())}function DJ(n,e){n&1&&(g(0,"div",46),v(1,"Cognome \xE8 obbligatorio"),p())}function IJ(n,e){n&1&&(g(0,"div",46),v(1,"Email non valida"),p())}function MJ(n,e){n&1&&(g(0,"div",46),v(1,"Numero di telefono non valido"),p())}function TJ(n,e){n&1&&(g(0,"div",46),v(1,"Sesso \xE8 obbligatorio"),p())}function PJ(n,e){if(n&1){let t=ee();g(0,"div",26)(1,"label",47),v(2,"Sesso"),p(),g(3,"select",48,9),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.formData.sesso,r)||(o.formData.sesso=r),R(r)}),g(5,"option",18),v(6,"Seleziona sesso"),p(),g(7,"option",49),v(8,"Maschile"),p(),g(9,"option",50),v(10,"Femminile"),p(),g(11,"option",51),v(12,"Altro"),p()(),N(13,TJ,2,0,"div",29),p()}if(n&2){let t=Ve(4),i=E(2);_(3),G("ngModel",i.formData.sesso),_(10),x("ngIf",t.invalid&&t.touched)}}function AJ(n,e){n&1&&(g(0,"div",46),v(1,"Data di nascita \xE8 obbligatoria"),p())}function RJ(n,e){n&1&&(g(0,"div",46),v(1,"Luogo di nascita \xE8 obbligatorio"),p())}function kJ(n,e){n&1&&(g(0,"div",46),v(1,"Ragione sociale \xE8 obbligatoria"),p())}function OJ(n,e){n&1&&(g(0,"div",46),v(1,"Partita IVA non valida (11 numeri)"),p())}function NJ(n,e){n&1&&(g(0,"div",46),v(1,"PEC non valida"),p())}function LJ(n,e){if(n&1){let t=ee();g(0,"div",52)(1,"label",53),v(2,"Ragione Sociale"),p(),g(3,"input",54,10),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.formData.ragioneSociale,r)||(o.formData.ragioneSociale=r),R(r)}),p(),N(5,kJ,2,0,"div",29),g(6,"label",55),v(7,"Partita IVA"),p(),g(8,"input",56,11),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.formData.piva,r)||(o.formData.piva=r),R(r)}),p(),N(10,OJ,2,0,"div",29),g(11,"label",57),v(12,"PEC"),p(),g(13,"input",58,12),Z("ngModelChange",function(r){A(t);let o=E(2);return Y(o.formData.pec,r)||(o.formData.pec=r),R(r)}),p(),N(15,NJ,2,0,"div",29),p()}if(n&2){let t=Ve(4),i=Ve(9),r=Ve(14),o=E(2);_(3),G("ngModel",o.formData.ragioneSociale),_(2),x("ngIf",t.invalid&&t.touched),_(3),G("ngModel",o.formData.piva),_(2),x("ngIf",i.invalid&&i.touched),_(3),G("ngModel",o.formData.pec),_(2),x("ngIf",r.invalid&&r.touched)}}function FJ(n,e){n&1&&(g(0,"div",46),v(1,"Password richiesta (min 8)"),p())}function zJ(n,e){n&1&&(g(0,"div",46),v(1," Le password non corrispondono "),p())}function VJ(n,e){if(n&1){let t=ee();tt(0),g(1,"div",25)(2,"div",26)(3,"label",27),v(4,"Nome"),p(),g(5,"input",28,1),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.formData.nome,r)||(o.formData.nome=r),R(r)}),p(),N(7,xJ,2,0,"div",29),p(),g(8,"div",26)(9,"label",30),v(10,"Cognome"),p(),g(11,"input",31,2),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.formData.cognome,r)||(o.formData.cognome=r),R(r)}),p(),N(13,DJ,2,0,"div",29),p()(),g(14,"label",32),v(15,"Email"),p(),g(16,"input",33,3),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.formData.email,r)||(o.formData.email=r),R(r)}),p(),N(18,IJ,2,0,"div",29),g(19,"label",34),v(20,"Numero di Telefono"),p(),g(21,"input",35,4),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.formData.telefono,r)||(o.formData.telefono=r),R(r)}),p(),N(23,MJ,2,0,"div",29),g(24,"div",25),N(25,PJ,14,2,"div",36),g(26,"div",26)(27,"label",37),v(28,"Data di Nascita"),p(),g(29,"input",38,5),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.formData.dataNascita,r)||(o.formData.dataNascita=r),R(r)}),p(),N(31,AJ,2,0,"div",29),p()(),g(32,"label",39),v(33,"Luogo di Nascita"),p(),g(34,"input",40,6),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.formData.luogoNascita,r)||(o.formData.luogoNascita=r),R(r)}),p(),N(36,RJ,2,0,"div",29)(37,LJ,16,6,"div",41),g(38,"label",42),v(39,"Password"),p(),g(40,"input",43,7),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.formData.password,r)||(o.formData.password=r),R(r)}),p(),N(42,FJ,2,0,"div",29),g(43,"label",44),v(44,"Conferma Password"),p(),g(45,"input",45,8),Z("ngModelChange",function(r){A(t);let o=E();return Y(o.formData.confirmPassword,r)||(o.formData.confirmPassword=r),R(r)}),p(),N(47,zJ,2,0,"div",29),nt()}if(n&2){let t=Ve(6),i=Ve(12),r=Ve(17),o=Ve(22),s=Ve(30),l=Ve(35),c=Ve(41),u=Ve(46),f=E();_(5),G("ngModel",f.formData.nome),_(2),x("ngIf",t.invalid&&t.touched),_(4),G("ngModel",f.formData.cognome),_(2),x("ngIf",i.invalid&&i.touched),_(3),G("ngModel",f.formData.email),_(2),x("ngIf",r.invalid&&r.touched),_(3),G("ngModel",f.formData.telefono),_(2),x("ngIf",o.invalid&&o.touched),_(2),x("ngIf",f.userType==="user"),_(4),G("ngModel",f.formData.dataNascita),_(2),x("ngIf",s.invalid&&s.touched),_(3),G("ngModel",f.formData.luogoNascita),_(2),x("ngIf",l.invalid&&l.touched),_(),x("ngIf",f.userType==="admin"),_(3),G("ngModel",f.formData.password),_(2),x("ngIf",c.invalid&&c.touched),_(3),G("ngModel",f.formData.confirmPassword),_(2),x("ngIf",u.touched&&f.formData.confirmPassword!==f.formData.password)}}function jJ(n,e){if(n&1&&(g(0,"div",59),v(1),p()),n&2){let t=E();_(),q(t.errorMsg)}}function BJ(n,e){if(n&1&&(g(0,"div",60),v(1),p()),n&2){let t=E();_(),q(t.successMsg)}}var D0=class n{constructor(e,t,i,r){this.route=e;this.router=t;this.inviteService=i;this.clientService=r;this.supabase=lo(Nn.supabaseUrl,Nn.supabaseAnonKey)}userType="";formData={nome:"",cognome:"",email:"",telefono:"",sesso:"",dataNascita:"",luogoNascita:"",ragioneSociale:"",piva:"",pec:"",password:"",confirmPassword:""};loading=!1;errorMsg="";successMsg="";inviteToken=null;salonId=null;supabase;ngOnInit(){return C(this,null,function*(){this.route.queryParams.subscribe(e=>{this.inviteToken=e.invite||null,this.inviteToken&&this.loadInviteData()})})}loadInviteData(){return C(this,null,function*(){if(this.inviteToken)try{let e=yield this.inviteService.getInviteByToken(this.inviteToken);e&&!e.used&&new Date(e.expires_at)>new Date?(this.salonId=e.salon_id,e.email&&(this.formData.email=e.email)):(this.errorMsg="Invito non valido o scaduto",this.inviteToken=null)}catch(e){console.error("Errore nel caricamento dell'invito:",e),this.errorMsg="Errore nel caricamento dell'invito",this.inviteToken=null}})}validateForm(){if(!this.userType)return"Seleziona il tipo di utente";if(!this.formData.nome.trim()||!this.formData.cognome.trim())return"Nome e cognome sono obbligatori";if(!this.formData.email.trim())return"Email \xE8 obbligatoria";if(!this.formData.telefono.trim())return"Numero di telefono \xE8 obbligatorio";if(this.userType==="user"&&!this.formData.sesso)return"Seleziona il sesso";if(!this.formData.dataNascita)return"Seleziona la data di nascita";if(!this.formData.luogoNascita.trim())return"Inserisci il luogo di nascita";if(!this.formData.password||this.formData.password.length<8)return"La password deve contenere almeno 8 caratteri";if(this.formData.password!==this.formData.confirmPassword)return"Le password non corrispondono";if(this.userType==="admin"){if(!this.formData.ragioneSociale.trim())return"Ragione sociale \xE8 obbligatoria per admin";if(!this.formData.piva||!/^[0-9]{11}$/.test(this.formData.piva))return"Partita IVA non valida (deve contenere 11 numeri)";if(!this.formData.pec.trim())return"PEC \xE8 obbligatoria per admin"}return null}normalizeEmail(e){if(!e)return"";let t=e.toString().replace(/^"+|"+$/g,"").trim().toLowerCase();return t=t.replace(/\s+/g,""),t}validateEmailFormat(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}onSubmit(){return C(this,null,function*(){this.errorMsg="",this.successMsg="";let e=this.validateForm();if(e){this.errorMsg=e;return}this.loading=!0;try{let t=this.normalizeEmail(this.formData.email);if(!this.validateEmailFormat(t)){this.errorMsg="indirizzo email non valido. Usa un formato tipo nome@dominio.it",this.loading=!1;return}if(this.formData.email=t,this.userType==="admin"&&this.formData.pec&&(this.formData.pec=this.normalizeEmail(this.formData.pec),!this.validateEmailFormat(this.formData.pec))){this.errorMsg="PEC non valida. Controlla il formato.",this.loading=!1;return}let i={email:t,password:this.formData.password,options:{data:{first_name:this.formData.nome.trim(),last_name:this.formData.cognome.trim(),role:this.userType==="admin"?"admin":"customer"}}};console.log("[register] calling signUp with payload:",i);let{data:r,error:o}=yield this.supabase.auth.signUp(i);if(console.log("[register] signUpData:",r),console.log("[register] signUpError:",o),o){console.error("[register] signUpError full:",o),this.errorMsg=o.message||"Errore durante la registrazione",this.loading=!1;return}let s=r.user?.id||null;if(s){let c=[{id:s,first_name:this.formData.nome.trim()||null,last_name:this.formData.cognome.trim()||null,full_name:`${this.formData.nome.trim()} ${this.formData.cognome.trim()}`.trim()||null,email:t,role:this.userType==="admin"?"admin":"customer",telefono:this.formData.telefono.trim()||null,sesso:this.formData.sesso||null,data_nascita:this.formData.dataNascita?this.formData.dataNascita:null,luogo_nascita:this.formData.luogoNascita.trim()||null,ragione_sociale:this.userType==="admin"&&this.formData.ragioneSociale.trim()||null,piva:this.userType==="admin"&&this.formData.piva||null,pec:this.userType==="admin"&&this.formData.pec.trim()||null,created_at:new Date().toISOString()}];console.log("[register] profile upsert payloadArray:",JSON.stringify(c,null,2));let{data:u,error:f}=yield this.supabase.from("profiles").upsert(c,{onConflict:"id"}).select();if(console.log("[register] profile upsert response:",u,f),f){console.error("[register] profile upsert error object:",f);let m=f.details??f.message??JSON.stringify(f);this.errorMsg=`Errore durante il salvataggio del profilo: ${m}`,this.loading=!1;return}if(this.inviteToken&&this.salonId)try{yield this.inviteService.markInviteAsUsed(this.inviteToken);let m=yield this.clientService.createClient({first_name:this.formData.nome,last_name:this.formData.cognome,email:this.formData.email,phone:this.formData.telefono,profile_id:s,salon_id:this.salonId,sesso:this.formData.sesso,data_nascita:this.formData.dataNascita});yield this.clientService.addClientToSalon(m.id,this.salonId)}catch(m){console.error("Errore nella gestione dell'invito:",m)}}else{this.successMsg="Registrazione effettuata. Controlla la tua email per confermare l'account. Il profilo verr\xE0 creato automaticamente dopo la conferma.",this.loading=!1;return}this.successMsg="Registrazione completata. Controlla la tua email per confermare (se richiesto).",this.formData={nome:"",cognome:"",email:"",telefono:"",sesso:"",dataNascita:"",luogoNascita:"",ragioneSociale:"",piva:"",pec:"",password:"",confirmPassword:""},this.userType=""}catch(t){console.error("[register] unexpected error",t),this.errorMsg=t?.message||"Errore imprevisto durante la registrazione"}finally{this.loading=!1}})}static \u0275fac=function(t){return new(t||n)(z(qt),z(We),z(ud),z(ir))};static \u0275cmp=he({type:n,selectors:[["app-register"]],decls:19,vars:6,consts:[["registerForm","ngForm"],["nome","ngModel"],["cognome","ngModel"],["email","ngModel"],["telefono","ngModel"],["dataNascita","ngModel"],["luogoNascita","ngModel"],["password","ngModel"],["confirmPassword","ngModel"],["sesso","ngModel"],["ragioneSociale","ngModel"],["piva","ngModel"],["pec","ngModel"],[1,"register-container"],[1,"section-title"],["novalidate","",3,"ngSubmit"],["for","userType"],["id","userType","name","userType","required","",3,"ngModelChange","ngModel"],["value","","disabled",""],["value","user"],["value","admin"],[4,"ngIf"],["type","submit",3,"disabled"],["class","error-msg",4,"ngIf"],["class","success-msg",4,"ngIf"],[1,"row"],[1,"col"],["for","nome"],["type","text","id","nome","name","nome","required","",3,"ngModelChange","ngModel"],["class","error",4,"ngIf"],["for","cognome"],["type","text","id","cognome","name","cognome","required","",3,"ngModelChange","ngModel"],["for","email"],["type","email","id","email","name","email","required","","email","",3,"ngModelChange","ngModel"],["for","telefono"],["type","tel","id","telefono","name","telefono","required","","pattern","^[0-9+ ]{6,15}$",3,"ngModelChange","ngModel"],["class","col",4,"ngIf"],["for","dataNascita"],["type","date","id","dataNascita","name","dataNascita","required","",3,"ngModelChange","ngModel"],["for","luogoNascita"],["type","text","id","luogoNascita","name","luogoNascita","required","",3,"ngModelChange","ngModel"],["class","admin-fields",4,"ngIf"],["for","password"],["type","password","id","password","name","password","required","","minlength","8",3,"ngModelChange","ngModel"],["for","confirmPassword"],["type","password","id","confirmPassword","name","confirmPassword","required","",3,"ngModelChange","ngModel"],[1,"error"],["for","sesso"],["id","sesso","name","sesso","required","",3,"ngModelChange","ngModel"],["value","M"],["value","F"],["value","O"],[1,"admin-fields"],["for","ragioneSociale"],["type","text","id","ragioneSociale","name","ragioneSociale","required","",3,"ngModelChange","ngModel"],["for","piva"],["type","text","id","piva","name","piva","required","","pattern","^[0-9]{11}$",3,"ngModelChange","ngModel"],["for","pec"],["type","email","id","pec","name","pec","required","","email","",3,"ngModelChange","ngModel"],[1,"error-msg"],[1,"success-msg"]],template:function(t,i){if(t&1){let r=ee();g(0,"div",13)(1,"h2",14),v(2,"Registrazione"),p(),g(3,"form",15,0),F("ngSubmit",function(){return A(r),R(i.onSubmit())}),g(5,"label",16),v(6,"Tipo Utente"),p(),g(7,"select",17),Z("ngModelChange",function(s){return A(r),Y(i.userType,s)||(i.userType=s),R(s)}),g(8,"option",18),v(9,"Seleziona tipo utente"),p(),g(10,"option",19),v(11,"Utente normale"),p(),g(12,"option",20),v(13,"Barbiere / Parrucchiere"),p()(),N(14,VJ,48,18,"ng-container",21),g(15,"button",22),v(16),p(),N(17,jJ,2,1,"div",23)(18,BJ,2,1,"div",24),p()()}if(t&2){let r=Ve(4);_(7),G("ngModel",i.userType),_(7),x("ngIf",i.userType),_(),x("disabled",!i.userType||r.invalid||i.loading),_(),J(" ",i.loading?"Registrazione...":"Registrati"," "),_(),x("ngIf",i.errorMsg),_(),x("ngIf",i.successMsg)}},dependencies:[Se,Ne,vt,bi,Ot,Nt,st,Dt,at,yi,Ln,Pf,xE,CE,pt,Ir],styles:['.register-container[_ngcontent-%COMP%], .register-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{box-sizing:border-box;background:transparent}.register-container[_ngcontent-%COMP%]{margin:36px auto;padding:24px;background:linear-gradient(180deg,var(--background2),rgba(0,0,0,.6));border-radius:12px;border:1px solid rgba(255,255,255,.05);color:var(--text-light);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial;box-shadow:0 6px 30px #0009}.register-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 18px;font-size:1.4rem;color:var(--text-light);text-align:center;letter-spacing:.6px}.register-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:600;font-size:.92rem;margin-bottom:8px;color:var(--gold-light);background:transparent}.row[_ngcontent-%COMP%]{display:flex;gap:14px;margin-top:8px;margin-bottom:6px;flex-wrap:wrap}.col[_ngcontent-%COMP%]{flex:1 1 220px;min-width:160px}.register-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .register-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .register-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border-radius:8px;border:1px solid rgba(212,175,55,.12);color:var(--text-light);font-size:.98rem;outline:none;transition:border-color .18s ease,box-shadow .18s ease,transform .08s}.register-container[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{color:#e6e6e68c}.register-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .register-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .register-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:var(--primary);box-shadow:0 4px 18px #cc9c001f;transform:translateY(-1px);background:transparent!important}.register-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:linear-gradient(45deg,transparent 50%,var(--text-light) 50%),linear-gradient(135deg,var(--text-light) 50%,transparent 50%);background-position:calc(100% - 18px) calc(1em + 2px),calc(100% - 13px) calc(1em + 2px);background-size:5px 5px,5px 5px;background-repeat:no-repeat;padding-right:36px}.admin-fields[_ngcontent-%COMP%]{margin-top:16px;padding-top:14px;border-top:1px solid rgba(212,175,55,.06)}.register-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{margin-top:20px;width:100%;padding:12px 16px;font-size:1.02rem;font-weight:700;background:linear-gradient(90deg,var(--primary),var(--secondary));color:var(--bg-black);border:none;border-radius:10px;cursor:pointer;box-shadow:0 6px 18px #c4a33c1f;transition:transform .12s ease,box-shadow .12s ease,opacity .12s}.register-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.register-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:disabled{opacity:.55;cursor:not-allowed;transform:none;box-shadow:none}.error[_ngcontent-%COMP%]{color:#ff7b7b;font-size:.85rem;margin-top:6px;margin-bottom:1rem}.error-msg[_ngcontent-%COMP%]{color:#ff6b6b;margin-top:14px;font-weight:700;text-align:center}.success-msg[_ngcontent-%COMP%]{color:#7fe38a;margin-top:14px;font-weight:700;text-align:center}.helper[_ngcontent-%COMP%]{font-size:.82rem;color:#e6e6e699;margin-top:6px}@media (max-width: 480px){.register-container[_ngcontent-%COMP%]{padding:18px;margin:18px}.row[_ngcontent-%COMP%]{gap:10px}.col[_ngcontent-%COMP%]{min-width:120px}}.register-container[_ngcontent-%COMP%]   input[disabled][_ngcontent-%COMP%], .register-container[_ngcontent-%COMP%]   select[disabled][_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed}input[_ngcontent-%COMP%]:-webkit-autofill{box-shadow:0 0 0 1000px transparent inset!important;-webkit-box-shadow:0 0 0px 1000px transparent inset!important;-webkit-text-fill-color:var(--text-light)!important}.register-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .register-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:var(--text-light);background-color:var(--background)}.register-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;padding-right:40px;position:relative}.register-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--primary)}.register-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background-color:var(--background);color:var(--text-light)}.register-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]::-ms-expand{display:none}.register-container[_ngcontent-%COMP%]   .select-wrapper[_ngcontent-%COMP%]{position:relative}.register-container[_ngcontent-%COMP%]   .select-wrapper[_ngcontent-%COMP%]:after{content:"";position:absolute;right:12px;top:50%;width:8px;height:8px;transform:translateY(-50%) rotate(45deg);border-right:2px solid var();border-bottom:2px solid var(--text-light);pointer-events:none}']})};function UJ(n,e){if(n&1&&(g(0,"div",23),v(1),p()),n&2){let t=E();_(),q(t.errorMsg)}}function HJ(n,e){n&1&&(g(0,"div",24),v(1,"Non hai un account? "),g(2,"a",25),v(3,"Registrati"),p()())}var I0=class n{constructor(e){this.router=e;this.supabase=lo(Nn.supabaseUrl,Nn.supabaseAnonKey)}email="";password="";remember=!1;loading=!1;errorMsg="";showPassword=!1;supabase;toggleShowPassword(){this.showPassword=!this.showPassword}normalizeEmail(e){if(!e)return"";let t=e.toString().replace(/^"+|"+$/g,"").trim().toLowerCase();return t=t.replace(/\s+/g,""),t}onSubmit(e){return C(this,null,function*(){if(this.errorMsg="",e&&e.invalid){this.errorMsg="Compila tutti i campi richiesti.";return}let t=this.normalizeEmail(this.email);if(!t){this.errorMsg="Inserisci una email valida";return}if(!this.password){this.errorMsg="Inserisci la password";return}this.loading=!0;try{let{data:i,error:r}=yield this.supabase.auth.signInWithPassword({email:t,password:this.password});if(r){console.error("[login] signIn error",r),this.errorMsg=r.message||"Errore durante il login",this.loading=!1;return}let o=i?.user?.id??i?.session?.user?.id??null;if(!o){this.errorMsg="Login effettuato ma non \xE8 stato possibile recuperare l'utente. Controlla la mail di conferma se richiesta.",this.loading=!1;return}let{data:s,error:l}=yield this.supabase.from("profiles").select("role,salon_id,first_name,last_name").eq("id",o).maybeSingle();if(l){console.warn("[login] profile fetch error",l),this.router.navigate(["/user/home"]);return}(s?.role??"customer")==="admin"?yield this.router.navigate(["/admin/home"]):yield this.router.navigate(["/user/home"])}catch(i){console.error("[login] unexpected",i),this.errorMsg=i?.message||"Errore imprevisto"}finally{this.loading=!1}})}signOut(){return C(this,null,function*(){yield this.supabase.auth.signOut(),this.router.navigate(["/"])})}static \u0275fac=function(t){return new(t||n)(z(We))};static \u0275cmp=he({type:n,selectors:[["app-login"]],decls:34,vars:13,consts:[["f","ngForm"],["emailRef","ngModel"],["pwRef","ngModel"],[1,"container"],[2,"display","flex","align-items","center","flex-direction","column"],[1,"login-card"],[1,"section-title"],["novalidate","",1,"login-form",3,"ngSubmit"],[1,"form-group"],["for","email",1,"label"],["id","email","name","email","type","email","required","","placeholder","es. nome@dominio.it","autocomplete","email",3,"ngModelChange","ngModel"],[1,"error"],["for","password",1,"label"],[1,"password-wrapper",2,"position","relative"],["id","password","name","password","required","","minlength","8","placeholder","La tua password","autocomplete","current-password",3,"ngModelChange","type","ngModel"],["type","button","aria-label","Mostra password",1,"eye-btn","btn-icon",2,"position","absolute","right","0.5rem","top","50%","transform","translateY(-50%)",3,"click"],[1,"row-opts"],[1,"remember"],["type","checkbox","name","remember",3,"ngModelChange","ngModel"],["routerLink","/forgot-password",1,"forgot"],["type","submit",1,"btn-primary",3,"disabled"],["class","error-message",4,"ngIf"],["class","hint",4,"ngIf"],[1,"error-message"],[1,"hint"],["routerLink","/register",2,"text-decoration","none","font-weight","800","color","rgba(233, 233, 233, 0.712)"]],template:function(t,i){if(t&1){let r=ee();g(0,"div",3)(1,"div",4)(2,"div",5)(3,"h2",6),v(4,"Accedi"),p(),g(5,"form",7,0),F("ngSubmit",function(){A(r);let s=Ve(6);return R(i.onSubmit(s))}),g(7,"div",8)(8,"label",9),v(9,"Email"),p(),g(10,"input",10,1),Z("ngModelChange",function(s){return A(r),Y(i.email,s)||(i.email=s),R(s)}),p(),g(12,"div",11),v(13," Email obbligatoria "),p()(),g(14,"div",8)(15,"label",12),v(16,"Password"),p(),g(17,"div",13)(18,"input",14,2),Z("ngModelChange",function(s){return A(r),Y(i.password,s)||(i.password=s),R(s)}),p(),g(20,"button",15),F("click",function(){return A(r),R(i.toggleShowPassword())}),v(21),p()(),g(22,"div",11),v(23," Password richiesta (min 8) "),p()(),g(24,"div",16)(25,"label",17)(26,"input",18),Z("ngModelChange",function(s){return A(r),Y(i.remember,s)||(i.remember=s),R(s)}),p(),v(27," Ricordami "),p(),g(28,"a",19),v(29,"Password dimenticata?"),p()(),g(30,"button",20),v(31),p(),N(32,UJ,2,1,"div",21)(33,HJ,4,0,"div",22),p()()()()}if(t&2){let r=Ve(6),o=Ve(11),s=Ve(19);_(10),G("ngModel",i.email),_(2),Oe("visible",o.invalid&&o.touched),_(6),x("type",i.showPassword?"text":"password"),G("ngModel",i.password),_(3),J(" ",i.showPassword?"\u{1F648}":"\u{1F441}\uFE0F"," "),_(),Oe("visible",s.invalid&&s.touched),_(4),G("ngModel",i.remember),_(4),x("disabled",i.loading||r.invalid),_(),J(" ",i.loading?"Caricamento...":"Accedi"," "),_(),x("ngIf",i.errorMsg),_(),x("ngIf",!i.errorMsg)}},dependencies:[Se,Ne,vt,bi,st,Dr,at,yi,Ln,Pf,pt,Ir,bt,sn],styles:["[_ngcontent-%COMP%]:root{--card-bg: linear-gradient(180deg, var(--background2), rgba(0,0,0,.65))}.login-card[_ngcontent-%COMP%]{max-width:420px;margin:var(--padding-h);padding:var(--padding-v);border-radius:var(--border-radius);background:var(--card-bg);color:var(--text-light);border:1px solid color-mix(in srgb,var(--text-light) 20%,transparent);box-shadow:0 10px 40px #0009;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial}.login-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 14px;color:var(--primary);font-size:var(--font-size-xl);text-align:center}.login-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.login-form[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:var(--primary);font-weight:600}.login-form[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .login-form[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .login-form[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{padding:var(--padding-v);border-radius:var(--border-radius);border:1px solid color-mix(in srgb,var(--text-light) 30%,transparent);background:transparent;color:var(--text-light);font-size:var(--font-size-base);outline:none;transition:box-shadow .14s ease,transform .08s}.password-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.password-wrapper[_ngcontent-%COMP%]   .eye-btn[_ngcontent-%COMP%]{position:absolute;right:10px;background:transparent;border:none;color:var(--text-light);font-size:var(--font-size-base);cursor:pointer}.row-opts[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:var(--padding-v);font-size:var(--font-size-base)}.row-opts[_ngcontent-%COMP%]   .remember[_ngcontent-%COMP%]{color:var(--text-muted);display:flex;align-items:center;gap:var(--padding-v);padding:var(--padding-v)}.row-opts[_ngcontent-%COMP%]   .forgot[_ngcontent-%COMP%]{color:var(--text-light);text-decoration:none;font-weight:700;padding:var(--padding-v)}.hint[_ngcontent-%COMP%]{color:#e6e6e699;text-align:center;margin-top:8px;font-size:.92rem}"]})};var WJ=n=>["/user/nuovo-appuntamento",n],$J=()=>["/user/lista-barbieri"];function qJ(n,e){n&1&&(g(0,"div",6)(1,"p"),v(2,"Caricamento informazioni del salone..."),p(),ie(3,"div",7),p())}function GJ(n,e){if(n&1&&(g(0,"div",8)(1,"p"),v(2),p(),g(3,"button",9),v(4,"Torna alla lista"),p()()),n&2){let t=E();_(2),q(t.error)}}function ZJ(n,e){if(n&1&&(g(0,"div",28)(1,"a",29),v(2),p()()),n&2){let t=E(2);_(),x("href",t.salone.sito_web,kt),_(),J(" ",t.salone.sito_web," ")}}function YJ(n,e){if(n&1&&(g(0,"span",36),v(1),p()),n&2){let t=E().$implicit,i=E(3);_(),J(" ",i.formatIntervals(t.intervals)," ")}}function QJ(n,e){n&1&&(g(0,"span",37),v(1,"Chiuso"),p())}function KJ(n,e){if(n&1&&(g(0,"div",33)(1,"strong",34),v(2),p(),N(3,YJ,2,1,"span",35)(4,QJ,2,0,"ng-template",null,0,$t),p()),n&2){let t=e.$implicit,i=Ve(5);_(2),J("",t.day_name,":"),_(),x("ngIf",t.intervals==null?null:t.intervals.length)("ngIfElse",i)}}function JJ(n,e){if(n&1&&(g(0,"div",30)(1,"h2"),v(2,"Orari di Apertura"),p(),g(3,"div",31),N(4,KJ,6,3,"div",32),p()()),n&2){let t=E(2);_(4),x("ngForOf",t.openingHours)}}function XJ(n,e){if(n&1&&(g(0,"a",44),ie(1,"i",45),v(2," Facebook "),p()),n&2){let t=E(3);x("href",t.socials.facebook,kt)}}function eX(n,e){if(n&1&&(g(0,"a",46),ie(1,"i",47),v(2," Instagram "),p()),n&2){let t=E(3);x("href",t.socials.instagram,kt)}}function tX(n,e){if(n&1&&(g(0,"a",48),ie(1,"i",49),v(2," LinkedIn "),p()),n&2){let t=E(3);x("href",t.socials.linkedin,kt)}}function nX(n,e){if(n&1&&(g(0,"a",50),ie(1,"i",51),v(2," WhatsApp "),p()),n&2){let t=E(3);x("href","https://wa.me/"+t.socials.whatsapp,kt)}}function iX(n,e){if(n&1&&(g(0,"div",38)(1,"h2"),v(2,"Seguici sui social"),p(),g(3,"div",39),N(4,XJ,3,1,"a",40)(5,eX,3,1,"a",41)(6,tX,3,1,"a",42)(7,nX,3,1,"a",43),p()()),n&2){let t=E(2);_(4),x("ngIf",t.socials.facebook),_(),x("ngIf",t.socials.instagram),_(),x("ngIf",t.socials.linkedin),_(),x("ngIf",t.socials.whatsapp)}}function rX(n,e){if(n&1&&(g(0,"div",52)(1,"h2"),v(2,"Descrizione"),p(),g(3,"p",53),v(4),p()()),n&2){let t=E(2);_(4),q(t.salone.descrizione)}}function oX(n,e){if(n&1&&(g(0,"div",59)(1,"h3"),v(2),p()()),n&2){let t=E().$implicit;_(2),q(t.name)}}function sX(n,e){if(n&1){let t=ee();g(0,"div",60),F("click",function(){A(t);let r=E().index,o=E(3);return R(o.toggleFlip(r))}),g(1,"div",61)(2,"div",62)(3,"h3"),v(4),p(),g(5,"p",63),v(6),Me(7,"currency"),p()(),g(8,"div",64)(9,"p",65),v(10),p()()()()}if(n&2){let t=E(),i=t.$implicit,r=t.index,o=E(3);Oe("flipped",o.flippedCards[r]),_(4),q(i.name),_(2),q(Te(7,5,i.price,"EUR")),_(4),q(i.description||"Nessuna descrizione disponibile")}}function aX(n,e){if(n&1&&(tt(0),N(1,oX,3,1,"div",57)(2,sX,11,8,"div",58),nt()),n&2){let t=e.$implicit;_(),x("ngIf",t.isGroupHeader),_(),x("ngIf",!t.isGroupHeader)}}function lX(n,e){if(n&1&&(g(0,"div",54)(1,"h2"),v(2,"Servizi offerti"),p(),g(3,"div",55),N(4,aX,3,2,"ng-container",56),p()()),n&2){let t=E(2);_(4),x("ngForOf",t.services)}}function cX(n,e){n&1&&(g(0,"div",66)(1,"p"),v(2,"Nessun servizio disponibile al momento"),p()())}function dX(n,e){if(n&1&&(g(0,"div",10)(1,"div",11)(2,"div",12),ie(3,"img",13),p(),g(4,"div",14)(5,"h1"),v(6),p(),N(7,ZJ,3,2,"div",15),p()(),g(8,"div",16)(9,"div",17)(10,"h2"),v(11,"Contatti"),p(),g(12,"div",18)(13,"div")(14,"strong"),v(15,"Telefono:"),p(),v(16),p(),g(17,"div")(18,"strong"),v(19,"Email:"),p(),g(20,"a",19),v(21),p()(),g(22,"div")(23,"strong"),v(24,"Indirizzo:"),p(),v(25),p()()(),N(26,JJ,5,1,"div",20),p(),N(27,iX,8,4,"div",21)(28,rX,5,1,"div",22)(29,lX,5,1,"div",23)(30,cX,3,0,"div",24),g(31,"div",25)(32,"button",26),v(33," Prenota Appuntamento "),p(),g(34,"button",27),v(35," Torna indietro "),p()()()),n&2){let t=E();_(3),x("alt",ha("Logo ",t.salone.ragione_sociale))("src",t.salone.logo_url||"/assets/default-salon.png",kt),_(3),q(t.salone.ragione_sociale),_(),x("ngIf",t.salone.sito_web),_(9),J(" ",t.salone.telefono||"\u2014"),_(4),x("href","mailto:"+t.salone.email,kt),_(),q(t.salone.email),_(4),J(" ",t.salone.indirizzo),_(),x("ngIf",t.openingHours.length>0),_(),x("ngIf",t.hasSocials()),_(),x("ngIf",t.salone.descrizione),_(),x("ngIf",t.services.length),_(),x("ngIf",!t.services.length),_(2),x("routerLink",Wi(16,WJ,t.salone.id)),_(2),x("routerLink",_S(18,$J))}}var M0=class n{constructor(e,t,i,r,o,s){this.route=e;this.router=t;this.location=i;this.admin=r;this.supabase=o;this.openingHoursService=s}saloneId=null;salone=null;loading=!0;error=null;services=[];openingHours=[];socials={};flippedCards={};ngOnInit(){if(this.saloneId=this.route.snapshot.paramMap.get("id"),!this.saloneId){this.error="ID salone non specificato.",this.loading=!1;return}this.loadSalone(this.saloneId)}loadSalone(e){return C(this,null,function*(){try{let t=yield this.admin.getAdminById(e);console.log("Dati salone:",t),this.salone=t,this.services=this.organizeServices(t.services||[]),this.openingHours=yield this.openingHoursService.getOpeningHours(e),console.log("Orari di apertura:",this.openingHours),this.socials=yield this.supabase.getProfileSocials(e),console.log("Social del salone:",this.socials),this.salone||(this.error="Salone non trovato.")}catch(t){console.error("Errore nel caricamento del salone",t),this.error="Errore nel caricamento dei dati."}finally{this.loading=!1}})}toggleFlip(e){this.flippedCards[e]=!this.flippedCards[e]}formatIntervals(e=[]){return!e||e.length===0?"Chiuso":e.map(t=>`${t.start} - ${t.end}`).join(" - ")}hasSocials(){return!!this.socials&&(!!this.socials.facebook||!!this.socials.instagram||!!this.socials.linkedin||!!this.socials.whatsapp)}organizeServices(e){let t=new Map,i=[];e.forEach(s=>{s.is_group&&t.set(s.id,ne(B({},s),{children:[]}))}),e.forEach(s=>{s.is_group||(s.parent_id&&t.has(s.parent_id)?t.get(s.parent_id).children.push(s):i.push(s))}),t.forEach(s=>{s.children.sort((l,c)=>(l.order_index??0)-(c.order_index??0))});let r=[],o=Array.from(t.values()).sort((s,l)=>(s.order_index??0)-(l.order_index??0));for(let s of o)r.push(ne(B({},s),{isGroupHeader:!0})),r.push(...s.children);return i.sort((s,l)=>(s.order_index??0)-(l.order_index??0)),r.push(...i),r}static \u0275fac=function(t){return new(t||n)(z(qt),z(We),z(eo),z(_o),z(ue),z(vo))};static \u0275cmp=he({type:n,selectors:[["app-salone-detail"]],decls:5,vars:3,consts:[["closed",""],[1,"container"],[1,"card-content",2,"padding","1.5rem"],["class","loading-container",4,"ngIf"],["class","error-container",4,"ngIf"],["class","salone-profile",4,"ngIf"],[1,"loading-container"],[1,"spinner"],[1,"error-container"],["routerLink","/barbieri"],[1,"salone-profile"],[1,"salone-header"],[1,"salone-logo-wrap"],[1,"salone-logo",3,"src","alt"],[1,"salone-info"],["class","salone-website",4,"ngIf"],[1,"contact-hours-container"],[1,"contact-section"],[1,"contact-info"],[3,"href"],["class","opening-hours-section",4,"ngIf"],["class","social-section",4,"ngIf"],["class","description-section",4,"ngIf"],["class","services-section",4,"ngIf"],["class","no-services",4,"ngIf"],[1,"actions"],[1,"btn-primary",3,"routerLink"],[1,"btn",3,"routerLink"],[1,"salone-website"],["target","_blank",1,"website-link",3,"href"],[1,"opening-hours-section"],[1,"opening-hours"],["class","opening-day",4,"ngFor","ngForOf"],[1,"opening-day"],[1,"day-name"],["class","has-hours",4,"ngIf","ngIfElse"],[1,"has-hours"],[1,"closed"],[1,"social-section"],[1,"social-links"],["target","_blank","class","social-link facebook",3,"href",4,"ngIf"],["target","_blank","class","social-link instagram",3,"href",4,"ngIf"],["target","_blank","class","social-link linkedin",3,"href",4,"ngIf"],["target","_blank","class","social-link whatsapp",3,"href",4,"ngIf"],["target","_blank",1,"social-link","facebook",3,"href"],[1,"fab","fa-facebook"],["target","_blank",1,"social-link","instagram",3,"href"],[1,"fab","fa-instagram"],["target","_blank",1,"social-link","linkedin",3,"href"],[1,"fab","fa-linkedin"],["target","_blank",1,"social-link","whatsapp",3,"href"],[1,"fab","fa-whatsapp"],[1,"description-section"],[1,"salone-description"],[1,"services-section"],[1,"services-grid"],[4,"ngFor","ngForOf"],["class","service-group",4,"ngIf"],["class","service-card",3,"flipped","click",4,"ngIf"],[1,"service-group"],[1,"service-card",3,"click"],[1,"card-inner"],[1,"card-front"],[1,"price"],[1,"card-back"],[1,"description"],[1,"no-services"]],template:function(t,i){t&1&&(g(0,"div",1)(1,"div",2),N(2,qJ,4,0,"div",3)(3,GJ,5,1,"div",4)(4,dX,36,19,"div",5),p()()),t&2&&(_(2),x("ngIf",i.loading),_(),x("ngIf",i.error),_(),x("ngIf",i.salone&&!i.loading))},dependencies:[Se,Ze,Ne,bt,sn,Sr],styles:[".salone-detail[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:var(--padding-v) var(--padding-h)}.salone-header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:clamp(1rem,3vw,2rem);margin-bottom:clamp(1.5rem,3vw,2rem);align-items:center}.salone-logo[_ngcontent-%COMP%]{width:clamp(100px,20vw,150px);height:clamp(100px,20vw,150px);border-radius:var(--border-radius);object-fit:cover;border:2px solid var(--primary);box-shadow:0 4px 12px #0003}.salone-info[_ngcontent-%COMP%]{flex:1;min-width:min(100%,300px)}.salone-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 clamp(.5rem,1vw,.8rem) 0;color:var(--primary);font-size:var(--font-size-xl);line-height:1.2}.website-link[_ngcontent-%COMP%]{display:inline-block;color:var(--primary);font-weight:600;margin-top:clamp(.3rem,1vw,.5rem);word-break:break-all;text-decoration:none}.website-link[_ngcontent-%COMP%]:hover{text-decoration:underline;text-underline-offset:.2rem}.contact-section[_ngcontent-%COMP%]{margin-bottom:clamp(1.5rem,3vw,2rem);padding-bottom:clamp(1rem,2vw,1.5rem);border-bottom:1px solid rgba(255,255,255,.1)}.opening-hours[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.opening-day[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem;background:#ffffff08;border-radius:8px}.contact-section[_ngcontent-%COMP%], .opening-hours-section[_ngcontent-%COMP%]{flex:1;min-width:min(100%,300px)}.services-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .opening-hours-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .contact-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .description-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--primary);font-size:var(--font-size-xl);margin-bottom:clamp(1rem,1.5vw,1.2rem);border-bottom:2px solid var(--primary);padding-bottom:.3rem;display:inline-block}.contact-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.3rem;margin-bottom:clamp(.8rem,1.5vw,1rem);padding:.5rem;background:#ffffff08;border-radius:8px}.contact-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600;color:var(--text-light)}.contact-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary);text-decoration:none;word-break:break-all}.contact-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.description-section[_ngcontent-%COMP%]{margin-bottom:clamp(1.5rem,3vw,2rem)}.salone-description[_ngcontent-%COMP%]{line-height:1.7;color:var(--text-light);padding:clamp(.8rem,1.5vw,1rem);background:#ffffff08;border-radius:8px;white-space:pre-wrap}.services-section[_ngcontent-%COMP%]{margin-top:clamp(1.5rem,3vw,2rem)}.services-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(clamp(200px,45%,300px),1fr));gap:var(--padding-h);margin:var(--padding-v) 0}.service-group[_ngcontent-%COMP%]{grid-column:1 / -1;background-color:var(--background2);padding:var(--padding-v);text-align:center;border-radius:.5rem;font-weight:700;margin-top:var(--padding-v);font-size:var(--font-size-base)}.service-card[_ngcontent-%COMP%]{perspective:1200px;min-height:clamp(180px,15vw,280px);background:var(--background2);border-radius:var(--border-radius);border:1px solid var(--secondary);transition:all .4s ease,transform .6s ease;padding:var(--padding-v);cursor:pointer;overflow:hidden;box-shadow:0 6px 16px color-mix(in srgb,var(--primary) 30%,transparent)}.service-card[_ngcontent-%COMP%]:hover{transform:translateY(-6px) scale(1.03);box-shadow:0 12px 28px color-mix(in srgb,var(--primary) 50%,transparent);border-color:var(--primary)}.card-inner[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;transition:transform .6s;transform-style:preserve-3d;border-radius:var(--border-radius)}.service-card[_ngcontent-%COMP%]:hover   .card-inner[_ngcontent-%COMP%]{transform:rotateY(180deg)}.card-front[_ngcontent-%COMP%], .card-back[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;backface-visibility:hidden;padding:clamp(1rem,1.5vw,1.2rem);box-sizing:border-box;border-radius:var(--border-radius)}.card-front[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between}.card-back[_ngcontent-%COMP%]{transform:rotateY(180deg);overflow-y:auto;background:#1e1e1ef2;display:flex;align-items:center;justify-content:center;padding:clamp(1rem,1.5vw,1.5rem)}.service-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 clamp(.5rem,1vw,.8rem) 0;color:var(--primary);font-size:clamp(1.2rem,2vw,1.4rem);line-height:1.3}.service-card[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-weight:700;font-size:clamp(1.3rem,2vw,1.5rem);color:var(--text-light);margin:0}.service-card[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:var(--text-light);line-height:1.6;font-size:clamp(.9rem,1.5vw,1rem);margin:0}.no-services[_ngcontent-%COMP%]{text-align:center;padding:clamp(1.5rem,2vw,2rem);background:#ffffff08;border-radius:var(--border-radius);border:1px dashed rgba(255,255,255,.1);color:var(--text-muted)}.actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:clamp(.8rem,1.5vw,1rem);margin-top:clamp(1.5rem,3vw,2rem)}.btn-book[_ngcontent-%COMP%]{flex:1;min-width:min(100%,250px)}.btn-back[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--text-muted);color:var(--text-light)}.btn-back[_ngcontent-%COMP%]:hover{background:#ffffff1a;border-color:var(--text-light)}.salone-logo[_ngcontent-%COMP%]{width:clamp(100px,20vw,150px);height:auto;max-height:clamp(100px,20vw,150px);border-radius:var(--border-radius);object-fit:contain;display:block;margin:0;border:2px solid var(--primary);box-shadow:0 4px 12px #0003;background:#ffffff05;padding:4px}.contact-hours-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:2rem;margin-bottom:clamp(1.5rem,3vw,2rem);padding-bottom:clamp(1rem,2vw,1.5rem);border-bottom:1px solid rgba(255,255,255,.1)}.day-name[_ngcontent-%COMP%]{color:var(--text-light);font-weight:600}.closed[_ngcontent-%COMP%]{color:var(--text-muted);font-style:italic}.has-hours[_ngcontent-%COMP%]{color:var(--primary)}@media (max-width: 768px){.opening-day[_ngcontent-%COMP%]{flex-direction:column;gap:.3rem}}.social-section[_ngcontent-%COMP%]{margin-bottom:clamp(1.5rem,3vw,2rem);padding-bottom:clamp(1rem,2vw,1.5rem);border-bottom:1px solid rgba(255,255,255,.1)}.social-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--primary);font-size:var(--font-size-lg);margin-bottom:clamp(1rem,1.5vw,1.2rem);border-bottom:2px solid var(--primary);padding-bottom:.3rem;display:inline-block}.social-links[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem}.social-link[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem 1rem;border-radius:8px;text-decoration:none;color:#fff;font-weight:500;transition:all .3s ease}.social-link[_ngcontent-%COMP%]:hover{opacity:.9;transform:translateY(-2px)}.social-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem;font-size:1.2rem}.social-link.facebook[_ngcontent-%COMP%]{background-color:#3b5998}.social-link.instagram[_ngcontent-%COMP%]{background:linear-gradient(45deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888)}.social-link.linkedin[_ngcontent-%COMP%]{background-color:#0077b5}.social-link.whatsapp[_ngcontent-%COMP%]{background-color:#25d366}@media (max-width: 768px){.social-links[_ngcontent-%COMP%]{flex-direction:column}.social-link[_ngcontent-%COMP%]{justify-content:center}}@media (hover: none){.service-card[_ngcontent-%COMP%]{transform:none!important;box-shadow:none!important}.card-inner[_ngcontent-%COMP%]{transform:none!important;transition:none!important}.card-back[_ngcontent-%COMP%]{position:relative;transform:none;backface-visibility:visible;margin-top:1rem;border-top:1px solid rgba(212,175,55,.3);padding-top:1rem}}"]})};var T0=class n{constructor(e,t,i){this.supabase=e;this.dipendentiService=t;this.appointmentService=i}appointmentSubscription=null;checkSimpleAvailability(e,t,i,r){return C(this,null,function*(){let{data:o,error:s}=yield this.supabase.getClient().from("appointments").select("id").eq("salon_id",e).lt("start_time",i).gt("end_time",t).neq("status","cancelled");return s?(console.error("Error checking simple availability:",s),!1):(o?.length||0)<r})}checkAdvancedAvailability(e,t,i,r){return C(this,null,function*(){let o=yield this.dipendentiService.getDipendentiByServizio(e,r);if(o.length===0)return!1;for(let s of o)if(yield this.isDipendenteAvailable(s.id,t,i))return!0;return!1})}isDipendenteAvailable(e,t,i){return C(this,null,function*(){let{data:r,error:o}=yield this.supabase.getClient().from("appointments").select("id").eq("dipendente_id",e).lt("start_time",i).gt("end_time",t).neq("status","cancelled");if(o)return console.error("Error checking dipendente availability:",o),!1;if(r&&r.length>0)return!1;try{let{data:s,error:l}=yield this.supabase.getClient().from("dipendenti").select("orari_lavoro").eq("id",e).single();if(l)throw l;let c=s?.orari_lavoro;if(!c||c.fulltime===!0)return!0;let u=new Date(t),f=u.getDay().toString(),m=`${u.getHours().toString().padStart(2,"0")}:${u.getMinutes().toString().padStart(2,"0")}`;if(!c[f]||c[f].length===0)return!1;let[w,b]=m.split(":").map(Number),D=w*60+b;for(let T of c[f]){let[M,P]=T.start.split(":").map(Number),[U,K]=T.end.split(":").map(Number),W=M*60+P,re=U*60+K;if(D>=W&&D<=re)return!0}return!1}catch(s){return console.error("Errore verifica orari dipendente:",s),!1}})}checkAvailability(e,t,i,r,o,s){return C(this,null,function*(){try{if(o==="simple")return this.checkSimpleAvailability(e,t,i,s);{let l=yield this.checkAdvancedAvailability(e,t,i,r);return l||this.checkSimpleAvailability(e,t,i,s)}}catch(l){return console.error("Error in checkAvailability:",l),!1}})}getDayAppointmentsForSalon(e,t){return C(this,null,function*(){let i=new Date(t);i.setHours(0,0,0,0);let r=new Date(t);r.setHours(23,59,59,999);let{data:o,error:s}=yield this.supabase.getClient().from("appointments").select("*").eq("salon_id",e).gte("start_time",i.toISOString()).lte("start_time",r.toISOString()).neq("status","cancelled");return s?(console.error("Error getting day appointments:",s),[]):o||[]})}checkSimpleAvailabilityWithPreloaded(e,t,i,r){return e.filter(s=>{let l=new Date(s.start_time),c=new Date(s.end_time),u=new Date(t),f=new Date(i);return l<f&&c>u}).length<r}getDayAppointmentsForDipendenti(e,t,i){return C(this,null,function*(){let r=yield this.dipendentiService.getDipendentiByServizio(e,t),o=new Map,s=new Date(i+"T00:00:00").toISOString(),l=new Date(i+"T23:59:59").toISOString();return yield Promise.all(r.map(c=>C(this,null,function*(){let f=((yield this.appointmentService.getAppointmentsByDipendenteAndTimeRange(c.id,s,l))||[]).filter(m=>m.status!=="cancelled");o.set(c.id,{dipendente:c,appointments:f})}))),o})}checkAdvancedAvailabilityWithPreloaded(e,t,i){return C(this,null,function*(){let r=new Date(t),o=new Date(i),s=t.slice(0,10),l=r.getDay(),c=r.toTimeString().slice(0,5),u=o.toTimeString().slice(0,5);for(let[f,m]of e.entries()){let w=m.dipendente,b=m.appointments||[];if(w.assente)if(w.assente_fino){let M=new Date(w.assente_fino),P=new Date(s+"T00:00:00"),U=new Date(M.getFullYear(),M.getMonth(),M.getDate());if(new Date(P.getFullYear(),P.getMonth(),P.getDate())<=U)continue}else continue;let D=w.orari_lavoro||{fulltime:!0};if(D.fulltime!==!0){let M=String(l),P=Array.isArray(D[M])?D[M]:[];if(P.length===0)continue;let U=!1;for(let K of P)if(this.intervalContains(K.start,K.end,c,u)){U=!0;break}if(!U)continue}let T=!1;for(let M of b){let P=new Date(M.start_time),U=new Date(M.end_time);if(!(o<=P||r>=U)){T=!0;break}}if(!T)return!0}return!1})}timeStrToMinutes(e){let[t,i]=e.split(":").map(Number);return t*60+i}intervalContains(e,t,i,r){let o=this.timeStrToMinutes(e),s=this.timeStrToMinutes(t),l=this.timeStrToMinutes(i),c=this.timeStrToMinutes(r);return l>=o&&c<=s}static \u0275fac=function(t){return new(t||n)(te(ue),te(_i),te(qn))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};function fX(n,e){if(n&1&&(tt(0),v(1),nt()),n&2){let t=E().$implicit;_(),J(" \u2014 ",t.timing," min ")}}function pX(n,e){if(n&1&&(tt(0),v(1),Me(2,"number"),nt()),n&2){let t=E().$implicit;_(),J(" \u2014 \u20AC",Te(2,1,t.price,"1.0-2")," ")}}function hX(n,e){if(n&1&&(g(0,"option",22),v(1),N(2,fX,2,1,"ng-container",23)(3,pX,3,4,"ng-container",23),p()),n&2){let t=e.$implicit;x("value",t.id)("disabled",t.isGroup),_(),J(" ",t.name," "),_(),x("ngIf",t.timing!==void 0&&!t.isGroup),_(),x("ngIf",t.price!=null&&!t.isGroup)}}function gX(n,e){if(n&1){let t=ee();g(0,"li")(1,"button",19),F("click",function(){let r=A(t).$implicit,o=E(3);return R(o.pickSlot(r))}),v(2),p()()}if(n&2){let t=e.$implicit,i=E(3);_(),Oe("selected",i.form.value.time===t),_(),J(" ",i.getSlotLabel(t,(i.selectedService==null?null:i.selectedService.timing)??30)," ")}}function mX(n,e){if(n&1&&(g(0,"div")(1,"div",25),v(2,"Mattina"),p(),g(3,"ul",26),N(4,gX,3,3,"li",27),p()()),n&2){let t=E(2);_(4),x("ngForOf",t.morningSlots)}}function vX(n,e){if(n&1){let t=ee();g(0,"li")(1,"button",19),F("click",function(){let r=A(t).$implicit,o=E(3);return R(o.pickSlot(r))}),v(2),p()()}if(n&2){let t=e.$implicit,i=E(3);_(),Oe("selected",i.form.value.time===t),_(),J(" ",i.getSlotLabel(t,(i.selectedService==null?null:i.selectedService.timing)??30)," ")}}function _X(n,e){if(n&1&&(g(0,"div")(1,"div",25),v(2,"Pomeriggio"),p(),g(3,"ul",26),N(4,vX,3,3,"li",27),p()()),n&2){let t=E(2);_(4),x("ngForOf",t.afternoonSlots)}}function yX(n,e){if(n&1&&(g(0,"div",3)(1,"div",15)(2,"label"),v(3,"Orari disponibili "),g(4,"span",6),v(5,"*"),p()(),g(6,"div",24),N(7,mX,5,1,"div",23)(8,_X,5,1,"div",23),p()()()),n&2){let t=E();_(7),x("ngIf",t.morningSlots.length>0),_(),x("ngIf",t.afternoonSlots.length>0)}}function bX(n,e){n&1&&(g(0,"div",28),v(1," Nessun orario disponibile per questa data. "),p())}function wX(n,e){n&1&&(g(0,"div",29)(1,"div",30),ie(2,"div",31),g(3,"p"),v(4,"Caricamento in corso..."),p()()())}var P0=class n{constructor(e,t,i,r,o,s,l,c,u,f){this.route=e;this.fb=t;this.admin=i;this.router=r;this.supabase=o;this.appointment=s;this.profileService=l;this.openingHoursService=c;this.dipendentiService=u;this.availabilityService=f}form;salonId="";services=[];timeslots=[];availableSlots=[];submitting=!1;loading=!1;appointmentSettings={mode:"simple",maxConcurrentAppointments:1};minDate=this.todayString();errorMessage="";morningSlots=[];afternoonSlots=[];salonSettingsCache=null;sub;ngOnInit(){return C(this,null,function*(){this.salonId=this.route.snapshot.paramMap.get("salonId")||"",this.form=this.fb.group({service_id:["",co.required],date:[this.todayString(),co.required],time:["",co.required],notes:[""]}),yield this.loadSalonSettings(),this.loadServices(),this.sub=Ys([this.form.get("service_id").valueChanges.pipe(dr(this.form.value.service_id)),this.form.get("date").valueChanges.pipe(dr(this.form.value.date))]).subscribe(([e,t])=>{e&&t?this.loadTimeSlots(t,e):(this.timeslots=[],this.availableSlots=[])})})}ngOnDestroy(){this.sub?.unsubscribe()}todayString(){let e=new Date,t=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${e.getFullYear()}-${t}-${i}`}pickSlot(e){this.form.patchValue({time:e})}loadSalonSettings(){return C(this,null,function*(){if(this.salonSettingsCache){this.appointmentSettings=this.salonSettingsCache;return}try{let e=yield this.profileService.getSalonSettings(this.salonId);console.log("Salon settings:",e),e&&(this.appointmentSettings={mode:e.appointment_mode||"simple",maxConcurrentAppointments:e.max_concurrent_appointments||1},this.salonSettingsCache=this.appointmentSettings)}catch(e){console.error("Errore caricamento impostazioni salone:",e)}})}loadServices(){return C(this,null,function*(){if(this.salonId){this.loading=!0;try{let e=yield this.admin.getAdminById(this.salonId);this.services=Array.isArray(e.services)?e.services.map(t=>({id:t.id,name:t.name,price:t.price??null,timing:t.timing??30,isGroup:t.is_group===!0,parent_id:t.parent_id??null,order_index:t.order_index??0})):[],this.orderServices()}catch(e){console.error("Errore caricamento servizi salone",e),this.services=[]}finally{this.loading=!1}}})}loadTimeSlots(e,t){return C(this,null,function*(){console.log("Loading slots for:",e,t),console.log("Appointment mode:",this.appointmentSettings.mode);let i=new Date(e+"T00:00:00"),r=new Date;if(r.setHours(0,0,0,0),i<r){this.availableSlots=[],this.errorMessage="Non \xE8 possibile prenotare in una data passata",this.loading=!1;return}this.loading=!0,this.availableSlots=[],this.errorMessage="";try{let s=new Date(e+"T00:00:00").getDay(),l=yield this.openingHoursService.getOpeningHoursForSalon(this.salonId,s);if(console.log("Opening hours:",l),!l||!l.intervals||l.intervals.length===0){this.availableSlots=[],this.errorMessage="Il salone \xE8 chiuso in questa data",this.loading=!1;return}let u=this.services.find(T=>T.id===t)?.timing??30,f=[],m=new Map;if(this.appointmentSettings.mode==="simple"?f=yield this.availabilityService.getDayAppointmentsForSalon(this.salonId,e):m=yield this.availabilityService.getDayAppointmentsForDipendenti(this.salonId,t,e),this.timeslots=this.generateTimeSlots(l.intervals,e,u),e===this.todayString()){let T=new Date;this.timeslots=this.timeslots.filter(M=>{let[P,U]=M.split(":").map(Number),K=new Date;return K.setHours(P,U,0,0),K>T})}let w=yield this.checkSlotsAvailabilityOptimized(e,t,this.timeslots,u,f,m);this.availableSlots=this.timeslots.filter((T,M)=>w[M]);let{morning:b,afternoon:D}=this.splitSlotsByTime(this.availableSlots);this.morningSlots=b,this.afternoonSlots=D,this.availableSlots.length===0&&(this.errorMessage="Nessun orario disponibile per questa data")}catch{this.errorMessage="Errore nel caricamento della disponibilit\xE0"}finally{this.loading=!1}})}checkSlotsAvailabilityOptimized(e,t,i,r,o,s){return C(this,null,function*(){let l=i.map(c=>{let u=new Date(`${e}T${c}:00`),f=new Date(u.getTime()+r*60*1e3),m=u.toISOString(),w=f.toISOString();return this.appointmentSettings.mode==="simple"?this.availabilityService.checkSimpleAvailabilityWithPreloaded(o,m,w,this.appointmentSettings.maxConcurrentAppointments):this.availabilityService.checkAdvancedAvailabilityWithPreloaded(s,m,w)});return Promise.all(l)})}checkSlotAvailability(e,t,i){return C(this,null,function*(){try{let r=new Date(`${e}T${t}:00`);if(r<new Date)return!1;let s=this.services.find(f=>f.id===i)?.timing||30,l=new Date(r.getTime()+s*60*1e3),c=r.toISOString(),u=l.toISOString();return yield this.availabilityService.checkAvailability(this.salonId,c,u,i,this.appointmentSettings.mode,this.appointmentSettings.maxConcurrentAppointments)}catch(r){return console.error("Errore verifica disponibilit\xE0 slot:",r),!1}})}submit(){return C(this,null,function*(){if(!(this.form.invalid||this.submitting||!this.form.value.time)){this.submitting=!0,this.errorMessage="";try{let{service_id:e,date:t,time:i,notes:r}=this.form.value;if(new Date(`${t}T${i}:00`)<new Date){this.errorMessage="Non \xE8 possibile prenotare appuntamenti nel passato",this.submitting=!1;return}if(!(yield this.checkSlotAvailability(t,i,e))){this.errorMessage="Questo orario non \xE8 pi\xF9 disponibile. Si prega di sceglierne un altro.",this.submitting=!1;return}let l=this.services.find(M=>M.id===e),c=l?.timing??30,u=new Date(`${t}T${i}:00`),f=new Date(u.getTime()+c*60*1e3),m=u.toISOString(),w=f.toISOString(),D=(yield this.supabase.getMyProfile(!0))?.id;if(!D){this.errorMessage="Devi essere autenticato per prenotare.",this.submitting=!1;return}let T;if(this.appointmentSettings.mode==="advanced"&&(T=yield this.trovaDipendenteDisponibile(t,i,e),!T)){this.errorMessage="Nessun dipendente disponibile per questo orario.",this.submitting=!1;return}yield this.appointment.createAppointment({salon_id:this.salonId,client_id:D,service_id:e,start_time:m,end_time:w,price:l?.price??void 0,notes:r?.trim()||void 0,status:"confirmed",dipendente_id:T,source:"client"}),alert("Appuntamento prenotato con successo!"),this.router.navigate(["/user/salone",this.salonId])}catch(e){console.error(e),this.errorMessage=e.message||"Errore nella prenotazione. Riprova."}finally{this.submitting=!1}}})}goBack(){this.router.navigate(["/user/salone",this.salonId])}generateTimeSlots(e,t,i){let r=[],o=new Date(t+"T00:00:00");return e.forEach(s=>{let[l,c]=s.start.split(":").map(Number),[u,f]=s.end.split(":").map(Number),m=new Date(o);m.setHours(l,c,0,0);let w=new Date(o);for(w.setHours(u,f,0,0);m<w&&!(new Date(m.getTime()+i*6e4)>w);){let D=String(m.getHours()).padStart(2,"0"),T=String(m.getMinutes()).padStart(2,"0");r.push(`${D}:${T}`),m=new Date(m.getTime()+15*6e4)}}),r}trovaDipendenteDisponibile(e,t,i){return C(this,null,function*(){try{let o=this.services.find(m=>m.id===i)?.timing||30,s=new Date(`${e}T${t}:00`),l=new Date(s.getTime()+o*60*1e3),c=s.toISOString(),u=l.toISOString(),f=yield this.availabilityService.getDayAppointmentsForDipendenti(this.salonId,i,e);for(let[m,w]of f.entries()){let b=w.dipendente,D=w.appointments||[];if(b.assente){if(!b.assente_fino)continue;let P=new Date(b.assente_fino),U=new Date(e+"T00:00:00");if(new Date(U.getFullYear(),U.getMonth(),U.getDate())<=new Date(P.getFullYear(),P.getMonth(),P.getDate()))continue}let T=b.orari_lavoro||{fulltime:!0};if(T.fulltime!==!0){let P=new Date(e+"T00:00:00").getDay(),U=Array.isArray(T[String(P)])?T[String(P)]:[];if(U.length===0)continue;let K=s.toTimeString().slice(0,5),W=l.toTimeString().slice(0,5),re=!1;for(let fe of U){let[ce,le]=fe.start.split(":").map(Number),[ct,Wt]=fe.end.split(":").map(Number),Li=ce*60+le,xi=ct*60+Wt,k0=Number(K.split(":")[0])*60+Number(K.split(":")[1]),Zn=Number(W.split(":")[0])*60+Number(W.split(":")[1]);if(k0>=Li&&Zn<=xi){re=!0;break}}if(!re)continue}let M=!1;for(let P of D){let U=new Date(P.start_time),K=new Date(P.end_time);if(!(l<=U||s>=K)){M=!0;break}}if(!M)return m}return}catch(r){console.error("Errore trovaDipendenteDisponibile:",r);return}})}getSlotLabel(e,t){let[i,r]=e.split(":").map(Number),o=new Date;o.setHours(i,r,0,0);let s=new Date(o.getTime()+t*6e4),l=String(s.getHours()).padStart(2,"0"),c=String(s.getMinutes()).padStart(2,"0");return`${e} - ${l}:${c}`}get selectedService(){let e=this.form?.value?.service_id;return this.services.find(t=>t.id===e)}splitSlotsByTime(e){let t=[],i=[];return e.forEach(r=>{let[o,s]=r.split(":").map(Number);o<13?t.push(r):i.push(r)}),{morning:t,afternoon:i}}orderServices(){let e=this.services.filter(r=>r.isGroup).sort((r,o)=>(r.order_index??0)-(o.order_index??0)),t=this.services.filter(r=>!r.isGroup&&!r.parent_id).sort((r,o)=>(r.order_index??0)-(o.order_index??0)),i=[];e.forEach(r=>{i.push(r);let o=this.services.filter(s=>s.parent_id===r.id&&!s.isGroup).sort((s,l)=>(s.order_index??0)-(l.order_index??0));i.push(...o)}),i.push(...t),this.services=i}static \u0275fac=function(t){return new(t||n)(z(qt),z(qv),z(_o),z(We),z(ue),z(qn),z(wi),z(vo),z(_i),z(T0))};static \u0275cmp=he({type:n,selectors:[["app-nuovo-appuntamento"]],decls:32,vars:10,consts:[[1,"container"],[1,"section-title"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group"],["for","service"],[1,"required"],["id","service","formControlName","service_id"],["value","","disabled",""],[3,"value","disabled",4,"ngFor","ngForOf"],["for","date"],["type","date","id","date","formControlName","date",1,"form-control",3,"min"],["type","hidden","formControlName","time"],["class","form-row",4,"ngIf"],["class","no-slots-message",4,"ngIf"],[1,"form-group",2,"flex","1"],["for","notes"],["id","notes","rows","3","placeholder","Es: preferenze taglio, richieste particolari\u2026","formControlName","notes"],[1,"form-row",2,"justify-content","flex-end","gap",".6rem"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],["class","loading-overlay",4,"ngIf"],[3,"value","disabled"],[4,"ngIf"],[1,"slots-section"],[1,"slots-title"],[1,"slots-list"],[4,"ngFor","ngForOf"],[1,"no-slots-message"],[1,"loading-overlay"],[1,"universal-loader"],[1,"loader-spinner"]],template:function(t,i){if(t&1&&(g(0,"div",0)(1,"h2",1),v(2,"Prenota Appuntamento"),p(),g(3,"form",2),F("ngSubmit",function(){return i.submit()}),g(4,"div",3)(5,"div",4)(6,"label",5),v(7,"Servizio "),g(8,"span",6),v(9,"*"),p()(),g(10,"select",7)(11,"option",8),v(12,"Seleziona un servizio"),p(),N(13,hX,4,5,"option",9),p()(),g(14,"div",4)(15,"label",10),v(16,"Data"),p(),ie(17,"input",11),p(),ie(18,"input",12),p(),N(19,yX,9,2,"div",13)(20,bX,2,0,"div",14),g(21,"div",3)(22,"div",15)(23,"label",16),v(24,"Note"),p(),ie(25,"textarea",17),p()(),g(26,"div",18)(27,"button",19),F("click",function(){return i.goBack()}),v(28,"Annulla"),p(),g(29,"button",20),v(30),p()()(),N(31,wX,5,0,"div",21),p()),t&2){let r;_(3),x("formGroup",i.form),_(10),x("ngForOf",i.services),_(4),Oe("error",i.errorMessage&&((r=i.form.get("date"))==null?null:r.invalid)),x("min",i.minDate),_(2),x("ngIf",i.morningSlots.length>0||i.afternoonSlots.length>0),_(),x("ngIf",i.availableSlots.length===0&&!i.loading&&i.form.value.service_id&&i.form.value.date),_(9),x("disabled",i.form.invalid||i.submitting||!i.form.value.time),_(),J(" ",i.submitting?"Salvataggio\u2026":"Conferma Prenotazione"," "),_(),x("ngIf",i.loading)}},dependencies:[Se,Ze,Ne,Gv,bi,Ot,Nt,st,Dt,at,yi,Uc,Mf,_a],styles:[".btn.selected[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff}.loading-indicator[_ngcontent-%COMP%]{text-align:center;padding:1rem;color:var(--text-muted)}.no-slots-message[_ngcontent-%COMP%]{text-align:center;padding:1rem;color:var(--error)}.slots-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:1rem;margin-top:.5rem;margin-bottom:.5rem;padding:0;list-style:none}.slots-list[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{background:var(--background2);color:var(--primary);border:2px solid var(--primary);border-radius:10px;font-size:1.15rem;font-weight:600;padding:.5rem;margin:0;width:100%;box-shadow:0 2px 8px #d4af3714;transition:background .2s,color .2s,box-shadow .2s,border-color .2s;display:flex;align-items:center;justify-content:center;gap:.5rem}.slots-list[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,var(--primary) 0%,var(--secondary) 100%);color:var(--background);border-color:var(--primary);box-shadow:0 4px 16px #d4af372e;transform:translateY(-2px) scale(1.04)}.slots-list[_ngcontent-%COMP%]   .btn.selected[_ngcontent-%COMP%], .slots-list[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:active{background:linear-gradient(90deg,var(--primary),var(--secondary));color:var(--background);border-color:var(--primary);box-shadow:0 0 0 3px #d4af372e;font-weight:700;outline:none}.slot-time-icon[_ngcontent-%COMP%]{font-size:1.2em;margin-right:.3em;color:var(--primary);vertical-align:middle}.slots-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:var(--primary);margin-bottom:.3rem;margin-top:.7rem}.slots-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-control.error[_ngcontent-%COMP%]{border-color:#e74c3c;box-shadow:0 0 0 2px #e74c3c33}"]})};function SX(n,e){if(n&1&&(g(0,"option",31),v(1),p()),n&2){let t=e.$implicit;x("value",t),_(),J(" ",t," ")}}function CX(n,e){if(n&1&&(g(0,"option",31),v(1),p()),n&2){let t=e.$implicit;x("value",t.code),_(),yt(" ",t.code," - ",t.name," ")}}var Tp=class n{constructor(e,t,i,r,o){this.supplierService=e;this.utilityService=t;this.router=i;this.route=r;this.titleService=o}save=new ye;cancel=new ye;newSupplier={ragione_sociale:"",partita_iva:"",indirizzo:"",citta:"",provincia:"",regione:"",telefono:"",email:"",pec:"",persona_contatto:"",telefono_contatto:"",metodo_pagamento:"",iban:""};isEditMode=!1;supplierId=null;provinces=[];regions=[];filteredProvinces=[];loading=!1;error=null;ngOnInit(){return C(this,null,function*(){this.provinces=this.utilityService.getProvinces(),this.regions=this.utilityService.getRegions(),this.supplierId=this.route.snapshot.paramMap.get("id"),this.isEditMode=!!this.supplierId,this.isEditMode?(yield this.loadSupplierData(),this.titleService.setTitle("Modifica Fornitore")):this.titleService.setTitle("Aggiungi Nuovo Fornitore")})}loadSupplierData(){return C(this,null,function*(){if(this.supplierId){this.loading=!0,this.error=null;try{let e=yield this.supplierService.getSupplierById(this.supplierId);e&&(this.newSupplier={ragione_sociale:e.ragione_sociale,partita_iva:e.partita_iva,indirizzo:e.indirizzo,citta:e.citta,provincia:e.provincia,regione:e.regione||"",telefono:e.telefono||"",email:e.email||"",pec:e.pec||"",persona_contatto:e.persona_contatto||"",telefono_contatto:e.telefono_contatto||"",metodo_pagamento:e.metodo_pagamento||"",iban:e.iban||""},this.newSupplier.regione&&this.filterProvincesByRegion(this.newSupplier.regione))}catch(e){console.error("Errore nel caricamento:",e),this.error="Impossibile caricare i dati del fornitore"}finally{this.loading=!1}}})}onRegionChange(){this.filterProvincesByRegion(this.newSupplier.regione||""),this.newSupplier.provincia=""}filterProvincesByRegion(e){this.filteredProvinces=this.provinces.filter(t=>t.region===e)}onSubmit(){return C(this,null,function*(){this.loading=!0,this.error=null;try{if(this.isEditMode&&this.supplierId){let e=B({id:this.supplierId},this.newSupplier);yield this.supplierService.updateSupplier(e),this.router.navigate(["/admin/fornitori"])}else yield this.supplierService.createSupplier(this.newSupplier),this.router.navigate(["/admin/fornitori"])}catch(e){console.error("Errore nel salvataggio:",e),this.error="Impossibile salvare il fornitore"}finally{this.loading=!1}})}onCancel(){this.router.navigate(["/admin/fornitori"])}static \u0275fac=function(t){return new(t||n)(z(fd),z(rr),z(We),z(qt),z(Dm))};static \u0275cmp=he({type:n,selectors:[["app-add-profile"]],outputs:{save:"save",cancel:"cancel"},decls:90,vars:18,consts:[[1,"container"],[1,"header-row"],["routerLink","/admin/fornitori","title","Torna indietro",1,"btn-icon"],[1,"material-icons"],[1,"section-title"],[3,"ngSubmit"],[1,"form-row"],[1,"form-group"],[1,"required"],["type","text","name","ragione_sociale","required","",1,"input-field",3,"ngModelChange","ngModel"],["type","text","name","partita_iva","required","","maxlength","11",1,"input-field",3,"ngModelChange","ngModel"],["type","text","name","indirizzo",1,"input-field",3,"ngModelChange","ngModel"],["type","text","name","citta",1,"input-field",3,"ngModelChange","ngModel"],["name","regione",1,"input-field",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["name","provincia",1,"input-field",3,"ngModelChange","ngModel","disabled"],["type","tel","name","telefono",1,"input-field",3,"ngModelChange","ngModel"],["type","email","name","email",1,"input-field",3,"ngModelChange","ngModel"],["type","email","name","pec",1,"input-field",3,"ngModelChange","ngModel"],["type","text","name","persona_contatto",1,"input-field",3,"ngModelChange","ngModel"],["type","tel","name","telefono_contatto",1,"input-field",3,"ngModelChange","ngModel"],["name","metodo_pagamento",1,"input-field",3,"ngModelChange","ngModel"],["value","Bonifico"],["value","Assegno"],["value","Contanti"],["value","Carta"],["type","text","name","iban",1,"input-field",3,"ngModelChange","ngModel"],[1,"modal-actions"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],[3,"value"]],template:function(t,i){t&1&&(g(0,"div",0)(1,"div",1)(2,"button",2)(3,"i",3),v(4,"arrow_back"),p()(),g(5,"h2",4),v(6),p()(),g(7,"form",5),F("ngSubmit",function(){return i.onSubmit()}),g(8,"div",6)(9,"div",7)(10,"label"),v(11,"Ragione Sociale "),g(12,"span",8),v(13,"*"),p()(),g(14,"input",9),Z("ngModelChange",function(o){return Y(i.newSupplier.ragione_sociale,o)||(i.newSupplier.ragione_sociale=o),o}),p()(),g(15,"div",7)(16,"label"),v(17,"Partita IVA "),g(18,"span",8),v(19,"*"),p()(),g(20,"input",10),Z("ngModelChange",function(o){return Y(i.newSupplier.partita_iva,o)||(i.newSupplier.partita_iva=o),o}),p()()(),g(21,"div",6)(22,"div",7)(23,"label"),v(24,"Indirizzo"),p(),g(25,"input",11),Z("ngModelChange",function(o){return Y(i.newSupplier.indirizzo,o)||(i.newSupplier.indirizzo=o),o}),p()(),g(26,"div",7)(27,"label"),v(28,"Citt\xE0"),p(),g(29,"input",12),Z("ngModelChange",function(o){return Y(i.newSupplier.citta,o)||(i.newSupplier.citta=o),o}),p()()(),g(30,"div",6)(31,"div",7)(32,"label"),v(33,"Regione"),p(),g(34,"select",13),Z("ngModelChange",function(o){return Y(i.newSupplier.regione,o)||(i.newSupplier.regione=o),o}),F("change",function(){return i.onRegionChange()}),g(35,"option",14),v(36,"Seleziona Regione"),p(),N(37,SX,2,2,"option",15),p()(),g(38,"div",7)(39,"label"),v(40,"Provincia (Sigla)"),p(),g(41,"select",16),Z("ngModelChange",function(o){return Y(i.newSupplier.provincia,o)||(i.newSupplier.provincia=o),o}),g(42,"option",14),v(43,"Seleziona Provincia"),p(),N(44,CX,2,3,"option",15),p()()(),g(45,"div",6)(46,"div",7)(47,"label"),v(48,"Telefono"),p(),g(49,"input",17),Z("ngModelChange",function(o){return Y(i.newSupplier.telefono,o)||(i.newSupplier.telefono=o),o}),p()(),g(50,"div",7)(51,"label"),v(52,"Email"),p(),g(53,"input",18),Z("ngModelChange",function(o){return Y(i.newSupplier.email,o)||(i.newSupplier.email=o),o}),p()()(),g(54,"div",6)(55,"div",7)(56,"label"),v(57,"PEC"),p(),g(58,"input",19),Z("ngModelChange",function(o){return Y(i.newSupplier.pec,o)||(i.newSupplier.pec=o),o}),p()(),g(59,"div",7)(60,"label"),v(61,"Persona di Contatto"),p(),g(62,"input",20),Z("ngModelChange",function(o){return Y(i.newSupplier.persona_contatto,o)||(i.newSupplier.persona_contatto=o),o}),p()()(),g(63,"div",6)(64,"div",7)(65,"label"),v(66,"Telefono Contatto"),p(),g(67,"input",21),Z("ngModelChange",function(o){return Y(i.newSupplier.telefono_contatto,o)||(i.newSupplier.telefono_contatto=o),o}),p()(),g(68,"div",7)(69,"label"),v(70,"Metodo Pagamento"),p(),g(71,"select",22),Z("ngModelChange",function(o){return Y(i.newSupplier.metodo_pagamento,o)||(i.newSupplier.metodo_pagamento=o),o}),g(72,"option",23),v(73,"Bonifico"),p(),g(74,"option",24),v(75,"Assegno"),p(),g(76,"option",25),v(77,"Contanti"),p(),g(78,"option",26),v(79,"Carta di Credito"),p()()()(),g(80,"div",6)(81,"div",7)(82,"label"),v(83,"IBAN"),p(),g(84,"input",27),Z("ngModelChange",function(o){return Y(i.newSupplier.iban,o)||(i.newSupplier.iban=o),o}),p()()(),g(85,"div",28)(86,"button",29),F("click",function(){return i.onCancel()}),v(87,"Annulla"),p(),g(88,"button",30),v(89),p()()()()),t&2&&(_(6),q(i.isEditMode?"Modifica Fornitore":"Aggiungi Nuovo Fornitore"),_(8),G("ngModel",i.newSupplier.ragione_sociale),_(6),G("ngModel",i.newSupplier.partita_iva),_(5),G("ngModel",i.newSupplier.indirizzo),_(4),G("ngModel",i.newSupplier.citta),_(5),G("ngModel",i.newSupplier.regione),_(3),x("ngForOf",i.regions),_(4),G("ngModel",i.newSupplier.provincia),x("disabled",!i.newSupplier.regione),_(3),x("ngForOf",i.filteredProvinces),_(5),G("ngModel",i.newSupplier.telefono),_(4),G("ngModel",i.newSupplier.email),_(5),G("ngModel",i.newSupplier.pec),_(4),G("ngModel",i.newSupplier.persona_contatto),_(5),G("ngModel",i.newSupplier.telefono_contatto),_(4),G("ngModel",i.newSupplier.metodo_pagamento),_(13),G("ngModel",i.newSupplier.iban),_(5),J(" ",i.isEditMode?"Aggiorna":"Salva"," "))},dependencies:[Se,Ze,vt,bi,Ot,Nt,st,Dt,at,yi,Ln,EE,pt,Ir,bt,sn],styles:[".header-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem}.btn-icon[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--text-light);cursor:pointer;padding:.5rem;border-radius:50%;transition:all .3s ease}.btn-icon[_ngcontent-%COMP%]:hover{background:#ffffff1a;transform:scale(1.1)}"]})};var Pp=class n{constructor(e,t,i,r){this.clientService=e;this.supabase=t;this.router=i;this.route=r}cliente={first_name:"",last_name:"",email:"",phone:"",data_nascita:null,sesso:null};isEditMode=!1;clienteId=null;loading=!1;error=null;ngOnInit(){return C(this,null,function*(){this.clienteId=this.route.snapshot.paramMap.get("id"),this.isEditMode=!!this.clienteId,this.isEditMode&&(yield this.loadClienteData())})}loadClienteData(){return C(this,null,function*(){this.loading=!0,this.error=null;try{let e=yield this.clientService.getClientById(this.clienteId);e&&(this.cliente={first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",phone:e.phone||"",data_nascita:e.data_nascita||null,sesso:e.sesso||null})}catch(e){console.error("Errore nel caricamento:",e),this.error="Impossibile caricare i dati del cliente"}finally{this.loading=!1}})}onSubmit(){return C(this,null,function*(){this.loading=!0,this.error=null;try{let e=ne(B({},this.cliente),{data_nascita:this.cliente.data_nascita||null,sesso:this.cliente.sesso||null});this.isEditMode&&this.clienteId?(yield this.clientService.updateClient(this.clienteId,e),this.router.navigate(["/admin/clienti"])):(yield this.clientService.createClient(e),this.router.navigate(["/admin/clienti"]))}catch(e){console.error("Errore nel salvataggio:",e),this.error="Impossibile salvare il cliente: "+(e.message||"Errore sconosciuto")}finally{this.loading=!1}})}onCancel(){this.router.navigate(["/admin/clienti"])}static \u0275fac=function(t){return new(t||n)(z(ir),z(ue),z(We),z(qt))};static \u0275cmp=he({type:n,selectors:[["app-add-cliente"]],decls:50,vars:9,consts:[[1,"container"],[1,"header-row"],["routerLink","/admin/clienti","title","Torna indietro",1,"btn-icon"],[1,"material-icons"],[1,"section-title"],[3,"ngSubmit"],[1,"form-row"],[1,"form-group"],[1,"required"],["type","text","name","first_name","required","",1,"input-field",3,"ngModelChange","ngModel"],["type","text","name","last_name","required","",1,"input-field",3,"ngModelChange","ngModel"],["type","email","name","email",1,"input-field",3,"ngModelChange","ngModel"],["type","tel","name","phone",1,"input-field",3,"ngModelChange","ngModel"],["type","date","name","data_nascita",1,"input-field",3,"ngModelChange","ngModel"],["for","sesso"],["id","sesso","name","sesso",1,"form-select",3,"ngModelChange","ngModel"],[3,"ngValue"],["value","maschio"],["value","femmina"],[1,"modal-actions"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary"]],template:function(t,i){t&1&&(g(0,"div",0)(1,"div",1)(2,"button",2)(3,"i",3),v(4,"arrow_back"),p()(),g(5,"h2",4),v(6),p()(),g(7,"form",5),F("ngSubmit",function(){return i.onSubmit()}),g(8,"div",6)(9,"div",7)(10,"label"),v(11,"Nome "),g(12,"span",8),v(13,"*"),p()(),g(14,"input",9),Z("ngModelChange",function(o){return Y(i.cliente.first_name,o)||(i.cliente.first_name=o),o}),p()(),g(15,"div",7)(16,"label"),v(17,"Cognome "),g(18,"span",8),v(19,"*"),p()(),g(20,"input",10),Z("ngModelChange",function(o){return Y(i.cliente.last_name,o)||(i.cliente.last_name=o),o}),p()()(),g(21,"div",6)(22,"div",7)(23,"label"),v(24,"Email"),p(),g(25,"input",11),Z("ngModelChange",function(o){return Y(i.cliente.email,o)||(i.cliente.email=o),o}),p()(),g(26,"div",7)(27,"label"),v(28,"Telefono"),p(),g(29,"input",12),Z("ngModelChange",function(o){return Y(i.cliente.phone,o)||(i.cliente.phone=o),o}),p()()(),g(30,"div",6)(31,"div",7)(32,"label"),v(33,"Data di Nascita (opzionale)"),p(),g(34,"input",13),Z("ngModelChange",function(o){return Y(i.cliente.data_nascita,o)||(i.cliente.data_nascita=o),o}),p()(),g(35,"div",7)(36,"label",14),v(37,"Sesso (opzionale)"),p(),g(38,"select",15),Z("ngModelChange",function(o){return Y(i.cliente.sesso,o)||(i.cliente.sesso=o),o}),g(39,"option",16),v(40,"Seleziona sesso"),p(),g(41,"option",17),v(42,"Maschio"),p(),g(43,"option",18),v(44,"Femmina"),p()()()(),g(45,"div",19)(46,"button",20),F("click",function(){return i.onCancel()}),v(47,"Annulla"),p(),g(48,"button",21),v(49),p()()()()),t&2&&(_(6),q(i.isEditMode?"Modifica Cliente":"Aggiungi Nuovo Cliente"),_(8),G("ngModel",i.cliente.first_name),_(6),G("ngModel",i.cliente.last_name),_(5),G("ngModel",i.cliente.email),_(4),G("ngModel",i.cliente.phone),_(5),G("ngModel",i.cliente.data_nascita),_(4),G("ngModel",i.cliente.sesso),_(),x("ngValue",null),_(10),J(" ",i.isEditMode?"Aggiorna":"Salva"," "))},dependencies:[Se,vt,bi,Ot,Nt,st,Dt,at,yi,Ln,pt,Ir,bt,sn],encapsulation:2})};var kF=[{path:"admin/home",component:Tv},{path:"admin/lista-prodotti",component:Zv,canDeactivate:[n=>n.canDeactivate()]},{path:"admin/servizi",component:t_},{path:"admin/calendario",component:g0},{path:"admin/popup-calendario",component:cd},{path:"admin/popup-fedelity",component:dd},{path:"admin/clienti",component:m0},{path:"admin/clienti/nuovo",component:Pp},{path:"add-cliente/:id",component:Pp},{path:"admin/fornitori",component:v0},{path:"admin/fornitori/nuovo",component:Tp},{path:"admin/fornitori/edita/:id",component:Tp},{path:"admin/tessera",component:_0},{path:"admin/impostazioni",component:Ip},{path:"admin/product-detail",component:Mp},{path:"admin/product-detail/:type/:id",component:Mp},{path:"user/home",component:y0},{path:"user/lista-barbieri",component:w0},{path:"user/mappa",component:E0},{path:"user/storico-apt",component:x0},{path:"user/impostazioni",component:Ip},{path:"user/salone/:id",component:M0},{path:"user/nuovo-appuntamento/:salonId",component:P0},{path:"",redirectTo:"admin/home",pathMatch:"full"},{path:"register",component:D0},{path:"login",component:I0},{path:"**",redirectTo:""}];var OF={providers:[Hb(),wS({eventCoalescing:!0}),zC(kF),xm()]};function EX(n,e){if(n&1){let t=ee();g(0,"li")(1,"a",9),F("click",function(){A(t);let r=E();return R(r.onNavClick())}),ie(2,"i"),g(3,"span"),v(4),p()()()}if(n&2){let t=e.$implicit;_(),x("routerLink",t.link),_(),hs(t.icon),_(2),q(t.label)}}function xX(n,e){if(n&1&&(tt(0),ie(1,"img",13),nt()),n&2){let t=E(2);_(),x("src",t.avatarUrl,kt)}}function DX(n,e){if(n&1&&(g(0,"div",14),v(1),p()),n&2){let t=E(2);_(),q(t.initials||"?")}}function IX(n,e){if(n&1&&(tt(0),N(1,xX,2,1,"ng-container",8)(2,DX,2,1,"ng-template",null,1,$t),g(4,"div",10)(5,"div",11),v(6),p(),g(7,"div",12),v(8),p()(),nt()),n&2){let t=Ve(3),i=E();_(),x("ngIf",i.avatarUrl)("ngIfElse",t),_(5),q(i.userName),_(2),q(i.isAdmin?"Barbiere Admin":"Cliente")}}function MX(n,e){n&1&&(g(0,"div",14),v(1,"G"),p(),g(2,"div",10)(3,"div",11),v(4,"Guest"),p(),g(5,"div",12),v(6,"Visitatore"),p()())}var A0=class n{constructor(e){this.router=e;this.supabase=lo(Nn.supabaseUrl,Nn.supabaseAnonKey)}isAdmin=!1;open=!0;toggle=new ye;navigate=new ye;logout=new ye;menuItems=[];userId=null;userName="";initials="";avatarUrl=null;supabase;authSub=null;routerSub=null;ngOnInit(){this.setContextAndMenu(this.router.url),this.routerSub=this.router.events.subscribe(e=>{e instanceof mn&&this.setContextAndMenu(e.urlAfterRedirects)}),this.initAuthHandling()}ngOnDestroy(){try{this.authSub&&typeof this.authSub.unsubscribe=="function"?this.authSub.unsubscribe():this.authSub&&typeof this.authSub=="object"&&this.authSub?.subscription&&this.authSub.subscription.unsubscribe?.()}catch{}this.routerSub?.unsubscribe?.()}setContextAndMenu(e){this.isAdmin=e.startsWith("/admin/"),this.menuItems=this.isAdmin?[{label:"Home",link:"/admin/home",icon:"fa fa-home"},{label:"Lista prodotti",link:"/admin/lista-prodotti",icon:"fa fa-box"},{label:"Lista servizi",link:"/admin/servizi",icon:"fa fa-concierge-bell"},{label:"Calendario",link:"/admin/calendario",icon:"fa fa-calendar-alt"},{label:"Clienti",link:"/admin/clienti",icon:"fa fa-users"},{label:"Fornitori",link:"/admin/fornitori",icon:"fa fa-truck"},{label:"Impostazioni",link:"/admin/impostazioni",icon:"fa fa-cog"}]:[{label:"Home",link:"/user/home",icon:"fa fa-home"},{label:"Lista barbieri",link:"/user/lista-barbieri",icon:"fa fa-user"},{label:"Mappa barbieri",link:"/user/mappa",icon:"fa fa-map-marked-alt"},{label:"Storico appuntamenti",link:"/user/storico-apt",icon:"fa fa-history"},{label:"Impostazioni",link:"/user/impostazioni",icon:"fa fa-cog"}]}onNavClick(){this.navigate.emit()}onToggle(){this.toggle.emit()}onLogout(){return C(this,null,function*(){try{yield this.supabase.auth.signOut()}catch(e){console.warn("Logout error",e)}this.clearUser(),this.logout.emit(),this.router.navigate(["/"])})}initAuthHandling(){return C(this,null,function*(){console.log("[Sidebar] initAuthHandling start");try{let{data:e}=yield this.supabase.auth.getSession(),t=e?.session;if(console.log("[Sidebar] getSession result:",t),t?.user?.id)yield this.loadProfile(t.user.id);else{let{data:i}=yield this.supabase.auth.getUser(),r=i?.user;console.log("[Sidebar] getUser fallback result:",r),r?.id?yield this.loadProfile(r.id):this.clearUser()}}catch(e){console.warn("[Sidebar] getSession/getUser error:",e),this.clearUser()}try{let{data:e}=this.supabase.auth.onAuthStateChange((t,i)=>{console.log("[Sidebar] onAuthStateChange event:",t," session:",i),i?.user?.id?this.loadProfile(i.user.id).catch(r=>console.warn("loadProfile err",r)):this.clearUser()});this.authSub=e?.subscription??e}catch(e){console.warn("[Sidebar] onAuthStateChange subscribe error",e)}})}loadProfile(e){return C(this,null,function*(){console.log("[Sidebar] loadProfile for",e);try{let{data:t,error:i}=yield this.supabase.from("profiles").select("first_name,last_name,full_name,role,avatar_path").eq("id",e).maybeSingle();if(i){console.warn("[Sidebar] profile fetch error",i),this.clearUser();return}if(!t){console.warn("[Sidebar] profile missing for user",e),this.clearUser();return}let r=t.first_name??"",o=t.last_name??"",s=t.full_name??"",l=`${r} ${o}`.trim()||s||"Utente";this.userName=l,this.initials=this.computeInitials(l),t.avatar_path?/^https?:\/\//.test(t.avatar_path)?this.avatarUrl=t.avatar_path:this.avatarUrl=`${Nn.supabaseUrl.replace(/^https?:\/\//,"https://")}/storage/v1/object/public/avatars/${t.avatar_path}`:this.avatarUrl=null,this.isAdmin=t.role==="admin",this.userId=e,console.log("[Sidebar] profile loaded",{userId:e,name:l,avatar:this.avatarUrl,role:t.role})}catch(t){console.error("[Sidebar] loadProfile unexpected error",t),this.clearUser()}})}computeInitials(e){if(!e)return"?";let t=e.split(" ").filter(Boolean);return t.length===1?t[0].slice(0,2).toUpperCase():(t[0].charAt(0)+t[t.length-1].charAt(0)).toUpperCase()}clearUser(){this.userId=null,this.userName="",this.initials="",this.avatarUrl=null}static \u0275fac=function(t){return new(t||n)(z(We))};static \u0275cmp=he({type:n,selectors:[["app-sidebar"]],inputs:{isAdmin:"isAdmin",open:"open"},outputs:{toggle:"toggle",navigate:"navigate",logout:"logout"},decls:12,vars:4,consts:[["guestTpl",""],["initialsTpl",""],[1,"sidebar",3,"ngClass"],[1,"sidebar__brand"],[1,"sidebar__spacer"],[1,"sidebar__nav"],[4,"ngFor","ngForOf"],[1,"sidebar__user-info"],[4,"ngIf","ngIfElse"],["routerLinkActive","active",3,"click","routerLink"],[1,"user-details"],[1,"user-name"],[1,"user-role"],["alt","Avatar",1,"user-avatar",3,"src"],[1,"user-avatar","initials"]],template:function(t,i){if(t&1&&(g(0,"aside",2)(1,"div",3)(2,"h1"),v(3,"BarberApp"),p()(),ie(4,"div",4),g(5,"nav",5)(6,"ul"),N(7,EX,5,4,"li",6),p()(),g(8,"div",7),N(9,IX,9,4,"ng-container",8)(10,MX,7,0,"ng-template",null,0,$t),p()()),t&2){let r=Ve(11);x("ngClass",i.isAdmin?"admin":"user"),_(7),x("ngForOf",i.menuItems),_(2),x("ngIf",i.userName&&i.userName.length)("ngIfElse",r)}},dependencies:[Se,va,Ze,Ne,bt,sn,FC],styles:[".sidebar[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;width:100%;max-width:300px;min-width:200px;flex:0 0 auto;background:var(--background);color:var(--text-light);padding:var(--padding-v) 0;font-family:Segoe UI,sans-serif;overflow:auto}.sidebar__brand[_ngcontent-%COMP%]{text-align:center;padding:var(--padding-v)}.sidebar__brand[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:var(--font-size-xl);background:linear-gradient(135deg,var(--primary),var(--secondary));background-clip:text;-webkit-background-clip:text;color:transparent;-webkit-text-fill-color:transparent;filter:drop-shadow(0 0 4px color-mix(in srgb,var(--primary) 60%,transparent))}.sidebar__spacer[_ngcontent-%COMP%]{flex:1}.sidebar__nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.sidebar__nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:0}.sidebar__nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;padding:clamp(.4rem,.8vw,1rem) clamp(1rem,1vw,2rem);color:var(--text-light);text-decoration:none;font-size:var(--font-size-medium);border-left:3px solid transparent;transition:background .3s,border-color .3s}.sidebar__nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:var(--padding-v);width:var(--padding-h);text-align:center}.sidebar__nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .sidebar__nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--primary) 20%,transparent);border-left-color:var(--secondary);font-weight:600;border-radius:var(--border-radius);margin:0}.sidebar__nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{font-weight:700}.sidebar__user-info[_ngcontent-%COMP%]{display:flex;align-items:center;padding:var(--padding-v);margin-top:var(--padding-v);margin-bottom:var(--padding-v);border-top:1px solid color-mix(in srgb,var(--text-light) 20%,transparent);gap:var(--padding-v);background:color-mix(in srgb,var(--background2) 30%,transparent)}.user-avatar[_ngcontent-%COMP%]{flex:0 0 40px;width:40px;height:40px;border-radius:50%;object-fit:cover;background:linear-gradient(180deg,color-mix(in srgb,var(--primary) 20%,transparent),color-mix(in srgb,var(--secondary) 20%,transparent))!important;border:1px solid color-mix(in srgb,var(--text-light) 20%,transparent);color:var(--text-light)}.user-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1 1 auto;min-width:0;overflow:hidden}.user-name[_ngcontent-%COMP%]{display:block;text-overflow:ellipsis;white-space:nowrap;font-weight:700;color:var(--primary);overflow:hidden;max-width:100%}.user-role[_ngcontent-%COMP%]{font-size:.82rem;color:var(--text-muted);margin-top:var(--padding-v);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.sidebar__footer[_ngcontent-%COMP%]{padding:var(--padding-v)}.user-avatar.initials[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-weight:700}"]})};function TX(n,e){if(n&1){let t=ee();g(0,"div",6),F("click",function(){A(t);let r=E();return R(r.closeSidebar())}),p()}}var R0=class n{constructor(e){this.router=e;this.router.events.subscribe(t=>{t instanceof mn&&(this.sidebarOpen=!1)})}sidebarOpen=!0;isAdmin=!1;showSidebar=!0;toggleSidebar(){this.sidebarOpen=!this.sidebarOpen}closeSidebar(){this.sidebarOpen=!1}static \u0275fac=function(t){return new(t||n)(z(We))};static \u0275cmp=he({type:n,selectors:[["app-root"]],decls:8,vars:4,consts:[[1,"hamburger-btn",3,"click"],[1,"layout",3,"click"],[1,"sidebar-container"],[3,"navigate","logout","isAdmin"],["class","overlay",3,"click",4,"ngIf"],[1,"content-container",3,"click"],[1,"overlay",3,"click"]],template:function(t,i){t&1&&(g(0,"button",0),F("click",function(o){return i.toggleSidebar(),o.stopPropagation()}),v(1,` \u2630
`),p(),g(2,"div",1),F("click",function(){return i.closeSidebar()}),g(3,"div",2)(4,"app-sidebar",3),F("navigate",function(){return i.closeSidebar()})("logout",function(){return i.closeSidebar()}),p()(),N(5,TX,1,0,"div",4),g(6,"div",5),F("click",function(o){return o.stopPropagation()}),ie(7,"router-outlet"),p()()),t&2&&(_(2),Oe("open",i.sidebarOpen),_(2),x("isAdmin",i.isAdmin),_(),x("ngIf",i.sidebarOpen))},dependencies:[Se,Ne,bt,Uu,A0],styles:["*[_ngcontent-%COMP%]{box-sizing:border-box}.layout[_ngcontent-%COMP%]{display:flex;height:100vh;overflow:hidden}.layout.open[_ngcontent-%COMP%]{grid-template-columns:250px 1fr}.sidebar-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;height:100%;width:250px;background:var(--background2);border-right:2px solid var(--primary);transform:translate(-100%);transition:transform .3s ease-in-out;z-index:15}.layout.open[_ngcontent-%COMP%]   .sidebar-container[_ngcontent-%COMP%]{transform:translate(0)}.hamburger-btn[_ngcontent-%COMP%]{position:fixed;top:1rem;left:1rem;background:transparent;border:1px var(--secondary) solid;color:var(--primary);font-size:var(--font-size-lg);padding:.5rem;border-radius:20px;z-index:20;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px)}.hamburger-btn[_ngcontent-%COMP%]:hover{background:var(--primary);color:var(--background)}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:color-mix(in srgb,var(--background) 80%,transparent);z-index:10;opacity:0;pointer-events:none;transition:opacity .3s ease-in-out}.layout.open[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{opacity:1;pointer-events:auto}.content-container[_ngcontent-%COMP%]{flex:1;padding:.5rem;overflow-y:auto;background-color:var(--background2);color:var(--gold);transition:filter .3s ease-in-out}.layout.open[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]{filter:blur(2px)}"]})};iC(R0,OF).catch(n=>console.error(n));
